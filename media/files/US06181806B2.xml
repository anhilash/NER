<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06181806B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06181806</doc-number>
        <kind>B2</kind>
        <date>20010130</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6181806</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference family-id="13407647" extended-family-id="4579735">
      <document-id>
        <country>US</country>
        <doc-number>09318823</doc-number>
        <kind>A</kind>
        <date>19990526</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1999US-09318823</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>4768702</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>31882399</doc-number>
        <kind>A</kind>
        <date>19990526</date>
        <priority-active-indicator>N</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1999US-09318823</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="2">
        <country>JP</country>
        <doc-number>6960593</doc-number>
        <kind>A</kind>
        <date>19930329</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="2">
        <doc-number>1993JP-0069605</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="3">
        <country>US</country>
        <doc-number>34354394</doc-number>
        <kind>A</kind>
        <date>19941129</date>
        <priority-linkage-type>3</priority-linkage-type>
        <priority-active-indicator>N</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="3">
        <doc-number>1994US-08343543</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010130</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <term-of-grant>
      <disclaimer/>
    </term-of-grant>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>G06K   9/00        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>K</subclass>
        <main-group>9</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>382118000</text>
        <class>382</class>
        <subclass>118000</subclass>
      </main-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>G06K-009/00F1S</text>
        <section>G</section>
        <class>06</class>
        <subclass>K</subclass>
        <main-group>009</main-group>
        <subgroup>00F1S</subgroup>
      </classification-ecla>
      <classification-ecla sequence="2">
        <text>G06K-009/00F2</text>
        <section>G</section>
        <class>06</class>
        <subclass>K</subclass>
        <main-group>009</main-group>
        <subgroup>00F2</subgroup>
      </classification-ecla>
      <classification-ecla sequence="3">
        <text>G06K-009/00F2L</text>
        <section>G</section>
        <class>06</class>
        <subclass>K</subclass>
        <main-group>009</main-group>
        <subgroup>00F2L</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06K-009/00255</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>K</subclass>
        <main-group>9</main-group>
        <subgroup>00255</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06K-009/00268</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>K</subclass>
        <main-group>9</main-group>
        <subgroup>00268</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06K-009/00281</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>K</subclass>
        <main-group>9</main-group>
        <subgroup>00281</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>4</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>8</number-of-drawing-sheets>
      <number-of-figures>15</number-of-figures>
      <image-key data-format="questel">US6181806</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Apparatus for identifying a person using facial features</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>CLINE HARVEY E, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4710876</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4710876</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>KURAGANO TETSUZO, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4819192</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4819192</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>DRANEY MARLOW R</text>
          <document-id>
            <country>US</country>
            <doc-number>4829446</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4829446</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>SCHROEDER WILLIAM J</text>
          <document-id>
            <country>US</country>
            <doc-number>5561749</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5561749</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="5">
          <text>MARQUARDT STEPHEN R</text>
          <document-id>
            <country>US</country>
            <doc-number>5659625</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5659625</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="6">
          <text>KADO YOSHIYASU, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5995639</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5995639</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="7">
          <text>ANDO MITSUHIRO</text>
          <document-id>
            <country>US</country>
            <doc-number>5008946</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5008946</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="8">
          <text>LAMBERT LAURENCE C</text>
          <document-id>
            <country>US</country>
            <doc-number>5012522</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5012522</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="9">
          <text>UENO HIROSHI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5293427</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5293427</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="10">
          <text>HOOGERHYDE RANDALL J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5448687</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5448687</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="11">
          <text>TOKYO JUKI INDUSTRIAL CO LTD</text>
          <document-id>
            <country>JP</country>
            <doc-number>S61177273</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP61177273</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="12">
          <text>MITSUBISHI ELECTRIC CORP</text>
          <document-id>
            <country>JP</country>
            <doc-number>H056419</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP05006419</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="13">
          <text>MATSUSHITA ELECTRIC IND CO LTD</text>
          <document-id>
            <country>JP</country>
            <doc-number>H05197793</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP05197793</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="1">
          <text>J.T. Tou and R.C. Gonzalez, Pattern Recognition Principles, Addison-Wesley Publishing., pp. 75-83.</text>
        </nplcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="2">
          <text>S.Y. Guan, B.H. McCormick, Design for a 3D Deformable Brain Atlas, Computer-Based Medical Systems, Proceedings fo the Fourth Annual IEEE Symposium.</text>
        </nplcit>
      </citation>
    </references-cited>
    <related-documents>
      <division>
        <relation>
          <parent-doc>
            <document-id>
              <country>US</country>
              <doc-number>34354394</doc-number>
              <kind>A</kind>
              <date>19941129</date>
            </document-id>
          </parent-doc>
        </relation>
        <relation>
          <parent-doc>
            <document-id>
              <country>US</country>
              <doc-number>5995639</doc-number>
              <kind>A</kind>
            </document-id>
          </parent-doc>
        </relation>
      </division>
    </related-documents>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Matsushita Electric Industrial Co., Ltd.</orgname>
            <address>
              <address-1>Osaka, JP</address-1>
              <city>Osaka</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>PANASONIC</orgname>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Kado, Yoshiyasu</name>
            <address>
              <address-1>Kadoma, JP</address-1>
              <city>Kadoma</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="2">
          <addressbook lang="en">
            <name>Nakagawa, Masamichi</name>
            <address>
              <address-1>Hirakata, JP</address-1>
              <city>Hirakata</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="3">
          <addressbook lang="en">
            <name>Nobori, Kunio</name>
            <address>
              <address-1>Kadoma, JP</address-1>
              <city>Kadoma</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <orgname>McDermott, Will &amp; Emery</orgname>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Mancuso, Joseph</name>
      </primary-examiner>
    </examiners>
    <pct-or-regional-filing-data>
      <document-id>
        <country>WO</country>
        <doc-number>JP9400493</doc-number>
        <date>19940328</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1994WO-JP00493</doc-number>
      </document-id>
    </pct-or-regional-filing-data>
    <pct-or-regional-publishing-data>
      <document-id>
        <country>WO</country>
        <doc-number>9423390</doc-number>
        <kind>A1</kind>
        <date>19941013</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>WO9423390</doc-number>
      </document-id>
    </pct-or-regional-publishing-data>
    <lgst-data>
      <lgst-status>EXPIRED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      The present invention inputs a face image through an image input section, extracts feature points of face components such as an eye, nose, mouth from the input face image, and divides the face image into many patches according to predetermined rules to describe the face image as a set of patches.
      <br/>
      Then the present invention extracts a feature amount for each patch to describe the face image as a set of feature amounts to identify a person.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <p num="1">
      This is a divisional application of Ser.
      <br/>
      No. 08/343,543, filed Nov. 29, 1994, U.S. Pat. No 5,995,639.
    </p>
    <heading>FIELD OF THE TECHNOLOGY</heading>
    <p num="2">The present invention relates to apparatus for identifying persons such as identifying persons by their face images in their admission to a room or searching and outputting the name of a person whose face image resembles an input face image.</p>
    <heading>BACKGROUND TECHNOLOGY</heading>
    <p num="3">
      As a prior apparatus for identifying persons by their face images there is one described in Japanese Pat. laid-open Publication No. Sho 63-177273.
      <br/>
      The composition of that apparatus is described in the following.
    </p>
    <p num="4">
      FIG. 15 shows a block diagram showing a composition of the prior apparatus for identifying persons by their face images.
      <br/>
      In the FIG., 21 is an image input section that inputs a face image, 22 is a feature-points extracting section comprising an analog-to-digital converter, a central processor, and a memory, 23 is a personal database section that records people's feature points on cards or the like, 24 is a judgment section that uses the feature-points information of above feature-points extracting section 22 and the feature-points information of personal database section 23 to detect their difference and identifies the person having that face image as the person of personal database 23 based on the test whether the difference is greater than a threshold value or not.
    </p>
    <p num="5">
      The above prior technology extracts, in feature-points extracting section 22, feature points of a person's face image input from image input section 21 and detects, in judgment section 24, the differences between these feature points and the feature points of a face image registered in personal database section 23, and identifies the person based on the amount of the difference.
      <br/>
      In this case, if the sizes of the two images are different, or if their photographing angles are different, then the differences in the feature points become great, so that even the same person is identified as a different person.
      <br/>
      In order to avoid such a situation, it was necessary to fix the distance between the image input section and a photographed person and to make him or her face turned straight toward the front.
      <br/>
      However, this method of inputting a face image imposes a burden on the photographed person, and no matter how hard the person tries to turn straight to the front, a slight rotation and inclination are inevitable, so that it was difficult to obtain an image exactly facing the front.
    </p>
    <p num="6">The basic object of the present invention is to provide an apparatus for identifying persons having high discriminating power.</p>
    <p num="7">Another object of the present invention is to provide an apparatus for identifying persons that performs identification with high accuracy against minor fluctuations of photographing conditions such as illumination conditions and the position of the face.</p>
    <heading>DISCLOSURE OF THE INVENTION</heading>
    <p num="8">
      In order to achieve the aforementioned objective, the present invention extracts feature points of face components such as the eyes, nose, mouth, and uses the extracted feature points to divide a face image into small patches of, for example, triangles and describe a face image as the set of these patches.
      <br/>
      Then a feature amount is extracted for each patch and the set of extracted feature amounts is used to identify the face image of a person.
      <br/>
      As a feature amount, the average brightness of each patch can be used.
      <br/>
      In this case, the face image is treated as a monochromatic image, so that the processing can be simplified, and the image formed by obtained patches having graded brightnesses sufficiently reflects the characteristics of the face, that is, concavo-convexity, flatness, curvature and the like are indirectly expressed.
      <br/>
      Therefore, by using these features, identification of a person can be performed accurately.
      <br/>
      Besides average brightness, the difference in brightnesses between adjacent patches can be used as a feature amount.
    </p>
    <p num="9">
      A practical method applies a standard structure model that describes a standard face image as a set of patches.
      <br/>
      When the feature points of an input face image is extracted, they are compared with the feature points of the standard structure model, and the standard structure model is deformed and adjusted based on the extracted feature point information, to obtain an adjusted structure model corresponding to the input face image.
      <br/>
      The adjusted structure model obtained in this way is expressed as a set of patches as described above, and a feature amount is extracted for each patch.
    </p>
    <p num="10">
      The extracted feature amounts are compared with the feature amounts of each person in the personal database to detect the degree of agreement by calculating a distance between the feature amounts.
      <br/>
      In case of confirming a specific person, the extracted feature amounts are compared with the feature amounts of the specific person.
      <br/>
      In case of searching for identification, the extracted feature amounts are successively compared with the data stored in the personal database to extract a face image having a large degree of agreement.
    </p>
    <p num="11">
      The standard structure model may be either 2-dimensional or 3-dimensional.
      <br/>
      In the 3-dimensional case, if the normal vector of each patch is extracted as well as its brightness, then the concavo-convexity of the face is expressed more clearly, and the position of the light source can be estimated from the distribution of the brightnesses, so that correction depending on the position of the light source can be made possible.
      <br/>
      Further, if the face is slightly inclined against the camera, errors due to the inclination can be prevented by a correction such that the brightness distribution becomes bilaterally symmetric.
    </p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="12">
      The characteristics and objects of the present invention will become clear from the following description taken in conjunction with the preferred embodiments thereof with reference to the accompanying drawings.
      <br/>
      FIG. 1 is a system configuration diagram of an apparatus for identifying persons in accordance with the present invention.
      <br/>
      FIG. 2 is a block diagram of an embodiment of an apparatus for identifying persons in accordance with the present invention.
      <br/>
      FIG. 3 is an illustration showing feature points of a face.
      <br/>
      FIGS. 4, 5, 6 and 7 are enlarged illustrations respectively showing feature points of an eyebrow, eye, nose, and mouth.
      <br/>
      FIG. 8 is an illustration showing a distribution of extracted feature points.
      <br/>
      FIG. 9 is an illustration showing the frame structure of a standard structure model.
      <br/>
      FIG. 10 is an illustration showing the frame structure of the result obtained by deforming and adjusting the standard structure model based on extracted feature points.
      <br/>
      FIG. 11 is an illustration showing a system diagram of an apparatus for identifying persons in accordance with the present invention.
      <br/>
      FIG. 12 is a flowchart of extracting feature points.
      <br/>
      FIG. 13 is an illustration for describing a linear interpolation of a vertex.
      <br/>
      FIG. 14 is a block diagram showing another embodiment of an apparatus for identifying persons in accordance with the present invention.
      <br/>
      FIG. 15 is block diagram showing the composition of a prior apparatus for identifying persons.
    </p>
    <heading>BEST FORM FOR IMPLEMENTING THE INVENTION</heading>
    <p num="13">In the following is described embodiments of the present invention.</p>
    <p num="14">&lt;System Configuration&gt;</p>
    <p num="15">
      The hardware of an apparatus in accordance with the present invention is, as shown in FIG. 1, basically comprised of an image input section 2 consisting in a TV camera 1 that takes a picture of a person to be identified and an image processing section 4 comprising a microcomputer 3 to which the data of a face image photographed by TV camera 1 is input.
      <br/>
      The image processing section 4 has, in addition to microcomputer 3, a display 5 that displays necessary information, a printer 6 that records necessary information, an operation means 8 comprising a keyboard 7, a mouse (not illustrated) and the like for operating microcomputer 3.
    </p>
    <p num="16">&lt;Functional Block Composition&gt;</p>
    <p num="17">FIG. 2, which shows a first embodiment of the present invention, extracts, as functions, the contents of image processing that is performed by microcomputer 3 for an input face image, and expresses the functions as a block diagram.</p>
    <p num="18">
      Face image data input from image input section 2 is first stored in an image memory 12, and a feature points extracting section 13 extracts feature points from the stored face image, as described in the following.
      <br/>
      Here, the term "feature point" means a predetermined point for specifying an individual component such as an eye, nose, mouth, head, and cheek.
      <br/>
      Therefore, the extraction of feature points means, for example, to detect where the center of the pupil of an eye is located in an input face image, and the characteristics of an individual face are described by detecting the position information of individual feature points.
      <br/>
      FIGS. 4, 5, 6 and 7 respectively show the feature points of an eyebrow, eye, nose and mouth in details.
      <br/>
      The method of extracting feature points is described later.
      <br/>
      FIG. 8 shows an example of extracted feature points.
    </p>
    <p num="19">Feature points, whose positions are specified by feature points extracting section 15 are individually compared with the feature points of a predetermined standard structure model of a face, and the standard structure model is deformed and adjusted so that an individual feature point of the standard structure model becomes in agreement with the corresponding extracted feature point.</p>
    <p num="20">
      The standard structure model is sometimes called a standard wire model, and as exemplified in FIG. 9, the standard face image is divided into many small patches and approximately expressed as the set of the patches.
      <br/>
      Each patch may be a polygon, but a triangle is preferably used for ease of processing, as shown in FIG. 5.
      <br/>
      A concrete method of adjusting is described later.
      <br/>
      FIG. 10 shows an adjusted result obtained from the standard structure model of FIG. 7 using the extracted feature points shown in FIG. 8.
      <br/>
      In the following, a structure model obtained by the adjustment is called adjusted structure model.
    </p>
    <p num="21">
      Back to FIG. 2, a feature amounts extracting section 16 cuts out the part of a face image for each patch stored in image memory 12 to extract a feature amount for the patch based on structure model adjustment section 15.
      <br/>
      As the feature amount, for example, the average brightness of each patch is used.
      <br/>
      If the average brightness is used as the feature amount, the brightness distribution over a face comparatively faithfully reflects the three-dimensional shape of a face under definite illumination conditions.
      <br/>
      Also, the brightness distribution has an advantage of not greatly being affected by a slight change in the angle of the face at the photographing time.
      <br/>
      The feature amount is not limited to the brightness of each patch (average brightness), and the difference in the brightnesses of adjacent patches can be used.
    </p>
    <p num="22">When the feature amounts of an adjusted structure model are extracted in this way, a judgment section 18 successively compares the extracted feature amounts with the feature amounts of persons prepared in a personal database 17, judges a degree of agreement through distance computation, and outputs the result (identification search).</p>
    <p num="23">In case of identification checking, that is, when whether an input face image is that of a specific person or not is checked, judgment section 18 calculates the distance (the absolute value of the difference) between each extracted feature amount and the corresponding feature amount of the specific person stored in personal database 17, and if the total sum of the distances is less than a predetermined threshold value, the input face image is positively identified as that of the person of personal database 17.</p>
    <p num="24">FIG. 11 illustrates the above personal identification processing, and the procedure of the processing will be clearly understood by the illustration.</p>
    <p num="25">Next, individual processing is described in more details.</p>
    <p num="26">&lt;Feature Points Extraction&gt;</p>
    <p num="27">
      The method of extracting the feature points described in the following is not a feature of the present invention, which, however, presumes a method of extracting the feature points.
      <br/>
      The presumed method of extracting the feature points is described in the public report, which the present applicants had already applied for a Japanese patent as a Japanese Pat.
      <br/>
      Appl. No. Hei 4-9753, and was laid open as a Japanese Pat. laid-open publication No. Hei 5-1997793.
      <br/>
      The basic principle of the method is described using the flowchart of FIG. 12.
    </p>
    <p num="28">The extraction of the feature points is, as stated above, performed in feature points extracting section 13.</p>
    <p num="29">
      First, step S1 inputs a face image stored in image memory 12, and after step S2 luminance-converts to generate a monochromatic graded image, step S3 generates an edge image.
      <br/>
      In this case, an operator that obtains not only the magnitude of an edge but its direction, such as the Sobel operator, which is described in Computer Vision, D. H. Ballard and C. M. Brown, Translated by Akio Fukumura, Japan Computer Association 1987, p. 98, is used to extract an edge.
      <br/>
      An edge obtained in this way is called an edge vector, since its components are magnitude and direction.
      <br/>
      An edge image obtained by the edge extraction can not be vividly illustrated, but is displayed by display 5 in such a way as horizontal edges are displayed in green, vertical edges are displayed in red, and the magnitude of edges are displayed by brightness.
    </p>
    <p num="30">
      Next, step S4 determines search areas that show where the face components such as an eye and nose are located.
      <br/>
      These search areas consist of the eyebrow areas, iris area, nose area, right cheek area, left cheek area, and mouth area.
      <br/>
      First, the locations of the right and left irises are determined from the search area of the irises which are positioned in the middle of the vertical direction.
      <br/>
      When the locations of the right and left irises are detected, the size of the whole face is estimated from the distance between the irises and the inclination of the irises.
      <br/>
      The other four areas are successively determined using the obtained locations of the irises.
    </p>
    <p num="31">
      After all search areas are determined, step S5 converts the edge image of each search area into a binary expression.
      <br/>
      Each extracted edge has a magnitude and contains noise.
      <br/>
      The binary coding is performed for the purpose of eliminating noise, and a predetermined threshold value is used.
      <br/>
      The threshold value is determined so that, in the area ratio, 20% of the edge pixels in a search area become 1 and the remaining edge pixels become 0.
    </p>
    <p num="32">
      Next, step S6 performs shape matching for the binary-coded edge image using shape templates to deduce a candidate area by judging a degree of agreement.
      <br/>
      The degree  PHI  of agreement is obtained, for example, by calculating the inner product of two vectors, because the edges and the shape data of each component of a shape template are both expressed by vectors.
    </p>
    <p num="33">
      More specifically, if the edge vectors of an edge image are
      <br/>
      ui, j =(ux, uy)(i, j: the x and y coordinates of an image, ux2 +uy2 =1 or 0)
    </p>
    <p num="34">
      and if the shape data is
      <br/>
      element data pk =(lk, mk)(lk, mk : the x and y coordinates of an element)
    </p>
    <p num="35">slope vector vk =(vx, vy) (vx2 +vy2 =1)</p>
    <p num="36">
      where 1 &lt;= k &lt;= n (n is the number of elements) then the degree of agreement in the coordinates (i, j) of the edge image with the shape data  PHI  becomes
      <br/>
      PHI =( SIGMA Ui+lk, j+mk * vk)/n (1 &lt;= k &lt;= n)
    </p>
    <p num="37">where ui+lk, j+mk * vk =ux * vx +uy * vy</p>
    <p num="38">
      In this way the degree of agreement for each pair of coordinates in the search area with the shape data is calculated.
      <br/>
      Then a plurality of pairs of coordinates having great degrees  PHI  of agreement is made a candidate area of the face component.
    </p>
    <p num="39">
      In practice, for example, in case of an eye template, the two irises, eyebrows, the hair part between a cheek and an ear, a nostril and the like are listed as parts having high degrees of agreement.
      <br/>
      In other words, if a shape template of irises is used to judge the degree of agreement, then the parts mentioned above are derived as a candidate area of the irises.
    </p>
    <p num="40">
      Next, step S7 judges matching (degree of agreement) for each edge image of a candidate area obtained as described above, by deforming the corresponding shape template.
      <br/>
      The method of the deformation is to deform a shape template to improve the degree of agreement by shifting the elements of the shape template of each component and by calculating the degree of agreement with each edge image (step 7).
      <br/>
      If the highest degree of agreement is obtained (step 8), then step S9 extracts a feature point from the shape of the shape template at this time.
    </p>
    <p num="41">
      Extraction of feature points is performed, for example, as shown in FIG. 4 for an eyebrow.
      <br/>
      In a matched eyebrow shape, i.e. having the highest degree of agreement, the left and right terminal points are first taken as feature points.
      <br/>
      Then the 4 points where two perpendicular trisectors of the segment between the two terminal points cross the upper and lower rims are taken as feature points.
      <br/>
      Therefore, total 6 points are extracted as the feature points of an eyebrow.
      <br/>
      The feature points of the nose and mouth are extracted respectively as shown in FIGS. 6 and 7.
    </p>
    <p num="42">Actual extraction of feature points are not shown in the flowchart of FIG. 12, but performed in the following order.</p>
    <p num="43">
      First, the irises are extracted.
      <br/>
      As described above, when the locations of the irises are obtained, the size, inclination and the like of the whole face can be estimated.
      <br/>
      If the inclination of the two irises (slope of the line segment connecting the feature points) is found, the inclination of the input whole face is found.
      <br/>
      Therefore, when step S9 extracts the feature points of the irises, step S10 applies an affine transformation to theedge image.
    </p>
    <p num="44">
      After the affine transformation, extraction of the feature points of the eye contours is performed.
      <br/>
      When the eyes are extracted, then the locations of the eyebrows can be estimated, so that the feature points of the eyebrows are extracted.
      <br/>
      Further, by extracting the mouth, the locations of the nose and chin can be estimated, so that the feature points of these components are extracted.
      <br/>
      Finally, the feature points of the top of the head and the cheek contours are extracted.
      <br/>
      Extraction of feature points are not necessarily performed in the above order, but if the extraction is performed in that order, extraction of feature points is performed smoothly.
      <br/>
      In this way, extraction of the all feature points is performed, and the routine of feature points extraction is completed.
    </p>
    <p num="45">&lt;Adjustment Processing Routine for the Structure Model&gt;</p>
    <p num="46">After features point extracting section 13 extracts the total 49 feature points (see FIG. 3), structure model adjustment section 15 performs deformation and adjustment of the standard structure model (FIG. 9).</p>
    <p num="47">
      The standard structure model consists of the data of 205 vertices and 385 triangular patches created by connecting these vertices.
      <br/>
      Since the connected structure is invariant, an adjusted structure model is obtained by adjusting the vertices data.
    </p>
    <p num="48">The adjustment is performed in the following rules.</p>
    <p num="49">
      (a) If a vertex to be obtained is a feature point (for example, the center of an iris, the corner of an eye, the corners of the mouth etc.), then the coordinates of the extracted feature point are used as they are.
      <br/>
      (b) If a vertex to be obtained is not a feature point, then 3 feature points are selected according to a predetermined rule, and a linear interpolation is performed using the coordinates of these feature points in the following way.
    </p>
    <p num="50">The method of the linear interpolation is described with reference to FIG. 13.</p>
    <p num="51">
      In FIG. 13, the triangle on the left side P0 P1 P2 is the triangle formed by 3 feature points P0, P1, P2 surrounding a vertex q on the standard structure model, and the triangle on the right side P0 'P1 'P2 ' is the triangle formed by 3 feature points P0 ', P1 ', P2 ' extracted corresponding to the feature points P0, P1, P2 on the standard structure model.
      <br/>
      The point q' is a vertex obtained by interpolating the above vertex q on the standard structure model.
      <br/>
      If the coordinates of feature points P0, P1, P2 are respectively (x0, y0), (x1, Y1), (x2, Y2), the coordinates of vertex q is (x, y), and the ratio of the weights of feature points P0, P1, P2 are m0, m1, m2, then m0, m1, m2 can be obtained by solving the following 3 equations.
    </p>
    <p num="52">
      M0 +m1 +m2 =1
      <br/>
      x=m0 x0 +m1 x1 +m2 x2
      <br/>
      y=m0 y0 +m1 y1 +m2 y2
    </p>
    <p num="53">
      Next, if the coordinates of the corresponding feature points P0 ', P1 ', P2 ' of the deformed structure model, i.e. adjusted structure m0del, are respectively (x0 ', Y0 '), (x1 ', Y1 '), (x2 ', Y2 '), then the desired coordinates (x', y') of the vertex q' are obtained in the following using the obtained weight ratios m0, m1, m2.
      <br/>
      x'=m0 x0 '+m1 x1 '+m2 x2'
      <br/>
      y'=m0 y0 '+m1 y1 '+m2 y2'
    </p>
    <p num="54">The selection rules of the feature points ar as follows.</p>
    <p num="55">
      Rule 1.
      <br/>
      The 3 points form a triangle.
    </p>
    <p num="56">
      Rule 2.
      <br/>
      Before and after the deformation, the orientation is invariant, i.e. the clockwise order is invariant (P0 --&gt; P1 --&gt; P2 : P0 ' --&gt; P1 ' --&gt; P2 ').
    </p>
    <p num="57">
      Rule 3.
      <br/>
      The vertex q exists inside the triangle.
    </p>
    <p num="58">
      Rule 4.
      <br/>
      P0, P1, P2 exist as near as possible to the vertex q.
    </p>
    <p num="59">
      The linear interpolation is performed for all the 205 vertices, as a result, an adjusted structure model as shown in FIG. 10 is obtained.
      <br/>
      Here, since the perimeter of the standard structure m0del should be formed with feature points only, structure model adjustment section 15 approximates the perimeters of the head, chin, and etc. using functions such as quadratic functions.
    </p>
    <p num="60">&lt;Brightness Correction&gt;</p>
    <p num="61">The brightness correction is performed to prevent misjudgment due to a difference in the position of the light source in photographing.</p>
    <p num="62">
      As shown in FIG. 14, a brightness correcting section 19 that corrects the brightness of the face image is installed following feature amounts extracting section 16.
      <br/>
      In this case, standard structure model 14 stores beforehand the normal vector of each patch as data.
      <br/>
      That is, the standard structure model is made three-dimensional by giving the normal vector of each patch.
      <br/>
      Feature amounts extracting section 16 extracts the brightness and normal vector of each patch for the adjusted structure model obtained by structure model adjustment section 15.
      <br/>
      The position of the light source is estimated by the extracted brightnesses and normal vectors of the patches.
      <br/>
      For example, if a face image is divided into 4 parts with horizontal and vertical line.
      <br/>
      By observing the brightness distribution over the 4 parts, the position in what direction the light source is located from the photographed face can be estimated.
      <br/>
      If the estimated position of the light source is different from the position of the light source at the time of creating the personal feature amounts stored in personal database 17, then the brightnesses are corrected to adjust them to one of the positions of the light source.
      <br/>
      That is, the brightness of a patch whose normal is closer to the old direction of the light source is lowered, and the brightness of a patch whose normal is closer to the new direction of the light source is raised.
      <br/>
      By performing such brightness correction, misjudgment can be prevented under different illumination conditions.
    </p>
    <p num="63">Although the present invention has been fully described in connection with the embodiments, the present invention is not limited to the above embodiment, and changes and modifications apparent to those skilled in the art are included within the scope of the present invention as defined by the appended claims unless they depart therefrom.</p>
    <p num="64">&lt;Possible Industrial Applications&gt;</p>
    <p num="65">According to the composition of the present invention, personal identification and identification checking can be performed with high accuracy using feature amounts extracted from a great number of small parts.</p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>An apparatus for identifying persons comprising:</claim-text>
      <claim-text>an image input section that inputs a personal face image of a person to be identified; an image memory section that stores the personal face image input by said image input section; a feature points extracting section that extracts predefined feature points from the personal face image stored in said image memory section; a feature amounts extracting section that divides the personal face image into small triangles based on the extracted feature points according to a predefined rule, thereby describing the personal face image as a set of the small triangles and extracts each difference in an average brightness between adjacent two small triangles as a feature amount;</claim-text>
      <claim-text>and a judgment section that calculates distances between the feature amounts extracted by said amounts extracting section and feature amounts extracted beforehand with respect to each person to be identified and judges whether the person having said personal face image input by said image input section is the person to be identified.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. The apparatus according to claim 1, wherein said feature amounts extracting section comprises: a standard structure model that describes a presumed standard face as a set of small triangles defined on the basis of standard feature points predefined with respect to said standard face;</claim-text>
      <claim-text>and a structure model adjustment section that deforms the standard structure model based on the feature points extracted by said feature points extracting section so as to match the personal face image with the deformed standard structure model.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. The apparatus according to claim 2, wherein the standard structure model is a three-dimensional model defined by small triangles and their normal vectors, wherein the normal vector of each small triangle is detected together with an average brightness of each small triangle;</claim-text>
      <claim-text>and wherein a position of a light source for illuminating a personal face relative to the psersonal face is estimated based on the detected normal vectors and average brightnesses.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. The apparatus according to claim 1, wherein a position of a light source for illuminating a personal face relative to the personal face is estimated based on a distribution of the average brightnesses of small triangles and each average brightness is corrected based on the estimated position of the light source.</claim-text>
    </claim>
  </claims>
</questel-patent-document>