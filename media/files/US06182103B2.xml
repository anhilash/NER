<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06182103B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06182103</doc-number>
        <kind>B2</kind>
        <date>20010130</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6182103</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference family-id="21936983" extended-family-id="58678940">
      <document-id>
        <country>US</country>
        <doc-number>09360547</doc-number>
        <kind>A</kind>
        <date>19990726</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1999US-09360547</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>59976368</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>36054799</doc-number>
        <kind>A</kind>
        <date>19990726</date>
        <priority-active-indicator>N</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1999US-09360547</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="2">
        <country>US</country>
        <doc-number>6767398</doc-number>
        <kind>A</kind>
        <date>19980428</date>
        <priority-linkage-type>3</priority-linkage-type>
        <priority-active-indicator>N</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="2">
        <doc-number>1998US-09067673</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="3">
        <country>US</country>
        <doc-number>4527997</doc-number>
        <kind>P</kind>
        <date>19970501</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="3">
        <doc-number>1997US-60045279</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010130</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>H04R  25/00        20060101AFI20051220RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>R</subclass>
        <main-group>25</main-group>
        <subgroup>00</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051220</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>H03H  15/00        20060101ALI20051220RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>03</class>
        <subclass>H</subclass>
        <main-group>15</main-group>
        <subgroup>00</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051220</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="3">
        <text>H03H  17/00        20060101ALI20051220RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>03</class>
        <subclass>H</subclass>
        <main-group>17</main-group>
        <subgroup>00</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051220</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="4">
        <text>H03H  17/02        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>03</class>
        <subclass>H</subclass>
        <main-group>17</main-group>
        <subgroup>02</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="5">
        <text>H03H  17/06        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>03</class>
        <subclass>H</subclass>
        <main-group>17</main-group>
        <subgroup>06</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>708319000</text>
        <class>708</class>
        <subclass>319000</subclass>
      </main-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>H03H-017/02F8A</text>
        <section>H</section>
        <class>03</class>
        <subclass>H</subclass>
        <main-group>017</main-group>
        <subgroup>02F8A</subgroup>
      </classification-ecla>
      <classification-ecla sequence="2">
        <text>H03H-017/06</text>
        <section>H</section>
        <class>03</class>
        <subclass>H</subclass>
        <main-group>17</main-group>
        <subgroup>06</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H03H-017/06</classification-symbol>
        <section>H</section>
        <class>03</class>
        <subclass>H</subclass>
        <main-group>17</main-group>
        <subgroup>06</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H03H-017/0266</classification-symbol>
        <section>H</section>
        <class>03</class>
        <subclass>H</subclass>
        <main-group>17</main-group>
        <subgroup>0266</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>16</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>4</number-of-drawing-sheets>
      <number-of-figures>6</number-of-figures>
      <image-key data-format="questel">US6182103</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Finite impluse response bandpass filter</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>LAY ROBERT F</text>
          <document-id>
            <country>US</country>
            <doc-number>5227991</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5227991</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>GIRARDEAU JR JAMES W, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5731769</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5731769</doc-number>
          </document-id>
        </patcit>
      </citation>
    </references-cited>
    <related-documents>
      <division>
        <relation>
          <parent-doc>
            <document-id>
              <country>US</country>
              <doc-number>6767398</doc-number>
              <kind>A</kind>
              <date>19980428</date>
            </document-id>
          </parent-doc>
        </relation>
        <relation>
          <parent-doc>
            <document-id>
              <country>US</country>
              <doc-number>5983139</doc-number>
              <kind>A</kind>
            </document-id>
          </parent-doc>
        </relation>
      </division>
      <related-publication>
        <document-id>
          <country>US</country>
          <doc-number>60/045,279</doc-number>
          <date>19970501</date>
        </document-id>
        <document-id>
          <country>US</country>
          <doc-number>60/045279</doc-number>
          <date>19970501</date>
        </document-id>
      </related-publication>
    </related-documents>
    <parties>
      <applicants>
        <applicant app-type="applicant" sequence="1">
          <addressbook lang="en">
            <name>ZIERHOFER CLEMENS</name>
          </addressbook>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Zierhofer, Clemens</name>
            <address>
              <address-1>Kundl, AT</address-1>
              <city>Kundl</city>
              <country>AT</country>
            </address>
          </addressbook>
          <nationality>
            <country>AT</country>
          </nationality>
        </inventor>
      </inventors>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Mai, Tan V.</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>EXPIRED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      A digital finite impulse response bandpass filter is described.
      <br/>
      Analog to digital conversion (A/D) of an input signal uses a Sigma-Delta (SIGMA-DELTA) converter, resulting in a digital sequence representation of the input signal.
      <br/>
      A low-pass FIR filter convolves the binary sequence to produce a low-pass vector, and a digital comb filter defined by at least one set of weighted and time-shifted unit impulses convolves the low-pass vector with the comb filter weights.
      <br/>
      An envelope detector detects a bandpass envelope of the digital FIR bandpass filter.
      <br/>
      Also described is a filter bank of a plurality of such digital FIR filters arranged in parallel.
      <br/>
      A square root of a sum of squares of the convolution products of the low-pass vector with the comb filter weights is calculated to estimate the bandpass envelope.
      <br/>
      The square root of the sum of two squares is estimated by determining the greater of the roots of the two squares and the lesser of the roots of the two squares, calculating a sum of one half the lesser of the roots of the two squares and one half a product of the greater of the roots of the two squares and the square root of three, and selecting whichever is larger between the greater of the roots of the two squares and the sum of one half the lesser of the roots of the two squares and one half the product of the greater of the roots of the two squares and the square root of three.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <p num="1">
      This application is a divisional of U.S. patent application Ser.
      <br/>
      No. 09/067,673, filed Apr. 28, 1998, now U.S. Pat. No. 5,983,139 which in turn claims priority from provisional application No. 60/045,279, filed May 1, 1997.
      <br/>
      These applications are hereby incorporated herein by reference.
    </p>
    <heading>TECHNICAL FIELD</heading>
    <p num="2">The present invention pertains to low power digital signal processing, specifically, a finite impulse response bandpass filter.</p>
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="3">
      In the field of cochlear implants, electrostimulation of the acoustic nerve by the technique of continuous interleaved sampling (CIS) has successfully achieved high levels of speech recognition.
      <br/>
      The signal processing used in CIS, as implemented in an external speech processor, commonly employs a filter bank for splitting up the audio frequency range.
      <br/>
      The amplitudes of the stimulation pulses within the cochlea are derived from the envelopes of the band pass filter output signals.
    </p>
    <p num="4">
      At present, commercially available Digital Signal Processors (DSP) are used to perform speech processing according to CIS.
      <br/>
      For example, the digital signal processing for a 12-channel CIS typically comprises the following stages:
    </p>
    <p num="5">(1) a digital filter bank having 12 digital Butterworth band pass filters of 6th order, Infinite Impulse Response (IIR) type;</p>
    <p num="6">(2) 12 subsequent rectifiers and 12 digital Butterworth low pass filters of 2nd order, IIR-type, for envelope detection; and</p>
    <p num="7">(3) a stage for patient specific estimation of the stimulation amplitudes from the envelope signals.</p>
    <p num="8">
      The DSP power consumption in a speech processor typically is about 300 mW.
      <br/>
      Thus, comparatively large batteries (usually AA-sized) are necessary, resulting in speech processor dimensions of about 90 * 70 * 20 mm3.
    </p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="9">
      In accordance with a preferred embodiment of the present invention, there is provided an apparatus for processing an audio input signal with a digital finite-impulse-response (FIR) bandpass filter.
      <br/>
      In this embodiment, the FIR bandpass filter has an oversampling type analog to digital converter to convert the input audio signal into a digital sequence, a low-pass FIR filter to convolve the binary sequence to produce a low-pass vector, a digital comb filter defined by at least one set of weighted and time-shifted unit impulses to convolve the low-pass vector with the comb filter weights, and an envelope detector to detect a bandpass envelope of the digital FIR bandpass filter.
    </p>
    <p num="10">
      In further embodiments, the analog to digital converter may use sigma-delta modulation to produce a two-level binary sequence.
      <br/>
      The low-pass FIR filter may directly convolve the digital sequence by multiplying and accumulating the digital sequence with a low-pass FIR filter impulse response.
      <br/>
      The low-pass FIR filter may be further comprised of an input filter to convolve the binary sequence to produce a five level sequence, and a peripheral filter to convolve the five level sequence to produce the low-pass vector.
      <br/>
      The low-pass filter may further include an output counter to downsample the low-pass vector which may further be sequentially stored in a low-pass random access memory (RAM).
    </p>
    <p num="11">
      Also in further embodiments, the digital comb filter may further include comb filter weight RAM to store the sets of comb filter weights and an Arithmetic Logic Unit (ALU) to calculate a convolution product of the downsampled low-pass vector with the comb filter weights.
      <br/>
      The comb filter weight RAM may store two orthogonal sets of comb filter weights, in which case, the ALU further calculates convolution products of the downsampled low-pass vector with the two orthogonal sets of comb filter weights.
      <br/>
      The ALU may comprise the envelope detector, in which case it estimates an envelope of the digital FIR bandpass filter by calculating a square root of a sum of squares of the convolution products of the downsampled low-pass vector with the two orthogonal sets of comb filter weights.
      <br/>
      The ALU estimates the value of the square root of the sum of two squares by determining the greater of the roots of the two squares and the lesser of the roots of the two squares, calculating a sum of one half the lesser of the roots of the two squares and one half a product of the greater of the roots of the two squares and the square root of three, and selecting whichever is larger between the greater of the roots of the two squares and the sum of one half the lesser of the roots of the two squares and one half the product of the greater of the roots of the two squares and the square root of three.
    </p>
    <p num="12">
      In accordance with another embodiment of the present invention, a plurality of such digital FIR bandpass filters may be arranged in parallel to form a digital filter bank.
      <br/>
      In yet a further embodiment, such a digital FIR bandpass filter or a filter bank of such digital FIR bandpass filters may be a subpart of an external portion of a cochlear implant system for providing auditory signals to an implantable portion for implantation into a person.
    </p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="13">
      The foregoing and other objects and advantages of the invention will be appreciated more fully from the following further description thereof with reference to the accompanying drawings wherein:
      <br/>
      FIG. 1 depicts the impulse response h(n) for s=72 and wi =+3 -30 80-128 142-107 53-13}.
      <br/>
      FIG. 2 depicts the amplitude characteristics of low pass filter Hlp (f), comb filter  PSI s (f), and the resulting band pass filter H(f) for s=72 and wi =+3-30 80-128 142-107 53-13}.
      <br/>
      FIG. 3 depicts the approximately orthogonal impulse responses h(n) and h(n) for s=72, wi =+3-30 80-128 142-107 53-13} and wi =+13-53 107-142 128-80 30-3}.
      <br/>
      FIG. 4 depicts a block diagram of the implementation of a 12-channel filter bank.
    </p>
    <heading>DETAILED DESCRIPTION OF PREFERRED EMBODIMENTS</heading>
    <p num="14">
      A preferred embodiment of the present invention implements a digital signal processing scheme for CIS implementation suitable for integration in an Application Specific Integrated Circuit (ASIC).
      <br/>
      This significantly reduces the power consumption of the CIS speech processing as compared to prior techniques, which enables miniaturization of the speech processor to a Behind-The-Ear (BTE) device.
    </p>
    <p num="15">
      A preferred embodiment of the present invention includes an implementation of a digital filter bank with estimation of the envelopes of the band pass filter bank.
      <br/>
      For example, a preferred embodiment employs a 12 channel filter bank wherein each channel is designed to pass only a relatively narrow selected band of frequencies around some center frequency.
      <br/>
      By proper selection of filter channel frequencies, the entire filter bank may process all or a large part of the audio frequency spectrum.
    </p>
    <p num="16">
      In a preferred embodiment, an input audio signal initially undergoes analog-to-digital conversion by use of Sigma Delta ( SIGMA - DELTA ) Modulation at a relatively high sampling rate, f0, resulting in a two-level sequence x(n) at the rate f0.
      <br/>
      Each filter channel of the digital filter bank in a preferred embodiment then employs fixed impulse response (FIR) bandpass filters.
      <br/>
      The center frequency fr of each FIR band-pass filter is related to the approximate  SIGMA - DELTA  rate f0 and an integer parameter s by:  (Equation image '1' not included in text)
    </p>
    <p num="17">
      Each FIR band-pass filter also has a filter characteristic defined by a set of comb filter weights wi, with typically i=0, 1, . . . 7.
      <br/>
      In general, bell-shaped pass band characteristics are obtained, with side lobes typically attenuated by 24 dB.
    </p>
    <p num="18">
      For each filter channel of a preferred embodiment, envelope detection is achieved by implementing two FIR band-pass filters with approximately orthogonal impulse responses h(n) and h(n).
      <br/>
      The impulse responses h(n) and h(n) have equal (or almost equal) filter amplitude characteristics.
      <br/>
      Thus, the convolution products y(n) =h(n)*x(n) and y(n) =h(n)*x(n) are related to each other via the Hilbert Transform.
      <br/>
      Final estimation of the bandpass envelopes of each filter channel employs the equation:  (Equation image '2' not included in text)
    </p>
    <p num="19">
      as performed within an Arithmetic Logic Unit (ALU) by use of an approximation method.
      <br/>
      The calculation error is between 0 and -3.4%.
    </p>
    <p num="20">
      A more detailed description of a preferred embodiment of the present invention starts with analog-to-digital conversion of an analog input signal, accomplished by means of a Sigma-Delta ( SIGMA - DELTA ) modulator.
      <br/>
      Sigma Delta modulation is a well-known method of analog-to-digital conversion by the oversampling technique, described in greater detail in J. C. Candy and G. C. Temes, "Oversampling Delta-Sigma Converters," Oversampling Methods for A/D and D/A Conversion, eds. J. C. Candy and G. C. Temes, IEEE Press, 1991, incorporated herein by reference.
      <br/>
      The output of the  SIGMA - DELTA  modulator is a binary sequence x(n)  EPSILON �-1,+1� at a rate equal to the sampling rate f0.
      <br/>
      The spectrum X(f) of x(n) is composed of the spectrum of the audio input signal plus the shaped spectrum of the quantization noise.
    </p>
    <p num="21">
      For each filter channel of a preferred embodiment, the convolutions of the input  SIGMA - DELTA  input sequence x(n) with orthogonal FIR filter impulse responses h(n) and h(n), respectively, are performed in two stages: peripheral convolution and central convolution.
      <br/>
      The peripheral convolution involves low pass filtering and downsampling in a peripheral filter stage.
      <br/>
      Downsampling, or decimation, is the reduction in sampling rate by an integral factor.
      <br/>
      The low pass filter is operated at the comparatively high  SIGMA - DELTA  rate f0, but the impulse response of the low pass filter is extremely simple.
      <br/>
      Thus, the implementation requires only few binary counters with variable increments.
      <br/>
      The peripheral convolution results are stored in a peripheral RAM (Random Access Memory) at a rate (1/4s)f0, which corresponds to a decimation by a factor of 4s.
      <br/>
      Each peripheral convolution stage is implemented such that it operates completely independently of the following processing stages.
    </p>
    <p num="22">
      The central convolution stage of a preferred embodiment involves convolution of the peripheral convolution results with two sets of comb filter weights.
      <br/>
      This is performed by means of an Arithmetic Logic Unit (ALU), which is driven by a micro program.
      <br/>
      Similar to a DSP, comparatively complicated operations, e.g. Multiply-and-Accumulate (MAC) operations, are performed.
      <br/>
      However, since the bandwidth of the envelope signals is comparatively low, the clock frequency of the ALU can be kept very low, resulting in strongly reduced ALU power consumption.
    </p>
    <p num="23">
      The computational efficiency of the direct convolution technique of preferred embodiments is actually the result of choosing a low order filter design with a generally bell-shaped frequency response rather than a higher order filter with a more well-defined frequency response.
      <br/>
      Although a sixth order infinite impulse response Butterworth filter typically used in the prior art may have more sharply defined frequency responses, such a design requires significantly more system computations which in aggregate require relatively substantial power resources.
      <br/>
      Moreover, some preliminary informal data suggest that users are not sensitive to the difference in frequency response.
      <br/>
      In fact, users actually seem to prefer the bell-shaped bandpass frequency response of preferred embodiments of the present invention over the more sharply defined frequency responses characteristic of the prior art.
    </p>
    <p num="24">
      Each digital bandpass filter channel of a preferred embodiment is implemented by directly using the two-level high-frequency sequence x(n).
      <br/>
      The impulse response h(n) is of finite length (FIR-type) and can be written as the convolution product of the impulse responses of a low pass filter hlp and a comb filter  PSI s (n):
      <br/>
      h(n)=hlp (n)* PSI s (n)  (Eq. 1)
    </p>
    <p num="25">
      The low pass filter hlp (n) represents the peripheral convolution stage and the comb filter  PSI s (n) represents the central convolution stage described above.
      <br/>
      The low pass filter impulse response hlp (n) is further the convolution product of two filter impulse responses h0 (n) and hs (n), i.e.,
      <br/>
      hlp (n)=h0 (n)*hs (n).  (Eq. 2)
    </p>
    <p num="26">
      Response h0 (n) is given by:
      <br/>
      h0 (n)=�1/21 1/2�.  (Eq. 3)
    </p>
    <p num="27">
      For convenience, here and in the following, a finite impulse response is defined by a vector.
      <br/>
      Coefficients within the brackets denote the values of the impulse response at n=0, 1, etc.
      <br/>
      Coefficients outside the range covered by the brackets are zero.
      <br/>
      MATLAB notation for vectors is used.
    </p>
    <p num="28">
      Filter Impulse response hs (n) is composed of two vectors hs,up and hs,down,
      <br/>
      hs (n)=�hs,up hs,down �,  (Eq. 4)
    </p>
    <p num="29">
      and shows even symmetry, i.e.,
      <br/>
      hs,down =hs,up (length(hs,up):-1:1).  (Eq. 5)
    </p>
    <p num="30">
      Vector hs,up has of four segments of equal lengths s, respectively,
      <br/>
      hs,up =�hs,a hs,b hs,c hs,d �  (Eq. 6)
    </p>
    <p num="31">
      where
      <br/>
      hs,a =�1 0 1 0 1 . . . �  (Eq. 7a)
    </p>
    <p num="32">
      hs,b =�1 1 1 1 1 . . . �  (Eq. 7b)
      <br/>
      hs,b =�2 1 2 1 2 . . . �  (Eq. 7c)
      <br/>
      hs,d =�2 2 2 2 2 . . . �  (Eq. 7d)
    </p>
    <p num="33">Convolution of hs (n) with h0 (n) removes the oscillating character of segments hs,a and hs,c resulting in a stair-like response hlp (n).</p>
    <p num="34">
      For example, hs (n) for s=4 is given by
      <br/>
      hs (n)=�1 0 1 0 1 1 1 1 2 1 2 1 2 2 2 2 2 2 2 2 1 2 1 2 1 1 1 1 0 1 0 1�.  (Eq. 8)
    </p>
    <p num="35">
      Convolution with h0 (n) yields
      <br/>
      hlp (n)=�1/2 1 1 1 1 3/2 22 5/2 3 3 3 3 7/2 4 4 4 4 4 4 7/2 3 3 3 3 5/2 22 3/2 1 1 1 1 1/2�  (Eq. 9)
    </p>
    <p num="36">Filter response  PSI s (n) represents a comb filter composed of a set of weighted and equidistant unit impulses,  (Equation image '3' not included in text)</p>
    <p num="37">
      The distance between the unit impulses is 8s.
      <br/>
      Weights wi (i=0, 1, . . . 7) are usually derived by sampling a window function (e.g., Hamming window) and then multiplying every second sample with -1, resulting in a sequence with alternating sign.
      <br/>
      Convolution of  PSI s (n) with impulse response hlp (n) causes a superposition of eight amplified and time-shifted responses hlp (n).
    </p>
    <p num="38">
      An embodiment of an FIR impulse response h(n) for s=72, wi =+3-30 80-128 142-107 53-13} is shown in FIG. 1.
      <br/>
      Response h(n) represents a band pass filter with a resonance frequency which is approximately defined by the distance between the zero crossings.
      <br/>
      It aims at approximating an impulse response composed of four periods of a window-weighted sinusoid.
      <br/>
      In the frequency domain, the convolution product of Eq. 1 is replaced by the product of the corresponding Fourier transforms of low pass filter Hlp (f) and comb filter  PSI s (f), i.e.,
      <br/>
      H(f)=Hlp (f) PSI s (f).  (Eq. 11)
    </p>
    <p num="39">
      The low pass filter Hlp (f) tends to select the first main lobe of  PSI s (f), resulting in band pass filter H(f).
      <br/>
      Side lobes occur at odd multiples of fr.
      <br/>
      The side lobe with the maximum amplitude is at a frequency .apprxeq.15fr, and the attenuation is about 24 dB.
      <br/>
      An example is shown in FIG. 2 for s=72 and wi =+3-30 80-128 142-107 53-13}. Filters Hlp (f) and  PSI s (f) are connected via parameter s, which defines the position of the zeros of Hlp (f) as well as the resonance frequencies in  PSI s (f).
      <br/>
      Thus, for a given set of weights wi, the following characteristic parameters of filter function H(f) are almost independent of s:
    </p>
    <p num="40">
      relative position of zeros referred to the main lobe resonance frequency
      <br/>
      relative position of center frequencies of side lobes with respect to the resonance frequency
      <br/>
      quality factor of the main lobe, and
      <br/>
      side lobe attenuation referred to the amplification at resonance frequency.
    </p>
    <p num="41">However, the absolute amplification is proportional to s, since the energy of hlp (n) is proportional to s. In order to achieve equal amplification at the resonance frequencies for different parameters s, it is necessary to multiply coefficients wi with a scaling factor proportional to 1/s.</p>
    <p num="42">
      Envelope detection in a preferred embodiment is achieved by implementing a second filter with an impulse response h(n) which is approximately orthogonal to h(n):
      <br/>
      h(n)=hlp (n)* PSI s (n)  (Eq. 12)
    </p>
    <p num="43">with  (Equation image '4' not included in text)</p>
    <p num="44">
      The unit impulse responses in  PSI s (n) are shifted by 4s compared to the unit responses in  PSI s (n), and a different set of weights wi is used.
      <br/>
      FIG. 3 illustrates the impulse responses h(n) and h(n) for an embodiment where s=72 and weights wi =+3-30 80-128 142-107 53-13} and wi =+13-53 107-142 128-80 30-3}. Here, coefficients wi are equal to the set wi, but with reversed order and different sign.
      <br/>
      In this case, h(n) can be obtained from h(n) by mirroring h(n) in time, inverting the sign, and introducing a time shift.
      <br/>
      Thus the amplitude characteristics .vertline.H(f).vertline. and .vertline.H(f).vertline. are identical.
    </p>
    <p num="45">
      Filtering the  RHO - DELTA  sequence x(n) with the FIR-filters h(n) and h(n) results in
      <br/>
      y(n)=x(n)*h(n)
      <br/>
      y(n)=x(n)*h(n)  (Eq. 14)
    </p>
    <p num="46">The envelope signal e(n) is defined by  (Equation image '5' not included in text)</p>
    <p num="47">
      The resonance frequency fr of filters .vertline.H(f).vertline. and .vertline.H(f).vertline. is approximately defined by the distance 16s between the zero crossings, i.e.,
      <br/>
      fr.apprxeq.f0 /16s.  (Eq. 16)
    </p>
    <p num="48">
      This definition results in a relatively fine resolution of the positions of possible resonance frequencies.
      <br/>
      For example, with f0 =1 MHZ, fr1 =1.008 kHz for s1 =63, and fr2 =0.992 kHz for s2 =62, resulting in a relative difference (fr1 -fr2)/fr1 =1.6%. However, the resolution is decreasing for higher resonances frequencies.
    </p>
    <p num="49">
      Approximation of the square root of the sum of squares.
      <br/>
      In the present application, the estimation of the square root of the sum of two squared numbers, i.e., a2 +b2, required for the calculation of e(n) to estimate the envelope, is achieved with the following three-step approach.
      <br/>
      Let a and b be two positive numbers.
      <br/>
      Then,
      <br/>
      (1) determine the maximum max(a,b) and the minimum min(a,b),
      <br/>
      (2) calculate 3/2 max(a,b)+1/2 min(a,b), and
      <br/>
      (3) determine the maximum max(max(a,b), 3/2 max (a,b)+1/2 min (a,b)).
    </p>
    <p num="50">
      The result of step (3) represents the approximation to a a2 +b2.
      <br/>
      If numbers a and b define two complex vectors a+jb and b+ja, then in step (1), out of these two vectors the one with an argument between 0 and 45 degrees is selected.
      <br/>
      This vector is rotated clockwise by 30 degrees.
      <br/>
      Step (2) calculates the real part of this vector.
      <br/>
      In step (3), the real parts of the rotated and unrotated vectors are compared, and the maximum is the desired approximation.
    </p>
    <p num="51">
      For example, with a=45 and b=57:
      <br/>
      (1) max(a,b)=57 and min(a,b) =45,
      <br/>
      (2) 3/2 max(a,b)+1/2 min(a,b)=71.86, and
      <br/>
      (3) max(max(a,b), 3/2 max (a,b)+1/2 min(a,b))=71.86.
    </p>
    <p num="52">Here, the approximation 71.86 is about 1% smaller than the exact result 452 +572 =72.62.</p>
    <p num="53">
      It can be shown that the deviation of the approximation to the correct value lies between 0% and -3.4%. The worst case occurs with a=b.
      <br/>
      Then, the approximation yields  ALPHA *cos( PI /12)= ALPHA *0.9659. The implementation of this method in the ALU requires only two comparisons of numbers (steps (1) and (3)) and one multiply and accumulate (MAC) instruction (step (2)) including one non-trivial multiplication (factor 3/2).
      <br/>
      It does not require a look-up-table, which is usually used to estimate the square root.
    </p>
    <p num="54">
      The signal processing so far has been derived with signals sampled at the sampling frequency f0.
      <br/>
      However, calculation of signal e(n) at a rate f0 is not necessary, since the sampling rate fenv necessary for the digital representation of the envelope of a band pass signal is much lower.
      <br/>
      The lower limit for fenv theoretically is given by
      <br/>
      fenv,min =2B,  (Eq. 17)
    </p>
    <p num="55">
      where B is the bandwidth of the band pass filter.
      <br/>
      In fact, the rate fenv,min is even considerably lower than the Nyquist rate (given by maximum signal frequency of the band pass signal times two).
      <br/>
      Thus, the method used by preferred embodiments of the invention define orthogonal impulse responses h(n) and h(n) that allow an efficient implementation of downsampling stages and that is applicable for the integration in a digital low power ASIC (Application Specific Integrated Circuit).
    </p>
    <p num="56">
      An example of an embodiment of a 12-channel filter bank in the context of a cochlear implant system is illustrated in FIG. 4.
      <br/>
      A microphone 10 worn behind the ear of a user transforms the acoustic signals in the user's environment into analog electrical signals.
      <br/>
      A preprocessor 12 performs additional preprocessing of the signal such as pre-emphasis or automatic gain control.
      <br/>
      The input audio signal is analog to digital converted by a  SIGMA - DELTA  modulator 14 which uses the oversampling technique to produce a relatively high frequency digital sequence x(n) which is representative of the input audio signal at sampling frequency f0.
      <br/>
      The  SIGMA - DELTA  sequence x(n) is then input to an input filter 16 where it is convolved with the input filter impulse response h0 (n).
      <br/>
      Due to the simplicity of impulse response h0 (n), this convolution requires only a few logic gates which convert the two level  SIGMA - DELTA  sequence x(n) EPSILON �-1, +1� into a five-level sequence x0 (n) EPSILON  �0,  +- 1,  +- 2�. The rate of x0 (n) is equal to the  SIGMA - DELTA  A sampling frequency f0.
    </p>
    <p num="57">
      Peripheral filters 18 of each of the 12 filter bank channels perform the convolution of the five-level sequence x0 (n) from the prefilter 16 with the impulse response hs,k (n) of each peripheral filter 18 (see Equations 4-7 and accompanying text) and downsample the result by a factor 4sk where k represents each of the filter channels, k=1, 2, . . . 12. Convolving x0 (n) with hs,k (n) means to multiply and accumulate x0 (n) and hs,k (n).
      <br/>
      Because of hs,k (n) EPSILON �0, 1, 2� and x0 (n) EPSILON �0,  +- 1,  +- 2�, the possible multiplication results are 0,  +- 1,  +- 2, and  +- 4.
      <br/>
      These are powers of two and thus the convolution product at a particular time instance can be calculated with the help of a binary counter with variable increments 0,  +- 1,  +- 2, and  +- 4.
      <br/>
      Since the length of hs,k (n) is 8sk, the calculation of the downsampled convolution product, at a rate of (1/4sk)f0, requires two counters with variable increments, where the starting times of the two counters are offset by 4sk.
      <br/>
      Sampling rate (1/4sk)f0 is four times higher than the resonance frequency of each filter as estimated in Eq. 16, and thus usually considerably higher than the minimum frequency fenv,min as defined in Eq. 17.
    </p>
    <p num="58">
      The convolution products at the peripheral filter counter outputs are then stored in turns in a 16-word peripheral convolution RAM 20 (also called a low pass RAM) where the sequence of RAM addresses is . . . 0, 1, 2, . . . 14, 15, 0, 1, . . . (ring configuration).
      <br/>
      For each filter channel, the combination of peripheral filter 18 with peripheral convolution RAM 20 requires only parameter Sk for correct operation, which is set during an initialization procedure by a controller unit 24.
      <br/>
      After initialization, the filter and WRITE operations of peripheral filters 18 and peripheral convolution RAMs 20 work completely autonomously, without being influenced by controller unit 24 or any other signal processing stage.
    </p>
    <p num="59">
      The controller unit 24 in combination with a central convolution parameter RAM 26 (also called a comb filter weight RAM) also provides the instructions for an Arithmetic Logic Unit (ALU) 28 to perform the central convolutions with the comb filter weights and estimations of each bandpass envelope.
      <br/>
      If the controller unit 24 initiates the estimation of an envelope sample, the output of the peripheral convolution RAM 20 of the selected filter channel is connected to the ALU 28 via a multiplexer 22, and the actual contents of that peripheral convolution RAM 20 are read into the ALU 28.
      <br/>
      The 16 words from the RAM are organized as two sets of eight words, which are multiplied and accumulated with the corresponding sets of eight comb filter weights wi,k and wi,k (i=0, 1, . . . 7) which are read out from the central convolution parameter RAM 26 where they are stored during an initialization procedure.
      <br/>
      The resulting outputs are the orthogonal filter output signals yk (n.dwnarw.) and yk (n.dwnarw.) (cf. Eqs.14), where the argument n.dwnarw. denotes downsampling.
      <br/>
      The estimation of these signals yk (n.dwnarw.) and yk (n.dwnarw.) requires 16 multiply and accumulate (MAC) instructions within the ALU 28.
      <br/>
      Together with the estimation of ek (n.dwnarw.) from yk (n.dwnarw.) and yk (n.dwnarw.) (cf. Eq. 15), in all, 17 ALU instructions are necessary.
    </p>
    <p num="60">
      Thus, the ALU 28 produces a sequence of instantaneous bandpass envelopes for each filter channel.
      <br/>
      In the context of a cochlear implant system, the ALU 28 of a preferred embodiment would also adjust the envelope amplitude by a loudness mapping function specific to the individual user's hearing abilities.
      <br/>
      The loudness mapping may be an instantaneous logarithmic compression of the envelope and adjustment of the envelope amplitude above a threshold discerning level to a comfortable hearing level.
      <br/>
      The data coding and rf-stage 30 converts the sequence of instantaneous bandpass envelopes for each filter channel into a digital data stream which is radio transmitted.
      <br/>
      The implanted rf receiver/stimulator 32 worn by the user converts the received radio signal into narrow amplitude modulated biphasic stimulation pulses arranged sequentially by frequency band.
      <br/>
      Each frequency band has an associated electrode within the implanted portion of the device such that the electrode for a given frequency band will stimulate the neural fibers for that band of frequencies with the cochlea of the ear.
      <br/>
      As a result, the pulsatile stimulation of the cochlear neural fibers by the electrodes 34 induce stochastically distributed action potentials in the neural fibers which resemble the physiological response patterns of the stochastic activations of neural fibers in a healthy ear.
    </p>
    <p num="61">
      The envelope signals ek (n.dwnarw.) in FIG. 4 are calculated sequentially, controlled by a micro program.
      <br/>
      For example, a filter bank composed of 12 filter channels with equal bandwidths B=1 kHz, the minimum rate for calculating the envelope signals is given by 12*fevn,min =12*2*1 kHz=24 kHz.
      <br/>
      Assuming that one clock cycle is necessary to execute one ALU instruction, the minimum ALU-clock frequency fALU,min is given by fALU,min =17*12*2B=408 kHz.
      <br/>
      This operating frequency is far below the frequency usually used in DSPs.
    </p>
    <p num="62">
      Regarding the power consumption of the structures in FIG. 4, it is useful to separate the convolutions of the input  SIGMA - DELTA -input sequence x(n) with h(n) and h(n) into the two stages of peripheral convolution and central convolution.
      <br/>
      The peripheral convolution involves low pass filtering and downsampling in peripheral filter stages.
      <br/>
      These peripheral filters are operated at the comparatively high  SIGMA - DELTA -rate f0, but the impulse responses are extremely simple.
      <br/>
      In combination with downsampling, the implementation requires only two counters with variable increments.
      <br/>
      Thus, the power consumption can be kept extremely low, if asynchronous counters are used.
      <br/>
      If an asynchronous counter of arbitrary length is driven at clock frequency f0, then on average only two flip flops toggle and hence contribute to the power consumption.
      <br/>
      For example, for a 12-channel filter bank, an overall number of 12 * 2 * 2=48 flip flops in average are toggled at f0.
      <br/>
      Assuming f0 =1 MHZ and a power consumption of 10  MU W/MHZ per flip flop results in a power consumption of only 0.48 mW.
    </p>
    <p num="63">
      The central convolution performs the convolution of the downsampled low pass filter output with the comb filter weights wi,k and wi,k (i=0, 1, . . . 7).
      <br/>
      This step requires more complex hardware, including an ALU which contains registers, a multiplier, etc., however, the clock frequency of the ALU can be kept very low.
      <br/>
      For example, in an ALU composed of 6000 logical gates, approximately 30% of the logical gates would be active at any given time.
      <br/>
      Assuming a power consumption of 3  MU W/MHZ per gate, and a clock frequency of fALU =408 kHz results in a power consumption of 2.2 mW. Thus, in the presented example, the power consumption of peripheral plus central convolution is approximately 2.68 mW, which is less than 1% of the 300 mW power consumption typical in a commercial DSP implementation of the CIS strategy.
    </p>
    <p num="64">
      Although various exemplary embodiments of the invention have been disclosed, it should be apparent to those skilled in the art that various changes and modifications can be made which will achieve some of the advantages of the invention without departing from the true scope of the invention.
      <br/>
      These and other obvious modifications are intended to be covered by the appended claims.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A digital finite-impulse-response (FIR) bandpass filter for processing an input signal, the filter comprising:</claim-text>
      <claim-text>an oversampling-type analog to digital converter to convert the input signal into a digital sequence; a low-pass FIR filter to convolve the digital sequence to produce a low-pass vector; a digital comb filter defined by at least one set of comb filter weights representative of weighted and time-shifted unit impulses to convolve the low-pass vector with the comb filter weights;</claim-text>
      <claim-text>and an envelope detector to detect a bandpass envelope of the digital FIR bandpass filter.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. A digital FIR bandpass filter as in claim 1, wherein the analog to digital converter uses sigma-delta modulation.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. A digital FIR bandpass filter as in claim 1, wherein the digital sequence is a two-level binary sequence.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. A digital FIR bandpass filter as in claim 1, wherein the low-pass FIR filter directly convolves the digital sequence by multiplying and accumulating the digital sequence with a low-pass FIR filter impulse response.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. A digital FIR bandpass filter as in claim 1, wherein the low-pass FIR filter is further comprised of: an input filter to convolve the digital sequence to produce a multi-level sequence having a plurality of allowable values; a peripheral filter to convolve the multi-level sequence to produce the low-pass vector; an output stage including at least one output counter to downsample the low-pass vector at selected times;</claim-text>
      <claim-text>and a low-pass random access memory (RAM) to sequentially store the downsampled low-pass vector.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. A digital FIR bandpass filter as in claim 5, wherein the multi-level sequence is a five level sequence.</claim-text>
    </claim>
    <claim num="7">
      <claim-text>7. A digital FIR bandpass filter as in claim 5 wherein the digital comb filter is further comprised of: a comb filter weight RAM to store the sets of comb filter weights;</claim-text>
      <claim-text>and an Arithmetic Logic Unit (ALU) to calculate a convolution product of the downsampled low-pass vector with the comb filter weights.</claim-text>
    </claim>
    <claim num="8">
      <claim-text>8. A digital FIR bandpass filter as in claim 7 wherein the comb filter weight RAM stores two orthogonal sets of comb filter weights and the ALU calculates convolution products of the downsampled low-pass vector with the two orthogonal sets of comb filter weights.</claim-text>
    </claim>
    <claim num="9">
      <claim-text>9. A digital FIR bandpass filter as in claim 8, wherein the ALU further comprises the envelope detector.</claim-text>
    </claim>
    <claim num="10">
      <claim-text>10. A digital FIR bandpass filter as in claim 9, wherein the ALU operates at a frequency less than two times a maximum bandpass frequency of the digital FIR bandpass filter.</claim-text>
    </claim>
    <claim num="11">
      <claim-text>11. A digital FIR bandpass filter as in claim 9, wherein the ALU estimates the bandpass envelope of the digital FIR bandpass filter by: calculating a square root of a sum of squares of the convolution products calculated by the ALU.</claim-text>
    </claim>
    <claim num="12">
      <claim-text>12. A digital FIR bandpass filter as in claim 11, wherein the ALU estimates the value of the square root of the sum of two squares by: determining the greater of the roots of the two squares and the lesser of the roots of the two squares; calculating a sum of one half the lesser of the roots of the two squares and one half a product of the greater of the roots of the two squares and the square root of three;</claim-text>
      <claim-text>and selecting whichever is larger between the greater of the roots of the two squares and the calculated sum.</claim-text>
    </claim>
    <claim num="13">
      <claim-text>13. A digital FIR bandpass filter as in claim 1, wherein the envelope detector detects a bandpass envelope of the digital FIR bandpass filter by calculating a square root of a sum of squares of the convolution products calculated by the digital comb filter.</claim-text>
    </claim>
    <claim num="14">
      <claim-text>14. A digital FIR bandpass filter as in claim 13, wherein the envelope detector estimates the value of the square root of the sum of two squares by: determining the greater of the roots of the two squares and the lesser of the roots of the two squares; calculating a sum of one half the lesser of the roots of the two squares and one half a product of the greater of the roots of the two squares and the square root of three;</claim-text>
      <claim-text>and selecting whichever is larger between the greater of the roots of the two squares and the calculated sum.</claim-text>
    </claim>
    <claim num="15">
      <claim-text>15. A method of processing an input signal by a digital finite-impulse-response (FIR) bandpass filter, the method comprising: converting the input signal into a digital sequence in a digital to analog converter by oversampling; convolving the digital sequence in low-pass FIR filter to produce a low-pass vector; convolving the low-pass vector in a digital comb filter defined by at least one set of comb filter weights representative of weighted and time-shifted unit impulses;</claim-text>
      <claim-text>and detecting in an envelope detector a bandpass envelope of the digital FIR bandpass filter.</claim-text>
    </claim>
    <claim num="16">
      <claim-text>16. A method of processing an input signal by a digital finite-impulse-response (FIR) bandpass filter, the method comprising: converting the input signal into a digital sequence in a digital to analog converter by oversampling; convolving the digital sequence in an input filter to produce a multi-level sequence having a plurality of allowable values; directly convolving the multi-level sequence in a peripheral filter to produce a low-pass vector; downsampling the low-pass vector at selected times with an output stage which includes at least one output counter; sequentially storing the downsampled low-pass vector in a low-pass random access memory (RAM); calculating in an Arithmetic Logic Unit (ALU) convolution products of the downsampled low-pass vector with two orthogonal sets of comb filter weights representative of weighted and time shifted unit impulses of a digital comb filter; estimating in the ALU a bandpass envelope of the digital FIR bandpass filter by calculating a square root of a sum of squares of the convolution products calculated by the ALU, the value of the square root of the sum of two squares being estimated by:</claim-text>
      <claim-text>- determining the greater of the roots of the two squares and the lesser of the roots of the two squares; - calculating a sum of one half the lesser of the roots of the two squares and one half a product of the greater of the roots of the two squares and the square root of three;</claim-text>
      <claim-text>and - selecting whichever is larger between the greater of the roots of the two squares and the calculated sum.</claim-text>
    </claim>
  </claims>
</questel-patent-document>