<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06185515B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06185515</doc-number>
        <kind>B2</kind>
        <date>20010206</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6185515</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference family-id="9508567" extended-family-id="14422968">
      <document-id>
        <country>US</country>
        <doc-number>09104265</doc-number>
        <kind>A</kind>
        <date>19980625</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1998US-09104265</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>14743725</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>FR</country>
        <doc-number>9708130</doc-number>
        <kind>A</kind>
        <date>19970627</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1997FR-0008130</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010206</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>G01F  23/26        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>01</class>
        <subclass>F</subclass>
        <main-group>23</main-group>
        <subgroup>26</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>B41J   2/175       20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>B</section>
        <class>41</class>
        <subclass>J</subclass>
        <main-group>2</main-group>
        <subgroup>175</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>702199000</text>
        <class>702</class>
        <subclass>199000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>347007000</text>
        <class>347</class>
        <subclass>007000</subclass>
      </further-classification>
      <further-classification sequence="2">
        <text>347014000</text>
        <class>347</class>
        <subclass>014000</subclass>
      </further-classification>
      <further-classification sequence="3">
        <text>702189000</text>
        <class>702</class>
        <subclass>189000</subclass>
      </further-classification>
      <further-classification sequence="4">
        <text>702190000</text>
        <class>702</class>
        <subclass>190000</subclass>
      </further-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>B41J-002/175C8</text>
        <section>B</section>
        <class>41</class>
        <subclass>J</subclass>
        <main-group>002</main-group>
        <subgroup>175C8</subgroup>
      </classification-ecla>
      <classification-ecla sequence="2">
        <text>B41J-002/175L</text>
        <section>B</section>
        <class>41</class>
        <subclass>J</subclass>
        <main-group>002</main-group>
        <subgroup>175L</subgroup>
      </classification-ecla>
      <classification-ecla sequence="3">
        <text>G01F-023/26B4</text>
        <section>G</section>
        <class>01</class>
        <subclass>F</subclass>
        <main-group>023</main-group>
        <subgroup>26B4</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>B41J-002/17553</classification-symbol>
        <section>B</section>
        <class>41</class>
        <subclass>J</subclass>
        <main-group>2</main-group>
        <subgroup>17553</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>B41J-002/17566</classification-symbol>
        <section>B</section>
        <class>41</class>
        <subclass>J</subclass>
        <main-group>2</main-group>
        <subgroup>17566</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G01F-023/266</classification-symbol>
        <section>G</section>
        <class>01</class>
        <subclass>F</subclass>
        <main-group>23</main-group>
        <subgroup>266</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>36</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>8</number-of-drawing-sheets>
      <number-of-figures>8</number-of-figures>
      <image-key data-format="questel">US6185515</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Method and device for detecting a filling threshold for an electrically insulating reservoir containing an electrically conductive product, for example a printing ink</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>COUDRAY PASCAL, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>6022090</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6022090</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>CANON KK</text>
          <document-id>
            <country>EP</country>
            <doc-number>0856724</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>EP-856724</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>CANON KK</text>
          <document-id>
            <country>EP</country>
            <doc-number>0783968</doc-number>
            <kind>A2</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>EP-783968</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>CANON KK</text>
          <document-id>
            <country>EP</country>
            <doc-number>0856725</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>EP-856725</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="5">
          <text>CANON KK, et al</text>
          <document-id>
            <country>WO</country>
            <doc-number>9727061</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>WO9727061</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="6">
          <text>MARTIN GAYLE P</text>
          <document-id>
            <country>US</country>
            <doc-number>4255791</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4255791</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="7">
          <text>ELHATEM ABDUL M, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4853718</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4853718</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="8">
          <text>ENDOTHERAPEUTICS</text>
          <document-id>
            <country>WO</country>
            <doc-number>9013797</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>WO9013797</doc-number>
          </document-id>
        </patcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Canon Kabushiki Kaisha</orgname>
            <address>
              <address-1>Tokyo, JP</address-1>
              <city>Tokyo</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>CANON</orgname>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Coudray, Pascal</name>
            <address>
              <address-1>La Chapelle des Fougeretz, FR</address-1>
              <city>La Chapelle des Fougeretz</city>
              <country>FR</country>
            </address>
          </addressbook>
          <nationality>
            <country>FR</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="2">
          <addressbook lang="en">
            <name>Lorgeoux, Mickaël</name>
            <address>
              <address-1>Rennes, FR</address-1>
              <city>Rennes</city>
              <country>FR</country>
            </address>
          </addressbook>
          <nationality>
            <country>FR</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="3">
          <addressbook lang="en">
            <name>Froger, Marie-Hélène</name>
            <address>
              <address-1>Chateaugiron, FR</address-1>
              <city>Chateaugiron</city>
              <country>FR</country>
            </address>
          </addressbook>
          <nationality>
            <country>FR</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <orgname>Fitzpatrick, Cella, Harper &amp; Scinto</orgname>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Shah, Kamini</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>LAPSED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      The object of the invention is the detection of a given threshold (optionally zero) for filling, with an electrically conductive product, a reservoir made of electrically insulating material having a storage cavity connected to an outlet channel.
      <br/>
      An excitation signal is applied to the cavity, in periodic square waves, and a measurement signal is taken off, one characteristic of which varies substantially with the quantity of product contained in the cavity reaches the filling threshold.
      <br/>
      From this characteristic, by comparison with a reference threshold, a binary signal C,C' is derived, which is filtered digitally whilst multiplying it (convolution product) by a signal which is identical to it, but with a delay equal to a multiple, at least equal to one, of the period of the square waves.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <p num="1">
      The invention concerns the detection of a threshold for filling, with an electrically conducted product, a reservoir made of electrically insulating material.
      <br/>
      It relates notably, but not exclusively, to the detection of a threshold for filling, with a marking product, a reservoir designed to be integrated into an image formation device, for example for an ink in a printing apparatus.
      <br/>
      The filling threshold can be zero, corresponding to the case of a reservoir which no longer contains any available product.
    </p>
    <p num="2">The main aim of detecting when a filling threshold has been crossed is to be able to inform the user of the appliance including the reservoir that it will shortly be time to replace the reservoir.</p>
    <p num="3">Such detection is notably useful in printing appliances: this is then normally referred to as ink level detection.</p>
    <p num="4">Various methods of detecting an ink level in devices using inkjet technology are already known.</p>
    <p num="5">
      In particular the document EP-A2-0 028 399 describes a method of detecting a minimum level of ink in a reservoir which uses a resonating resonant circuit whose capacitance is formed by two metal plates between which the ink reservoir is situated.
      <br/>
      This ink behaves like a dielectric whose value changes as the ink level decreases; likewise the capacitance of the resonant circuit changes with this ink level.
      <br/>
      This resonant circuit is calibrated so that its resonant frequency, and therefore the maximum level of the voltage at its resistor, is achieved when the ink level has dropped to a predetermined minimum level, for example 20%.
      <br/>
      When it is detected that this threshold has been crossed, a visual or audible signal is emitted.
    </p>
    <p num="6">The detection of a given ink threshold appears to correspond to the detection of the crossing of a voltage threshold for the frequency which has previously been defined as being the resonant frequency for the residual quantity of ink which is to be detected.</p>
    <p num="7">
      In fact, it should be noted that, the lower the quantity of ink defining the capacitance, the lower the voltage peak, as a consequence of which this voltage peak is all the more difficult to detect when it corresponds to a small residual quantity of ink in the reservoir.
      <br/>
      This is no doubt one of the reasons which explains why this document provides for a minimum threshold as high as 20%.
    </p>
    <p num="8">
      In addition, the crossing of the voltage threshold by the electrical signal which is detected appeared to correspond to fairly scattered values of the residual quantity of ink actually available in the reservoir.
      <br/>
      This is no doubt another reason why the manufacturers of the printing equipment choose substantial safety margins in their indications of a "zero" residual ink level, supposed to cause the user to replace the reservoir.
    </p>
    <p num="9">One consequence of the choice of such a high safety margin is that, in order to guarantee that the user will not be prematurely short of ink, the reservoir is scrapped when there sometimes still remains a not insignificant quantity of usable ink.</p>
    <p num="10">The same situation prevails more generally with regard to reservoirs containing a marking product, whether or not it is a case of ink, and more generally with regard to reservoirs made of electrically insulating material containing an electrically conductive product, which can therefore be integrated into a capacitive arrangement.</p>
    <p num="11">
      One reason for the aforementioned scatter lies certainly in the existence of noise which is added to the measuring signal.
      <br/>
      Such noise is notably to be feared in the presence of significant sources of electromagnetic waves situated close to the reservoir, or when requirements for installation or mechanical configuration do not make it possible to place the plates sufficiently close to the reservoir, which reinforces the sensitivity of the measurements vis-a-vis the environment.
    </p>
    <p num="12">
      The object of the invention is to mitigate the aforementioned drawbacks by affording an improved accuracy of the time when the residual quantity of an electrically conductive product contained in an electrically insulating reservoir crosses a minimum threshold, with the consequence of allowing, in complete safety for the user, a lowering of this threshold and therefore a more complete utilisation of the product contained in the reservoir before scrapping the latter.
      <br/>
      The invention aims to achieve this object without any modification of the reservoir being necessary (such a modification is of course possible whilst remaining within the scope of the invention).
      <br/>
      The invention also aims to determine the absence of product in the outlet channel of the reservoir (zero filling threshold), notably the absence of ink in a duct connected to a print head, whilst doing away with ambient noise.
    </p>
    <p num="13">
      More particularly the invention aims to reduce noise liable to impair the accuracy of the measurements, in a simple and reliable fashion, but without giving rise to appreciable cost.
      <br/>
      It aims in fact to be able to achieve the aforementioned objects in the context of mass production.
    </p>
    <p num="14">The invention relates to this end to a method of detecting a predetermined threshold for filling, with an electrically conductive product, a reservoir made of electrically insulating material having a storage cavity containing this product connected to a product outlet channel, according to which</p>
    <p num="15">
      the storage cavity is disposed in a capacitive arrangement;
      <br/>
      a measuring procedure is defined having an excitation step consisting of applying, in periodic square waves, an electrical excitation signal to this capacitive arrangement and a capture step consisting of taking off a measurement signal from this capacitive arrangement, this electrical excitation signal being chosen so that this measurement signal has a characteristic varying substantially when the quantity of product contained in this cavity reaches this filling threshold;
      <br/>
      a conversion procedure is defined, including steps consisting of identifying an instantaneous value (for example a peak to peak amplitude) of a quantity representing the said characteristic, comparing it with a reference threshold representing the filling threshold, and deriving therefrom a first binary signal representing the situation of the said instantaneous value with respect to the reference threshold;
      <br/>
      a digital filtering procedure is defined, including a convolution step consisting of generating a third binary signal whilst effecting the convolution product of this first binary signal and a second binary signal derived from the first binary signal by introducing a delay equal to a multiple of at least one of the period of the square waves;
      <br/>
      a processing procedure is defined including a test step consisting of deriving from the mean value of this third binary signal a binary value representing the situation of the quantity of product with respect to the filling threshold; and
      <br/>
      at least one measuring cycle is effected, including steps consisting of monitoring the measuring procedure, the conversion procedure, the filtering procedure and the processing procedure and capturing the said binary value.
    </p>
    <p num="16">
      It should be noted here that the measurement signal must normally be zero outside the square waves, that is to say when there is no excitation signal; when the measurement signal is not zero this may be due to noise, but an effective way of eliminating the noise is to seek the part of the measurement signal which is periodic with a period equal to that of the excitation square waves and to eliminate the remainder of the signal.
      <br/>
      It is this result that the convolution product makes it possible to produce very simply.
      <br/>
      The most simple delay is a delay equal to the period of the square waves, but it is of course possible to choose longer delays, for example in order to eliminate the periodic noises of short duration.
    </p>
    <p num="17">In so far, however, as this digital filtering does not make it possible to eliminate any part of the noise which has a frequency of occurrence substantially equal to the frequency of the square waves, it may be advantageous to combine this digital filtering with a filtering of another nature, for example a frequency filtering, so as also to exclude the noise being repeated at the frequency of the square waves and having a different frequency from that of the excitation signal.</p>
    <p num="18">Preferably, this frequency filtering is carried out with a passband filter (or with an equivalent system) whose band is centred on the excitation frequency; its width is advantageously equal to twice the frequency of the square waves, which has the advantage of allowing only the frequencies of the signal generated to pass.</p>
    <p num="19">
      Preferably, the capacitive arrangement is formed by disposing the said storage cavity between two electrically conductive plates, the excitation step consisting of applying the excitation signal to one of these plates, and the capture step consisting of taking the output signal from the other one of these plates.
      <br/>
      Advantageously, the other end of the outlet channel is connected to a predetermined potential, which can simply be that of earth: this ensures a certain degree of stability for the measuring signal, and in particular makes it possible to detect an absence of product in the outlet channel (it should be noted here that it is already conventional for a print head to be connected to earth, for reasons independent of any detection of ink level).
    </p>
    <p num="20">
      Preferably, in particular when the filling threshold in question is zero, the excitation signal is an electrical signal having a frequency which the said characteristic of the measurement signal is substantially independent of the value of the quantity of product, provided that this is greater than the filling threshold (for example provided that there is ink in the outlet channel).
      <br/>
      This has the advantage of allowing a clear detection of the (zero) filling threshold.
      <br/>
      This is notably the case when the product contained in the outlet channel is no longer capable of ensuring connection with earth.
    </p>
    <p num="21">A particularly simple choice for the said characteristic of the measuring signal which varies with the quantity of product contained in the cavity is the amplitude of the voltage.</p>
    <p num="22">
      As is known, square waves are defined by their period, but also by their cycle ratio, that is to say a ratio defining the duration of a square wave with respect to the period.
      <br/>
      So as to ensure an effective filtering it appears advisable for the duration of the square waves to be at most equal to half their period, or even at most equal to one third of their period.
    </p>
    <p num="23">So that the square waves are defined when the excitation signal is an alternating signal, it appears preferable for the frequency of the square waves to be at least around 100 times less than the frequency of the excitation signal.</p>
    <p num="24">
      One particularly effective and simple way of conducting the test step is to compare the mean value of the third binary signal during a reference duration with a predetermined threshold.
      <br/>
      So this mean is significant, it appears that this duration should be equal to at least around 10 times the period of the square waves.
    </p>
    <p num="25">
      The method applies particularly to cases where the product is a marking product, and the reservoir is designed to be integrated into an image formation device: the frequency of the electrical excitation signal is then preferably around 10 kilohertz.
      <br/>
      When the product is a printing ink and the reservoir is designed to be integrated into a printing device, the frequency of the electrical excitation signal is then preferably around 10 kHz.
    </p>
    <p num="26">
      For implementing the method, the invention also proposes a device for detecting a predetermined threshold for filling, with an electrically conductive product, a reservoir made of an electrically insulating material having a storage cavity containing this product, connected to a product outlet channel, having:
      <br/>
      means designed to form, with the said storage cavity, a capacitive arrangement;
      <br/>
      excitation means for applying, by periodic square waves, an electrical excitation signal to this capacitive arrangement and capture means for taking off a measurement signal from this capacitive arrangement, this electrical excitation signal being chosen so that this measurement signal has a characteristic varying substantially when the quantity of product contained in this cavity reaches this filling threshold;
      <br/>
      conversion means designed so as to identify an instantaneous value of a quantity representing the said characteristic, to compare it with a reference threshold representing the filling threshold, and to derive therefrom a first binary signal representing the situation of the said instantaneous value with respect to the reference threshold;
      <br/>
      digital filtering means designed so as to generate a third binary signal by producing the convolution product of this first binary signal and a second binary signal derived from the first binary signal by introducing a delay equal to a multiple at least equal to the period of the square waves;
      <br/>
      processing means designed so as to derive, from the mean value of this third binary signal, a binary value representing the situation of the quantity of product with respect to the filling threshold.
    </p>
    <p num="27">Preferably this device has means for also implementing the preferred provisions mentioned above with regard to the method.</p>
    <p num="28">
      The invention also concerns a product supply device having a reservoir made from electrically insulating material having a storage cavity containing an electrically conductive product and a filling threshold detection device of the aforementioned type.
      <br/>
      It is preferably a case of an image formation device, such as in particular a printing device.
    </p>
    <p num="29">The invention also covers a logic processing unit designed to form part of a filling threshold detection device of the aforementioned type.</p>
    <p num="30">
      Objects, characteristics and advantages of the invention will emerge from the following description, given by way of non-limitative illustrative example with regard to the accompanying drawings in which:
      <br/>
      FIG. 1 is a block diagram of a printing device according to the invention;
      <br/>
      FIG. 2 is a simplified perspective view of this printing device;
      <br/>
      FIG. 3 is a perspective schematic view of a reservoir of this printing device;
      <br/>
      FIG. 4 is a block diagram of the conversion and filtering device of this printing device;
      <br/>
      FIG. 5 is a timing diagram showing the change over time of various signals of the device of FIG. 4;
      <br/>
      FIG. 6 is a diagram depicting the capacitive arrangement of which the cavity forms part;
      <br/>
      FIG. 7 is a flow diagram of the program resident in read only memory for implementing the invention; and
      <br/>
      FIG. 8 is an example of a curve obtained for the change in the amplitude of the voltage of the measuring signal as a function of the residual proportion of ink.
    </p>
    <p num="31">In general terms, the invention uses a capacitive arrangement by utilising two metal plates on each side of a cartridge or reservoir made of plastic (and therefore electrically insulating) containing a conductive ink, the whole a forming a capacitor, and preferably using the duct connecting the reservoir to the print head as an electrical switch between the said reservoir and the equivalent impedance between the said print head and earth.</p>
    <p num="32">
      The invention is here described with regard to an image transfer 11, for example included in a printer 10, which receives data to be printed DI by means of a parallel input/output port 107 connected to an interface circuit 106.
      <br/>
      The circuit 106 is connected to an ink ejection control circuit 110 which controls an ink cartridge 111, via an amplification circuit 114.
    </p>
    <p num="33">The ink cartridge 111 is exchangeable and is mounted on a reciprocating carriage actuated by a motor 102.</p>
    <p num="34">
      The ink cartridge comprises essentially an ink reservoir 112, a duct 120 connecting the reservoir and the print head 113.
      <br/>
      This print head 113 creates an impedance between the ink and earth.
    </p>
    <p num="35">
      The printer also has a main data processing circuit 110, associated with a read only memory 103 and a random access memory 109.
      <br/>
      The read only memory 103 contains the operating programs of the main processing circuit 100, whilst the random access memory 109, also associated with the ink ejection control circuit 110, temporarily stores the data DI received by means of the interface 106 as well as the data processed by the main processing circuit 100.
      <br/>
      This random access memory 106 serves to store the measurement samples necessary for the convolution product.
    </p>
    <p num="36">
      The main processing circuit 100 is connected to a display 104, on which the main processing circuit 100 controls the display of messages representing the operation of the printer.
      <br/>
      The main processing circuit 100 is connected to a keypad 105, having at least one switch, by means of which the user can transmit operating commands to the printer.
    </p>
    <p num="37">
      The processing circuit 100 is also connected to the motor 102 by means of an amplification circuit 101.
      <br/>
      The motor 102 ensures the movement of the carriage which carries the printing cartridge 111.
      <br/>
      The motor 102 is for example a stepping motor.
      <br/>
      The printer described previously is conventional and well known to persons skilled in the art.
      <br/>
      It will therefore not be detailed any further.
    </p>
    <p num="38">Thus, according to the invention, the printer has two metal plates 122 and 121 fixed outside the plastic reservoir containing the conductive ink, the whole producing a capacitor.</p>
    <p num="39">
      The printer comprises a means for supplying the metallic element 121 with an alternating signal supplied by an oscillator 117, via a switch 118 and an amplifier 119.
      <br/>
      This oscillator supplies a signal of moderate frequency, for example 10 kHz.
      <br/>
      It may be replaced with another oscillator (not shown) of high frequency, for example 5 MHz; as a variant these two oscillators can coexist.
    </p>
    <p num="40">
      The printer also comprises a means 115 for converting the electrical signal between the plate 122 and earth into a signal representing the crossing or otherwise of an ink threshold, or the presence or otherwise of ink in the connecting duct 120 (this case can correspond to a zero ink threshold).
      <br/>
      The presence or absence of ink in this duct connects or does not connect the ink contained in the reservoir to earth by means of the impedance existing between the ink in the print head and the said earth.
    </p>
    <p num="41">
      The main processing circuit 100 is connected to the switch 118 in order to control it and thus to enable the alternating signal to be transmitted between the oscillator 117 and the metal element 121 constituting one of the faces of the capacitor.
      <br/>
      This switch 118 controlled by the central unit serves to generate the signal of period  TAU  as well as its cycle ratio.
    </p>
    <p num="42">The metal reception element 122 is connected to a conversion circuit 115, itself connected to the main processing circuit 100, this metallic element 122 constituting the second face of the capacitor with the dielectric cartridge.</p>
    <p num="43">The element 122 is connected to the conversion circuit 115, which in response supplies a digital signal SN to the main processing circuit 100.</p>
    <p num="44">
      The device comprises, in a conventional fashion, a carriage 60 (see FIG. 2) for carrying the print cartridge 111.
      <br/>
      This carriage is driven in a reciprocating movement on a movement path formed by guide rails 67.
      <br/>
      The motor drives the carriage 60 by means of a belt device 63.
    </p>
    <p num="45">
      The movement path of the print head 113 is parallel to a line on a printing medium, not shown, such as a sheet of paper.
      <br/>
      A flexible cable 62 connects the amplification circuit 114 to the cartridge 111, the amplifier 119 to the metallic element 121 and the metallic element 122 to the detection circuit 115.
    </p>
    <p num="46">
      FIG. 3 is a view of the ink cartridge 111.
      <br/>
      The reservoir part 112, the connecting duct 102 connecting the said reservoir to the print head and finally the print head 113 can be seen.
    </p>
    <p num="47">
      The conversion circuit 115 in FIG. 4 extracts the amplitude of the signal received by the metal plate 122 in response to the excitation signal SE.
      <br/>
      This conversion circuit 115 comprises an amplifier 50 with an input impedance of 1 M OMEGA  connected to a passband filter 51 able to transmit signals whose frequency lies between f0-1/ TAU  (f0 is the oscillator frequency) and f0+1/ TAU .
      <br/>
      The function of this filter is to filter all the signals whose frequency is outside this spectrum.
      <br/>
      The filter 51 is connected to a comparator 52 connected to the processing circuit 100.
      <br/>
      This comparator has an envelope detector 52A followed by a comparison element 52B delivering the binary signal SNi as a function of the position of the amplitude detected with respect to a reference threshold.
    </p>
    <p num="48">FIG. 5 shows the efficacy of the invention.</p>
    <p num="49">The curve A represents the signal received at the metal plate 122 and solely filtered by the filter 51, when there is no longer any ink in the duct 120.</p>
    <p num="50">
      The curve B represents the noise received by this same plate.
      <br/>
      The source of the noise being represented by the generator B in FIG. 5.
    </p>
    <p num="51">
      The curve C represents the output of the comparator, and the curve D is the result, after the convolution product.
      <br/>
      It is easy to find the periodic signal generated by the oscillator 117: this corresponds to the absence of ink.
    </p>
    <p num="52">The curve A' represents the signal received on the metal plate 122 and filtered by the filter 51 when the ink is present in the duct 120.</p>
    <p num="53">The curve C' represents the binary signal obtained at the output of the comparator 52B.</p>
    <p num="54">The curve D' represents the convolution product effected between  TAU  and the signal previously received at time t- TAU .</p>
    <p num="55">It is easy to see that the curve D' for most of the time remains at the low level, which corresponds to the presence of ink.</p>
    <p num="56">FIG. 6 depicts the electrical diagram of the phenomenon where:</p>
    <p num="57">
      Ci1: represents the capacitor formed by the metal element 121, the wall of the reservoir 112 and the ink;
      <br/>
      Ze: represents the equivalent impedance of the ink, which can be resistive and capacitive;
      <br/>
      Ci2: represents the capacitance formed by the metal element 122, the wall of the reservoir 112 and the ink;
      <br/>
      Sw: represents the ink present or absent in the duct 120.
      <br/>
      This is depicted in the form of a switch which is open or closed according to the absence or presence of ink;
      <br/>
      Z: represents the impedance between the ink contained in the print head and the earth of the system.
      <br/>
      The oscillator is connected to the element 121 and, when the quantity of ink decreases, the capacitances Ci1 and Ci2 decrease, the impedance Ze increases substantially and the voltage at 122 decreases.
      <br/>
      When there is no ink in the duct, this serves as a switch, then causing an abrupt rise in the electrical signal on the element 122;
      <br/>
      B: represents a source of pseudo-random noise coming either from the outside environment to the printer, or from the printer itself.
    </p>
    <p num="58">FIG. 7 shows an algorithm of the invention based on the case of curve C2 in FIG. 8, as stored in the read only memory 103 of the printing device.</p>
    <p num="59">This curve C2 gives the correspondence between the amplitude of the voltage of the signal measured and the percentage of residual ink, for a frequency (here equal to 10 kHz) for which this amplitude depends only on the quality of the earthing provided by ink in the outlet channel.</p>
    <p num="60">
      The algorithm comprises 13 steps E70 to E82, which are run through periodically, for example during the printing of a document.
      <br/>
      The algorithm determines the presence of ink in the reservoir 112.
    </p>
    <p num="61">The step E70 consists, at the start of the test, of setting the variables t and sum to 0 and allocating the memory space in RAM 102 necessary for the storage of the data.</p>
    <p num="62">
      Step E71 consists of activating the switch 118 so as to produce a signal of period equal to  TAU  and of predetermined cycle ratio.
      <br/>
      At E72, the signal received by the plate 122 is processed and then compared, and is transcribed into a binary information item Sni(t).
    </p>
    <p num="63">
      At E73, the convolution product is then effected.
      <br/>
      It consists of multiplying the bit contained in the memory area in Sni(t- TAU ) by the value in Sni(t) and storing the result.  TAU  represents an index of the central unit periodically, every ms for example, reads the output of the comparator.
    </p>
    <p num="64">
      For example, when t=3000, the central unit has sufficient samples to effect a processing, and therefore leaves the loop towards E75.
      <br/>
      If not, t is incremented at E81 and the acquisition continues, and the central unit then switches to E71.
    </p>
    <p num="65">At E75, the switch 118 is deactivated and reset to 0.</p>
    <p num="66">Steps E76, E77 and E82 consist of counting the number of times where the result (t) is at level 1.</p>
    <p num="67">The number is then composed at E78 at a predetermined threshold.</p>
    <p num="68">Where the test is negative, that is to say sum &gt;= threshold, the central unit interrupts the printing and alerts the user.</p>
    <p num="69">In the affirmative, this implies that there is ink, and printing can continue.</p>
    <p num="70">As indicated above, the curve C2 in FIG. 8 is substantially horizontal and rises abruptly beyond a threshold SC2 when there is no ink in the channel.</p>
    <p num="71">However, the invention also applies to the case of a curve such as C1, which corresponds to a sequence (here 5 MHz) for which the amplitude of the signal measured decreases continuously with the quantity of ink: The threshold SC1 to be monitored is then defined in arbitrary fashion according to the percentage of residual ink for which it is wished to send, for example, a warning message to the operator.</p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A method of detecting a predetermined threshold for filling, with an electrically conductive product a reservoir made of electrically insulating material having a storage cavity for containing the product and having an outlet channel for the product in which the storage cavity is disposed in a capacitive arrangement, said method comprising:</claim-text>
      <claim-text>defining a measuring procedure having an excitation step of applying, in periodic square waves, an electrical excitation signal to the capacitive arrangement and a capture step of taking a measurement signal from the capacitive arrangement, the electrical excitation signal being chosen so that the measurement signal has a characteristic varying substantially when the quantity of product contained in the storage cavity reaches the predetermined filling threshold; defining a conversion procedure including steps of identifying an instantaneous value of a quantity representing the characteristic, comparing the instantaneous value with a reference threshold representing the predetermined filling threshold, and deriving therefrom a first binary signal representing the situation of the instantaneous value with respect to the reference threshold; defining a digital filtering procedure including a convolution step of generating a third binary signal whilst effecting convolution product of the first binary signal and a second binary signal derived from the first binary signal by introducing a delay equal to a multiple at least equal to one times the period of the square waves; defining a processing procedure including a test step of deriving from the mean value of the third binary signal a binary value representing the situation of the quantity of product with respect to the predetermined filling threshold;</claim-text>
      <claim-text>and effecting at least one measuring cycle including steps of monitoring the measuring procedure, the conversion procedure, the filtering procedure and the processing procedure, and of capturing the binary value.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. A method according to claim 1, wherein the storage cavity is disposed between two electrically conductive plates forming part of the capacitive arrangement, the excitation step applies the excitation signal to one of said plates, and the capture step takes the output signal at the other one of said plates.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. A method according to claim 2, wherein one end of the outlet channel is connected to a predetermined potential.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. A method according to claim 3, wherein the predetermined potential is that of earth.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. A method according to claim 1, wherein the excitation signal is an electrical signal having a frequency for which the characteristic of the measurement signal is substantially independent of the value of the quantity of product, provided that the latter is greater than the predetermined filling threshold.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. A method according to claim 1, wherein the characteristic of the measurement signal which varies with the quantity of product contained in the cavity includes amplitude of the voltage.</claim-text>
    </claim>
    <claim num="7">
      <claim-text>7. A method according to claim 1, wherein the excitation signal has a given frequency and the conversion procedure includes a prior step of frequency filtering.</claim-text>
    </claim>
    <claim num="8">
      <claim-text>8. A method according to claim 7, wherein said filtering step includes use of a passband filter whose passband is centered on the frequency of the excitation signal with a width substantially equal to twice the frequency of the square waves.</claim-text>
    </claim>
    <claim num="9">
      <claim-text>9. A method according to claim 7, wherein duration of the square waves is at most equal to half their period.</claim-text>
    </claim>
    <claim num="10">
      <claim-text>10. A method according to claim 9, wherein duration of the square waves is at most equal to one third of their period.</claim-text>
    </claim>
    <claim num="11">
      <claim-text>11. A method according to claim 1, wherein the frequency of the square waves is at least around 100 times less than the frequency of the excitation signal.</claim-text>
    </claim>
    <claim num="12">
      <claim-text>12. A method according to claim 1, wherein the delay is equal to the period of the square waves.</claim-text>
    </claim>
    <claim num="13">
      <claim-text>13. A method according to claim 1, wherein the test step of the processing procedure includes comparing the mean value of the third binary signal during a reference period to a predetermined threshold.</claim-text>
    </claim>
    <claim num="14">
      <claim-text>14. A method according to claim 13, wherein the reference period is equal to at least ten times the period of the square waves.</claim-text>
    </claim>
    <claim num="15">
      <claim-text>15. A method according to claim 1, wherein the product is a marking product, the reservoir is designed to be integrated into an image formation device, and the frequency of the electrical excitation signal is around 10 kilohertz.</claim-text>
    </claim>
    <claim num="16">
      <claim-text>16. A method according to claim 15, wherein the product is a printing ink and the reservoir is designed to be integrated into a printing device.</claim-text>
    </claim>
    <claim num="17">
      <claim-text>17. A device for detecting a predetermined threshold for filling, with an electrically conductive product, a reservoir made of an electrically insulating material having a storage cavity for containing the product and having a product outlet channel, said device including: means to form, with the storage cavity, a capacitive arrangement; excitation means for applying, by periodic square waves, an electrical excitation signal to the capacitive arrangement and capture means for taking a measurement signal from the capacitive arrangement, the electrical excitation signal being chosen so that the measurement signal has a characteristic varying substantially when the quantity of product contained in the storage cavity reaches the predetermined filling threshold; conversion means to identify an instantaneous value of a quantity representing the characteristic, to compare the instantaneous value with a reference threshold representing the predetermined filling threshold, and to derive therefrom a first binary signal representing the situation of the instantaneous value with respect to the reference threshold; digital filtering means to generate third binary signal by producing the convolution product of the first binary signal and a second binary signal derived from the first binary signal by introducing a delay equal to a multiple at least equal to one times the period of the square waves;</claim-text>
      <claim-text>and a processing means to derive, from the mean value of the third binary signal, a binary value representing the situation of the quantity of product with respect to the predetermined filling threshold.</claim-text>
    </claim>
    <claim num="18">
      <claim-text>18. A device according to claim 17, wherein the capacitive arrangement includes two electrically conductive plates defining a location designed to receive the storage cavity of the reservoir, one of said plates being connected to the excitation means and the other of said plates being connected to the measurement means.</claim-text>
    </claim>
    <claim num="19">
      <claim-text>19. A device according to claim 18, wherein the capacitive arrangement also includes means for connecting one end of the outlet channel to a predetermined potential.</claim-text>
    </claim>
    <claim num="20">
      <claim-text>20. A device according to claim 19, wherein the predetermined potential is that of earth.</claim-text>
    </claim>
    <claim num="21">
      <claim-text>21. A device according to claim 17, wherein the excitation means operates such that the excitation signal has a frequency for which the characteristic of the measurement signal is substantially independent of the value of the quantity of product, provided that the latter is greater than the predetermined filling threshold.</claim-text>
    </claim>
    <claim num="22">
      <claim-text>22. A device according to claim 17, wherein said conversion means detects the amplitude of the voltage of the measurement signal.</claim-text>
    </claim>
    <claim num="23">
      <claim-text>23. A device according to claim 17, wherein the excitation means includes oscillator means having a given frequency and the conversion means includes frequency filtering means.</claim-text>
    </claim>
    <claim num="24">
      <claim-text>24. A device according to claim 23, wherein said frequency filtering means includes a passband filter whose passband is centered on the frequency of the excitation signal with a width substantially equal to twice the frequency of the square waves.</claim-text>
    </claim>
    <claim num="25">
      <claim-text>25. A device according to claim 17, wherein the excitation means operates such that duration of the square waves is at most equal to half their period.</claim-text>
    </claim>
    <claim num="26">
      <claim-text>26. A device according to claim 25, wherein duration of the square waves is at most equal to one third of their period.</claim-text>
    </claim>
    <claim num="27">
      <claim-text>27. A device according to claim 17, wherein the frequency of the square waves is at least around 100 times the frequency of the excitation signal.</claim-text>
    </claim>
    <claim num="28">
      <claim-text>28. A device according to claim 17, wherein the delay is equal to the period of the square waves.</claim-text>
    </claim>
    <claim num="29">
      <claim-text>29. A device according to claim 17, wherein the processing means includes means for comparing the mean value of the third binary signal during a reference period with a predetermined threshold.</claim-text>
    </claim>
    <claim num="30">
      <claim-text>30. A device according to claim 29, wherein the reference period is equal to at least around ten times the period of the square waves.</claim-text>
    </claim>
    <claim num="31">
      <claim-text>31. A device according to claim 17, wherein the product is a marking product, the reservoir is designed to be integrated into an image formation device, and the frequency of the electrical excitation signal is around 10 kilohertz.</claim-text>
    </claim>
    <claim num="32">
      <claim-text>32. A device according to claim 31, wherein the product is a printing ink and the reservoir is designed to be integrated into a printing device.</claim-text>
    </claim>
    <claim num="33">
      <claim-text>33. A product supply device having a reservoir made of electrically insulating material having a storage capacity containing an electrically conductive product and a threshold detection device according to claim 17.</claim-text>
    </claim>
    <claim num="34">
      <claim-text>34. An image formation device having a reservoir made of electrically insulating material having a storage cavity containing an electrically conductive marking product and a threshold detection device according to claim 17.</claim-text>
    </claim>
    <claim num="35">
      <claim-text>35. A printing device having an electrically insulating reservoir having a storage cavity containing an electrically conductive ink and a consumption monitoring device according to claim 17.</claim-text>
    </claim>
    <claim num="36">
      <claim-text>36. Office equipment including a printing device according to claim 35.</claim-text>
    </claim>
  </claims>
</questel-patent-document>