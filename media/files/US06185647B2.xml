<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06185647B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06185647</doc-number>
        <kind>B2</kind>
        <date>20010206</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6185647</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference family-id="18400077" extended-family-id="14427378">
      <document-id>
        <country>US</country>
        <doc-number>09078442</doc-number>
        <kind>A</kind>
        <date>19980514</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1998US-09078442</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>14748622</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>JP</country>
        <doc-number>34888997</doc-number>
        <kind>A</kind>
        <date>19971218</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1997JP-0348889</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010206</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>G06F  13/36        20060101AFI20051220RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>36</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051220</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>G06F  13/362       20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>362</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="3">
        <text>G06F  13/40        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>40</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>710107000</text>
        <class>710</class>
        <subclass>107000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>710115000</text>
        <class>710</class>
        <subclass>115000</subclass>
      </further-classification>
      <further-classification sequence="2">
        <text>710116000</text>
        <class>710</class>
        <subclass>116000</subclass>
      </further-classification>
      <further-classification sequence="3">
        <text>710122000</text>
        <class>710</class>
        <subclass>122000</subclass>
      </further-classification>
      <further-classification sequence="4">
        <text>710123000</text>
        <class>710</class>
        <subclass>123000</subclass>
      </further-classification>
      <further-classification sequence="5">
        <text>710243000</text>
        <class>710</class>
        <subclass>243000</subclass>
      </further-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>G06F-013/362</text>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>362</subgroup>
      </classification-ecla>
      <classification-ecla sequence="2">
        <text>G06F-013/40D5A</text>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>013</main-group>
        <subgroup>40D5A</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06F-013/362</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>362</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06F-013/4031</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>4031</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>15</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>7</number-of-drawing-sheets>
      <number-of-figures>7</number-of-figures>
      <image-key data-format="questel">US6185647</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Dynamic bus control apparatus for optimized device connection</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>BOUDREAU DANIEL A</text>
          <document-id>
            <country>US</country>
            <doc-number>4511960</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4511960</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>HENDRIE GARDNER C, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4750177</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4750177</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>JENSEN CRAIG W, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4914580</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4914580</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>WHIPPLE DAVID L</text>
          <document-id>
            <country>US</country>
            <doc-number>4926419</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4926419</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="5">
          <text>LINDE YOSEPH L</text>
          <document-id>
            <country>US</country>
            <doc-number>5745670</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5745670</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="6">
          <text>HAGERSTEN ERIK E, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5754877</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5754877</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="7">
          <text>NIPPON ELECTRIC CO</text>
          <document-id>
            <country>JP</country>
            <doc-number>S54137941</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP54137941</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="8">
          <text>FUJI XEROX CO LTD</text>
          <document-id>
            <country>JP</country>
            <doc-number>S6371760</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP63071760</doc-number>
          </document-id>
        </patcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Fujitsu Limited</orgname>
            <address>
              <address-1>Kawasaki, JP</address-1>
              <city>Kawasaki</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>FUJITSU</orgname>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Shibuya, Keiko</name>
            <address>
              <address-1>Kawasaki, JP</address-1>
              <city>Kawasaki</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <orgname>Staas &amp; Halsey LLP</orgname>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Etienne, Ario</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>LAPSED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      A priority decision circuit decides priorities of a plurality of slots on the basis of access frequencies or the like.
      <br/>
      In conformity with these priorities, a bus mapping circuit performs mapping allowing a slot having a higher priority to be connected to the upper hierarchical bus whereas it performs mapping allowing a slot having a lower priority to be connected to the lower hierarchical bus.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="1">
      1.
      <br/>
      Field of the Invention
    </p>
    <p num="2">The present invention relates generally to a bus control apparatus for use in information processing apparatus such as a personal computer, a work station, an office computer, etc., and more particularly to a bus control apparatus for optimizing the connection positions of slots through which devices are connected to a bus.</p>
    <p num="3">2. Description of the Related Art</p>
    <p num="4">
      Recent information processing apparatus tends to include more and more devices in the form of peripheral units such as a storage unit and an input/output unit to be connected to buses, due to the increase in type of the devices.
      <br/>
      However, the number of devices connectable to a single bus is electrically restricted, so that the bus is divided so as to have a hierarchical structure.
      <br/>
      More specifically, an upper hierarchical device bus is connected via a host bridge to a host bus connecting to a host, with a lower hierarchical device bus being connected via a bus bridge to the upper hierarchical device bus, to thereby constitute a hierarchical bus allowing the devices such as the storage unit, the input/output unit, etc., to be connected to a plurality of slots provided on the upper and lower hierarchical buses.
      <br/>
      In the case of such a conventional hierarchical bus, the positions of the slots for connecting the peripheral units to the respective hierarchical buses are fixedly mapped.
      <br/>
      For this reason, in the case where the host accesses a device connected to a slot on the lower hierarchical bus, processing time will be elongated since the access is effected from the upper hierarchical bus through the bus bridge to the lower hierarchical bus.
      <br/>
      Thus, in the case of structuring a hierarchical bus, the devices are fixedly mapped taking into consideration the upper hierarchical bus having a short access time and the lower hierarchical bus having a long access time.
      <br/>
      However, the states of the access to the devices vary depending on the applications executed by the host.
      <br/>
      Some processing may incur a concentration of accesses to the device mapped to the lower hierarchical bus, with the result that elongation of the access time may possibly lead to a low processing performance.
    </p>
    <p num="5">
      On the contrary, even in the case of an ordinary bus having no hierarchical structure, an electrical characteristic, for instance, a delay time of the access from the host differs depending on the positions of connections of the slots to the bus.
      <br/>
      As a result of this, a plurality of devices connected to the same bus also have different access time depending on their bus connecting positions.
      <br/>
      For this reason, in case accesses are concentrated to the device connected to the position having an insufficient electrical characteristic, the access time may be increased or an error attributable to an electrical fault may occur, which requires a retry for recovery, resulting in a lower processing performance as a whole.
    </p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="6">According to the present invention, there is provided a bus control apparatus for adding to the speed of transfer on a bus having a hierarchical structure.</p>
    <p num="7">
      The present invention is directed to a bus control apparatus for a hierarchical bus, comprising a hierarchical bus connected to a host apparatus and consisting at least of an upper hierarchical bus and a lower hierarchical bus, a plurality of slots selectively connectable to the hierarchical bus in order to connect a device receiving an input/output demand from the host apparatus; a priority decision circuit for deciding priorities of the plurality of slots; and a bus mapping circuit for connecting each of the plurality of slots to the hierarchical bus to allow an execution of processing in response to an access demand from the host apparatus on the basis of the priorities determined by the priority decision circuit.
      <br/>
      In this case, the priority decision circuit decides the priorities on the basis of the frequencies of access of the host apparatus to devices connected to the plurality of slots.
      <br/>
      That is, the bus mapping circuit has an access counter which counts up the number of times of access of the host apparatus to the devices connected to the plurality of slots at a specified interval, and the priority decision circuit sets priorities of the slots in descending order of access number of times counted up by the access counter.
      <br/>
      At the start of use of the apparatus by the power on, the priority decision circuit assigns previously defined priorities to the plurality of slots whereas in use it assigns the priorities to the slots in descending order of the number of times of access of the host apparatus to the devices connected to the plurality of slots which are counted up by the access counter at a specified interval.
      <br/>
      Furthermore, the bus mapping circuit allows a non-volatile memory unit to store at the time of power off the priorities of the plurality of slots determined by the priority decision circuit, and the bus mapping circuit reads out the priorities stored in the non-volatile memory unit at the start of use by the next power on, to thereby perform initialization.
      <br/>
      When the priority decision circuit recognizes an unused slot which is not connected to the device among said plurality of slots, it assigns the lowest priority to said unused slot.
      <br/>
      The bus mapping circuit performs mapping allowing a slot having a higher priority to be connected to the upper hierarchical bus whereas it performs mapping allowing a slot having a lower priority to be connected to the lower hierarchical bus.
      <br/>
      According to such a bus control apparatus of the present invention, in case the upper hierarchical bus includes any slots having no access from the upper hierarchical bus and the lower hierarchical bus includes any slots having frequent accesses from the lower hierarchical bus, the bus connection is again mapped so that more frequently accessed lower hierarchical bus slot is turned to the upper hierarchical bus, thereby eliminating the access via the bus bridge to shorten the access path, making it possible to add to the bus access speed.
    </p>
    <p num="8">
      It is another object of the present invention to provide a bus control apparatus for increasing the speed of transfer on an ordinary bus having no hierarchical structure.
      <br/>
      This bus control apparatus comprises a bus connected to a host apparatus; a plurality of slots selectively connectable to buses for connecting devices receiving an input/output demand from the host apparatus; a plurality of slot connection positions provided on the buses for connecting a plurality of slots having priorities set in the descending order of the electrical characteristics with the host apparatus; a priority decision circuit for determining the priorities of the plurality of slots; and a bus mapping circuit for connecting each of the plurality of slots to the slot connection positions on the buses on the basis of the priorities determined by the priority decision circuit to thereby allow the execution of processing in response to the access demand from the host apparatus.
      <br/>
      The detail of the priority decision circuit in this case is the same as that of the case using the hierarchical bus and is provided with the access counter and the non-volatile memory.
      <br/>
      The bus mapping circuit performs mapping allowing a slot having a higher priority to be connected to a slot connection point having a higher priority whereas it performs mapping allowing a slot having a lower priority to be connected to a slot connection point having a lower priority.
      <br/>
      According to the bus control apparatus of the present invention, in case a frequently accessed slot lies in a bus connection position having a relatively low electric characteristic, the frequently accessed slot is again mapped to another slot connection position on the bus having a superior bus electric characteristic, so that the electric characteristic is improved to for instance shorten the delay time, making it possible to increase the bus access speed.
    </p>
    <p num="9">The above and other objects, features and advantages of the present invention will become more apparent from the following detailed description with reference to the accompanying drawings.</p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="10">
      FIG. 1 is a circuit block diagram of a bus control apparatus for a hierarchical bus in accordance with the present invention;
      <br/>
      FIG. 2 is a circuit block diagram of a bus mapping circuit of FIG. 1;
      <br/>
      FIG. 3 is an explanatory diagram of a bus mapping signal to be fed in response to the input of an arbitration signal indicative of an access frequency in a priority decision circuit of FIG. 1;
      <br/>
      FIG. 4 is a flowchart of a bus control in accordance with the embodiment of FIG. 1;
      <br/>
      FIG. 5 is a circuit block diagram of the embodiment of the present invention for mapping the positions of connections of slots to a single bus;
      <br/>
      FIG. 6 is a circuit block diagram of a bus mapping circuit of FIG. 5; and
      <br/>
      FIG. 7 is an explanatory diagram of a bus mapping signal to be fed in response to the input of an arbitration signal indicative of the access frequency in a priority decision circuit of FIG. 6.
    </p>
    <heading>DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
    <p num="11">
      FIG. 1 is a circuit block diagram of an embodiment of a bus control apparatus intended for a hierarchical bus in accordance with the present invention.
      <br/>
      A host computer 10 has a host bus 12 to which is connected via a host bridge 14 an upper hierarchical bus 16 within the hierarchical bus which is the object of the present invention.
      <br/>
      A lower hierarchical bus 18 is connected via a bus bridge 17 to the upper hierarchical bus 16.
      <br/>
      In this embodiment, the upper hierarchical bus 16 and the lower hierarchical bus 18 are each provided for example with four slots.
      <br/>
      Thus, the slots connectable to the upper hierarchical bus 16 and the lower hierarchical bus 18 are provided in the form of slots 20-1, 20-2, 20-3 and 20-4 in this embodiment which are associated respectively with device circuits 22-1, 22-2, 22-3 and 22-4.
      <br/>
      The device circuits 22-1 to 22-4 can be storage devices such as a hard disk drive, an optical disk drive, a floppy disk drive, etc., or any input/output devices such as a keyboard, a printer, a communication modem, etc.
      <br/>
      The slots 20-1 and 20-2 are allowed to be connected via a bus mapping circuit 24-1 to either the upper hierarchical bus 16 or the lower hierarchical bus 18.
      <br/>
      Similarly, the slots 20-3 and 20-4 are allowed to be connected via a bus mapping circuit 24-2 to either the upper hierarchical bus 16 or the lower hierarchical bus 18.
      <br/>
      The bus mapping circuit 24-1 is provided with branch buses 36-1 and 40-1 for the connection to the upper hierarchical bus 16 and with branch buses 36-2 and 40-2 for the connection to the lower hierarchical bus 18.
      <br/>
      The bus mapping circuit 24-2 is provided with branch buses 42-1 and 44-1 for the connection to the upper hierarchical bus 16 and with branch buses 42-2 and 44-2 for the connection to the lower hierarchical bus 18.
      <br/>
      The bus mapping circuits 24-1 and 24-2 are under the control of a priority decision circuit 26.
      <br/>
      The priority decision circuit 26 decides the priority for judging whether the slots 20-1 to 20-4 are to be connected to the upper hierarchical bus 16 or to the lower hierarchical bus 18.
      <br/>
      An algorithm for deciding the priority by the priority decision circuit 26 includes counting over a specified period of time the number of accesses of the host computer 10 to the device circuits 22-1 to 22-4 connected to the slots 20-1 to 20-4.
      <br/>
      The priority decision circuit 26, setting a higher priority when the number of accesses is equal to or more than a predetermined threshold value and setting a lower priority when the number of times of access is less than the predetermined threshold value.
      <br/>
      The bus mapping circuits 24-1 and 24-2 are informed set for priorities of the slots 20-1 to 20-4 by the priority decision circuit 26, to map the connections to the upper hierarchical bus 16 and to the lower hierarchical bus 18 in conformity with the thus decided priorities.
      <br/>
      More specifically, regarding slots 20-1 to 20-4, the bus mapping circuits 24-1 and 24-2 provide arbitration signals E11, E21, E31 and E41 to the priority decision circuit 26 indicating the number of times the frequency of access is equal to or more than a threshold value or less than the threshold value.
      <br/>
      That is, as will become clear from the following description, the arbitration signals E11 to E41 have a logical level 1 when the frequency of access over a specified period of time counted by access counters provided in the bus mapping circuit 24-1 and 24-2 is equal to or more than a threshold value, but have a logical level 0 when the aforementioned frequency of access is less than a threshold value.
      <br/>
      The priority decision circuit 26 receives the bus arbitration signals E11 to E41 indicative of the frequency of access to the slots 20-1 to 20-4, and provides bus mapping signals E12, E22, E32 and E42 to the bus mapping circuits 24-1 and 24-2 allowing bus mapping for connecting a slot having more accesses to the upper hierarchical bus 16 but providing bus mapping for connecting a slot having a smaller number of accesses to the lower hierarchical bus 18, thereby creating the states of connection of the slots 20-1 to 20-4 to the upper hierarchical bus 16 and the lower hierarchical bus 18.
    </p>
    <p num="12">
      FIG. 2 is a circuit block diagram of the bus mapping circuit 24-1 associated with the slots 20-1 and 20-2 of FIG. 1.
      <br/>
      The bus mapping circuit 24-1 is provided with an access counter 28 and multiplexers 30 and 32.
      <br/>
      The access counter 28 is connected to slot connection buses 34 and 38 associated with the slots 20-1 and 20-2, respectively, so the access counter 28 counts up the number of accesses of the host computer 10 to the device circuits 22-1 and 22-2 connected to the slots 20-1 and 20-2 for each specified period of time.
      <br/>
      Then, the counter 28 compares the access number of access counted for the slots 20-1 and 20-2 at the timing of the completion of a specified period of time with a previously defined threshold value.
      <br/>
      The access counter 28 sets the logical level of the arbitration signals E11 and E21 issued to the priority decision circuit 26 to 1 if the access count is equal to or more than the threshold value, but to 0 if the access count is less than the threshold value.
      <br/>
      The multiplexer 30 serves to switchably connect the slot connection bus 34 associated with the slot 20-1 to the branch bus 36-1 associated with the upper hierarchical bus 16 or to the branch bus 36-2 associated with the lower hierarchical bus 18.
      <br/>
      More specifically, the multiplexer 30 connects the slot connection bus 34 associated with the slot 20-1 to the branch bus 36-1 associated with the upper hierarchical bus 16 when the logic level of the bus mapping signal E12 from the priority decision circuit 26 is 1, whereas it connects the slot connection bus 34 associated with the slot 20-1 to the branch bus 36-2 associated with the lower hierarchical bus 18 when the logic level of the bus mapping signal E12 is 0.
      <br/>
      The multiplexer 32 is switched to connect the slot connection bus 38 associated with the slot 20-2 to the branch bus 40-1 associated with the upper hierarchical bus 16 when the logical level of the bus mapping signal E22 from the priority decision circuit 26 is 1, whereas The multiplexer 32 is switched to connect the slot connection bus 38 associated with the slot 20-2 to the branch bus 40-2 associated with the lower hierarchical bus 18 when the logical level of the bus mapping signal E22 is 0.
    </p>
    <p num="13">
      FIG. 3 is a logical table of input/output relationship between the arbitration signals Ell to E41 indicative of the number of of accesses to the slots 20-1 to 20-4 imparted from the bus mapping circuits 24-1 and 24-2 to the priority decision circuit 26 of FIG. 1 and the bus mapping signals E12 to E42 imparted from the priority decision circuit 26 to the bus mapping circuits 24-1 and 24-2.
      <br/>
      In this logical table, 16 modes of mode Nos. 0 to 15 are assigned to 4-bit input information consisting of the arbitration signals E11 to E41 having the logical level 1 when the access number of accesses is equal to or more than a threshold value but having the logical level 0 when it is less than the threshold value.
      <br/>
      The mode No. 0 indicates a case where the arbitration signals E11 to E41 result in 0000 since the number of accesses to all the slots is less than the threshold value, which occurs at the initial state where the apparatus has been activated to first start the use.
      <br/>
      In the case of the mode No. 0 indicative of the initial state, the bus mapping signals E12 to E42 result in 1100, which are default bus mapping signals determining the initial relationship of the slot connections.
      <br/>
      This means that the slots 20-1 and 20-2 of FIG. 1 are connected by the bus mapping circuit 24-1 to the upper hierarchical bus 16 whereas the slots 20-3 and 20-4 are connected by the bus mapping circuit 24-2 to the lower hierarchical bus 18.
      <br/>
      If the use of the apparatus is started in the connection states of the slots 20-1 to 20-4 in conformity with the default 1100 of the bus mapping signals E12 to E42 in such an initial state, then for example the number of accesses to the slot 20-4 may be equal to or more than the threshold value as in the mode No. 0 for example after the elapse of a specified period of time depending on the state of accesses of the host computer 10 to the device circuit 22-1 to 22-4 connected to the slot 20-4, whereupon the arbitration signal E14 results in 1, allowing the arbitration signals E11 to E41 to result in 0001.
      <br/>
      In consequence, the priority decision circuit 26, upon the input of the arbitration signals E11 to E41 sets the bus mapping signals E12 to E42 imparted to the bus mapping circuits 24-1 and 24-2 to 1001 in conformity with the logical table of FIG. 3.
      <br/>
      That is, since the number of times of access to the slot 20-4 hitherto connected to the lower hierarchical bus 18 has exceeded the threshold value, a bus mapping is effected so as to connect the slot 20-4 to the upper hierarchical bus 16.
      <br/>
      Another bus mapping is simultaneously effected so as to connect the slot 20-2 hitherto connected to the upper hierarchical bus 16 to the lower hierarchical bus 18.
      <br/>
      Afterwards, in the same manner, a four bits of information is output as bus mapping signals E12 to E42 corresponding to the four-bit information of arbitration signals E11 to E41 of any one of the mode Nos. 0 to 15 on the basis of the counted number of accesses to the slots 20-1 to 20-4 during every specified period of time, thereby dynamically effecting the bus mapping in which the slot having a greater number of accesses is always connected to the upper hierarchical bus 16, whereas the slot having a smaller number of accesses is always connected to the lower hierarchical bus 18.
    </p>
    <p num="14">
      Although in the embodiment of FIG. 1 the device circuits 22-1 to 22-4 are connected to all the slots 20-1 to 20-4, if there is an unused slot having no connection with the device circuit, then the arbitration signal from that slot is always fixed to 0, and in the bus mapping circuits 24-1 and 24-2 a mapping is fixedly effected so as to allow a constant connection with the bus corresponding to the lowest priority, that is, with the lower hierarchical bus 18.
      <br/>
      Furthermore, the non-volatile memory is provided in the priority decision circuit 26 as shown in FIG. 1 so that upon the log-off processing action for removing the power of the apparatus it stores the four-bit information of the bus mapping signals E12 to E42 at that time to thereby hold the bus mapping information in spite of the disconnection of the power.
      <br/>
      Then, upon the next power on of the apparatus, the bus mapping signals at the time of the power off stored and held in the non-volatile memory 25 are read out for the initialization processing of the bus mapping by means of the bus mapping circuits 24-1 and 24-2.
      <br/>
      This enables the priority in conformity with thes number of accesses before the most recent disconnection of power to be taken over upon the power on during the operation of the apparatus, thereby providing a more appropriate switching of connection of the slots to the hierarchical buses.
    </p>
    <p num="15">
      FIG. 4 is a flowchart of a bus mapping control for the hierarchical buses of FIG. 1.
      <br/>
      First in step S1, a check is made to see if the non-volatile memory 25 retains the bus mapping information, and if no such retained information is found the procedure goes to step S2 to perform the default bus mapping; that is, the bus mapping of the slots 20-1 to 20-4 in conformity with the bus mapping signals E12 to E42=1100 indicated at the mode No. 0 of FIG. 3.
      <br/>
      If the non-volatile memory 25 retains the bus mapping information, then in step S3 a bus mapping is carried out on the basis of the retained bus mapping information.
      <br/>
      Then in step S4 the measurements of the number of times of access to all the slots 20-1 to 20-4 are initiated, and in step S5 it is determined whether specified period of time has elapsed.
      <br/>
      If so, the procedure advances to step S6 to determined the number of times of access on a slot-by-slot basis to thereby change the bus mapping.
      <br/>
      For example, the number of accesses are compared with the previously defined threshold value, and if the access number is equal to or more than the threshold value, the bus arbitration signal imparted to the priority decision circuit 26 is set to 1 whereas if it is less than the threshold value, the bus arbitration signal is set to 0 so that the bus mapping of the slots 20-1 to 20-4 is changed by the output of the bus mapping signals E12-E42 in conformity with the logical table of FIG. 3.
      <br/>
      After the completion of the bus mapping, the number of accesses is cleared in step S7, and if no completion instruction is issued in step S8, the procedure goes back to step S4 to measure the number of accesses to all the slots in the next specified period of time.
      <br/>
      Then, if it is determined in step S8 that a completion instruction has been issued on the basis of a log off operation for the connection of power during the use of the apparatus, the procedure goes to step S9 to retain the current bus mapping information into the non-volatile memory 25 to complete a series of processing.
      <br/>
      This bus mapping information stored in the non-volatile memory 25 is read out in the processing of FIGS.
      <br/>
      S1 and S3 at the time of the initialization upon the next power on, in order to be again utilized for the initialization setting of the bus mapping.
    </p>
    <p num="16">
      FIG. 5 illustrates another embodiment of a bus control apparatus in accordance with the present invention.
      <br/>
      This embodiment is characterized in that the bus mapping is effected through the switching of the positions of connections of a plurality of slots to the same bus on the basis of the priority of each slot.
      <br/>
      The bus 16 is connected via the host bridge 14 to the host bus 12 of the host computer 10 and is provided with exemplary slot connection positions 50-1, 50-2, 50-3 and 50-4 so as to allow four slots 20-1 to 20-4 to be selectively connected via a bus mapping circuit 46 in this embodiment.
      <br/>
      The device circuits 22-1 to 22-4 are connected to the slots 20-1 to 20-4, respectively.
      <br/>
      The bus mapping circuit 46 is associated with a priority decision circuit 48 provided with the non-volatile memory 25, the priority decision circuit 48 serving to receive arbitration signals E11 to E41 based on the result of comparison with the threshold value of the access number of times counted up for each slot 20-1 to 20-4 by the bus mapping circuit 46 and to issue bus mapping signals E13 to E43 in conformity with a previously defined logical table; shown in FIG. 7.
    </p>
    <p num="17">
      FIG. 6 is a circuit block diagram of the bus mapping circuit 46 of FIG. 5.
      <br/>
      The bus mapping circuit is provided with an access counter 52 and four multiplexers 54-1 to 54-4.
      <br/>
      The access counter 52 connects the buses of the slots 20-1 to 20-4, counts up the number of accesses of the host computer 10, and sets the logical level of the bus arbitration signals E11 to E41 to 1 when the access number is equal to or more than a threshold value but to 0 when it is less than the threshold value.
      <br/>
      The multiplexers 54-1 to 54-4 are provided in such a manner as to correspond to the slots 20-1 to 20-4, respectively, and each connect to the buses associated with the slots 20-1 to 20-4 and connect to the slot connection positions 50-1 to 50-4 of the bus 16, allowing the slots 20-1 to 20-4 to be selectively connected to the four slot connection positions 50-1 to 50-4.
      <br/>
      For this reason, the bus mapping signals E13 to E43 are imparted from the priority decision circuit 48 to the multiplexers 54-1 to 54-4, respectively.
      <br/>
      These bus mapping signals E13 to E43 are provided in the form of 2-bit signals since they switch the connections of four slot connection positions 50-1 to 50-4 on the bus 16 with respect to the slots 20-1 to 20-4.
      <br/>
      More specifically, the bus mapping signals E13 to E43 each select the slot connection position 50-1 having the highest priority when 00, select the slot connection position 50-2 having the second highest priority when 01, select the slot connection position 50-3 having the third highest priority when 10, and select the slot connection position 50-4 having the lowest priority when 11.
    </p>
    <p num="18">
      FIG. 7 is a logical table for use in the priority decision circuit 48 of FIG. 5.
      <br/>
      This logical table is used for inputting 4-bit information of the bus arbitration signals E11 to E43 from the access counter 52 provided in the bus mapping circuit 46 of FIG. 6 to issue the bus mapping signals E13 to E43 having 2-bit information to the multiplexers 54-1 to 54-4 of the bus mapping circuit 46 of FIG. 6, thereby providing a control of the state of connection of the slots 20-1 to 20-4 to the four slot connection positions 50-1 to 50-4.
      <br/>
      Since the arbitration signals E11 to E14 are four bits in this manner, there exist 16 modes including the mode Nos. 0 to 15. Mode No. 0 represents an initial state in which the number of times of access to all the slots 20-1 to 20-4 is less than a threshold value, and hence it defines the default logical relationship.
      <br/>
      At that time, the bus mapping signal E13 is 00, allowing the slot 20-1 to be connected to the slot connection position 50-1 having the highest priority.
      <br/>
      The bus mapping signal E23 results in 01, allowing the slot 20-2 to be connected by the multiplexer 54-2 to the slot connection position 50-2 having the second highest priority.
      <br/>
      The bus mapping signal E33 imparted to the multiplexer 54-3 results in 10, allowing the slot 20-3 to be connected to the slot connection position 50-3 having the third priority.
      <br/>
      Furthermore, the bus mapping signal E43 imparted to the multiplexer 54-4 results in 11, allowing the slot 20-4 to be connected to the slot connection position 50-4 having the lowest priority.
      <br/>
      The apparatus is started in the initial state representing the default logical patterns and the access number of times over a specified period of time is counted up, so that the mode of the four-bit arbitration signal changes from the mode No. 0 to any one of the mode Nos. 1 to 15. It is natural that the mode No. 0 may possibly be unvaried.
      <br/>
      It is assumed in this case that the number of times of access to the slot 20-4 connected to the slot connection position 50-4 having the lowest priority became equal to or more than a threshold value to change the logical level of the arbitration signal E14 to 1.
      <br/>
      In response to the change of the logical level of the arbitration signals E11 to E14 into 0001, the bus mapping signal E43 imparted to the multiplexer 54-4 corresponding to the slot 20-4 having the largest access number of times results in 00, allowing a selection of a connection to the slot connection position 50-4 having the highest priority.
      <br/>
      At the same time, the bus mapping signals E13, E23 and E33 imparted to the multiplexers 54-1 to 54-3 corresponding to the slots 20-1 to 20-3 result in 01, 10 and 11, respectively, allowing the connections to the slot connection positions 50-2, 50-3 and 50-4 which are each shifted by one since the slot 20-4 is connected to the slot connection position 50-1.
      <br/>
      As a result of this, the slot 20-4 having the largest access number of times is connected to the slot connection position 50-1 having the highest priority whereas the slots 20-1, 20-2 and 20-3 receiving unvarying arbitration signals are connected to the slot connection positions 50-2, 50-3 and 50-4, respectively, having priorities lowered by one.
      <br/>
      From there onward as well, every specified period of time there is dynamically effected switching of the connections of the slots 20-1 to 20-4 to the slot connection positions 50-1 to 50-4 on the bus 16 by the bus mapping signal corresponding to the arbitration signal having any one of the mode Nos. 0 to 15, on the basis of the comparison of the result of counting of the access number of times with the threshold value.
    </p>
    <p num="19">According to the present invention as described hereinabove, the priorities are determined on the basis of the frequencies of access to a plurality of slots, and a mapping is effected so as to connect the slot having a higher priority to the upper hierarchical bus but to connect the slot having a lower priority to the lower hierarchical bus whereby in-case there exist a slot having no access of the upper hierarchical bus, a slot having less access number of times and an idle slot, a bus mapping is effected for connecting the slot of the lower hierarchical bus having more access number of times to a slot of the upper hierarchical bus when there exists a frequently accessed lower slot, with the result that there is no access via the bus bridge to the slot having more access number of times to shorten the access path, thereby increasing the speed of bus access to the frequently accessed slot to improve the access properties as a whole.</p>
    <p num="20">Moreover, in compliance with the electrical characteristics of the slot connection positions, priorities are assigned to a plurality of slots connected to a single bus, and a mapping is effected so that a slot having a higher access frequency is connected to the slot position having a higher priority on the bus and that a slot having a lower access frequency is connected to the slot position having a lower priority on the bus, whereby the slot having more access number of times is mapped to the slot position having a satisfactory electric characteristic to improve the electric characteristic and shorten the delay time for example, thereby making it possible to increase the speed of bus access to the slot having more access number of times to improve the access properties as a whole.</p>
    <p num="21">
      It is to be appreciated that although in this embodiment two slots or four slots are connected to a single bus by way of example, the number of slots to be connected to the bus may be any appropriate number based on the bus architecture and that it is not limited by the embodiments.
      <br/>
      Although the hierarchical bus of FIG. 1 is two-hierarchical bus consisting of the upper hierarchical bus 16 and the lower hierarchical bus 18 by way of example, the number of hierarchy could appropriately be increased as needed.
    </p>
    <p num="22">
      Furthermore, although in the embodiments of FIG. 1 and FIG. 5 the bus mapping circuit and the priority decision circuit are implemented as logical circuits, they may naturally be implemented under the control of a software by means of a bus control processor.
      <br/>
      In addition, although in the above embodiments the number of times of access to each slot is compared with a threshold value to represent the access number of times by 2-bit information having high level and low level, direct use may be made of the access number of times itself.
    </p>
    <p num="23">It is to be construed that the present invention includes variants without impairing the objects and advantages thereof and that it is not limited by the numerical values shown in the embodiments.</p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A bus control apparatus comprising:</claim-text>
      <claim-text>a bus connected to a host apparatus by hierarchizing the bus to at least an upper hierarchical bus and a lower hierarchical bus; a plurality of slots selectively connectable to said bus in order to connect a device receiving an input/output demand from said host apparatus; a priority decision circuit for dynamically deciding priorities of said plurality of slots at specified time intervals;</claim-text>
      <claim-text>and a bus mapping circuit for mapping said plurality of slots so as to connect each slot having a high priority to said upper hierarchical bus and to connect each slot having a low priority to said lower hierarchical bus each time the priority of the plurality of slots is decided by said priority decision circuit.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. A bus control apparatus according to claim 1, wherein positions of connections of said bus to said slots are assigned priorities set in the order of descending electric characteristics with said host apparatus, and wherein said bus mapping circuit connects each of plurality of slots to a position of connection having a predetermined priority on said bus on the basis of priorities.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. A bus control apparatus according to claim 2, wherein said priority decision circuit decides the priorities on the basis of the frequencies of access of said host apparatus to devices connected to said plurality of slots.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. A bus control apparatus according to claim 3, wherein said bus mapping circuit has an access counter which counts up the number of times of access of said host apparatus to the devices connected to said plurality of slots at a specified interval, and wherein said priority decision circuit sets priorities of said slots in descending order of access number of times counted up by said access counter.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. A bus control apparatus according to claim 4, wherein at the start of the use of said apparatus by a power on, said priority decision circuit assigns previously defined priorities to said plurality of slots whereas, while in use, it priority decision circuit assigns the priorities to said slots in descending order of the number of times of access of said host apparatus to the devices connected to said plurality of slots which are counted up by said access counter at a specified interval.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. A bus control apparatus according to claim 4, wherein said bus mapping circuit allows a non-volatile memory unit to store at the time of power off the priorities of said plurality of slots determined by said priority decision circuit, and wherein said bus mapping circuit reads out the priorities stored in said non-volatile memory unit at the start of use by the next power on, to thereby perform initialization.</claim-text>
    </claim>
    <claim num="7">
      <claim-text>7. A bus control apparatus according to claim 2, wherein when said priority decision circuit recognizes an unused slot which is not connected to the device among said plurality of slots, it assigns the lowest priority to said unused slot.</claim-text>
    </claim>
    <claim num="8">
      <claim-text>8. A bus control apparatus according to claim 2, wherein said bus mapping circuit performs mapping allowing a slot having a higher priority to be connected to a slot connection position having a higher priority whereas it performs mapping allowing a slot having a lower priority to be connected to a slot connection position having a lower priority.</claim-text>
    </claim>
    <claim num="9">
      <claim-text>9. A bus control apparatus for connecting a plurality of slots for the connection of devices receiving an input/output demand from a host apparatus to a bus connected to said host apparatus, said bus control apparatus comprising: a plurality of slot connecting positions which are provided for said bus and to which predetermined priorities have been assigned; a priority decision circuit for dynamically deciding priorities of said plurality of slots at every certain time interval;</claim-text>
      <claim-text>and a bus mapping circuit for selectively connecting each of said plurality of slots to said slot connecting position having said slot connecting position of the corresponding priority each time the priority of the slot is determined by said priority decision circuit.</claim-text>
    </claim>
    <claim num="10">
      <claim-text>10. A bus control apparatus according to claim 9, wherein said bus has a hierarchical structure; said plurality of slot connecting positions are provided for a predetermined hierarchical level of said bus;</claim-text>
      <claim-text>and said bus mapping circuit selectively connects each of said plurality of slots to said predetermined hierarchical level of said bus.</claim-text>
    </claim>
    <claim num="11">
      <claim-text>11. A bus control apparatus according to claim 9, wherein said slot connecting positions provided for said bus are assigned priorities set in the order of descending electric characteristics with said host apparatus, and wherein said bus mapping circuit connects each of plurality of slots to a slot connecting position having a predetermined priority on said bus on the basis of priorities.</claim-text>
    </claim>
    <claim num="12">
      <claim-text>12. A method of connecting a plurality of slots to a hierarchical bus, said hierarchical bus having an upper bus and a lower bus, for the connection of devices receiving access requests from a host apparatus, comprising: determining the priorities of each of the plurality of slots, based on the frequency of access of the host apparatus to devices connected to said each of the plurality of slots; connecting each slot having a high priority to the upper bus;</claim-text>
      <claim-text>and connecting each slot having a low priority to the lower bus.</claim-text>
    </claim>
    <claim num="13">
      <claim-text>13. A method of connecting a plurality of slots to a bus for the connection of devices receiving access requests from a host apparatus, comprising: assigning predetermined priorities to a plurality of slot connecting positions; dynamically determining the priorities of the plurality of slots at every certain time interval;</claim-text>
      <claim-text>and selectively connecting each slot of the plurality of slots to said slot connecting position having said slot connecting position of the corresponding priority each time the priority of the slot is determined.</claim-text>
    </claim>
    <claim num="14">
      <claim-text>14. A method of connecting a plurality of slots to a bus, comprising: hierarchizing the bus to at least an upper hierarchical bus and a lower hierarchical bus; dynamically deciding priorities of said plurality of slots at specified time intervals;</claim-text>
      <claim-text>and mapping the plurality of slots, wherein each slot having a high priority is connected to said upper hierarchical bus and each slot having a low priority is connected to said lower hierarchical bus each time the priority of the plurality of slots is dynamically decided.</claim-text>
    </claim>
    <claim num="15">
      <claim-text>15. A bus control apparatus, comprising: means for hierarchizing a bus to at least an upper hierarchical bus and a lower hierarchical bus; means for selectively connecting a plurality of slots to said bus in order to connect a device receiving an input/output demand from a host; means for dynamically deciding priorities of said plurality of slots at specified time intervals;</claim-text>
      <claim-text>and means for mapping said plurality of slots so as to connect each slot having a high priority to said upper hierarchical bus and to connect each slot having a low priority to said lower hierarchical bus each time the priority of the plurality of slots is decided.</claim-text>
    </claim>
  </claims>
</questel-patent-document>