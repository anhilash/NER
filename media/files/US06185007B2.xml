<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06185007B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06185007</doc-number>
        <kind>B2</kind>
        <date>20010206</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6185007</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference is-representative="YES" family-id="17549542" extended-family-id="23895965">
      <document-id>
        <country>US</country>
        <doc-number>09135841</doc-number>
        <kind>A</kind>
        <date>19980818</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1998US-09135841</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>24514790</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>JP</country>
        <doc-number>27500397</doc-number>
        <kind>A</kind>
        <date>19970820</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1997JP-0275003</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010206</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>H04N   1/407       20060101AFI20051220RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>1</main-group>
        <subgroup>407</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051220</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>H04N   1/60        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>1</main-group>
        <subgroup>60</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>358001900</text>
        <class>358</class>
        <subclass>001900</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>358521000</text>
        <class>358</class>
        <subclass>521000</subclass>
      </further-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>H04N-001/60F2</text>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>001</main-group>
        <subgroup>60F2</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04N-001/6033</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>1</main-group>
        <subgroup>6033</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>6</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>27</number-of-drawing-sheets>
      <number-of-figures>31</number-of-figures>
      <image-key data-format="questel">US6185007</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Image forming apparatus</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>HATTORI YOSHIHIRO, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5305057</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5305057</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>KUWATA KAZUMI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>6055071</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6055071</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>MAMIZUKA MITSURU</text>
          <document-id>
            <country>US</country>
            <doc-number>6061144</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6061144</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="4">
          <text>TSUJI KATSUHISA, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5057914</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5057914</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="5">
          <text>TSUJI KATSUHISA</text>
          <document-id>
            <country>US</country>
            <doc-number>5077615</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5077615</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="6">
          <text>CANON KK</text>
          <document-id>
            <country>JP</country>
            <doc-number>H07264411</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP07264411</doc-number>
          </document-id>
        </patcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Ricoh Company, Ltd.</orgname>
            <address>
              <address-1>Tokyo, JP</address-1>
              <city>Tokyo</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>RICOH</orgname>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Hayashi, Koji</name>
            <address>
              <address-1>Kanagawa, JP</address-1>
              <city>Kanagawa</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="2">
          <addressbook lang="en">
            <name>Bisaiji, Takashi</name>
            <address>
              <address-1>Kanagawa, JP</address-1>
              <city>Kanagawa</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="3">
          <addressbook lang="en">
            <name>Tsuji, Katsuhisa</name>
            <address>
              <address-1>Kanagawa, JP</address-1>
              <city>Kanagawa</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="4">
          <addressbook lang="en">
            <name>Kuwata, Kazumi</name>
            <address>
              <address-1>Tokyo, JP</address-1>
              <city>Tokyo</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <orgname>Oblon, Spivak, McClelland, Maier &amp; Neustadt, P.C.</orgname>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Lee, Thomas D.</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>LAPSED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      When an ACC menu is called out on a liquid crystal screen of an operating section, the screen shown in FIG. 19 is displayed.
      <br/>
      When "Execution" of automatic color calibration for use of a copying function is selected, the screen in FIG. 20 is displayed.
      <br/>
      When it is desired to use the copying function, a gradation calibration table used when the copying function is changed with reference to the deference data.
      <br/>
      When Print Start key in FIG. 20 is selected, a plurality of density gradation patterns corresponding to colors of YMCK as well as to a plurality of image quality mode such as characters and pictures are formed on a transfer material.
      <br/>
      The density gradation patterns are previously stored and set in a ROM of an IPU.
      <br/>
      A write value for a pattern is changed according to a result of detection of the development characteristics.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>FIELD OF THE INVENTION</heading>
    <p num="1">The present invention relates to a method of calibrating a corrected gradation curve for gradation conversion of image data used for image processing in image forming apparatuses such as a copying machine, a printer, or a facsimile machine each based on the digital system, and to an image forming apparatus using the method therein.</p>
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="2">Conventionally, in an image forming apparatus based on the digital system, for calibrating output characteristics of an output device such as a printer (image forming unit) and also for emphasizing an area having particular density, there has been used an image signal conversion table (Look-Up Table and described as LUT hereinafter).</p>
    <p num="3">An image forming apparatus generally comprises an image reading unit, an image processing unit, an image writing unit, and image output unit, and the LUT described above is incorporated in the image processing unit and converts an input image signal inputted from the image reading unit to the image processing unit and outputs the converted image signal as an output image signal to the image writing unit.</p>
    <p num="4">This LUT utilizes the output characteristics such as density of an image outputted from a printer, so that, when output characteristics of the printer changes due to "degradation or contamination" of the image forming unit or other related sections, the LUT can not play a role for calibration.</p>
    <p num="5">To overcome this problem, as a control generally called as process control executed in an image forming apparatus, sometimes a plurality of patterns each having a different image density are formed on an image carrier such as a light-sensing body or a transfer member, a reflected light from or a transmitting light through the patterns is detected, and such parameters as a charged potential, a development bias, or a exposure rate of a laser are changed or the gradation calibration table is changed according to a result of the detection above.</p>
    <p num="6">
      The calibrating method described above provides the merit that calibration is automatically executed in an image forming apparatus without requiring manual labor of an operator, but because of the characteristics of an optical sensor, there is no sensibility in the high density side where a deposition rate of toner is high, and calibration is made only in a range from a low density area to an intermediate density area where a toner deposition rate is rather low.
      <br/>
      Also with the calibrating method above, fluctuation in a quantity of transferred toner caused by gradually change of the transfer performance of a transfer section and fluctuation of image density due to change in the fixing capability in a fixing section can not be corrected.
    </p>
    <p num="7">
      In contrast, there is a method in which a pattern image formed on an image carrier and transferred and fixed on a transfer member is read with a scanner, and the gradation calibration table is selected or prepared according to the read data or a color conversion coefficient/RGB-YMCK color conversion table is prepared according to the read data.
      <br/>
      In this method, different from the calibrating method using an optical sensor described above, treatment by an operator such as manually placing a discharged transfer member on a document base or the like is required, but calibration of a high image density section where a toner deposition rate is high is possible, and also change of image density due to gradually change in performance of the transfer section as well as to change in the fixing capability in the fixing section can advantageously be corrected.
    </p>
    <p num="8">
      The invention disclosed in Japanese Patent Laid-Open Publication No. HEI 7-264411 relates to an image forming apparatus comprising a pattern forming unit for forming a gradation pattern on a recording member, a reading unit for reading the gradation pattern formed by the pattern forming unit, and a regulating unit for regulating conditions for image formation according to the gradation pattern read by the pattern reading unit, in which more gradation pattern steps are provided in a density area where the gradation characteristics is not linear as compared to those in other density areas.
      <br/>
      In this invention, the gradation patterns are fixed.
    </p>
    <p num="9">
      By the way, to execute regulation of image density, sometimes a gradation pattern is outputted onto transfer paper, the gradation pattern is read with a scanner, and the conversion characteristics of a gradation calibration table in an image processing section is decided according to the read gradation pattern.
      <br/>
      This operation is called automatic color calibration (ACC).
      <br/>
      In this step, to simplify processing executed no software and also to reduce a quantity of toner used for preparing a gradation pattern, it is necessary to precisely decide a gradation calibration table with a small number of gradation patterns.
    </p>
    <p num="10">
      When the number of gradation patterns is small, if a write value for gradation patterns is fixed, sometimes precision in regulation may not be stabilized due to effects by the development characteristics gradually changing.
      <br/>
      Description is made below for the reason with reference to FIG. 31.
    </p>
    <p num="11">
      In FIG. 31, a horizontal axis of the first quadrant indicates a laser write value for a gradation pattern, while a vertical axis indicates a gradation pattern read value outputted onto transfer paper, which indicates a relation between a gradation pattern write value and a scanner read value, and a horizontal axis of the second quadrant indicates a toner deposition rate on a light-sensing body, and this value indicates a relation between a toner deposition rate on the light-sensing body and a scanner read value.
      <br/>
      A vertical axis of the third quadrant indicates a development potential, which indicates a development characteristics of a printer.
      <br/>
      The development potential indicates a difference between a surface potential on the light-sensing body and a DC component of development bias, and the larger the value is, the higher a deposition rate of toner onto the light-sensing body is.
      <br/>
      The fourth quadrant indicates a relation between a development potential and a gradation pattern write value.
    </p>
    <p num="12">The reference numerals n (1) and n (2) on the horizontal axis of the first quadrant indicates write values in the first and second stages of a gradation pattern respectively, and herein a write value for a stage 0 of the gradation pattern is 0, which indicates a read value for background of the transfer paper.</p>
    <p num="13">
      The reference numerals g1) and h1) in the first quadrant show cases each having different development characteristics, and g1) indicates a case where a toner deposition rate onto a light-sensing body is large, and the case is indicated by the phrase of "Development rate is large" in the figure.
      <br/>
      The reference numeral h1) indicates a case where a toner deposition rate onto the light-sensing body is standard, and the case is indicated by the phrase of "Development rate is standard".
      <br/>
      Herein it is assumed that scanner read values to gradation pattern write values n �1�, n �2� for the development characteristics of g1), h1) are Ag �n�1��, Ag �n�2��, Ah �n�1��, and Ah �n�2��. As shown by the graph, Ag �n�1�� and Ah �n�1�� are substantially the same values.
      <br/>
      Assuming that the value is A �1�, a difference value A �1�-Ag �n�2�� and A �1�-Ah �n�2�� for the read values in the first stage and second stage of the gradation pattern for the development characteristics g1), h1) correspond to (e)  DELTA Ag �1� and (f)  DELTA Ah �1� in the figure respectively.
      <br/>
      As understood from the figure,  DELTA Ag �1� is larger than  DELTA Ah �1�, so that sometimes the error becomes larger when a gradation calibration table is prepared by estimating a laser write value between n �1� and n �2� by means of linear interpolation or spline interpolation.
    </p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="14">It is a first object of the present invention to provide an image forming apparatus which can prepare a gradation calibration table with a small number of gradation patterns as well as with high precision in the case as described above.</p>
    <p num="15">It is a second object of the present invention to provide an image forming apparatus having gradation calibration tables in an image forming section and a printer section respectively capable of preparing a gradation calibration table with a small number of patterns as well as with high precision.</p>
    <p num="16">It is a third object of the present invention to provide an image forming apparatus which can prepare a gradation table having high precision adjustability with a small number of patterns by detecting development characteristics from a toner image developed on an image carrier and deciding a write value for a gradation pattern according to the detected development characteristics.</p>
    <p num="17">It is a fourth object of the present invention to provide an image forming apparatus which can prepare a YMCK gradation calibration table for excellent color balance and gradation by executing ACC by ways of detecting the development characteristics from a surface potential of a pattern formed as a latent image of an image carrier and reading a surface potential of the pattern formed as a latent image on a light-sensing body.</p>
    <p num="18">With the present invention, there is provided a detecting unit for detecting development characteristics, and gradation calibration tables for YMCK can be prepared at high precision with a small number of gradation patterns by changing a write value for the gradation patterns used for preparing the gradation calibration tables for YMCK according to the development characteristics.</p>
    <p num="19">With the present invention, a gradation calibration table for a printer section is formed according to the development characteristics and an output signal for the gradation pattern is converted by way of referring to the gradation calibration table for forming an image on transfer paper, so that a gradation calibration table can be prepared at high precision with a smaller number of gradation patterns.</p>
    <p num="20">With the present invention, a quantity of toner deposited on a carrier is detected by a light sensing unit, a plurality of gradation patterns each having a different write value are prepared according to the detected toner deposition rate, and the development characteristics is detected by reading the plurality of gradation patterns, so that a gradation calibration table with precision having high adjustability can be prepared with a small number of patterns.</p>
    <p num="21">With the invention, a latent image potential of a gradation pattern is detected not only by the light sensing unit, but also by a surface potential detecting unit, a YMCK gradation calibration table for reading a surface potential of a gradation pattern formed as a latent image on the image carrier and obtaining an excellent color balance and gradation can be obtained by executing ACC.</p>
    <p num="22">Other objects and features of this invention will become understood from the following description with reference to the accompanying drawings.</p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="23">
      FIG. 1 is a block diagram showing a copying machine according to an embodiment of the present invention;
      <br/>
      FIG. 2 is an explanatory view for illustrating a control system for a copying machine according to the present invention;
      <br/>
      FIG. 3 is a block diagram showing configuration of an image processing section;
      <br/>
      FIG. 4 is a block diagram showing configuration of a printer  GAMMA  calibration circuit for image processing as well as of a gradation processing circuit;
      <br/>
      FIG. 5 is a block diagram showing configuration of a laser modulating circuit;
      <br/>
      FIG. 6 is a flow chart showing a sequence for preparing a gradation conversion curve;
      <br/>
      FIG. 7 is a view for illustrating preparation of a gradation conversion curve;
      <br/>
      FIG. 8 is a view showing change of a curvature with Bedge function;
      <br/>
      FIG. 9 is a view showing a conversion curve for changing gradation characteristics of a hi-lighted area;
      <br/>
      FIG. 10 is a flow chart showing a sequence in a method of detecting development characteristics;
      <br/>
      FIG. 11 is a view showing formation of 12 types of gradation pattern each having a different gradation density respectively;
      <br/>
      FIG. 12 is a view for illustrating a method of calibrating an image signal;
      <br/>
      FIG. 13 is a flow chart showing a sequence in processing for calibrating displacement in development;
      <br/>
      FIG. 14 is a view showing a relation between output from an optical sensor and a toner deposition rate;
      <br/>
      FIG. 15 is a flow chart showing a sequence in preparation of a gradation conversion table for image formation;
      <br/>
      FIG. 16 is a flow chart showing a sequence in processing for calibration so that gradation having changed from that initially set after passage of a specified period of time apparently seems not to have changed;
      <br/>
      FIG. 17 is a flow chart showing a sequence in operations for automatically calibrating gradation in image density;
      <br/>
      FIG. 18 is a view showing a liquid crystal screen showing an operating section;
      <br/>
      FIG. 19 is a view showing a screen with an ACC menu having been called thereon;
      <br/>
      FIG. 20 is a view showing a screen which is displayed when "Execution" for automatic gradation calibration is selected;
      <br/>
      FIG. 21 is a view showing a plurality of density gradation patterns formed on a transfer member;
      <br/>
      FIG. 22 is a view showing a screen displaying a message asking an Operator to place a transfer member on a document base after output of a pattern on the transfer member;
      <br/>
      FIG. 23 is a view showing a screen during processing for automatic gradation calibration;
      <br/>
      FIG. 24 is a table showing a calibration value for an RGB signal;
      <br/>
      FIG. 25 is a view for illustrating a method of preparing a gradation conversion table executed in the  GAMMA  calibration processing section during execution of ACC;
      <br/>
      FIG. 26 is a flow chart showing a sequence in preparation of a gradation calibration table during execution of ACC;
      <br/>
      FIG. 27 is a view for illustrating a method of calibrating an output value for a gradation pattern used for ACC according to a result of detection of development characteristics according to another embodiment of the present invention;
      <br/>
      FIG. 28 is a flow chart showing a sequence in decision of a write value for a gradation pattern;
      <br/>
      FIG. 29 is a view showing a relation between a write value for a gradation pattern and a read value read with a scanner, a relation between a toner deposition rate and a read value read with a scanner, and a relation among development characteristics of a printer, a write value for LD and a write value for the gradation pattern;
      <br/>
      FIG. 30 is a view showing matrix used for processing for color calibration; and
      <br/>
      FIG. 31 is a view that the precision in adjustment may not be stabilized when there are a small number of gradation patterns like in the conventional technology.
    </p>
    <heading>DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
    <p num="24">Next detailed description is made for presently preferable embodiments of the present invention with reference to FIG. 1 through FIG. 30.</p>
    <p num="25">
      FIG. 1 is a block diagram showing a copying machine according to an embodiment of the present invention, and general description is made for a basic system of the copying machine 101 with reference to this figure.
      <br/>
      Provided around an organic light-sensing (OPC) drum 102 with a diameter of  PHI 120 mm as an image carrier located at a substantially central section of the basic system of copying machine 101 are an electrifying charger 103 for electrifying a surface of the light-sensing drum 102; a laser optic system 104 for irradiating a semiconductor laser beam on a surface of the light-sensing drum 102 homogeneously electrified; a black-developing unit 105 and other three color developing units 106, 107, 108 for yellow Y, magenta M, and cyan C for obtaining a toner image for each color by supplying toner for each color to an electro-static latent image; an intermediate transfer belt 109 for successively transferring a toner image for each color formed on the light-sensing drum 102; a bias roller 110 for loading an transfer voltage onto the intermediate transfer belt 109; a cleaning device 111 for removing toner remaining on a surface of the light-sensing drum 102 after transfer of the latent image; a charge removing section 112 for removing a charge remaining on a surface of the light-sensing drum 102 after the transfer, and other related sections.
    </p>
    <p num="26">Also provided on the intermediate transfer belt 109 are a transfer bias roller 113 for loading a voltage for transferring the transferred toner image onto the transfer member and a belt cleaning device 114 for cleaning a toner image remaining there after transfer of the toner image onto the transfer member.</p>
    <p num="27">Arranged at an exit-side edge section of a carrier belt 115 for carrying a transfer member exfoliated from this intermediate transfer belt 109 is a fixing device 116 for loading heat and pressure to a toner image to fix it, and a paper discharge tray 117 is attached to an exit portion of this fixing device 116.</p>
    <p num="28">
      Provided on the laser optical system 104 are a contact glass 118 as a document base placed on the basic system of copying machine 101, an exposure lamp 119 for irradiating a scanning beam onto a document placed on this contact glass 118, and a reflected light from the document is guided by a reflection mirror 121 into an image-forming lens 122 and introduced into an image sensor array 123 of a CCD (Charged Coupled Device) which is an opto-electric conversion element.
      <br/>
      An image signal converted into an electric signal by the image sensor array 123 of the CCD controls laser oscillation of a semiconductor laser in the laser optical system 104 via an image processor not shown in the figure.
    </p>
    <p num="29">
      Then description is made for a control system incorporated in the copying machine described above.
      <br/>
      As shown in FIG. 2, the control system has a main control section (CPU) 130, and a specified type of ROM 131 and RAM 132 are provided for this main control section 130, and a laser optical system control section 134, a power supply circuit 135, an optical sensor 136, a toner density sensor 137, an environment sensor 138, a light-sensing body potential sensor 139, a toner supply circuit 140, and an intermediate transfer belt driving section 141 are connected via an interface I/O 133 to this main control section 130.
    </p>
    <p num="30">
      A laser optical system control section 134 adjusts laser output from the laser optical system 104.
      <br/>
      The power supply circuit 135 gives a specified voltage to the electrifying charger 113, gives development bias with a specified voltage to the developing units 105, 106, 107, 108, and also gives a specified voltage to the bias roller 110 as well as to the transfer bias roller 113.
    </p>
    <p num="31">The optical sensor 136 comprises a light-emitting element such as a light-emitting diode provided at a position close to an area onto which a toner image has been transferred from the light-sensing drum 102 and a light-receiving element such as a photo sensor, and a toner deposition rate on a toner image corresponding to a detected latent pattern image formed on the light-sensing drum 102 and that on the background section are detected for each color, and the so-called residual potential after electric charge is removed from the light-sensing body is detected.</p>
    <p num="32">
      A detected output signal from this optical sensor 136 is loaded to an optical sensor control section not shown in the figure.
      <br/>
      The optical sensor control section computes a ratio of a toner deposition rate of the detected pattern toner image vs that on the background section, detects fluctuation in image density by comparing the ratio value to a reference value, and corrects a control value for a toner density sensor 137.
    </p>
    <p num="33">
      The toner density sensor 137 detects toner density according to change of magnetic permeability of a developer existing in each of the developing units 105 to 108.
      <br/>
      The toner density sensor 137 has a function for comparing the detected toner density value to the reference value and loading, when the toner density is lower than a specified value and the toner is short, a toner supply signal having amplitude corresponding to the shortage to the toner supply circuit 140.
      <br/>
      The potential sensor 139 detects a surface potential of the light-sensing body drum 102 as an image carrier, and the intermediate transfer belt driving section 141 controls for driving the intermediate transfer belt.
    </p>
    <p num="34">
      A developer containing black toner and a carrier is accommodated in the black developing unit 105, the developer is agitated by rotation of a developer agitating member 202, and a volume of the developer pumped up to a sleeve by a developer regulating member is adjusted on the development sleeve 201B.
      <br/>
      The supplied developer is magnetically carried on the development sleeve 201B and is rotated as a magnetic brush in the rotating direction of the development sleeve 201B.
    </p>
    <p num="35">Next description is made for the image processing section with reference to the block diagram in FIG. 3.</p>
    <p num="36">In FIG. 1, designated at the reference numeral 420 is a scanner, at 401 a shading calibration circuit, at 402 a scanner  GAMMA  conversion circuit, at 403 an area processing circuit, at 404 an image separating circuit, at 405 an MTF filter, at 406 a color conversion UCR processing circuit, at 407 a size-changing circuit, at 408 an image create circuit, at a printer  GAMMA  calibration circuit for image processing; at 410 a gradation processing circuit, at 411 and 423 each an interface I/F selector, at 412 a printer  GAMMA  (described as procon  GAMMA ) conversion circuit for image formation, at 413 a printer, and at 421 and 422 each a pattern generating circuit.</p>
    <p num="37">
      A document to be copied is subjected to color separation to R, G, and B by a color scanner 420, and is read as a 10-bit signal.
      <br/>
      The read image signal is subjected to calibration of non-uniformity in the main scanning direction by the shading calibration circuit 401 and is outputted as a 10-bit signal.
    </p>
    <p num="38">
      In the scanner  GAMMA  conversion circuit 402, a read signal from the scanner is converted from reflection factor data to brightness data.
      <br/>
      In the image separating circuit 404, determination for discriminating a character section from a picture section and also determination for discriminating chromatic colors from achromatic colors are executed.
      <br/>
      In the MTF filter 405, processing for changing frequency characteristics of an image signal such as emphasis of an edge or smoothing to obtain a sharp image or a soft image according to a user's desire is executed.
    </p>
    <p num="39">
      In the area processing 403, an area signal is generated to indicate to which area of a document the image data currently being processed belongs.
      <br/>
      Parameters used in an image processing section in the downstream section is switched according to the area signal generated in this circuit.
      <br/>
      Image processing parameters such as a color calibration coefficient, a space filter, and a gradation conversion table most suited to each of various types of document such as characters, glossy photo (photo-sensitive paper), a printed document, a document printed with an ink-jet printer, a document written with a fluorescent pen, a map, or a thermally transferred document can be set for each specified area.
    </p>
    <p num="40">
      The interface (I/F) 423 is used when outputting an image read with the scanner 420 to the outside.
      <br/>
      When used as a printer section (an image forming section) and a scanner/IPU section (image reading/image processing section) like in a copying machine, it is possible to take out the read image from the I/F selector 411 of the printer section to an external device.
    </p>
    <p num="41">
      The color conversion UCR processing circuit 409 comprises a color calibration processing section for calibrating the difference between color separation characteristics of a color material in the input system and spectral characteristic of that in the output system and computing a volume of color materials YMC required for reproduction of faithful colors and a UCR processing section for replacing a section where three colors of Y, M, and C are superimposed with a BK (black) section.
      <br/>
      The color calibration processing can be realized by executing the matrix computing as shown in FIG. 30.
    </p>
    <p num="42">
      Herein *R, *G, and *B indicate complements for R, G, and B respectively.
      <br/>
      The matrix coefficient aij is decided according to the spectral characteristic of color materials in the input system as well as those in the output system.
      <br/>
      Herein the primary masking equation is described as an example thereof, but it is possible to execute color calibration with higher precision by way of using a quadratic term such as *B2 or * (BG), or a higher-dimensional term.
    </p>
    <p num="43">
      Also the equation for computing may be changed according to a color phase, or the Neugebauwer equation may be employed.
      <br/>
      In any way, required volumes of color materials Y, M, and C can be obtained from values of *B, *G, and *R (or may be obtained from the values of B, G, and R).
      <br/>
      In the color phase determining circuit 422, determination is made as to which of R, G, B, C, M, and Y the RGG signal is for, and a color conversion coefficient corresponding to the determined color phase is selected.
    </p>
    <p num="44">
      On the other hand, the UCR processing can be executed by computing through the following equations:
      <br/>
      Y'=Y- ALPHA  * min (Y, M, C)
      <br/>
      M'=M- ALPHA  * min (Y, M, C)
      <br/>
      C'=C- ALPHA  * min (Y, M, C)
      <br/>
      Bk= ALPHA  * min (Y, M, C)  (1)
    </p>
    <p num="45">
      In these equations,  ALPHA  is a coefficient for deciding a rate of UCR, and when  ALPHA =1, 100% UCR processing is executed.
      <br/>
      The numeral  ALPHA  may be a constant value.
      <br/>
      For instance, an image in a hi-lighted section can be made smooth by setting  ALPHA  in a high density section to a value close to 1 and that in the hi-lighted section to a value close to 0.
    </p>
    <p num="46">In the size-change processing circuit 407, size change in the horizontal direction as well as in the vertical direction is made, and the image create circuit 408 executes such operations as repeat processing.</p>
    <p num="47">
      In the printer  GAMMA  calibration circuit 409 for image processing, calibration of an image signal is executed according to an image quality mode such as a character, or a picture.
      <br/>
      Also such processing as deletion of the background can be executed simultaneously.
      <br/>
      The printer  GAMMA  calibration circuit 409 for image processing has a plurality (for instance, 10) of gradation conversion tables switchable according to an area signal generated by the area processing circuit 403 described above.
      <br/>
      Any optimal gradation conversion table suited to each type of document can be selected from among the plurality of gradation tables according to a plurality of image processing parameters such as a character, glossy photo (sensitized paper), a printed document, a document printed with an ink-jet printer, a document written with a fluorescent pen, a map, or a thermally transferred document.
    </p>
    <p num="48">
      In the gradation processing circuit 410, the dither processing is executed.
      <br/>
      As for output from this gradation processing circuit 410, the image data bus has a 16-bit width (2 sets of 8-bit image data) for lowering the pixel frequency to 1/2 of the original one so that the two sets of image data can be transmitted to the printer 413 simultaneously.
    </p>
    <p num="49">The interface I/F selector 411 has a switching function for outputting image data read with the scanner 401 for processing by an external image processor or the like or for outputting image data from an external host computer or an image processor to the printer 413.</p>
    <p num="50">The printer  GAMMA  (procon  GAMMA ) conversion circuit 412 for image formation converts an image signal from the interface I/F selector 411 by referring to the gradation conversion table and outputs the converted image signal to the laser modulation circuit.</p>
    <p num="51">
      The printer section comprises the interface I/F selector 411, printer  GAMMA  conversion circuit 412 for image formation, printer 413, and system controller 417, and can be used independently from a scanner or an IPU.
      <br/>
      An image signal from the host computer 418 is inputted via the printer controller 419 into the interface 411, and the inputted image signal is subjected to gradation conversion by the printer  GAMMA  conversion circuit 412 for image formation with the image formed by the printer 413, thus the printer 413 being used as a printer.
    </p>
    <p num="52">
      The image processing circuit described above is controlled by the CPU 415.
      <br/>
      The ROM 14 and RAM 416, are connected to this CPU 415 via bus.
      <br/>
      Also the CPU 415 is connected via a serial interface to the system controller 417, and commands from an operating section now shown herein or from other related sections are transmitted through the system controller 417.
      <br/>
      Various types of parameter are set in each of the image processing circuits described above according to the transmitted information concerning an image quality mode or image density as well as to the area information.
    </p>
    <p num="53">The pattern generating circuits 421, 422 generates gradation patterns used in the image processing section and in the image forming section respectively.</p>
    <p num="54">
      In FIG. 4, area information specified on the document is compared to information concerning a read position when reading the image, and an area signal is generated from the area processing circuit 403.
      <br/>
      Parameters used in the scanner y conversion circuit 403, MTF filter circuit 405, color conversion UCR circuit 406, image processing circuit 408, printer  GAMMA  calibration circuit for image create 409, and gradation processing circuit 410 are changed according to the area signal.
      <br/>
      In FIG. 4, especially the printer  GAMMA  calibration circuit 409 for image processing and gradation processing circuit 410 are shown.
    </p>
    <p num="55">
      In the printer  GAMMA  calibration circuit 409 for image processing, an area signal from the area processing circuit 403 is decoded by the decoder 1, and one image quality mode is selected from a plurality of gradation conversion tables for a character, a document printed with an ink-jet printer, or the like.
      <br/>
      The example of document shown in FIG. 4 shows a case where an area 0 of characters, area 1 of a picture, and area 2 of a document printed with an ink-jet printer exist therein.
      <br/>
      For instance, the gradation conversion table 1 for characters is selected to the area 0 of characters, gradation conversion table 3 for a picture to area 1 of a picture, and gradation conversion table 2 for a document printed with an ink-jet printer to area 2 of a document printed with an ink-jet printer respectively.
    </p>
    <p num="56">
      The image signal subjected to gradation conversion in the printer  GAMMA  calibration circuit 409 for image processing is again decoded by the decoder 2 and correlated to an area signal in the gradation processing circuit 410, and the selector 2 switches gradation processing to be executed.
      <br/>
      The gradation processing which can be selected in this state includes processing not using the dither, dither processing, error-diffusion processing or the like.
      <br/>
      The error-diffusion processing is executed to a document printed with a ink-jet printer.
    </p>
    <p num="57">
      The image signal having been subjected to gradation processing is again decoded by the decoder 3, and selects the line 1 or line 2 according to the read positional information.
      <br/>
      Line 1 and line 2 are switched for each one pixel in the auxiliary scanning direction.
      <br/>
      Data for line 1 is temporally stored in a FIFO (First-In First-Out) memory located in the downstream side from the selector 3, and data for line 1 and those for line 2 are outputted.
      <br/>
      With this feature, it is possible to reduce the pixel frequency to 1/2 of the original value for inputting into the interface I/F selector 411.
    </p>
    <p num="58">FIG. 5 is a block diagram showing a laser modulation circuit.</p>
    <p num="59">
      The write frequency is 18.6 �MHz�, and a scanning time for one pixel is 53.8 �nsec�. The 8-bit image data can be subjected to  GAMMA  conversion by way of referring to the lookup table (LUT) 451. Conversion to an 8-valued pulse width is executed according to upper 3 bits of an 8-bit image signal in a pulse width modulation circuit (PWM) 452, while power modulation to a 32-valued pulse width is executed according to lower 5 bits of the 8-bit image signal above in the power modulation circuit (PM) 453, and a laser diode (LD) 454 emits light according to the modulated signal.
      <br/>
      Brightness of the emitted light is monitored by a photo-detector (PD) 455, and calibration is executed for each one dot.
    </p>
    <p num="60">
      The maximum value of amplitude of laser beam can be changed by 8 bits (in 256 steps).
      <br/>
      A beam diameter in the main scanning direction (defined as a width when amplitude of the laser beam in the static mode is attenuated to 1/e2 against the maximum value) is less than 90% of size of one pixel, and preferably 80%.
      <br/>
      The beam diameter is 50  MU m in the main scanning direction and 60  MU m in the auxiliary scanning direction under the conditions of 600 DPI, 42.3  MU m (one pixel)
    </p>
    <p num="61">Next description is made for preparation of the gradation conversion table (LUT) 451 executed in the printer A calibration circuit 409 for image processing with reference to the flow chart in FIG. 6.</p>
    <p num="62">
      When preparing a gradation conversion curve, at first a general curvature is selected (step 10), and then a curvature h in the low image density (hi-lighted) section is selected (step 11).
      <br/>
      Then a curvature S in the high image density (shadowed) section is selected (step 12), and the curvatures is multiplied by a coefficient IDMAX to obtain a desired image density value (step 13).
    </p>
    <p num="63">Next description is made for processing in this step 10 with reference to FIG. 7.</p>
    <p num="64">Herein it is assumed that the reference gradation curve is A, gradation conversion for changing the general curvature is B, gradation conversion for changing a curvature in the hi-lighted area (in a low density area) is CH, and gradation conversion for changing a curvature in a shadowed area (a high density area) is CS.</p>
    <p num="65">A gradation curve obtained by subjecting the gradation curve A to gradation conversion B is herein assumed as E, and E is expressed as B (A) (E=B(A)).</p>
    <p num="66">More specifically, the above computing scheme can be expressed with the program language C as follows.</p>
    <p num="67">
      --
      <br/>
      -- &lt;List 1&gt;
      <br/>
      -- typedef int Table �256�;
      <br/>
      -- table       A, E;
      <br/>
      -- int     B (int A, int curvature)
      <br/>
      -- +
      <br/>
      --         int value;
      <br/>
      --         /*computing for changing a curvature according to
      <br/>
      --         size thereof*/
      <br/>
      --         . . .
      <br/>
      --         return value;
      <br/>
      -- }
      <br/>
      -- /*full (): processing for changing the general curvature,*/
      <br/>
      -- Table       full (int curvature)
      <br/>
      -- +
      <br/>
      --         /*curvature indicating a degree of curve */
      <br/>
      --         int     i;
      <br/>
      --         for (i = 0; i &lt; = 255; i + +)
      <br/>
      --             E �i� = B (A �i�, curvature);
      <br/>
      --         return E;
      <br/>
      -- }
    </p>
    <p num="68">Herein, B indicates a function for changing a curvature of A. For instance, it is possible to use a quadratic Bedge function satisfying the conditions of 0=B (0, n) and 255=B (255, n) (n: arbitrary integral number) for an 8-bit image signal.</p>
    <p num="69">The Bedge function satisfying the above conditions is expressed as a quadratic Bedge curve from a line L crossing a straight line P0P connecting a start point P0 (0, 0) to an end point 1 (255, 255) as well as a straight line P0P1 and a control point P2 existing on the line L as a function of a distance d from a cross point between the straight line P0P1 and straight line L as a parameter.</p>
    <p num="70">With the function above, a curvature can be changed by changing the distance d in proportion to an integral curvature as an argument for the function B. Next description is made for a case of a straight line L1 crossing the straight line P0P1 as well as for a case of a straight line L2 parallel to the vertical axis in the figure.</p>
    <p num="71">
      Using a distance d from the control point in the first example to a middle point PC=(P0+P1)/2=(127.5, 127.5) or (127, 127) or (128, 128) of a string formed by both edge points thereof, P0, and P1 as a parameter, the control point P2 is given by the following equation:
      <br/>
      P2(d)=PC+(-d/ 2, d/ 2)=(127.5--d/ 2, 127.5+d/ 2)  (2)
    </p>
    <p num="72">
      So the gradation conversion curve P (d, t) is given by the following equation:
      <br/>
      P(d, t)=P0 * t2 +2 * P2(d) * t * (1-t)+P1 * (1-t)2  (3)
    </p>
    <p num="73">
      Herein t is a parameter in a range from 0 to 1 (0 &lt;= t &lt;= 1).
      <br/>
      As P (d, t) is given as a combination of input x to the gradation conversion curve and output y therefrom (x, y), assuming that x is equal to A (x=A) as the integral number A given as an argument for the function B ( ), t is computed from the equation (1), and the output value y is obtained by substituting the obtained t again into the equation (3).
    </p>
    <p num="74">
      Actually, in place of executing each time the computing as described above, at first computing is made for all combinations of (x, y) (0 &lt;= x &lt;= 255), the obtained values are arranged as a table and stored in a ROM, thus time for computing being saved.
      <br/>
      Several (or several tens of) sets of this gradation calibration table each having a different curvature respectively are stored in a ROM.
      <br/>
      The curvature is given as an argument for the function B ( ) described above.
    </p>
    <p num="75">With this operation, &lt;list 1&gt;is rewritten as follows.</p>
    <p num="76">
      --
      <br/>
      -- &lt;List 2&gt;
      <br/>
      -- const              table_max = 9;
      <br/>
      -- typedef int    Table �256�;
      <br/>
      -- Table              A, E, B �table_max�;
      <br/>
      -- /*full (): Processing for changing the general curvature, */
      <br/>
      --      Table   full (int curvature)
      <br/>
      -- +
      <br/>
      --             /*curvature specifies a degree of curve. */
      <br/>
      --             int    i:
      <br/>
      --             for (i = 0; i &lt; = 255; 1 + +)
      <br/>
      --             E �i� = B �curvature� �A �i��;
      <br/>
      --         return E ;
      <br/>
      -- }
      <br/>
      -- main ()
      <br/>
      -- +
      <br/>
      --         /* curvature indicates a degree of curve */
      <br/>
      --         int    curvature = 1;
      <br/>
      --         E = full (curvature);
      <br/>
      -- }
    </p>
    <p num="77">In the example described above, table _max is equal to 9 (table_max=9), so that the number of tables each having a different curvature is 9.</p>
    <p num="78">It should be noted that, although the Bedge curve is used in the above example, a higher-dimensional function, an exponent, or logarithm may be used according to the necessity.</p>
    <p num="79">Next description is made for processing in step 11 and step 12.</p>
    <p num="80">Like in the case described above, it is possible to differentiate a curvature in a low image density (hi-lighted) area from that in a high image density (shadowed) area.</p>
    <p num="81">&lt;List 2&gt;can be rewritten to the following more general form:</p>
    <p num="82">
      --
      <br/>
      -- &lt;List 3&gt;
      <br/>
      -- const       table_max = 9;
      <br/>
      -- typedefint  Table �256�;
      <br/>
      -- Table A, E, B �table_max�,
      <br/>
      -- /*Transform (): Processing for changing a curvature, */
      <br/>
      -- Table Transform (Table Transformer, Table Original)
      <br/>
      -- +
      <br/>
      -- /*   This function executes processing for changing *
      <br/>
      -- *    a curvature of a gradation conversion curve called *
      <br/>
      -- *    original using a gradation conversion curve *
      <br/>
      -- *    called Transformer
      <br/>
      --      int  i;
      <br/>
      --      for (i = o; i &lt; = 255; 1 + +)
      <br/>
      --      E �i� + Transformer �Original �i��;
      <br/>
      --      return E;
      <br/>
      -- }
      <br/>
      -- main ()
      <br/>
      -- +
      <br/>
      --         /* curvature indicates a degree of a curve */
      <br/>
      --         int     curvature = 1;
      <br/>
      --         E = Transform (B �Curvature�, A);
      <br/>
      -- /*      Curvature of the gradation conversion curve A is *
      <br/>
      -- *       changed using the gradation conversion *
      <br/>
      -- *       curve B �curvature� */
      <br/>
      -- }
    </p>
    <p num="83">&lt;List 2&gt;can be rewritten as follows by executing conversion of the hi-light conversion curve CH �h� to the shadow conversion curve CS �s�.</p>
    <p num="84">
      --
      <br/>
      -- &lt;List 4&gt;
      <br/>
      -- const       table_max = 9;
      <br/>
      -- typedef     int  Table �256�;
      <br/>
      -- Table       A, B �table_max�, E, CH �table_max�, CS �
      <br/>
      -- table_max�;
      <br/>
      -- /*Transform (): Processing for changing a curvature */
      <br/>
      -- Table Transform (table Transformer, Table Original);
      <br/>
      -- main ()
      <br/>
      -- +
      <br/>
      --         int   curvature, h, s;
      <br/>
      -- /*      Curvature of a curve is changed by way of
      <br/>
      --         changing numerical values of curvature, h, s */
      <br/>
      --         /* The general curvature is changed */
      <br/>
      --         E = transform (B �curvature�, A);
      <br/>
      --         /*Curvature in a low image density (hi-light) section
      <br/>
      --         is changed */
      <br/>
      --         E = Transform (CH �h�, E);
      <br/>
      --         /*Curvature in a high image density (shadowed) section
      <br/>
      --         is changed */
      <br/>
      --         E = Transform (CS �s�, E);
      <br/>
      -- }
    </p>
    <p num="85">
      Herein, curvature, h, and s are values for deciding a general curvature and those in the hi-lighted section and in the shadowed section.
      <br/>
      It should be noted that curve in the hi-lighted section is decided independently from that in the shadowed section.
    </p>
    <p num="86">A gradation conversion curve for changing a curvature in a particular density area such as the hi-lighted area or shadowed area is prepared as described below.</p>
    <p num="87">The gradation conversion curve is generated by using a tertiary Bedge curve from the straight line P0P1 connecting the start point P0 to the end point P1, straight line L crossing the straight line P0P1, and the control point P2 existing on the straight line L as a function including the distance d from a crossing point between the straight line P0P1 and straight line L as a parameter.</p>
    <p num="88">Herein description is made for the line L1 crossing the straight line P0P1 at right angles as well as for the straight line L2 parallel to the vertical axis in the figure.</p>
    <p num="89">
      A conversion curve for changing gradation characteristics in a hi-lighted area is prepared, for instance, as shown in FIG. 9.
      <br/>
      Herein it is assumed that coordinate values of the start point P0 and end point P1 are (0, 0) and (255, 255) respectively, and also that those of the first control point P2 are (32, 32).
    </p>
    <p num="90">Also it is assumed herein that a control point P3 in the first example is defined by the expression of P3 (d)=(16, 16)+(-d/ 2, d 2), d being a distance from a cross point between the straight line P0P1 and the straight line L1 as a parameter.</p>
    <p num="91">
      Further it is assumed herein that the control point P3 in the second example is expressed by the expression of P3 (d)=(16, 16)+(0, d), d being a distance from a cross point between the straight line P0P1 and straight line L2.
      <br/>
      Using the control points P0 to P3 above, the gradation conversion curve P (d, t) is given by the following equation:
      <br/>
      P(d, t)=P0 * t3 +3 * P2t2 +(1-t)+3 * P3(d) * (1-t)2 +P1 * (1-t)3  (4)
    </p>
    <p num="92">
      Although it is assumed in the description above that the end point P1 is (255, 255), herein it is assumed that the end point P1 is a point on a string m: (0, 0)-(255, 255), thus the point P1 being, for instance, (64, 64).
      <br/>
      In this case, a portion not included in the string P0P1 on the string m is treated as identical in gradation conversion, and other portions effect as a gradation conversion curve for changing a curvature in a particular density area such as a hi-lighted area or a shadowed area.
    </p>
    <p num="93">Next, description is made for a method of preparing a gradation conversion table set in the printer y conversion circuit 412 for image formation.</p>
    <p num="94">
      At first, description is made for a method of detecting the development characteristics with reference to the flow chart in FIG. 10. As shown in FIG. 11, np pieces (herein np=12) of density gradation patterns are formed on the light-sensing drum 102 (step 20).
      <br/>
      Then a surface potential VS1 (i=1, 2, . . . , np) of the light-sensing drums are read with a surface potential sensor 139 (step 21), and toner is deposited thereon by a developing unit for development and visualization (step 22).
      <br/>
      Then detection output VPi (i=1, 2, . . . , np) for a toner image on the light-sensing drum 102 is obtained by an optical sensor 136 existing in the downstream side in the rotating direction of the light-sensing drum 102 (step 23).
    </p>
    <p num="95">For laser output used in detection, for instance, the following values of image signals (each in the hexadecimal form) are used: 00 (H), 10 (H), 20 (H), 30 (H), 40 (H), 50 (H), 60 (H), 70 (H), 90 (H), B0 (H), D0 (H), FF (H)</p>
    <p num="96">
      A sum of image signals for every two pixels in the main scanning direction is allocated to each of the two pixels according to the value as described below.
      <br/>
      Namely, assuming that an image signal for the first pixel is N1 and that for the second pixel is N2, and also that an image signal for the first pixel after processing is N1* and that for the second pixel is N2*,
      <br/>
      N1*=N1+N2, N2*=0, when N1+N2&lt;=FF (H), and
      <br/>
      N1*=FF (H), N2*=N1+N2-FF (H), when N1+N2&gt;FF (H)
    </p>
    <p num="97">Next description is made for a method of correcting an image signal with reference to FIG. 12.</p>
    <p num="98">
      The vertical axis in the graph a) indicates laser output (or an image output signal), while the horizontal axis indicates output from the optical sensor 136.
      <br/>
      This graph is obtained by forming np pieces of latent images for density gradation patterns on the light-sensing drum 102, developing the latent images, and detecting a volume of reflected light from the toner image.
    </p>
    <p num="99">
      The vertical axis in the graph b) indicates laser output like in the graph a), while the horizontal axis indicates a surface potential of the light-sensing drum.
      <br/>
      This indicates the light attenuation characteristics of the light-sensing drum 102.
      <br/>
      Like in graph a), the surface potential is obtained by measuring with the potential sensor a surface potential when np pieces of latent image for density gradation pattern are formed on the light-sensing drum 102.
    </p>
    <p num="100">
      The graph c) shows a gradation conversion table used in an image forming section, and the horizontal axis in the figure indicates an image input signal (a rate proportional, for instance, to density of a document image), while the vertical axis indicates an image signal (image output signal) after laser output or an image input signal is converted by referring to a gradation conversion table.
      <br/>
      Herein the image input signal has a resolution of 8 bits (256 values), and also there is provided an 8 (to 10)-bit resolution between a minimum value and a maximum value of laser output.
    </p>
    <p num="101">
      In the figure, a indicates a relation between laser output used for detection and an image input signal.
      <br/>
      The vertical axis in the graph d) indicates a toner deposition rate on the light-sensing drum 102, while the horizontal axis indicates output from the optical sensor 136, which indicates output characteristics of the optical sensor 136.
      <br/>
      This characteristics varies according to a type or a attachment angle of a sensor used or a distance from the light-sensing drum 102, but these parameters are previously known and substantially constant.
    </p>
    <p num="102">
      The vertical axis in the graph e) indicates a toner deposition rate, while the horizontal axis indicates a surface potential of the light-sensing drum 102.
      <br/>
      This graph shows a relation between a surface potential on the light-sensing drum 102 and a toner deposition rate 102 thereon (namely the development characteristics).
    </p>
    <p num="103">In the figure, h indicates a DC component of the development bias.</p>
    <p num="104">The graph f) shows a relation between an image input signal and a toner deposition rate on the light-sensing drum 102.</p>
    <p num="105">Output VPi from the optical sensor 136 is converted to a toner deposition rate (M/A) i �mg/cm2 � (i=1, 2, . . . , np) on the light-sensing drum 102 using the relation shown by the graph d).</p>
    <p num="106">This conversion is executed, for instance, in the following way.</p>
    <p num="107">
      A reflected light from a toner image 304 formed on the light-sensing drum 102 is detected by an optical sensor 136, and is sent as a detection signal to the main control section 130.
      <br/>
      Assuming herein that VSP and VSG are output from the optical sensor 136 for a reflected light from the toner-deposited section in the reference pattern section and output from the optical sensor 136 for a reflected light from the background section therein respectively, a deposition rate of toner deposition on the reference pattern per unit are ml �g/cm2 � is expressed by the following equation:
      <br/>
      m1=-1n(VSP /VSG)/ BETA
      <br/>
      BETA =6.0 * 103 �cm2 /g�  (5)
    </p>
    <p num="108">
      Herein  BETA  is a constant decided by the optical sensor 136 and toner, and the value shown above is a value for black toner.
      <br/>
      The conversion can be made similarly also for yellow, cyan, and magenta.
      <br/>
      Description was made above assuming a case where computing is executed, but conversion may be made by referring to a look-up table previously prepared.
    </p>
    <p num="109">With the method described above, a relation between a surface potential VSi of the light-sensing drum 102 and a toner deposition rate on the light-sensing drum 102 (M/A)i is fixed, and the development characteristics i on the graph e) is obtained.</p>
    <p num="110">
      However, as shown by the graph d), output from the optical sensor 136 shows a constant value VPMIN when the toner deposition rate is higher than a certain toner deposition rate (M/A) C ((M/A) &gt;= (M/A)C).
      <br/>
      On the other hand, for an image signal higher than the image input signal n at c) in FIG. 12, in spite that actually a surface potential of the light-sensing drum 102 goes down and a toner deposition rate changes as shown in b), a toner deposition rate (M/A) on the light-sensing drum 102 is always kept constant at (M/A)C. For this reason, even if the actual development characteristics is C in the graph e), the development characteristics obtained from a result of detection is as indicated by i, so that displacement occurs between the actual value C and the detected value i.
    </p>
    <p num="111">Next description is made for calibration of displacement between actual development characteristics and that obtained from a detected value with reference to the flow chart in FIG. 13.</p>
    <p num="112">
      At first, when a detected value VPI for am image signal i by the optical sensor 136 is higher than a specified value VPc, the detected value is converted to a toner deposition rate on the light-sensing drum 102 or a value (M/A) i substantially proportional to the toner deposition rate above (step 30).
      <br/>
      A relational value between an output value VSi from the surface potential sensor 139 and (M/A) i is obtained from these values.
      <br/>
      Herein the following relational equation is employed:
      <br/>
      (M/A) i=a * VSi+b(VPi &gt;= VPc)  (6)
    </p>
    <p num="113">
      when a primary equation is used, or
      <br/>
      (M/A) i=a * (VSi-VDC)+b(VPi &gt;= VPc)  (7)
    </p>
    <p num="114">
      assuming a DC component of development bias as VDC.
      <br/>
      Herein a and b are coefficients and are decided from values of VSi and (M/A) i using the minimum self-squaring method.
      <br/>
      Herein, assuming that a toner deposition rate on the light-sensing drum 102 when an output value from the optical sensor 136 is VPc is (M/A) C, the same effect can be obtained in a range of deposition rate satisfying the condition of (M/A) i &lt;= (M/A) C.
    </p>
    <p num="115">
      In an area where a toner deposition rate on the light-sensing drum 102 is lower than a certain value (M/A)MIN, sometimes deviation from a linear relation between a toner deposition rate and a surface potential on the light-sensing drum 102 may become large.
      <br/>
      To prevent this phenomenon, the coefficients a and b in the equation (6) described above are decided according to a result of detection (step 31, step 32) for a toner deposition rate on the light-sensing drum 102 so that the condition of (M/A)MIN &lt;= (M/A) &lt;= (M/A) C is satisfied (step 33).
    </p>
    <p num="116">
      Although a toner deposition rate is used, the coefficients a and b in the equation (7) described above may be decided according to a toner-deposited area satisfying the condition of:
      <br/>
      VPc &lt;= VP &lt;= VPMIN  (8)
    </p>
    <p num="117">assuming that VPMIN is detection output from the optical sensor 136 corresponding to (M/A)MIN.</p>
    <p num="118">
      Then determination is made as to whether (M/A) i is larger than (M/A) C or not (step 34).
      <br/>
      When it is determined that (M/A) i is larger than (M/A) C (step 35: Y), a toner deposition rate (M/A) i on the light-sensing drum 102 is obtained from the potential output VSi (step 35).
    </p>
    <p num="119">
      Although determination as to whether a value as detection output from the optical sensor 136 is to be used or not was made in the example above by checking whether the value as detection output from the optical sensor 136 is larger than a specified value VPc or not, this VPc can be obtained among (M/A) C as a toner deposition rate on the light-sensing drum 102 when an absolute value .vertline.
      <br/>
      DELTA VP/ DELTA (M/A).vertline. of a ratio of a change rate  DELTA VP of an output value VP from the optical detector vs a change rate  DELTA (M/A) in a toner deposition rate (M/A) on the light-sensing drum 102 is equal to a specified value .vertline.
      <br/>
      DELTA VP/ DELTA (M/A).vertline.0 and VPc as output value from the optical sensor 136 at that time, and can be used in the above method.
    </p>
    <p num="120">
      In this case, an area of the toner deposition rate or the light-sensing drum 102 satisfying the expression of .vertline.
      <br/>
      DELTA VP/ DELTA (M/A).vertline. &gt;= .vertline.VP/ .vertline.(M/A).vertline.0 corresponds to the relation of (M/A) &lt;= (M/A) C, and the expression of .vertline.
      <br/>
      DELTA VP/ DELTA (M/A).vertline.&gt;.vertline.
      <br/>
      DELTA VP/ DELTA (M/ A).vertline.0 corresponds to the relation of (M/A) i &lt;= (M/A)C (Refer to FIG. 4).
    </p>
    <p num="121">The detection result as shown in the graph f) can be obtained from the development characteristics i and an image signal as described above.</p>
    <p num="122">
      The detection characteristics c in the fourth quadrant is obtained from a gradation conversion table a in the first quadrant.
      <br/>
      Using this result, it is possible to obtain the gradation conversion table b) after calibration for obtaining the ideal characteristics d. The gradation conversion table as described above is used as a gradation conversion table for image formation.
    </p>
    <p num="123">The processing sequence described above is shown in the flow chart in FIG. 15.</p>
    <p num="124">
      At first, a reference pattern is prepared on the light-sensing drum 102 (step 40), and the reference pattern formed thereon is detected by the optical sensor 136 as well as by the surface potential sensor 139 (step 41).
      <br/>
      Then from a result of detection as well as from the laser output value (image signal) used when the pattern is formed, the development characteristics is estimated (step 42), and a gradation conversion table for image formation is prepared from the estimated development characteristics (step 43).
    </p>
    <p num="125">
      When the gradation patterns for automatic gradation calibration is outputted, a write value for the gradation patterns n �j� (for instance, j=0, 1, 2, . . . , 16) is converted and used according to the gradation conversion table B �i� (i=0, 1, 2, . . . , 255) (in a case of 8-bit processing) formed in the processing above.
      <br/>
      The processing assuming that a write value for a gradation pattern after conversion is n1 �j� (for instance, j=0, 1, 2, . . . , 16) can be written with the programming language C as follows.
    </p>
    <p num="126">/*Convert a write value for a gradation pattern according to a gradation conversion table for image formation */</p>
    <p num="127">/*Start of processing */</p>
    <p num="128">int j;</p>
    <p num="129">for (j=0; j&lt;16; j++)</p>
    <p num="130">- n1�j�=B �n�j��;</p>
    <p num="131">/*End of processing */</p>
    <p num="132">This means that n �i� is converted and n1 �i� is obtained according to the gradation conversion table B �i� which is a look-up table.</p>
    <p num="133">Next description is made for a method of calibrating the development characteristics when it changes in a specified period of time after it is initially set.</p>
    <p num="134">Herein it is assumed that a indicates a relation between an image input signal initially set and laser output; b indicates data detected by the optical sensor 136 for the laser output then; c indicates a relation between a toner deposition rate on the light-sensing drum 102 and a surface potential on the light-sensing drum obtained as described above; and d indicates a relation between a toner deposition rate on the light-sensing drum 102 and an image input signal.</p>
    <p num="135">If detection output from the optical sensor 136 in a specified period of time is b', it indicates that the development characteristics has changed from c to c', and that, as a result of the change described above, a ratio of a toner deposition rate on the light-sensing drum 102 vs the image input signal has changed to d'. For this reason, gradation in the initial state is different from that after passage of a specified period of time.</p>
    <p num="136">
      The fact that the gradation in the initial state and that after passage of a specified period of time is not identical to each other is not desirable from a viewpoint of image reproduction.
      <br/>
      So the following calibration is executed.
      <br/>
      Herein it is assumed that a relation in the initial state between an image input signal n in the first quadrant and laser output P is a linear one as indicated by the graph a).
      <br/>
      Namely, assuming a laser light volume for an image signal FFH is PMAX, the expression of P=PMAX/FF(H) x n is obtained.
    </p>
    <p num="137">Next description is made for processing for calibrating the gradation having changed after passage of a specified period of time from that in the initial state so that the gradation has not apparently changed with reference to the flow chart in FIG. 16.</p>
    <p num="138">
      At first, the development characteristics is detected according to the method described above (step 50), and a toner deposition rate (M/A) i (t) on the light-sensing drum 102 obtained from a result of detection by the optical sensor 136 as well as by the surface potential sensor 139 is stored in a memory (step 51).
      <br/>
      Herein t indicates current time t.
    </p>
    <p num="139">
      The development characteristics is corrected (step S52).
      <br/>
      When a relation between an image input signal and laser output is as indicated by a, laser output for the image input signal i is Pi, which indicates that a toner deposition rate on the light-sensing drum 102 has changed from (M/A) i (0) in the initial state to (M/A) i (t) after passage of a specified period of time.
    </p>
    <p num="140">On the other hand, laser output for the image input signal j is Pj, which indicates that a toner deposition rate on the light-sensing drum 102 has changed from (M/A) j (0) in the initial state to (M/A) j (t) after passage of a specified period of time.</p>
    <p num="141">In the case described above, especially when (M/A) i (0) is equal to (M/A) j (t), it is possible to apparently keep image density for an image input signal identical to that in the initial stage by changing a relation between an image input signal i to laser output after passage of a specified period of time from i --&gt; Pi to i --&gt; Pj.</p>
    <p num="142">
      The characteristics a' can be obtained by executing similar processing using np pieces of detection data.
      <br/>
      In this step, a value between actual measurement points can be given by executing linear interpolation or interpolation with a spline curve or the like.
    </p>
    <p num="143">The computing as described above may be executed, not to all the points, but to np pieces of data points detected or some points among the data points to select a look-up table stored in the ROM 416 using a value as a result of computing, and the value may be used as the calibration characteristics a'.</p>
    <p num="144">
      In the characteristics a' after a specified period of time obtained according to the method described above, assuming that laser output for the image input signal FFH is PMAX (t) and that for the image input signal FFH in the initial state is PMAX (0), as a method of calibration when PMAX (0) is not equal to PMAX (t), there is a method in which up to an image input signal k for PMAX (t)=Pk (0) is used keeping resolution between laser output P0 for the image signal 00H and PMAX (0), and also there is a method in which resolution for 8 to 10 bits is used for a section between laser output P0 for the image signal 00H and PMAX (t).
      <br/>
      In this embodiment, either one of the two methods may be used, and when the former one is used, as a maximum value of a laser-beam volume is not changed, controls for conditions for image formation are simple, but the number of substantial gradations is disadvantageously reduced.
    </p>
    <p num="145">Next description is made for operations for automatically calibrating image density (gradation) (ACC: Auto Color Calibration) with reference to the flow chart in FIG. 17.</p>
    <p num="146">
      On a liquid crystal screen of an operating section (Refer to FIG. 18), when the ACC menu is called, the screen shown in FIG. 19 is displayed.
      <br/>
      When �Execution� for ACC for using the function as a copying machine or the function as a printer is selected, the screen in FIG. 20 is displayed.
      <br/>
      When the function as a copying machine is selected, the gradation calibration table for use of the copying function is changed, and when the printing function is selected, a gradation calibration table for use of the printing function is changed both according to the reference data.
    </p>
    <p num="147">
      Herein, when the Print Start key in FIG. 20 is selected, as shown in FIG. 21, a plurality of density gradation patterns as shown in FIG. 21 each corresponding to each image quality mode such as each of Y, M, C and K colors, characters, and pictures are formed on a transfer material (step 60).
      <br/>
      The density gradation patterns are previously stored and set in a ROM of an IPU.
      <br/>
      A write value for each pattern is changed according to a result of detection of the development characteristics according to the method described below.
    </p>
    <p num="148">Herein description is made for a case, as an example, where 16 patterns of 00h, 11h, 22h, * *, EEh, FFh each expressed in the hexadecimal form are used.</p>
    <p num="149">
      This figure shows a patch of 5 gradations excluding those in the background section, but any arbitrary value can be selected among the 8-bit signals of 00h to FFh.
      <br/>
      In the character mode, dither processing such as pattern processing is not executed, and a pattern is formed with 256 gradations for 1 dot, and in the picture mode a write value for laser output is formed by allocating a sum of write values for two pixels adjoining to each other in the main scanning direction.
      <br/>
      Namely the pattern processing when a write value for the first pixel is n1 and that for the second pixel is n2 is, for instance, as follows:
      <br/>
      In a case of n1+n2&lt;255:
      <br/>
      a write value for the first pixel: n1+n2
      <br/>
      a write value for the second pixel: 0
      <br/>
      In a case of n1+n2&gt;255:
      <br/>
      a write value for the first pixel: 255
      <br/>
      a write value for the second pixel: n1+n2-255
      <br/>
      or
      <br/>
      In a case of n1+n2=128
      <br/>
      a write value for the first pixel: n1+n2
      <br/>
      a write value for the second pixel: 0
      <br/>
      In a case of 128&lt;n1+n2&lt;256:
      <br/>
      a write value for the first pixel: 128
      <br/>
      a write value for the second pixel n1+n2-128
      <br/>
      In a case of 256&lt;n1+n2&lt;383:
      <br/>
      a write value for the first pixel:n1+n2-128
      <br/>
      a white value for the second pixel 128
      <br/>
      In a case of 383&lt;n1+n2:
      <br/>
      a write value for the first pixel 255
      <br/>
      a write value for the second pixel: n1+n2-255
    </p>
    <p num="150">In addition to the allocation as described above, the pattern processing executed when an image is actually formed may be used.</p>
    <p num="151">After a pattern is outputted onto a transfer material, the screen in FIG. 22 prompting placement of the transfer material on the document base 118 is displayed on the operating screen.</p>
    <p num="152">
      When the transfer material with a pattern having been outputted thereunto is placed on the document base 118 (step 61) and Read Start is selected, the scanner begins running and RGB data for the YMCK density pattern is read (step 62).
      <br/>
      In this step, data for a pattern section and those for the background section of the transfer material are read.
      <br/>
      Then the read value for the pattern is calibrated by using calibration values for RGB (step 63).
      <br/>
      When processing with data for the background is specified (step 64; Y), the background data processing for the read data is executed (step 65), and when calibration of the reference data is executed (step 66; Y), processing for a high image density section for the reference data is executed (step 67), and then preparation and selection of YMCK gradation calibration tables are executed (step 68).
    </p>
    <p num="153">
      The above-described processing is executed for each color of YMCK (step 69) and also for each image quality mode of picture and characters (step 70).
      <br/>
      During this processing, the screen shown in FIG. 23 is displayed on the operating screen.
      <br/>
      The �Return to the previous screen� key is displayed in the screen shown in FIG. 19 so that any of the YMCK gradation calibration table before execution of the processing can be selected when a result of image formation according to the YMCK gradation calibration table after the processing is finished is not preferable.
    </p>
    <p num="154">Next description is made for calibration of the background.</p>
    <p num="155">
      A first object of calibration of the background is to calibrate a degree of a white color of a transfer material used in ACC.
      <br/>
      For, even if an image is formed with the same machine at the same time, a value read with a scanner varies according to a whiteness degree of a transfer material used.
      <br/>
      The demerit of not calibrating the parameter is that an appropriate image can not be obtained when, for instance, recycled paper with a low whiteness degree is used because generally recycled paper contains much yellow components, and to overcome this demerit, calibration is executed to reduce yellow components when a gradation calibration table for yellow is prepared.
      <br/>
      In this state, if copying is made using, for instance, art paper with a high whiteness degree, an image containing little yellow components is obtained, which makes it impossible to reproduce a desired color.
    </p>
    <p num="156">
      A second object of calibration of the background is to prevent a color of a pressure plate for holding down a transfer material from being read with a scanner through the transfer material when a thickness of the transfer material (paper thickness) used in ACC is small.
      <br/>
      For instance, if a machine called ADF (auto document feeder) is used in place of a pressure plate, a belt is used for carrying a document, but some rubber-based material used in this feed has a low whiteness degree, and is a little gray.
      <br/>
      For this reason, the color is read as an image signal apparently having a higher whiteness degree, so that processing for making the image thinner is made when a YMCK gradation calibration table is prepared.
      <br/>
      In this state, if thick paper with low transmittability is used, a generally thin image is reproduced, which is not preferable.
    </p>
    <p num="157">To prevent such a trouble as described above, calibration of am image signal read from a pattern section is made according to an image signal for the background section of the paper.</p>
    <p num="158">
      However, there is provided a merit also when the calibration as described above is not executed, and for instance, when transfer paper containing much yellow components such as recycled paper is used, color reproduction can be made better for colors containing yellow components when the calibration is not executed.
      <br/>
      Also when always thin transfer paper is used, a gradation calibration table suited to thin paper is prepared by not executing the calibration described above.
    </p>
    <p num="159">As described above, calibration of the background section may be or may not be executed according to the situation and to a user's choice.</p>
    <p num="160">
      Herein it is assumed that a write value for a gradation pattern formed on the light-sensing drum 102 is LD �i� (i=0, 1, . . . , 9) and a vector of a value read with a scanner for the formed pattern is v �t� �i� (r �t�, �i�, g �t� �i�, b �t� �i�) (t=Y, M, C, or K, i=1, 2, . . . , 9).
      <br/>
      Such parameters as brightness, saturation, and hue angle (L*, C*, and h*) or brightness, reddishness, and bluishness (L*, a*, b*) maybe used in place of (r, g, b).
    </p>
    <p num="161">Herein it is assumed that read values for whiteness as a reference previously stored in the ROM 416 or RAM 417 are (r �W�, g �W�, and b �W�).</p>
    <p num="162">
      When a number of a pattern having certain image density is k-th (for instance, a pattern with the highest image density is selected as the k-th pattern), read values of a pattern for each toner for Y, M, C, and K (A r �t� �k�, Ag �t� �k�, A b �t� �k�) are decided as described below from read values for RGB signals (r �t� �i�, g �t� �i�, b �t� �i�).
      <br/>
      DELTA r �t� �k� r �W�-r �t� �k�
      <br/>
      DELTA g �t� �k� g �W�-g �t� �k�
      <br/>
      DELTA b �t� �k�=b �W�-b �t� �k�  (9)
    </p>
    <p num="163">
      On the other hand, the following percentage of RGB components in a read value of a pattern for each of the YMCK toners is stored in the RAM 41:
      <br/>
      k �s� �t�=+s=R, G, or B, t=Y, M, C, or K.vertline.k �s� �t� &lt;= 1}  (10)
    </p>
    <p num="164">
      In the equation (6), k �s� �t� is a decimal value around 1, but the value is integral number data in a copying machine as follows:
      <br/>
      k �s� �t�=k1 �s� �t�/2n
    </p>
    <p num="165">(k1 �s� �t� is an integral number of k1 �s� �t�/2n) and for instance, n is equal to 10 (n=10), and 2n is equal to 1024 (2n =1024).</p>
    <p num="166">Using the values in equation (9) and equation (10), the scanner read value v �t� �i�=(r �t� �i�, g �t� �i�, and b �t� �i�) (t=Y, M, C, or K, i=0, 1, . . . , 9) is calibrated as described below.</p>
    <p num="167">
      Description is made for a case of t=C (Cyan) as an example.
      <br/>
      RGB components in a read value for cyan toner are calibrated as follows:
      <br/>
      r1 �C� �i�=r �C� �0�- DELTA r �t� �k� * k �r� �t�
      <br/>
      g1 �C� �i�=g �C� �0�- DELTA g �t� �k� * k �g� �t�
      <br/>
      b1 �C� �i�=b �C� �0�- DELTA b �t� �k� * k �b� �t�  (11)
    </p>
    <p num="168">
      and these values are used as new (r �t� �i�, g �t� �i�, b �t� �i�).
      <br/>
      The coefficients used in this step are shown in the table in FIG. 24.
    </p>
    <p num="169">Next description is made for a method of preparing a gradation conversion table (LUT) in the  GAMMA  conversion processing section 410 when ACC is executed with reference to FIG. 25.</p>
    <p num="170">
      The horizontal axis of the first quadrant in FIG. 25 indicates a write value for a gradation pattern, while the vertical axis indicates a read value for the gradation pattern outputted onto transfer paper, and this shows a relation between a write pattern for the gradation pattern and a value read with a scanner.
      <br/>
      The horizontal axis of the second quadrant indicates a toner deposition rate on the light-sensing drum 102, and this shows a relation between a toner deposition rate on the light-sensing drum 102 and a value read with a scanner.
      <br/>
      The vertical axis of the third quadrant indicates development potential, which indicates development characteristics of a printer.
    </p>
    <p num="171">
      The development potential indicates a difference between surface potential on the light-sensing drum 102 and a DC component of development bias, and the larger the difference is, the larger a quantity of toner deposition on the light-sensing drum 102 is.
      <br/>
      The fourth quadrant indicates a relation between the development potential and a write value for a gradation pattern.
    </p>
    <p num="172">
      The reference numerals n �0�, n �1� on the horizontal axis of the first quadrant indicates write values in the first and second stages of a gradation pattern.
      <br/>
      In a read value for a pattern v �t� �i�=(r �t� �i�, g �t� �i�, b �t� �i�), image signals for complement colors for YMC toners are b �t� �i�, g �t� �i�, and r �t� �i� respectively, so that only image signals for the complement colors are used.
      <br/>
      Herein to simplify the subsequent description, description is made using a �t� �i� (i=0, 1, 2, . . . , 9; t=C, M, Y, or K).
      <br/>
      Preparation of a gradation conversion table simplifies the processing.
      <br/>
      It should be noted that, although sufficient precision is achieved by using any image signal for RGB in a case of black toner, a G (green) component is used herein.
    </p>
    <p num="173">The reference data is given as a combination of a scanner read value v0 �t� �i�=(r 0 �t� �i�, g0 �t� �i�, b0 �t� �i� and a corresponding laser write value LD �i� (i=1, 2, . . . , 10).</p>
    <p num="174">Similarly to simplify the subsequent description, A �t� �n �i�� is expressed as (0 &lt;= n �i� &lt;= 255, i=1, 2, . . . , 10, t=Y, M, C, or K) using complement image signals for YMC.</p>
    <p num="175">
      The YMCK gradation conversion table is obtained by comparing the a �LD� described above and the reference data A �n� stored in the ROM 416.
      <br/>
      Herein n indicates an input value into the YMCK gradation conversion table, while the reference data A �n� is a target value for image signals obtained by reading YMC toner patterns outputted according to the laser write value LD �i� after the input value n is subjected to YMCK gradation conversion.
      <br/>
      Herein the reference data is classified to reference data A �n� requiring calibration according to image density which a printer can output and that A �n� not requiring the calibration.
      <br/>
      Determination as to whether the calibration should be executed or not is made according to data for determination previously stored in a ROM or a RAM and described later.
      <br/>
      Description is made for the calibration hereinafter.
    </p>
    <p num="176">
      By computing LD corresponding to A �n� from the a �LD� described above, a laser output value LD �n� corresponding to the input value n into the YMCK gradation conversion table is obtained.
      <br/>
      The gradation conversion table can be obtained by computing the laser output value LD �n� for each input value i of 0, 1, . . . , 255 (in a case of an 8-bit signal).
    </p>
    <p num="177">In this step, in place of executing the above-described processing for all values for the input value n (00h, 01h, . . . , FFh in hexadecimal form) to the YMCK gradation conversion table, the processing is executed to values at intervals such as ni=0, 11h, 22h, . . . FFh, and interpolation with the spline function is executed for other points, or a table for a conversion curve passing through or closest to a combination of (0, LD �0�), (11h, LD �11h�), (22h, LD �22h�), . . . , (FFh, LD �FFh�) obtained through the above-described processing is selected among the YMCK y calibration tables previously stored in the ROM 416.</p>
    <p num="178">Next description is made for the computing sequence with reference to the flow chart in FIG. 26.</p>
    <p num="179">
      At first, a necessary input value for obtaining the YMCK  GAMMA  calibration table is decided (step 80).
      <br/>
      Herein it is assumed that n �i�=11 (h) * i (i=0, 1, . . . , imax=15).
      <br/>
      Then the reference data is calibrated using calibration values for the RGB signals according to the sequence described above (step 81), and also the reference data A �n� is calibrated according to the image density which the printer can output (step 82).
    </p>
    <p num="180">
      Next it is assumed that a write value for laser output enabling the maximum image density obtainable in a printer section is FFh (hexadecimal number) and that a read value m �FFh� for the pattern then is mmax.
      <br/>
      Then there are reference data A �i� (i=1, 2, . . . , i1) not subjected to calibration in a range from the low image density area to the intermediate image density area, reference data A �i� (i=i2+1, . . . , imax-1) (i2 &gt;= i1, i2 &gt;= imax-1) in the side of high image density not subjected to calibration, and reference data A �i� (i=i1+1, . . . , i2).
    </p>
    <p num="181">
      Next description is made for specific method of computing assuming an image signal proportional to a reflection factor of a document and not requiring RBG- GAMMA  conversion.
      <br/>
      Of the reference data not subjected to calibration, a difference A ref between the reference data A �i2+1� with lower image density than that in the high image density area and reference data A �i1� with lower image density than that in the low image density area is computed.
      <br/>
      Namely, computing is made through the following equation:
      <br/>
      DELTA ref=A �i1�-A �i2+1�  (12)
    </p>
    <p num="182">
      Herein, in a case of a linear reflection factor or linear brightness degree not requiring RBG- GAMMA  conversion as processing for inversion, the difference  DELTA ref is larger than zero (0).
      <br/>
      Similarly the different  DELTA det is computed from a read value mmax for a pattern for which the maximum image density can be obtained in the printer section.
      <br/>
      Namely the following computing is executed:
      <br/>
      ALPHA det=A �i1�-mmax  (13)
    </p>
    <p num="183">
      From the equations (12), (13), the reference data having being subjected to calibration in the high density section A �i� (i=i1+1, . . . , i2) are as expressed by the following equation:
      <br/>
      A �i�=A �i1�+(A �i�-A �i1�) * ( DELTA det/ DELTA ret)(i=i1+1, i1+2, . . . , i2-1, i2)  (14)
    </p>
    <p num="184">Then an scanner read image signal m �i� corresponding to n �i� is obtained from the reference data A �n� (step 83).</p>
    <p num="185">Actually the reference data A �n �j�� (0 &lt;= n �i� &lt;= 255, j=0, 1, . . . , jmax, n �j� &lt;= n �k� for j &lt;= k) corresponding to the values n �j� at intervals are obtained as described below.</p>
    <p num="186">
      At first (0 &lt;= j &lt;= jmax) satisfying the condition of n �j� &lt;= n �i� &lt;= -n �j+1� is obtained.
      <br/>
      In a case of an 8-bit image signal, the computing becomes easier by executing the computing assuming that n �0�=0, n �jmax�=255, n �jmax+1�=n �jmax�+1, and A �jmax+1�=A �jmax�.
    </p>
    <p num="187">As for intervals of reference data points, the smaller the n �j� is, the higher precision of the y calibration table finally obtained is.</p>
    <p num="188">
      m �i� is computed from the j obtained as described above through the following equation (step 84).
      <br/>
      m �i�=A �j�-(A �j+1�-A �i�) * (n �i�-n �j�)/(n �j+1�-n �j�)  (15)
    </p>
    <p num="189">
      Although interpolation is made by way of using a primary expression, but interpolation may be made by using a higher-dimensional function or the spline function.
      <br/>
      In that case, it is assumed that m �i� is equal to f (n �i�).
      <br/>
      In a case of k-dimensional function, f(x)= SIGMA bi xi (It is assumed that the addition range i is from 0 to k).
    </p>
    <p num="190">Then a write value LD �i� of LD for obtaining m �i� obtained in step 83 is obtained according to a sequence similar to that in step 83.</p>
    <p num="191">
      When an image signal not having been subjected to RGB- GAMMA  conversion is processed, as a value of LD becomes larger, the a �LD� becomes smaller.
      <br/>
      In other words, when LD �k� is smaller than LD �k+1�, a �LD �k�� &gt;= a �LD �k+1��.
    </p>
    <p num="192">
      Herein it is assumed that the 10 values of LD �k�=00h, 11h, 22h, . . . , 66h, 88h, AAh, FFh (k=0, 1, . . . , 9) are used in pattern formation.
      <br/>
      For in a case of image density with a small toner deposition rate, a scanner read value for a toner deposition rate largely varies, so that intervals of pattern write values LD �k� are made smaller, and in a case of image density with a larger toner deposition rate, a scanner read value for a toner deposition rate little varies, so that the intervals are set larger in reading.
    </p>
    <p num="193">The merits provided by this scheme include that a toner consumption rate can be suppressed to a lower level as compared to that in a case where the number of patterns are increased as indicated by LD �k�=00h, 11h, 22h, . . . , EEh, FFh (totally 16 points), and that variance for an LD write value is small in a high image density area, and further as a read value may easily be inverted due to effects by non-uniformity in a surface potential on the light-sensing drum 102, non-uniformity in toner deposition, non-uniformity in fixing, or non-uniformity in potentials, use of shorter intervals of LD write values is not always effective in improvement of precision, and for the reasons as described above, the patterns are formed with the LD write values as described above.</p>
    <p num="194">
      For LD �k� satisfying the condition of a�LD �k�� &gt;= m �i�&gt;a�LD �k+1��, the following equation is applied:
      <br/>
      LD �i�=LD �k�+(LD �k+1�-LD �k�) * (m �i�-a�LD �k��)/a�LD �k+1��-a�LD �k��)  (16)
    </p>
    <p num="195">
      Assuming that 0 &lt;= k &lt;= kmax (kmax&gt;0), in a case of a �LD �kmax��&gt;m �i� (when a target density for image density obtained from the reference data is high), extrapolation using a primary equation is executed for estimation applying the following equation:
      <br/>
      LD �i�=LD �k�+(LD �kmax�-LD �kmax-1�) * (m �i�-a �LD �kmax-1��)/a �LD �kmax��-a �LD �kmax-1��)  (17)
    </p>
    <p num="196">With this operation, a pair of an input value n �i� into the YMCK  GAMMA  calibration table and an output value LD �i� (n �i�, LD �i�) (i=0, 1, . . . , 15) is obtained.</p>
    <p num="197">Then, according to the obtained part of the input value n �i� and output value LD �i� (i=0, 1, . . . , 15), interpolation is executed using the spline function or a  GAMMA  calibration table stored in an ROM is selected (step 245).</p>
    <p num="198">Next description is made for a method of calibrating an output value for a gradation pattern used for ACC according to another embodiment of the present invention according to a result of detection of development characteristics.</p>
    <p num="199">
      The horizontal axis of the first quadrant in FIG. 27 indicates a laser write value for a gradation pattern, while the vertical axis indicates a read value for a gradation pattern outputted onto transfer paper, which indicates a relation between a write value for a gradation pattern and a scanner read value.
      <br/>
      The horizontal axis of the second quadrant indicates a toner deposition rate on the light-sensing drum 102, which indicates a relation between a toner deposition rate on the light-sensing drum 102 and a scanner read value.
      <br/>
      The vertical axis of the third quadrant indicates a development potential, which indicates development characteristics of a printer.
      <br/>
      The development potential indicates a difference between a surface potential on the light-sensing drum 102 and a DC component of development bias, and as this value becomes larger, a toner deposition rate on the light-sensing drum 102 becomes larger.
      <br/>
      The fourth quadrant shows a relation between the development potential and a write value for a gradation pattern.
    </p>
    <p num="200">
      The development characteristics g2) for a case where "the development rate is high" in the third quadrant and development characteristics h2) for "development rate is standard" also shown in the third quadrant can be obtained from a result of detection of a gradation pattern formed on the light-sensing drum 102 by the surface potential sensor 130 as well as by the optical sensor 136.
      <br/>
      A result of output of a gradation pattern onto transfer paper under conditions for the development characteristics g2) and h2) is as indicated by the graph g1) and graph h1) in the first quadrant.
    </p>
    <p num="201">When the development characteristics h2) is regarded as standard, a toner deposition rate on the light-sensing drum 102 for a pattern formed according to the write value n �i� is (M/A) i, the development potential is  DELTA V �i�, and a scanner read value is A �i�. When the development characteristics newly detected is g2), a write value for a gradation pattern for obtaining (M/A) i as a toner deposition rate on the light-sensing drum 102 is n1 �i� in the fourth quadrant.</p>
    <p num="202">To obtain a toner deposition rate (M/A) i on the light-sensing drum 102 and a scanner read value A �i� for a printer with the standard development characteristics h2), it is required to set the development potential to A V1 �i� and a write value for the gradation pattern to n1 �i�.</p>
    <p num="203">
      The development potential  DELTA V1 �i� given when a point P ((M/A) i,  DELTA V �i�) in the third quadrant is moved along the string 1 in the direction indicated by the arrow mark m according to a cross point Q ((M/A) i,  DELTA , V1 �i�) with the curve for development characteristics g2) is the development potential appropriate when i-th gradation pattern is formed.
      <br/>
      The laser write value is n1 �i� as shown by the graph in the fourth quadrant.
    </p>
    <p num="204">As described above, when the optical sensor 136 is used, because of the functional limit of the optical sensor 136 that a quantity of reflected light from toner on the light-sensing drum 102 is detected, a high toner deposition rate can not be detected, but when the optical sensor 136 is used together with the potential sensor 139, by estimating a toner deposition rate in an area where the optical sensor 136 is not operable effectively according to a result of detection by the potential sensor 139, thus the problem described above being solved.</p>
    <p num="205">When a toner deposition rate on the light-sensing drum 102 is estimated from a result of detection with the potential sensor 139, a development potential is obtained from a surface potential of the light-sensing drum as well as from a DC component of development bias assuming that toner is deposited on the light-sensing drum in proportion to the development potential.</p>
    <p num="206">Next description is made for the processing sequence with reference to the flow chart in FIG. 28.</p>
    <p num="207">At first, determination is made as to whether the development characteristics is to be detected or not (step 90), and detection of the development characteristics should not always be executed just before execution of ACC, and may be executed in output of a specified number of sheets of transfer paper after previous detection of development characteristics (such as once for every 100 sheets of transfer paper), or in a case where a fixing temperature is lower than a specified value when power to the basic system is turned ON.</p>
    <p num="208">If it is determined that detection of development characteristics is not required to be executed (step 90: N), a result of previous detection of development characteristics is read out from a memory with detected data stored therein.</p>
    <p num="209">
      If it is determined that detection of the development characteristics is required (step 90: Y), the development characteristics is detected (step 91), and the detected development characteristics is compared to the standard development characteristics stored in the memory (step 92).
      <br/>
      Then a write value for the gradation pattern is changed according to a result of comparison (step 93).
      <br/>
      A pattern for ACC is outputted according to the result (step 94).
      <br/>
      Then the ACC processing described below is executed.
    </p>
    <p num="210">
      A case in which a toner deposition rate on the light-sensing drum 102 (M/A) ( DELTA V) is proportional to the development potential  DELTA V in the third quadrant in FIG. 27 at  DELTA Vmax (development potential for the write value FFh) and also at (M/A) &gt;= 0 can be expressed by the following equation:
      <br/>
      (M/A)( DELTA V)=k(h) *  DELTA V+ DELTA VK (h) ( DELTA V &lt;=  DELTA Vmax and at the same time (M/A &gt;= 0)  (18)
    </p>
    <p num="211">
      for the development characteristics h2); or by the following equation:
      <br/>
      (M/A) ( DELTA V)=k (g) *  DELTA V+ DELTA VK (g) ( DELTA V &lt;=  DELTA Vmax and at the same time (M/A &gt;= 0))  (19)
    </p>
    <p num="212">for the development characteristics g2).</p>
    <p num="213">Herein k (h) and k (g) indicate inclination (called toner deposition rate  GAMMA ), while  DELTA Vk (h) and  DELTA Vk (g) are constants each indicating a tangent to the vertical axis (called development start potential).</p>
    <p num="214">
      When coordinate values of the point P ((M/A) i,  DELTA V �i�) and point Q ((M/A) i,  DELTA V1 �i�) are introduced, a value of a toner deposition rate on the light-sensing drum 102 is (M/A) i and common to the two points, and further K (h) *  DELTA V �i�+ DELTA VK (h)=k (g) * V1 �i�+Vk (g) is satisfied, the equation (18) is equation (19) shown below, and for this reason the A V1 �i� is obtained through the equation (19):
      <br/>
      V1 �i�=(1/k (g))+k (h) *  DELTA V �i�+ DELTA VK (h)- DELTA VK (g)} (20)
    </p>
    <p num="215">
      The laser write value n1 �i� for obtaining A V1 �i� is obtained from the graph in the fourth quadrant.
      <br/>
      This graph is obtained from a result V �i� of detection of a surface potential when a gradation pattern for the laser write value n �i� is formed by subjecting the result to the conversion of  DELTA V �i�=VB-V �i�, Herein VB indicates a value of a DC component in development bias.
      <br/>
      In the example described above,  DELTA V &lt;=  DELTA Vmax and at the same time (M/A) &gt;= 0 are assumed for a range of development potential, and this is the same as the conditions of  DELTA VK (g) &lt;=  DELTA V&lt; DELTA Vmax and  DELTA VK (h) &lt;= - DELTA V&lt; DELTA Vmax when the development start potentials of  DELTA VK (g) and  DELTA VK (h) are used.
    </p>
    <p num="216">Next description is made for another embodiment of the present invention with reference to FIG. 29.</p>
    <p num="217">
      The horizontal axis of the first quadrant in FIG. 29 indicates a laser write value, while the vertical axis indicates a read value for a gradation pattern outputted onto transfer paper, which shows a relation between a write value for the gradation pattern and a scanner read value.
      <br/>
      The horizontal axis of the second quadrant indicates a toner deposition rate on the light-sensing drum 102, and shows a relation between a toner deposition rate on the light-sensing drum 102 and the scanner read value.
      <br/>
      The vertical axis of the third quadrant indicates a laser (LD) write value, which indicates development characteristics of the printer, and the fourth quadrant shows a relation between an LD write value and a write value for a gradation pattern, which is the same as that in the embodiment above.
    </p>
    <p num="218">
      The development characteristics g2) for a case of "high development rate" shown in the third quadrant and development characteristics h2) for the case of "standard development rate" also shown in the third quadrant can be obtained from a result of detection for a gradation pattern formed on the light-sensing drum 102 by the optical sensor 136 using the method described above.
      <br/>
      However, because of the functional limit of the optical sensor 136 that a quantity of reflected light from toner on the light-sensing drum 102 is detected, a toner deposition rate higher than the limit for the optical sensor 136 indicated by m) in the figure can not be detected.
      <br/>
      Therefore, only area for toner deposition rate lower than that showed by m) is used.
      <br/>
      A result of output of a gradation pattern onto transfer paper under the conditions of the development characteristics g2) and h2) is as indicated by the graph g1) and graph h1) in the first quadrant.
    </p>
    <p num="219">When the development characteristics h2) is regarded as the reference, a toner deposition rate on the light-sensing drum 102 for a pattern formed according to the write value n �i� is (M/A) i, the write value is n �i�, and the scanner read value is A �i�.</p>
    <p num="220">When the newly detected development characteristics is g2), a write value for a gradation pattern for obtaining (M/A) i as a toner deposition rate on the light-sensing drum 102 is n1 �i� in the fourth quadrant.</p>
    <p num="221">To obtain a toner deposition rate (M/A) i on the light-sensing drum 102 and a scanner read value A �i� for a printer with the standard development characteristics h2), a write value for the gradation pattern should be set to n1 �i�.</p>
    <p num="222">A write value given when a point P ((M/A) i, n �i�) is moved along the string 1 in the direction indicated by the arrow mark m by a cross point Q ((M/A) i, n1 �i�) is a value appropriate for forming a gradation pattern.</p>
    <p num="223">This application is based on Japanese patent application No. HEI 9-275003 filed in the Japanese Patent Office on Aug. 20, 1997, the entire contents of which are hereby incorporated by reference.</p>
    <p num="224">Although the invention has been described with respect to a specific embodiment for a complete and clear disclosure, the appended claims are not to be thus limited but are to be construed as embodying all modifications and alternative constructions that may occur to one skilled in the art which fairly fall within the basic teaching herein set forth.</p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>An image forming apparatus comprising:</claim-text>
      <claim-text>an image reading unit configured to read a document image by way of optically reading the document image; an image processing unit configured to convert an input image signal from the image reading unit and to output the converted input image signal as an output image signal by use of an image signal conversion table incorporated in said image processing unit; a writing unit configured to write information on an image carrier according to said output image signal; an image forming unit comprising said image carrier and configured to form an image on a transfer material; a gradation pattern image signal generating unit configured to generate a plurality of gradation patterns to be recorded on said transfer material; a unit configured to prepare and select an image signal conversion table according to a signal read by said image reading unit from said plurality of gradation patterns recorded on the transfer material;</claim-text>
      <claim-text>and a detecting unit configured to detect a relation between a surface potential and a toner deposition rate on the image carrier;</claim-text>
      <claim-text>wherein a write signal level for a gradation pattern formed on said transfer material is changed according to a result of detection by said detecting unit.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. An image forming apparatus according to claim 1 further comprising: a light-sensing unit configured to detect a reflected light from a transmitting light through the gradation pattern visualized on the image carrier;</claim-text>
      <claim-text>wherein the relation between a surface potential and a toner deposition rate on the image carrier is detected by said detecting unit according to a result of detection by said light-sensing unit.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. An image forming apparatus according to claim 2 further comprising a surface potential detecting unit configured to detect a surface potential of a gradation density pattern;</claim-text>
      <claim-text>wherein the relation between a surface potential and a toner deposition rate on the image carrier is detected according to a result of detection by the surface potential detecting unit as well as to a result of detection by said light-sensing unit, and a write value for a gradation pattern formed on the transfer material is changed according to the relation detected.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. An image forming apparatus comprising: an image reading unit configured to read a document image by way of optically reading the document image; an image processing unit configured to process an image signal from the image reading unit and to output the processed signal as an output image signal by use of an image signal conversion pattern incorporated in said image processing unit; an image writing unit configured to write information on an image carrier according to said output image signal from the image processing unit; an image signal switching unit configured to switch between an image signal from said image processing unit and an image signal from an external device, and to output the selected signal to said image writing unit; an image forming unit configured to visualize information on said image carrier with a developer for a plurality of colors, and to form an image on a transfer material; an image signal conversion table configured to subject an image signal from said switching unit to gradation conversion and to output the image signal having been subjected to gradation conversion to said image writing unit; a gradation pattern image signal generating unit configured to generate a plurality of gradation patterns to be recorded on said transfer material; a unit configured to prepare and select an image signal conversion table according to a read signal read by said image reading unit from said gradation patterns recorded on the transfer material;</claim-text>
      <claim-text>and a detecting unit configured to detect a relation between a surface potential and a toner deposition rate on the image carrier;</claim-text>
      <claim-text>wherein an image signal conversion table for signals having been switched by the switching unit is changed according to a result of detection by said detecting unit and, gradation patterns generated by the image signal generating unit are changed according to the image signal conversion table for signals having been switched by the switching unit to form a gradation pattern.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. An image forming apparatus according to claim 4 further comprising: a light-sensing unit configured to detect a reflected light from a transmitting light through the gradation pattern visualized on the image carrier;</claim-text>
      <claim-text>wherein the relation between a surface potential and toner deposition rate on the image carrier is detected by said detecting unit according to a result of detection by said light-sensing unit.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. An image forming apparatus according to claim 5 further comprising a surface potential detecting unit configured to detect a surface potential of a gradation density pattern;</claim-text>
      <claim-text>wherein the relation between a surface potential and toner deposition rate on the image carrier is detected according to a result of detection by the surface potential detecting unit as well as to a result of detection by said light-sensing unit, and a write value for a gradation pattern formed on the transfer material is changed according to the relation detected.</claim-text>
    </claim>
  </claims>
</questel-patent-document>