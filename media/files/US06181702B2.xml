<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06181702B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06181702</doc-number>
        <kind>B2</kind>
        <date>20010130</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6181702</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference family-id="21897687" extended-family-id="59228173">
      <document-id>
        <country>US</country>
        <doc-number>08993884</doc-number>
        <kind>A</kind>
        <date>19971218</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1997US-08993884</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>60445057</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>99388497</doc-number>
        <kind>A</kind>
        <date>19971218</date>
        <priority-active-indicator>N</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1997US-08993884</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="2">
        <country>US</country>
        <doc-number>3802597</doc-number>
        <kind>P</kind>
        <date>19970214</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="2">
        <doc-number>1997US-60038025</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010130</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>H04L  12/54        20130101A I20140531RMEP</text>
        <ipc-version-indicator>
          <date>20130101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>54</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20140531</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>H04L  13/08        20060101AFI20051220RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>13</main-group>
        <subgroup>08</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051220</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="3">
        <text>G06F  11/26        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>11</main-group>
        <subgroup>26</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="4">
        <text>G06F  12/00        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>12</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="5">
        <text>G06F  13/00        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="6">
        <text>G06F  13/10        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>10</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="7">
        <text>G06F  13/16        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>16</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="8">
        <text>G06F  13/24        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>24</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="9">
        <text>G06F  15/00        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>15</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="10">
        <text>G06F  15/16        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>15</main-group>
        <subgroup>16</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="11">
        <text>G08B   5/00        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>08</class>
        <subclass>B</subclass>
        <main-group>5</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="12">
        <text>G11C  11/412       20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>11</class>
        <subclass>C</subclass>
        <main-group>11</main-group>
        <subgroup>412</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="13">
        <text>H04B   7/14        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>B</subclass>
        <main-group>7</main-group>
        <subgroup>14</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="14">
        <text>H04J   3/02        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>J</subclass>
        <main-group>3</main-group>
        <subgroup>02</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="15">
        <text>H04J   3/12        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>J</subclass>
        <main-group>3</main-group>
        <subgroup>12</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="16">
        <text>H04J   3/22        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>J</subclass>
        <main-group>3</main-group>
        <subgroup>22</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="17">
        <text>H04J   3/24        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>J</subclass>
        <main-group>3</main-group>
        <subgroup>24</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="18">
        <text>H04L  12/18        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>18</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="19">
        <text>H04L  12/24        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>24</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="20">
        <text>H04L  12/28        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>28</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="21">
        <text>H04L  12/413       20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>413</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="22">
        <text>H04L  12/44        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>44</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="23">
        <text>H04L  12/46        20060101A I20060722RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>46</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20060722</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="24">
        <text>H04L  12/50        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>50</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="25">
        <text>H04L  12/66        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>66</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="26">
        <text>H04L  12/861       20130101A I20140531RMEP</text>
        <ipc-version-indicator>
          <date>20130101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>861</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20140531</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="27">
        <text>H04L  12/863       20130101A I20140531RMEP</text>
        <ipc-version-indicator>
          <date>20130101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>863</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20140531</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="28">
        <text>H04L  12/879       20130101A I20140531RMEP</text>
        <ipc-version-indicator>
          <date>20130101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>879</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20140531</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="29">
        <text>H04L  12/931       20130101A I20140531RMEP</text>
        <ipc-version-indicator>
          <date>20130101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>931</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20140531</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="30">
        <text>H04L  12/933       20130101A I20140531RMEP</text>
        <ipc-version-indicator>
          <date>20130101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>933</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20140531</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="31">
        <text>H04L  12/935       20130101A I20140531RMEP</text>
        <ipc-version-indicator>
          <date>20130101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>935</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20140531</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="32">
        <text>H04L  12/937       20130101A I20140531RMEP</text>
        <ipc-version-indicator>
          <date>20130101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>937</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20140531</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="33">
        <text>H04L  12/939       20130101A I20140531RMEP</text>
        <ipc-version-indicator>
          <date>20130101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>939</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20140531</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="34">
        <text>H04L  12/947       20130101A I20140531RMEP</text>
        <ipc-version-indicator>
          <date>20130101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>947</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20140531</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="35">
        <text>H04Q   3/545       20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>Q</subclass>
        <main-group>3</main-group>
        <subgroup>545</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="36">
        <text>H04Q  11/00        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>Q</subclass>
        <main-group>11</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>370401000</text>
        <class>370</class>
        <subclass>401000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>370389000</text>
        <class>370</class>
        <subclass>389000</subclass>
      </further-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>H04L-049/30A</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>30A</subgroup>
      </classification-ecla>
      <classification-ecla sequence="2">
        <text>G06F-013/16A</text>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>013</main-group>
        <subgroup>16A</subgroup>
      </classification-ecla>
      <classification-ecla sequence="3">
        <text>G06F-013/24</text>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>24</subgroup>
      </classification-ecla>
      <classification-ecla sequence="4">
        <text>G11C-011/412</text>
        <section>G</section>
        <class>11</class>
        <subclass>C</subclass>
        <main-group>11</main-group>
        <subgroup>412</subgroup>
      </classification-ecla>
      <classification-ecla sequence="5">
        <text>H04L-012/46V</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>012</main-group>
        <subgroup>46V</subgroup>
      </classification-ecla>
      <classification-ecla sequence="6">
        <text>H04L-012/56K</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>012</main-group>
        <subgroup>56K</subgroup>
      </classification-ecla>
      <classification-ecla sequence="7">
        <text>H04L-041/02B</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>041</main-group>
        <subgroup>02B</subgroup>
      </classification-ecla>
      <classification-ecla sequence="8">
        <text>H04L-047/62D1</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>047</main-group>
        <subgroup>62D1</subgroup>
      </classification-ecla>
      <classification-ecla sequence="9">
        <text>H04L-049/10E</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>10E</subgroup>
      </classification-ecla>
      <classification-ecla sequence="10">
        <text>H04L-049/20A</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>20A</subgroup>
      </classification-ecla>
      <classification-ecla sequence="11">
        <text>H04L-049/25</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>25</subgroup>
      </classification-ecla>
      <classification-ecla sequence="12">
        <text>H04L-049/25E3</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>25E3</subgroup>
      </classification-ecla>
      <classification-ecla sequence="13">
        <text>H04L-049/30</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>30</subgroup>
      </classification-ecla>
      <classification-ecla sequence="14">
        <text>H04L-049/30C</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>30C</subgroup>
      </classification-ecla>
      <classification-ecla sequence="15">
        <text>H04L-049/35A</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>35A</subgroup>
      </classification-ecla>
      <classification-ecla sequence="16">
        <text>H04L-049/35D</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>35D</subgroup>
      </classification-ecla>
      <classification-ecla sequence="17">
        <text>H04L-049/50</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>50</subgroup>
      </classification-ecla>
      <classification-ecla sequence="18">
        <text>H04L-049/55A</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>55A</subgroup>
      </classification-ecla>
      <classification-ecla sequence="19">
        <text>H04L-049/55C</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>55C</subgroup>
      </classification-ecla>
      <classification-ecla sequence="20">
        <text>H04L-049/90</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>90</subgroup>
      </classification-ecla>
      <classification-ecla sequence="21">
        <text>H04L-049/90C</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>90C</subgroup>
      </classification-ecla>
      <classification-ecla sequence="22">
        <text>H04L-049/90M</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>90M</subgroup>
      </classification-ecla>
      <classification-ecla sequence="23">
        <text>H04L-049/90Q</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>90Q</subgroup>
      </classification-ecla>
      <classification-ecla sequence="24">
        <text>H04L-049/90Q1A</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>90Q1A</subgroup>
      </classification-ecla>
      <classification-ecla sequence="25">
        <text>H04L-049/90Q3</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>90Q3</subgroup>
      </classification-ecla>
      <classification-ecla sequence="26">
        <text>H04L-049/90R</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>049</main-group>
        <subgroup>90R</subgroup>
      </classification-ecla>
      <classification-ecla sequence="27">
        <text>H04Q-003/545T2</text>
        <section>H</section>
        <class>04</class>
        <subclass>Q</subclass>
        <main-group>003</main-group>
        <subgroup>545T2</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/3009</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>3009</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06F-013/1605</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>1605</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06F-013/24</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>24</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="4">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G11C-011/412</classification-symbol>
        <section>G</section>
        <class>11</class>
        <subclass>C</subclass>
        <main-group>11</main-group>
        <subgroup>412</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="5">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-012/1863</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>1863</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="6">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-012/4641</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>4641</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="7">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-012/4645</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>4645</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="8">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-012/467</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>12</main-group>
        <subgroup>467</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="9">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-041/0213</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>41</main-group>
        <subgroup>0213</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="10">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-047/50</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>47</main-group>
        <subgroup>50</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170502</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="11">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-047/6225</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>47</main-group>
        <subgroup>6225</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="12">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/103</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>103</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="13">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/201</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>201</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="14">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/25</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>25</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="15">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/255</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>255</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="16">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/30</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>30</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="17">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/3027</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>3027</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="18">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/3054</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>3054</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="19">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/351</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>351</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="20">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/354</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>354</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="21">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/40</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>40</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="22">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/50</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>50</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="23">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/552</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>552</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="24">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/555</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>555</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="25">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/90</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>90</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="26">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/901</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>901</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="27">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/9047</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>9047</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="28">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/9063</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>9063</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="29">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/9073</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>9073</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="30">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/9078</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>9078</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="31">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-049/9084</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>49</main-group>
        <subgroup>9084</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="32">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04Q-003/54591</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>Q</subclass>
        <main-group>3</main-group>
        <subgroup>54591</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="33">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04Q-2213/1316</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>Q</subclass>
        <main-group>2213</main-group>
        <subgroup>1316</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="34">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04Q-2213/13162</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>Q</subclass>
        <main-group>2213</main-group>
        <subgroup>13162</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20170506</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="35">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-049/10E</classification-symbol>
      </patent-classification>
      <patent-classification sequence="36">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-049/20A</classification-symbol>
      </patent-classification>
      <patent-classification sequence="37">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-049/30</classification-symbol>
      </patent-classification>
      <patent-classification sequence="38">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-049/30A</classification-symbol>
      </patent-classification>
      <patent-classification sequence="39">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-049/30C</classification-symbol>
      </patent-classification>
      <patent-classification sequence="40">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-049/30F</classification-symbol>
      </patent-classification>
      <patent-classification sequence="41">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-049/35A</classification-symbol>
      </patent-classification>
      <patent-classification sequence="42">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-049/35D</classification-symbol>
      </patent-classification>
      <patent-classification sequence="43">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-049/40</classification-symbol>
      </patent-classification>
      <patent-classification sequence="44">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-049/50</classification-symbol>
      </patent-classification>
      <patent-classification sequence="45">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-049/55C</classification-symbol>
      </patent-classification>
      <patent-classification sequence="46">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-012/18R</classification-symbol>
      </patent-classification>
      <patent-classification sequence="47">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-012/46V1</classification-symbol>
      </patent-classification>
      <patent-classification sequence="48">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-012/46V2</classification-symbol>
      </patent-classification>
      <patent-classification sequence="49">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-041/02B</classification-symbol>
      </patent-classification>
      <patent-classification sequence="50">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04Q-213/13160</classification-symbol>
      </patent-classification>
      <patent-classification sequence="51">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04Q-213/13162</classification-symbol>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>10</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>13</number-of-drawing-sheets>
      <number-of-figures>14</number-of-figures>
      <image-key data-format="questel">US6181702</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Method and apparatus for capturing source and destination traffic</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>TSUTSUI EIICHI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5060228</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5060228</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>ROSS FLOYD E</text>
          <document-id>
            <country>US</country>
            <doc-number>5394402</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5394402</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>SHORT PHILLIP</text>
          <document-id>
            <country>US</country>
            <doc-number>5633865</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5633865</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>DEV ROGER, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5754532</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5754532</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="5">
          <text>DE MARCO JOSE GERALDO BUENO, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5761440</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5761440</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="6">
          <text>HILL SHANNON Q, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5796944</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5796944</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="7">
          <text>NISHIMURA TAKASHI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5910955</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5910955</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="8">
          <text>YANACEK JUDITH A, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5940376</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5940376</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="9">
          <text>SHANI RON</text>
          <document-id>
            <country>US</country>
            <doc-number>6023563</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6023563</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="10">
          <text>TOMIKAWA MASATAKA</text>
          <document-id>
            <country>US</country>
            <doc-number>5140585</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5140585</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="11">
          <text>CRAYFORD IAN</text>
          <document-id>
            <country>US</country>
            <doc-number>5305321</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5305321</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="12">
          <text>PICAZO JR JOSE J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5432907</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5432907</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="13">
          <text>CHRISTENSEN KENNETH J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5491687</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5491687</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="14">
          <text>MURTHY MANOHAR, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5515376</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5515376</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="15">
          <text>IBM</text>
          <document-id>
            <country>EP</country>
            <doc-number>0603444</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>EP-603444</doc-number>
          </document-id>
        </patcit>
      </citation>
    </references-cited>
    <related-documents>
      <related-publication>
        <document-id>
          <country>US</country>
          <doc-number>60/038,025</doc-number>
          <date>19970214</date>
        </document-id>
        <document-id>
          <country>US</country>
          <doc-number>60/038025</doc-number>
          <date>19970214</date>
        </document-id>
      </related-publication>
    </related-documents>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Advanced Micro Devices, Inc.</orgname>
            <address>
              <address-1>Sunnyvale, CA, US</address-1>
              <city>Sunnyvale</city>
              <state>CA</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>ADVANCED MICRO DEVICES</orgname>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Egbert, Chandan</name>
            <address>
              <address-1>San Jose, CA, US</address-1>
              <city>San Jose</city>
              <state>CA</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
      </inventors>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Olms, Douglas W.</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>EXPIRED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      A network switch configured for switching data packets across multiple ports uses an address table to generate frame forwarding information.
      <br/>
      The address table includes a field for capturing data transmissions between designated stations so that a management agent can monitor data conversations.
      <br/>
      When a data conversation between predetermined stations is detected, the switch forwards the data to the appropriate output ports identified in the address table and also forwards the data to a management agent.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
    <p num="1">
      This application claims priority from provisional patent application Ser.
      <br/>
      No. 60/038,025, filed Feb. 14, 1997, entitled INTEGRATED MULTIPORT SWITCH (attorney docket 1033-230PRO), which is incorporated herein by reference.
    </p>
    <p num="2">
      This application is related to the following commonly-assigned, copending applications, filed concurrently herewith, entitled: METHOD AND APPARATUS FOR AUTO-INCREMENTING THROUGH TABLE AND UPDATING SINGLE REGISTER IN MEMORY, application Ser.
      <br/>
      No. 08/993,834, filed Dec. 18, 1997, METHOD AND APPARATUS FOR SCALING NUMBER OF VIRTUAL LANS IN A SWITCH USING AN INDEXING SCHEME, application Ser.
      <br/>
      No. 08/993,831, filed Dec. 18, 1997, METHOD AND NETWORK SWITCH HAVING DUAL FORWARDING MODELS WITH A VIRTUAL LAN OVERLAY, application Ser.
      <br/>
      No. 08/993,835, filed Dec. 18, 1997, METHOD AND APPARATUS FOR MANAGING BIN CHAINS IN A MEMORY application Ser.
      <br/>
      No. 08/993,826 filed Dec. 18, 1997, APPARATUS AND METHOD FOR GENERATING AN INDEX KEY FOR A NETWORK SWITCH ROUTING TABLE USING A PROGRAMMABLE HASH FUNCTION, application Ser.
      <br/>
      No. 08/992,795, filed Dec. 18, 1997, METHOD AND APPARATUS FOR CREATING A PORT VECTOR, application Ser.
      <br/>
      No. 08/993,044, filed Dec. 18, 1997, SHARED ADDRESS TABLE WITH SOURCE AND DESTINATION TWO-PASS ALGORITHM, application Ser.
      <br/>
      No. 08/993,048, filed Dec. 18, 1997 and METHOD AND APPARATUS FOR MANAGING LEARNING IN AN ADDRESS TABLE IN A MEMORY, application Ser.
      <br/>
      No. 08/994,691, filed Dec. 18, 1997.
    </p>
    <heading>TECHNICAL FIELD</heading>
    <p num="3">The present invention relates to network communications and more particularly, to capturing data conversations between stations/ports connected to the network.</p>
    <heading>BACKGROUND ART</heading>
    <p num="4">
      In computer networks, a plurality of network stations are interconnected via a communications medium.
      <br/>
      For example, Ethernet is a commonly used local area network scheme in which multiple stations are connected to a single shared serial data path.
      <br/>
      These stations often communicate with a switch located between the shared data path and the stations connected to that path.
      <br/>
      Typically, the switch controls the communication of data packets on the network.
    </p>
    <p num="5">
      The network switch includes switching logic for receiving and forwarding frames to the appropriate destinations.
      <br/>
      When all of the stations connected to the network are simultaneously operating, packet traffic on the shared serial path can be heavy with little time between packets.
      <br/>
      In many prior art systems, the network switch does not have time to make data forwarding decisions as well as monitor data traffic on the network.
      <br/>
      Therefore, there is no way to monitor specific data conversations between particular stations or ports.
    </p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="6">There exists a need for a switching device that generates data forwarding decisions in a timely manner and monitors data conversations between stations/ports on the network.</p>
    <p num="7">There is also a need for a switching device that mirrors data conversations between designated ports/stations to a management device.</p>
    <p num="8">
      These and other needs are met by the present invention, where data received by the network switch is routed to an internal decision making engine that includes an address table that includes a traffic capture field.
      <br/>
      The internal decision making engine generates a forwarding port vector using the address table and identifies data conversations between designated stations/ports using the same table.
      <br/>
      Data conversations between the designated stations/ports are then mirrored to a management port.
    </p>
    <p num="9">
      According to one aspect of the invention, a network switch is configured for controlling the communication of data frames between stations.
      <br/>
      The switch includes a receive device that receives data frames from connected stations.
      <br/>
      The switch also includes an address table for storing address information including both source addresses and destination addresses.
      <br/>
      The switch further includes a control device that identifies a data frame being transmitted between designated stations.
    </p>
    <p num="10">
      Another aspect of the present invention provides a method for monitoring data traffic.
      <br/>
      The method includes receiving information from a data frame, the information including a source address and destination address.
      <br/>
      The method also includes identifying a data frame being transmitted between designated stations.
      <br/>
      The identified frame is then transmitted to a predetermined location,
    </p>
    <p num="11">
      Other objects and advantages of the present invention will become readily apparent to those skilled in this art from the following detailed description.
      <br/>
      The embodiments shown and described provide illustration of the best mode contemplated for carrying out the invention.
      <br/>
      The invention is capable of modifications in various obvious respects, all without departing from the invention.
      <br/>
      Accordingly, the drawings are to be regarded as illustrative in nature, and not as restrictive.
    </p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="12">
      FIG. 1 is a block diagram of a packet switched system in which the present invention may be utilized.
      <br/>
      FIGS. 2A and 2B show a block diagram of a multiport switch constructed in accordance with an embodiment of the present invention and used in the packet switched system of FIG. 1.
      <br/>
      FIG. 3 is a detailed block diagram of the switch subsystem of FIG. 2.
      <br/>
      FIG. 4 is a block diagram of a system including the internal rules checker of FIG. 2 in accordance with an embodiment of the present invention.
      <br/>
      FIG. 5 illustrates the composition of the IRC address table of FIG. 4.
      <br/>
      FIG. 6 illustrates the format of an IRC address table entry of the IRC address table of FIG. 5.
      <br/>
      FIGS. 7A and 7B illustrate the format of an untagged frame and a tagged frame, respectively.
      <br/>
      FIG. 8 illustrates an example of the use of the address table in connection with identifying a forwarding port vector.
      <br/>
      FIG. 9 is a block diagram of a system including the internal rules checker of FIG. 2 using programmable hash functions.
      <br/>
      FIG. 10 illustrates linked list chains for identifying table entries relative to a selected bin.
      <br/>
      FIG. 11 illustrates the hash function circuit of FIG. 9.
      <br/>
      FIG. 12 is a schematic representation of the IRC address port in relation to the IRC address table.
      <br/>
      FIG. 13 illustrates an example of the use of the address table in connection with capturing a data conversation.
    </p>
    <heading>DETAILED DESCRIPTION OF ILLUSTRATED EMBODIMENTS</heading>
    <p num="13">
      The present invention will be described with the example of a switch in a packet switched network, such as an Ethernet (IEEE 802.3) network.
      <br/>
      A description will first be given of the switch architecture, followed by the detailed description of the method and apparatus for capturing source and destination traffic between ports.
      <br/>
      It will become apparent, however, that the present invention is also applicable to other packet switched systems, as described in detail below.
    </p>
    <heading>SWITCH ARCHITECTURE</heading>
    <p num="14">
      FIG. 1 is a block diagram of an exemplary system in which the present invention may be advantageously employed.
      <br/>
      The exemplary system 10 is a packet switched network, such as an Ethernet network.
      <br/>
      The packet switched network includes an integrated multiport switch (IMS) 12 that enables communication of data packets between network stations.
      <br/>
      The network may include network stations having different configurations, for example twenty-four (24) 10 megabit per second (Mb/s) network stations 14 that send and receive data at a network data rate of 10 Mb/s, and two 100 Mb/s network stations 16 that send and receive data packets at a network speed of 100 Mb/s.
      <br/>
      The multiport switch 12 selectively forwards data packets received from the network stations 14 or 16 to the appropriate destination based upon Ethernet protocol.
    </p>
    <p num="15">
      According to the disclosed embodiment, the 10 Mb/s network stations 14 send and receive data packets to and from the multiport switch 12 via a media 18 and according to half-duplex Ethernet protocol.
      <br/>
      The Ethernet protocol ISO/IEC 8802-3 (ANSI/IEEE Std. 802.3, 1993 Ed.) defines a half-duplex medium access mechanism that permits all stations 14 to access the network channel with equality.
      <br/>
      Traffic in a half-duplex environment is not distinguished or prioritized over the medium 18.
      <br/>
      Rather, each station 14 includes an Ethernet interface card that uses carrier sense multiple access with collision detection (CSMA/CD) to listen for traffic on the media.
      <br/>
      The absence of network traffic is detected by sensing a deassertion of a receive carrier on the media.
      <br/>
      Any station 14 having data to send will attempt to access the channel by waiting a predetermined time after the deassertion of a receive carrier on the media, known as the interpacket gap interval (IPG).
      <br/>
      If a plurality of stations 14 have data to send on the network, each of the stations will attempt to transmit in response to the sensed deassertion of the receive carrier on the media and after the IPG interval, resulting in a collision.
      <br/>
      Hence, the transmitting station will monitor the media to determine if there has been a collision due to another station sending data at the same time.
      <br/>
      If a collision is detected, both stations stop, wait a random amount of time, and retry transmission.
    </p>
    <p num="16">
      The 100 Mb/s network stations 16 preferably operate in full-duplex mode according to the proposed Ethernet standard IEEE 802.3x Full-Duplex with Flow Control-Working Draft (0.3).
      <br/>
      The full-duplex environment provides a two-way, point-to-point communication link between each 100 Mb/s network station 16 and the multiport switch 12, where the IMS and the respective stations 16 can simultaneously transmit and receive data packets without collisions.
      <br/>
      The 100 Mb/s network stations 16 each are coupled to network media 18 via 100 Mb/s physical (PHY) devices 26 of type 100 Base-TX, 100 BaseT4, or 100 Base-FX.
      <br/>
      The multiport switch 12 includes a media independent interface (MII) 28 that provides a connection to the physical devices 26.
      <br/>
      The 100 Mb/s network stations 16 may be implemented as servers or routers for connection to other networks.
      <br/>
      The 100 Mb/s network stations 16 may also operate in half-duplex mode, if desired.
      <br/>
      Similarly, the 10 Mb/s network stations 14 may be modified to operate according to full-duplex protocol with flow control.
    </p>
    <p num="17">
      As shown in FIG. 1, the network 10 includes a series of switch transceivers 20 that perform time division multiplexing and time division demultiplexing for data packets transmitted between the multiport switch 12 and the 10 Mb/s stations 14.
      <br/>
      A magnetic transformer module 19 maintains the signal waveform shapes on the media 18.
      <br/>
      The multiport switch 12 includes a transceiver interface 22 that transmits and receives data packets to and from each switch transceiver 20 using a time-division multiplexed protocol across a single serial non-return to zero (NRZ) interface 24.
      <br/>
      The switch transceiver 20 receives packets from the serial NRZ interface 24, demultiplexes the received packets, and outputs the packets to the appropriate end station 14 via the network media 18.
      <br/>
      According to the disclosed embodiment, each switch transceiver 20 has four independent 10 Mb/s twisted-pair ports and uses 4:1 multiplexing across the serial NRZ interface enabling a four-fold reduction in the number of pins required by the multiport switch 12.
    </p>
    <p num="18">
      The multiport switch 12 contains a decision making engine, switching engine, buffer memory interface, configuration/control/status registers, management counters, and MAC (media access control) protocol interface to support the routing of data packets between the Ethernet ports serving the network stations 14 and 16.
      <br/>
      The multiport switch 12 also includes enhanced functionality to make intelligent switching decisions, and to provide statistical network information in the form of management information base (MIB) objects to an external management entity, described below.
      <br/>
      The multiport switch 12 also includes interfaces to enable external storage of packet data and switching logic in order to minimize the chip size of the multiport switch 12.
      <br/>
      For example, the multiport switch 12 includes a synchronous dynamic RAM (SDRAM) interface 32 that provides access to an external memory 34 for storage of received frame data, memory structures, and MIB counter information.
      <br/>
      The memory 34 may be an 80, 100 or 120 MHz synchronous DRAM having a memory size of 2 or 4 Mb.
    </p>
    <p num="19">
      The multiport switch 12 also includes a management port 36 that enables an external management entity to control overall operations of the multiport switch 12 by a management MAC interface 38.
      <br/>
      The multiport switch 12 also includes a peripheral component interconnect (PCI) interface 39 enabling access by the management entity via a PCI host and bridge 40.
      <br/>
      Alternatively, the PCI host and bridge 40 may serve as an expansion bus for a plurality of IMS devices 12.
    </p>
    <p num="20">
      The multiport switch 12 includes an internal decision making engine that selectively transmits data packets received from one source to at least one destination station.
      <br/>
      The multiport switch 12 includes an external rules checker interface (ERCI) 42 that allows an external rules checker (ERC) 44 to make frame forwarding decisions in place of the internal decision making engine.
      <br/>
      Hence, frame forwarding decisions can be made either by the internal switching engine or the external rules checker 44.
    </p>
    <p num="21">
      The multiport switch 12 also includes an LED interface 46 that clocks out the status of conditions per port and drives LED external logic 48.
      <br/>
      The LED external logic 48, in turn, drives LED display elements 50 that are human readable.
      <br/>
      An oscillator 30 provides a 40 MHz clock input for the system functions of the multiport switch 12.
    </p>
    <p num="22">
      FIG. 2 is a block diagram of the multiport switch 12 of FIG. 1.
      <br/>
      The multiport switch 12 includes twenty-four (24) 10 Mb/s media access control (MAC) ports 60 for sending and receiving data packets in half-duplex between the respective 10 Mb/s network stations 14 (ports 1-24), and two 100 Mb/s MAC ports 62 for sending and receiving data packets in full-duplex between the respective 100 Mb/s network stations 16 (ports 25, 26).
      <br/>
      As described above, the management interface 36 also operates according to MAC layer protocol (port 0).
      <br/>
      Each of the MAC ports 60, 62 and 36 has a receive first-in-first-out (FIFO) buffer 64 and transmit FIFO 66.
      <br/>
      Data packets from a network station are received by the corresponding MAC port and stored in the corresponding receive FIFO 64.
      <br/>
      The received data packet is output from the corresponding receive FIFO 64 to the external memory interface 32 for storage in the external memory 34.
    </p>
    <p num="23">
      Additional interfaces provide management and control information.
      <br/>
      For example, a management data interface 72 enables the multiport switch 12 to exchange control and status information with the switch transceivers 20 and the 100 Mb/s physical devices 26 according to the MII management specification (IEEE 802.3u).
      <br/>
      For example, the management data interface 72 outputs a management data clock (MDC) providing a timing reference on the bidirectional management data IO (MDIO) signal path.
    </p>
    <p num="24">
      The PCI interface 39 is a 32-bit PCI revision 2.1 compliant slave interface for access by the PCI host processor 40 to internal IMS status and configuration registers 74, and access external memory SDRAM 34.
      <br/>
      The PCI interface can also serve as an expansion bus for multiple IMS devices.
      <br/>
      The management port 36 interfaces to an external MAC engine through a standard seven-wire inverted serial GPSI interface, enabling a host controller access to the multiport switch 12 via a standard MAC layer protocol.
    </p>
    <p num="25">
      FIG. 3 depicts the switch subsystem 70 of FIG. 2 according to an exemplary embodiment of the present invention.
      <br/>
      Other elements of the multiport switch 12 of FIG. 2 are reproduced in FIG. 3 to illustrate the connections of the switch subsystem 70 to these other elements.
      <br/>
      The switch subsystem 70 contains the core switching engine for receiving and forwarding frames.
      <br/>
      The main functional blocks used to implement the switching engine include: a port vector FIFO 63, a buffer manager 65, a plurality of port output queues 67, a management port output queue 75, an expansion bus port output queue 77, a free buffer pool 104, a multicopy queue 90, a multicopy cache 96 and a reclaim queue 98.
    </p>
    <p num="26">
      There are two basic types of frames that enter the multiport switch 12 from the ports: unicopy frames and multicopy frames.
      <br/>
      A unicopy frame is a frame that is received at a port which is to be transmitted by the multiport switch 12 to only one other port.
      <br/>
      By contrast, a multicopy frame is a frame that is received at one port for transmission to more than one port.
      <br/>
      In FIG. 3, each port is represented by a corresponding MAC 60, 62, or 36 having its own receive FIFO 64 and transmit FIFO 66.
    </p>
    <p num="27">
      Frames, whether unicopy or multicopy, are received by the internal MAC engines 60, 62, or 36, and placed in the corresponding receive FIFO 64.
      <br/>
      Each data frame has a header including at least a destination address, a source address, and type/length information.
      <br/>
      The header of the received packet is also forwarded to a decision making engine to determine which MAC ports will output the data packet.
      <br/>
      The multiport switch 12 supports two decision making engines, an internal rules checker (IRC) 68 and an external rules checker (ERC) 44. In order for the ERC 44 to function, the multiport switch 12 sends data to the ERC 44 via the external rules checker interface (ERCI) 42. The ERCI 42 is enabled and disabled via a rules checker configuration register 74 located on the multiport switch 12.
      <br/>
      The IRC 68 and ERCI 42 do not operate simultaneously.
      <br/>
      The IRC 68 and ERC 44 provide the decision making logic for determining the destination MAC port for a given data packet.
      <br/>
      The decision making engine may determine that a given data packet is transmitted to either a single port, multiple ports, or all ports (i.e., broadcast).
    </p>
    <heading>CAPTURING SOURCE AND DESTINATION TRAFFIC</heading>
    <p num="28">
      The present invention is directed to using the internal rules checker (IRC) to monitor data conversations in the network.
      <br/>
      A description will first be given of the IRC 68 followed by the detailed description of the method and apparatus for capturing source and destination traffic.
      <br/>
      As described above, the switch subsystem 70 provides the switching logic for receiving and forwarding frames to the appropriate output ports.
      <br/>
      The forwarding decisions, however, are made by either the IRC 68 located on the multiport switch 12 or the ERC 44 located off the multiport switch 12.
    </p>
    <p num="29">
      Both the IRC 68 and ERC 44 perform the same functions utilizing the same basic logic.
      <br/>
      In the normal mode of operation, only one of the two rules checkers is active at any given time.
      <br/>
      The ERC 44 makes the frame forwarding decisions when the ERCI 42 is enabled.
      <br/>
      The ERCI 42 is enabled in the rules checker configuration register located with the PCI control/status registers 74.
      <br/>
      The description that follows assumes that the ERCI 42 is disabled and hence, the IRC 68 makes the frame forwarding decisions.
    </p>
    <p num="30">
      The multiport switch 12 supports virtual local area networks, or VLANs, for creating logical workgroups of users who may be physically separated from each other.
      <br/>
      VLAN groupings provide privacy and security to members of the groupings.
      <br/>
      In addition, VLANs provide "broadcast domains" whereby broadcast traffic is kept "inside" the VLAN.
      <br/>
      For example, a specific VLAN may contain a group of users at a high level of an organization.
      <br/>
      When sending data to this group of users, the data may include a specific VLAN identifier associated with this particular group to ensure that only these users receive the data.
      <br/>
      These VLAN groupings can be thought of as "sub-networks" within a larger network.
      <br/>
      Among other benefits, VLANs can greatly reduce the time an information systems manager spends processing adds, moves and changes within a network environment.
    </p>
    <p num="31">
      When the multiport switch 12 receives a frame, it sends the frame pointer (pointing to the location in external memory 34 where the frame is stored), the receive port number, destination address (DA), source address (SA) and VLAN ID (if applicable) to the IRC 68.
      <br/>
      FIG. 4 illustrates the IRC 68 which includes an IRC controller 104 and address table 106.
      <br/>
      In the exemplary embodiment, the address table 106 is within the IRC 68.
      <br/>
      In alternative embodiments, the address table 106 may be located outside the IRC 68 within another part of the multiport switch 12 or even external to the multiport switch 12, as in the case of the ERC 44.
    </p>
    <p num="32">
      In the exemplary embodiment, a host processor 120 functions as the management agent and is connected to the IRC 68 via the PCI interface 39, which functions as the management port.
      <br/>
      Alternatively, a management MAC 38 may be connected to the management port 36 to function as the management agent.
    </p>
    <p num="33">
      In the exemplary embodiment, the address table 106 supports 512 user addresses and capabilities for 32 unique VLANs.
      <br/>
      However, the number of addresses and VLANs supported may be increased by expanding the table size.
    </p>
    <p num="34">
      FIG. 5 illustrates an exemplary organization of the IRC address table 106.
      <br/>
      The IRC address table 106 contains an array of 512 entries.
      <br/>
      The first "n" entries 108 are referred to as "bin entries" and have addresses from "0" to "n-1".
      <br/>
      The remaining entries 110 are referred to as "heap entries" and have addresses from "n" to "511".
      <br/>
      Each of the entries includes a 12-byte address entry and a 9-bit "next pointer" field.
    </p>
    <p num="35">
      FIG. 6 illustrates the composition of each 12-byte address entry shown in FIG. 5.
      <br/>
      A valid bit indicates whether the entry is valid to search for a forwarding port vector.
      <br/>
      If the valid bit is cleared, the address entry is not to be used when searching for a DA/VLAN index match.
      <br/>
      A hit bit is used for address entry aging.
      <br/>
      When the IRC 68 finds a source address/receive port number match, the IRC 68 sets the hit bit.
      <br/>
      The host can read and clear this bit, then periodically poll for a cleared bit, to implement an aging algorithm.
    </p>
    <p num="36">
      A VLAN tag disable bit allows the IRC 68 to selectively disable tagging for frames to be forwarded to a tagged 100 Mb/s port.
      <br/>
      If tagging is enabled on a particular 100 Mb/s port, the VLAN tag disable bit overrides tagging for the particular DA address directed to the 100 Mb/s port.
    </p>
    <p num="37">Source and destination traffic capture 1 and 2 identify traffic capture source and destination MAC addresses for mirroring MAC or port conversations to the management port.</p>
    <p num="38">
      The VLAN index is a 5-bit field used to reference a 16-bit VLAN identifier.
      <br/>
      The port number identifies the port on which the associated address resides.
      <br/>
      The port vector provides the forwarding vector for forwarding the data frames.
    </p>
    <p num="39">
      The address entries include addresses for both source addresses and destination addresses.
      <br/>
      The addresses can be unicast, multicast or broadcast.
      <br/>
      A physical/multicast (P/M) bit is also included in the address field.
    </p>
    <p num="40">
      The host processor 120 is responsible for initializing the values in the address table 106.
      <br/>
      Upon power-up, the host loads values into the bin entries 108 based on the network configuration, including VLAN configurations.
      <br/>
      The heap entries 110 are not fixed at power-up and are used for adding entries to the table.
      <br/>
      The IRC 68 uses the specific fields of the address table 106 to make frame forwarding decisions, as described in detail below.
      <br/>
      More specifically, the IRC controller 104 includes control logic to search the address table 106 for frame forwarding information in the form of a port vector.
      <br/>
      The IRC 68 transmits the port vector along with the frame pointer, VLAN index and a control opcode to the port vector FIFO 63, as shown in FIG. 3.
    </p>
    <p num="41">
      The multiport switch 12 receives frames from both untagged and tagged ports.
      <br/>
      All of the 10 Mb/s ports connected to the multiport switch 12 are untagged.
      <br/>
      The two 100 Mb/s ports may be tagged or untagged.
      <br/>
      The management ports and expansion bus ports are also untagged.
      <br/>
      The IRC 68 performs its logic functions for tagged and untagged ports differently.
    </p>
    <p num="42">
      An exemplary network data packet is shown in FIG. 7A for untagged frame format, and FIG. 7B for tagged frame format.
      <br/>
      Untagged frames, as shown in FIG. 7A are formatted in accordance with IEEE 802.3 and tagged frames are formatted in accordance with IEEE 802.1d. Each untagged frame 140 and tagged frame 142 includes a 6-byte destination address field, a 6-byte source address field, a 2-byte type/length field, a variable length data field having a field width of 46 bytes to 1500 bytes, and a 4-byte frame check sequence (FCS) field.
      <br/>
      Each tagged frame 142 also includes a VLAN tag including a 2-byte VLAN Ethertype field and a 2-byte VLAN ID field.
      <br/>
      As recognized in the art, both the untagged frame and the tagged frame will be preceded by a 56-bit preamble, and an 8-bit start frame delimiter (SFD).
    </p>
    <p num="43">
      The host processor 120 maps the 16-bit VLAN IDs into 5-bit VLAN indexes in a VLAN index-to-identifier (ID) table.
      <br/>
      In this manner, the entire 16-bit VLAN identifier does not have to be transmitted with the frame forwarding information to the port vector FIFO 63.
      <br/>
      Instead, only a 5-bit VLAN index is transmitted along with the frame forwarding information, thereby saving data transmission time.
      <br/>
      In the exemplary embodiment, the VLAN index-to-ID table is located with the PCI control/status registers 74.
      <br/>
      Alternatively, the VLAN index-to-ID table may be located in the IRC 68.
    </p>
    <p num="44">A detailed description of IRC operations for processing data from untagged ports is described below, followed by a detailed description of IRC operations for tagged ports.</p>
    <p num="45">
      When the multiport switch 12 receives a frame from an untagged port, the receive MAC 60 strips off the DA and SA and sends this information to the IRC 68 along with the receive port number and frame pointer.
      <br/>
      The IRC controller 104 searches the address table 106 twice: once for an SA and receive (RX) port number match (to find a VLAN index) and once for a DA and VLAN index match (to find a forwarding port vector).
      <br/>
      The searches occur as follows:
    </p>
    <p num="46">Search 1: (SA, RX Port Number)=&gt;VLAN Index</p>
    <p num="47">Search 2: (DA, VLAN Index*)=&gt;Forwarding Port Vector</p>
    <p num="48">* VLAN Index found during Search 1</p>
    <p num="49">
      FIG. 8 illustrates an example of the search of the address table 106 by the IRC controller 104.
      <br/>
      For simplicity, this example illustrates only a portion of the address table and each field is shown as consisting of only three bits.
      <br/>
      However, in the exemplary embodiment, the address field is actually 48 bits and the port number field is five bits.
      <br/>
      In FIG. 8, the "X"s represent any given data stored by the host in the table.
    </p>
    <p num="50">
      Assume that the SA for a received frame is "001" and the receive port number is "010".
      <br/>
      The IRC controller 104 searches the address table and finds a SA/receive port number match at the second address entry.
      <br/>
      The VLAN index at this entry is "100".
    </p>
    <p num="51">
      The IRC controller 104 uses this VLAN index, "100", in a second search of the address table.
      <br/>
      For simplicity, assume that the DA of the received frame is "101".
      <br/>
      The IRC controller 104 searches the address table and finds a DA/VLAN index match at the fourth address entry.
      <br/>
      The port vector at this address entry (indicated by asterisks) contains the forwarding decision information necessary for forwarding the data frame.
      <br/>
      Specifically, the port vector in the exemplary embodiment is a 28-bit vector with a bit for set for each output port identified as a destination port to which the data frame should be forwarded.
      <br/>
      The 28-bit vector includes one bit for each of: the 24 10 Mb/s ports, two 100 MB/s ports, management port and expansion port.
      <br/>
      For example, for a unicopy frame only one bit corresponding to the one destination port is set in the port vector.
      <br/>
      For a broadcast frame, the port vector consists of all "1's", indicating that the frame will be transmitted to all the ports.
      <br/>
      However, in the exemplary embodiment, the IRC controller 104 masks out the bit in a port vector representing the port from which the data frame is received.
      <br/>
      This avoids sending a data frame back to the port on the multiport switch 12 from which it was received.
    </p>
    <p num="52">
      The IRC controller 104 sends the forwarding port vector along with the frame pointer, VLAN index identified in search 1 and a control opcode to the port vector FIFO 63 for forwarding the data frame to the appropriate output port(s).
      <br/>
      The control opcode includes various control information associated with traffic capture, the IRC address and the management port/tagging.
    </p>
    <p num="53">
      When frames are received from a tagged port, the frame may or may not contain a VLAN tag.
      <br/>
      The receive MAC 62 checks the frames for VLAN tags.
      <br/>
      If a frame contains a VLAN tag, the receive MAC 62 strips the VLAN identifier in the tag and writes the VLAN identifier to the buffer header of the first buffer in external memory 34 used to store the frame's data.
      <br/>
      The IRC 68 checks whether the tagged port's received frame contains a VLAN type which matches the VLAN type in a VLAN Ethertype register.
      <br/>
      The VLAN Ethertype field is assigned according to IEEE standards.
      <br/>
      When the VLAN type in the received frame does not match the contents of the VLAN Ethertype register, the IRC 68 assumes the frame is untagged.
      <br/>
      In the exemplary embodiment, the VLAN Ethertype register is located with the PCI control/status registers 74.
      <br/>
      Alternatively, the VLAN Ethertype register may be located in the IRC 68.
    </p>
    <p num="54">
      As discussed above, when the multiport switch 12 port receives a frame from a tagged port, it may or may not contain a VLAN tag.
      <br/>
      In either case, the receive MAC 62 sends the receive port number, frame pointer, DA and SA to the IRC 68.
      <br/>
      If the VLAN tag is present, the VLAN tag is also sent to the IRC 68.
      <br/>
      However, the IRC 68 operates differently depending on whether the tag is present.
    </p>
    <p num="55">
      When a VLAN tag is present, the IRC controller 104 uses the VLAN ID contained in the received frame and searches the VLAN index-to-ID table for a VLAN ID match.
      <br/>
      If a match occurs, the associated VLAN index is assigned to the frame.
      <br/>
      The IRC 68 then searches the address table for the SA/receive port number using the same searching method as performed for untagged frames, discussed above.
      <br/>
      However, the IRC controller 104 does not "police" the VLAN index identified in the VLAN index-to-ID table, based on the received VLAN ID, by comparing it to the VLAN index found in the SA/Rx port number search.
      <br/>
      The IRC controller 104 uses the VLAN index found in the VLAN index-to-ID table and performs a DA/VLAN index search, as described above.
      <br/>
      The IRC controller 104 identifies the forwarding port vector from the matched DA/VLAN index search.
    </p>
    <p num="56">The IRC controller 104 sends the forwarding port vector along with the frame pointer, VLAN index from the VLAN index-to-ID table and a control opcode to the port vector FIFO 63 for forwarding the data frame to the appropriate output port (s), in the same manner as for data from untagged ports.</p>
    <p num="57">
      When a VLAN tag is not present in a data frame received from a tagged port, the IRC 68 executes an SA/receive port number search to find a VLAN index and then executes a DA/VLAN index search to obtain a port vector as described above for untagged frames.
      <br/>
      The IRC controller 104 also sends the forwarding port vector along with the frame pointer, VLAN index and a control opcode to the port vector FIFO 63 for forwarding the data frame to the appropriate output port(s), in the same manner as for data from untagged ports.
    </p>
    <p num="58">
      In the present invention, the time spent searching the address table for a SA/receive port number match and then for a VLAN index/DA match in the manner discussed above (for both untagged and tagged ports) may be time consuming.
      <br/>
      In certain situations, searching the entire address table of 512 address entries may result in unacceptable delays in the network.
    </p>
    <p num="59">
      The time spent searching the address table may be reduced by searching only a subset of the address entries.
      <br/>
      The IRC controller 104 of the present invention saves processing time by performing a programmable hash function in the receive MAC 60 or 62.
    </p>
    <p num="60">FIG. 9 is a block diagram illustrating the functional components of the multiport switch 12 and the host 40 associated with searching the address table using programmable hash keys.</p>
    <p num="61">
      As described above, the multiport switch 12 needs to make frame forwarding decisions relatively quickly, since multiple data frames may be received by the multiport switch 12 simultaneously.
      <br/>
      Hence, the present invention may use a hashing scheme, where the address information from the header of a received data packet is processed using a hashing function, described below, to obtain index information.
    </p>
    <p num="62">
      As shown in FIG. 9, the multiport switch 12 includes a hash function circuit 100 configured for generating a hash polynomial h(x) for the address of the data packet according to a user-specified hash function.
      <br/>
      The user-specified hash function, stored in a user-programmable register (HASHPOLY) 74a, includes a 12-bit value defining the hash polynomial used by the hash function circuit 100, described in detail below.
      <br/>
      The hash polynomial output by the hash function circuit 100 is output to a logic circuit, for example a 12-bit parallel AND gate, that selectively outputs the lower significant bits of the hash-generated polynomial based upon a polynomial enable value (POLYEN) stored in register 74b.
      <br/>
      The field "POLYEN" defines how many bits of the hash polynomial are used to create the bin number, and preferably having a maximum value of seven (7).
      <br/>
      For example, if POLYEN=5, then the multiport switch uses the lower 5 bits of the output of the hash key (i.e., h(address)) after hashing on the address.
      <br/>
      Hence, the hash key output by the logic circuit 102 is based upon masking the 12-bit hash-generated polynomial output by the hash function circuit 100 using the stored register value POLYEN in register 74b to obtain a hash key having a prescribed number of bits corresponding to the number of bin entries, described below.
    </p>
    <p num="63">
      As shown in FIG. 9, the hash function circuit 100 and the logic circuit 102 are separate from the internal rules checker 68.
      <br/>
      The hash function circuit 100 and the logic circuit 102 may be implemented separately within the multiport switch 12, or may be incorporated within the functionality of each MAC port 60 or 62.
      <br/>
      Alternatively, the hash function circuit 100 and the logic 102 may be incorporated as part of the internal rules checker 68.
      <br/>
      Moreover, it will be appreciated that the programmable hashing described herein may be applied to the external rules checker 44, as desired.
    </p>
    <p num="64">
      As shown in FIG. 9, the internal rules checker 68 includes an internal controller 104 and a network address table 106, described in detail above and with reference to FIG. 4.
      <br/>
      The controller 104 accesses the address table 106 based upon the supplied hash key from the logic circuit 102 in order to obtain the necessary information to make a forwarding decision based upon the source address, receive port, destination address, and VLAN associations.
      <br/>
      Once the necessary forwarding information has been obtained, the controller 104 outputs a port vector to the switch subsystem 70, which outputs the received data packet to the appropriate ports based upon the information in the port vector.
    </p>
    <p num="65">
      The address table 106 of FIG. 9 is the same address table 106 described in detail with reference to FIG. 5.
      <br/>
      The address table 106 consists of 512 address entries including a first addressable range 108 of bin entries, and a second addressable range 110 of heap entries.
      <br/>
      The memory structure of FIG. 5 provides an indexed arrangement, where a given network address will be assigned to a corresponding bin.
      <br/>
      In other words, each bin entry 112 is configured to reference a plurality of table entries (i.e., heap entries) 114.
      <br/>
      Hence, the controller 104 performs a search of the address table 106 by first accessing a specific bin 112 pointed to by the hash key, and then searching the entries within (i.e., referenced by) the corresponding bin to locate the appropriate match.
    </p>
    <p num="66">
      Each bin entry 112 is the starting point for the search by the IRC controller 104 for a particular address within the address table 106.
      <br/>
      A bin entry may reference no addresses (i.e., be empty), may reference only one address within the bin entry location, or may reference a plurality of addresses using a linked list chain structure.
    </p>
    <p num="67">
      FIG. 10 is a diagram illustrating bin entries referencing a different number of table entries.
      <br/>
      Each of the bin entries 112 and heap entries 114 includes a 12-byte address field and a 9-bit "next pointer" field.
      <br/>
      The "next pointer" field associated with the bin entry 112 identifies the location of the next entry in the chain of linked list addresses.
      <br/>
      For example, Bin 3112c of FIG. 10 does not have any associated table entries.
      <br/>
      In such a case, the 12-byte address entry equals zero (or another null value), and the bin's corresponding "next pointer" field will have a value of "1", indicating no entries for the corresponding bin.
      <br/>
      If a bin such as bin 1, 112b, contains a single table entry, the bin entry will store the switching logic data for that single address in its address entry field, and store the value "zero" in the "next pointer" field, indicating there are no further address entries in the chain.
      <br/>
      Bin 0, 112a, however, references four addresses by using the "next pointer" field to identify the location of the next entry in the chain.
      <br/>
      The additional entries 114b and 114c in the bin are linked in no particular order into a linear list, as shown in FIG. 10. Thus, the first entry of Bin 0 is stored in the address entry field of the bin entry 112a and the next entry (heap entry 114a) is referenced by address entry "a" in the next pointer field of the bin entry 112a.
    </p>
    <p num="68">
      As described above, it is desirable to provide an even distribution of incoming network addresses across the available bin entries.
      <br/>
      Depending upon the number of bins that are programmed by the value POLYEN in register 74b, there will be a distribution of addresses across all the bins, such that the number of addresses in each bin is generally uniform, enabling the amount of time required to search for a specific address field to be controlled to a finite value.
      <br/>
      For example, if each bin had fifteen entries, then the IRC controller 104 would only need to search the fifteen entries of a bin, as opposed to searching for 512 entries, where the bin is identified based upon the corresponding hash key.
    </p>
    <p num="69">
      However, different hash functions may generate different distribution results, causing certain hash functions to map more addresses to one bin than another bin, depending upon the nature of the network addresses.
      <br/>
      Hence, certain hash function values may be inappropriate for a certain set of network addresses.
    </p>
    <p num="70">
      The disclosed embodiment enables monitoring of the number of table entries for a given bin, such that the hash function circuit 100 is selectively reprogrammed by rewriting the HASHPOLY value in register 74a with another value specifying another user-specified hash function.
      <br/>
      Specifically, the host 40 of FIG. 3 includes a host processor 120 that monitors the number of table entries for each bin.
      <br/>
      The host 40 also includes a nonvolatile memory 122 that stores a plurality of hash configuration values specifying respective available hash functions.
      <br/>
      The host processor 120 monitors the bin entries for the number of corresponding table entries, and selectively reprograms the HASHPOLY value stored in register 74a with another one of the available hash function values stored in registers 122a, 122b, 122c, etc. in response to the number of table entries exceeding a prescribed threshold.
    </p>
    <p num="71">
      The programmable hash polynomial is based upon a 12-bit value representing the coefficients of a 12th order polynomial.
      <br/>
      Hence, the HASHPOLY register value of "0000 1001 1001" (loaded from host memory 122a) corresponds to the hash polynomial h(x)=x12 +x7 +x4 +x3 +1, the HASHPOLY register value of "0000 0101 0011" (loaded from host memory 122b) corresponds to the hash polynomial h(x) =x12 +x6 +x4 +x+1, and the HASHPOLY register value of "0001 0110 0001" (loaded from host memory 122c) corresponds to the hash polynomial h(x)=x12 +x8 +x6 +x5 +1.
      <br/>
      The term x12 is assumed to always equal "1," and hence is not stored in the HASHPOLY register.
      <br/>
      These hash polynomials are preferred because they are prime polynomials, although other polynomials may be used for the hash polynomial.
    </p>
    <p num="72">
      Hence, the host processor 120 monitors the structure of the address table 106, and determines the number of table entries 114 for a given bin entry 112.
      <br/>
      If the number of entries in any bin exceeds a prescribed threshold (e.g., sixteen table entries in a bin), the processor 120 could reprogram the HASHPOLY register 74a with a new hash polynomial.
    </p>
    <p num="73">
      FIG. 11 is a block diagram illustrating a hash polynomial generator 100 as a serial hardware implementation of the programmable hash polynomial h(x).
      <br/>
      It will be recognized in the art that a similar parallel hardware implementation may be used for the programmable hash polynomial h(x).
      <br/>
      The hash polynomial generator 100 includes a series of AND gates 202, a series of exclusive OR gates (XOR) 204, and a shift register 206.
    </p>
    <p num="74">
      The hash polynomial generator 100 is configured by the programmable hash polynomial h(x) by receiving the bit-by-bit outputs from the HASHPOLY register 74a.
      <br/>
      Hence, each bit of the HASHPOLY register 74a drives a corresponding AND gate 202, such that a bit having a value of "1" in the HASHPOLY register 74a sets the output of the corresponding AND gate 202 equal to the bit stream value output from the XOR gate 20413.
    </p>
    <p num="75">
      The host 40 or management entity then programs the number of bins by setting a field "POLYEN" within a hash function configuration register 74b.
      <br/>
      The field POLYEN specifies the addressable bin range, and hence can be used as a mask for the hash polynomial to generate the appropriate hash key.
      <br/>
      Hence, the multiport switch will use only the lowest bits of the 12-bit hash function output to identify the bin.
      <br/>
      The selected bin will fall within the range of bins 0, N-1, where N=2POLYEN.
    </p>
    <p num="76">
      Hence, the host reprograms the hash key periodically by reprogramming the hash function register 74a.
      <br/>
      The host processor 120 reprograms the hash key by clearing the address table.
      <br/>
      The host processor 120 then changes the hash function by reprogramming the hash function register 100, and then allows the internal rules checker to relearn the addresses into new bins.
      <br/>
      Alternatively, the host can perform the new hash function in software, and load the address table with the new address table entries based on the new hash function.
    </p>
    <p num="77">
      Hence, the disclosed embodiment enables the hash function to be programmable on a network by network basis.
      <br/>
      The host can reprogram the HASHPOLY register 74a by storing a set of preferred hash polynomials, and selecting a new polynomial from the set of preferred hash polynomials in response to detecting the number of entries in a bin exceeding the prescribed threshold.
      <br/>
      Hence, the disclosed arrangement enables the hash key generation to be optimized for different network configurations.
    </p>
    <p num="78">
      The operation of the multiport switch 12 described above considers the reception of data frames from both untagged and tagged ports.
      <br/>
      The description above assumes that the IRC 68 finds the SA/receive port number match and the DA/VLAN index match in the address table 106, using the hashing scheme described above, and forwards the appropriate port vector to the port vector FIFO 63.
      <br/>
      However, data may be received by the multiport switch in which one or both of the address table searches results in no match.
      <br/>
      This may be due to a new station that is added to the network after the host has initially configured the address table 106.
    </p>
    <p num="79">
      When an address is received from a station that does not have an entry in the address table 106, the IRC 68 may learn the new address and add an entry to the address table 106 for that particular station.
      <br/>
      Alternatively, the host 120 may also add stations to the address table 106.
      <br/>
      In order to facilitate changes to the address table 106, the host 120 generates and maintains a software mapping of the address table 106.
      <br/>
      When the host 120 adds an entry to the address table 106, the host 120 inserts addresses and their associated fields into the table 106 and updates its software mapping of the address table 106.
      <br/>
      Alternatively, the host 120 may change particular fields within an entry in the address table 106, such as the valid bit field, and update the software mapping of the table upon completion.
      <br/>
      When the IRC 68 learns a new address, the IRC 68 sends the host 120 the information so that the host 120 can maintain an accurate mapping of the address table 106.
    </p>
    <p num="80">
      The host 120 accesses the IRC address table 106 through two ports in direct I/O space: an IRC address port and an IRC data port.
      <br/>
      These two ports provide access to five IRC address table entry registers in indirect I/O space through which the host 120 can manipulate any field in any entry in the table 120.
      <br/>
      These five indirect I/O space registers contain all the fields of an address table entry, plus the next pointer field.
      <br/>
      The IRC address table entry registers are: address table control register (accesses valid bit, hit bit, VLAN tag disable, SA/DA traffic capture, VLAN index and port number), port vector register (accesses port vector), upper address register (accesses upper 16 bits of address), lower address register (accesses lower 32 bits of address) and next pointer register (accesses next pointer).
    </p>
    <p num="81">
      FIG. 12 is a schematic representation of the IRC address port in relation to the IRC address table 106.
      <br/>
      The host 120 accesses any of the five registers by writing the desired address table entry number and a desired register index into the IRC address port.
      <br/>
      The register index identifies which of the five registers will be read/written from/to.
      <br/>
      The host 120 then reads or writes data into the desired IRC address table entry register(s).
      <br/>
      An autoincrement bit may be set by the host 120 that enables the host 120 to read/write complete address table entries.
      <br/>
      When the autoincrement bit is set, each field is written to a corresponding IRC address table entry register and when the host 120 writes the last register (next pointer register), all of the IRC address table entry registers are written as a single entry into the address table 106.
      <br/>
      Alternatively, if the autoincrement bit is not set, the host 120 may read/write to any given register individually.
    </p>
    <p num="82">
      As discussed above, the IRC controller 104 searches the address table twice, first for an SA/Rx port number match and second for a DA/VLAN index match.
      <br/>
      In the exemplary embodiment, as shown in FIG. 6, each entry in the IRC address table 106 includes four bits designated as source and destination traffic capture 1 (two bits) and source and destination traffic capture 2 (two bits).
      <br/>
      The host 120 sets the traffic capture bits in order to mirror predetermined data conversations to the management port.
      <br/>
      This allows the management agent to snoop on conversations between two stations on different ports or conversations between two ports.
    </p>
    <p num="83">
      FIG. 13 illustrates an example of capturing data conversations for an untagged frame.
      <br/>
      The process for capturing data conversations for tagged frames uses the same procedure regarding the data capture bits.
      <br/>
      However, the IRC controller 104 performs the search of the address table 106 in accordance with the description above for tagged frames.
      <br/>
      For simplicity, this example uses the same portion of the address table 106 illustrated in FIG. 8 and also uses the same field widths illustrated in FIG. 8.
      <br/>
      The source address (SA) traffic capture 1 field and destination address (DA) traffic capture 1 field each consist of a single bit.
      <br/>
      Similarly, SA traffic capture 2 and DA traffic capture 2 each consist of a single bit.
    </p>
    <p num="84">
      Assume that the SA for a received frame is "001" and the receive port number is "010".
      <br/>
      The IRC controller 104 searches the address table 106 and finds an SA/RX port number match at the second address entry.
      <br/>
      The VLAN index at this entry is "100".
      <br/>
      The IRC controller 104 also checks the SA traffic capture fields at the second address entry and determines that the SA traffic capture 2 bit is set in the second address entry.
      <br/>
      The IRC controller 104 saves the SA traffic capture 2 bit.
    </p>
    <p num="85">
      Next, the IRC controller 104 uses the VLAN index found in search 1, "100", and performs a second search of the address table 106.
      <br/>
      For simplicity assume that the DA of the received frame is "101".
      <br/>
      The IRC controller 104 searches the address table 106 and finds a DA/VLAN index match at the fourth address entry.
      <br/>
      The IRC controller 104 also checks the DA traffic capture fields at the fourth address entry and determines that DA traffic capture 2 bit is set in the fourth address entry.
      <br/>
      The IRC controller 104 saves the DA traffic capture 2 bit.
      <br/>
      Therefore, the IRC controller 104 determines that both the SA traffic capture 2 and DA traffic capture 2 bits are set.
      <br/>
      The IRC controller 104 then identifies that the data conversation between address "001" on receive port "010" and address "101" on receive port "111" for mirroring to the management port, based on the SA/DA traffic capture 2 bits.
    </p>
    <p num="86">
      The IRC controller 104 also identifies the forwarding port vector (indicated by asterisks) at the fourth address entry.
      <br/>
      The IRC controller 104 sends the forwarding port vector along with the frame pointer, VLAN index identified in search 1 and a control opcode to the port vector FIFO for forwarding the data frame to the appropriate output port(s).
      <br/>
      The IRC controller 104 generates the control opcode which includes a field indicating that the data frame is to be mirrored to the management port as traffic capture 2 frame.
      <br/>
      In this manner, the management agent monitors traffic between two stations.
      <br/>
      Alternatively, the management agent may monitor data traffic between two ports by setting the SA/DA traffic capture bits for all addresses on the two ports in which conversation capture is desired.
    </p>
    <p num="87">
      As discussed above, the host 120 is responsible for initializing the SA/DA traffic capture bits.
      <br/>
      The host 120 may also alter these bits using the IRC address port and IRC data port as shown in FIG. 12. For example, the host 120 may decide to change which data conversations it wishes to monitor.
      <br/>
      The host 120 then uses the address table control register to set up different conversations for mirroring by writing to the SA/DA traffic capture fields in the appropriate address entries.
      <br/>
      In the exemplary embodiment, the address table 106 includes fields for monitoring two separate conversations between designated stations/ports concurrently.
      <br/>
      Alternatively, the IRC address table 106 may be configured to monitor more conversations by expanding the number of traffic capture bits in the address table.
    </p>
    <p num="88">
      Described has been a system and method for monitoring data conversations between predetermined ports or stations.
      <br/>
      An advantage of the invention is that the data traffic is monitored with little additional processing overhead and requires little additional space on the switch.
      <br/>
      Another advantage of the invention is that the host may change the conversations it wishes to monitor at any time.
      <br/>
      In this disclosure, there is shown and described only certain preferred embodiments of the invention, but, as aforementioned, it is to be understood that the invention is capable of use in various other combinations and environments and is capable of changes or modifications within the scope of the inventive concept as expressed herein.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A multiport switch configured for controlling communication of data frames between stations, comprising:</claim-text>
      <claim-text>a receive device for receiving data frames; an address table for storing address information including both source addresses and destination addresses;</claim-text>
      <claim-text>and a control device configured to identify a data frame being transmitted between designated stations, wherein the address table comprises an address field, a virtual local area network (VLAN) field, a port number field and a traffic capture field, the traffic capture field has at least one two-bit indicator for source and destination traffic capture, and the bits of the two-bit indicator for source and destination traffic capture are respectively set when the data conversations of the corresponding source and destination addresses are to be monitored.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. The multiport switch of claim 1, wherein the control device is configured to: receive information from a data frame and search the address table for data forwarding information based on the received information, the data forwarding information including information indicating the identified data frame is to be forwarded to a management agent.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. A multiport switch configured for controlling communication of data frames between stations, comprising: a receive device for receiving data frames; an address table for storing address information including both source addresses and destination addresses;</claim-text>
      <claim-text>and a control device configured to identify a data frame being transmitted between designated stations, wherein the control device is configured to:</claim-text>
      <claim-text>- receive a source address of the data frame, a destination address of the data frame and a receive port number indicating the port on which the data frame was received, - search the address table for a first entry having the source address of the frame and the receive port number, - determine whether a first traffic capture field is set in the first entry, - search the address table for a second entry having the destination address of the frame and a specified VLAN index the second entry identifying first data forwarding information and - determine whether a second traffic capture field is set in the second entry.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. The multiport switch of claim 3, wherein the control device is further configured to: generate second data forwarding information indicating that the data frame is to be forwarded to a predetermined location based on the first and second traffic capture fields in the first and second entries, respectively.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. In a multiport switch that controls communication of data frames between stations, the multiport switch including an address table for storing address entries, a method of monitoring data traffic comprising: receiving information from a data frame, the information including a source address and destination address; identifying a data frame being transmitted between designated stations; transmitting the identified data frame to a predetermined location, wherein the address table comprises an address field, a virtual local area network (VLAN) field, a port number field and a traffic capture field, received; searching the address table for a first entry with the source address and a receive port number of the data frame; determining whether a first traffic capture field is set in the first entry; searching the address table for a second entry having the destination address of the data frame and a specified VLAN index;</claim-text>
      <claim-text>and determining whether a second traffic capture field is set in the second entry.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. The method of claim 5, further comprising: transmitting the data frame to a predetermined location based on the first and second traffic capture fields in the first and second entries, respectively.</claim-text>
    </claim>
    <claim num="7">
      <claim-text>7. A multiport switch configured for controlling communication of data frames between stations, comprising: a table configured for storing address information indicating both source addresses and destination address of data frames and for storing traffic capture information; a control device configured to receive information from a data frame including a source address and a destination address of the data frame, the control device further configured to: - search the table for a first entry with the source address of the data frame and a receive port number indicating the port on which the data frame was received, - determine whether a first traffic capture field in the first entry is set, - search the table for a second entry with the destination address of the data frame and a specified VLAN index, wherein the second entry identifies first data forwarding information, and - determine whether a second traffic capture field in the second entry is set.</claim-text>
    </claim>
    <claim num="8">
      <claim-text>8. The multipart switch of claim 7, wherein the control device is further configured to: generate second data forwarding information, indicating the data frame is to be forwarded to a predetermined location, based on the first and second traffic capture fields in the first and second entries, respectively.</claim-text>
    </claim>
    <claim num="9">
      <claim-text>9. The multiport switch of claim 8, wherein the first and second data forwarding information identify each port from which the data frame will be transmitted.</claim-text>
    </claim>
    <claim num="10">
      <claim-text>10. In a multiport switch that controls communicating of data frames between stations, a method of capturing data conversations comprising: setting data monitoring for a pair of stations; receiving data frames from stations connected to the multiport switch; monitoring data conversations between the pair of stations; capturing a data conversation between the pair of stations;</claim-text>
      <claim-text>and transmitting the captured data conversation to a predetermined location, wherein the monitoring step further comprises: - monitoring source addresses and destination addresses of data frames, the source and destination addresses indicating data conversations between stations, and the transmitting step further comprises: - transmitting the captured data conversations to a management agent;</claim-text>
      <claim-text>and - transmitting the captured conversation to an appropriate output port on the multiport switch, based on a destination address included in the data conversation.</claim-text>
    </claim>
  </claims>
</questel-patent-document>