<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06182237B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06182237</doc-number>
        <kind>B2</kind>
        <date>20010130</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6182237</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference is-representative="YES" family-id="22510004" extended-family-id="42109105">
      <document-id>
        <country>US</country>
        <doc-number>09144758</doc-number>
        <kind>A</kind>
        <date>19980831</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1998US-09144758</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>43165764</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>14475898</doc-number>
        <kind>A</kind>
        <date>19980831</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1998US-09144758</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010130</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>G01R  31/30        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>01</class>
        <subclass>R</subclass>
        <main-group>31</main-group>
        <subgroup>30</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>G06F   1/04        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>1</main-group>
        <subgroup>04</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="3">
        <text>H03D  13/00        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>03</class>
        <subclass>D</subclass>
        <main-group>13</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="4">
        <text>H04L   7/00        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>7</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>713503000</text>
        <class>713</class>
        <subclass>503000</subclass>
      </main-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>G01R-031/30D</text>
        <section>G</section>
        <class>01</class>
        <subclass>R</subclass>
        <main-group>031</main-group>
        <subgroup>30D</subgroup>
      </classification-ecla>
      <classification-ecla sequence="2">
        <text>G06F-001/04</text>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>1</main-group>
        <subgroup>04</subgroup>
      </classification-ecla>
      <classification-ecla sequence="3">
        <text>H03D-013/00B</text>
        <section>H</section>
        <class>03</class>
        <subclass>D</subclass>
        <main-group>013</main-group>
        <subgroup>00B</subgroup>
      </classification-ecla>
      <classification-ecla sequence="4">
        <text>H04L-007/00B</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>007</main-group>
        <subgroup>00B</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-007/0008</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>7</main-group>
        <subgroup>0008</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G01R-031/3016</classification-symbol>
        <section>G</section>
        <class>01</class>
        <subclass>R</subclass>
        <main-group>31</main-group>
        <subgroup>3016</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06F-001/04</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>1</main-group>
        <subgroup>04</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="4">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H03D-013/003</classification-symbol>
        <section>H</section>
        <class>03</class>
        <subclass>D</subclass>
        <main-group>13</main-group>
        <subgroup>003</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="5">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-007/0012</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>7</main-group>
        <subgroup>0012</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="6">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>T04L-007/00B2</classification-symbol>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>13</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>9</number-of-drawing-sheets>
      <number-of-figures>13</number-of-figures>
      <image-key data-format="questel">US6182237</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">System and method for detecting phase errors in asics with multiple clock frequencies</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>RAUCCI MICHELE</text>
          <document-id>
            <country>US</country>
            <doc-number>4852124</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4852124</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>UNDERWOOD GEORGE D</text>
          <document-id>
            <country>US</country>
            <doc-number>5910740</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5910740</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="3">
          <text>BRUENING ROLF, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4416680</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4416680</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="4">
          <text>ALBRECHT HORST</text>
          <document-id>
            <country>US</country>
            <doc-number>4528163</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4528163</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="5">
          <text>LU NING H</text>
          <document-id>
            <country>US</country>
            <doc-number>4559607</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4559607</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="6">
          <text>SURIE SERGE</text>
          <document-id>
            <country>US</country>
            <doc-number>4675886</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4675886</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="7">
          <text>CORDELL ROBERT R</text>
          <document-id>
            <country>US</country>
            <doc-number>4756011</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4756011</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="8">
          <text>WINTERBURN JOHN A</text>
          <document-id>
            <country>US</country>
            <doc-number>4759787</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4759787</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="9">
          <text>PAPANIKOLAU EMMANUEL, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4804422</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4804422</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="10">
          <text>CORDELL ROBERT R</text>
          <document-id>
            <country>US</country>
            <doc-number>4821296</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4821296</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="11">
          <text>UCHIKAWA AKIRA, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4935046</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4935046</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="12">
          <text>UCHIKAWA AKIRA, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4956208</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4956208</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="13">
          <text>LOWREY SCOTT W, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5278873</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5278873</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="14">
          <text>SEVENHANS JOANNES M J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5528637</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5528637</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="15">
          <text>CASAL HUMBERTO F, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5581699</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5581699</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="16">
          <text>GUO BIN</text>
          <document-id>
            <country>US</country>
            <doc-number>5619148</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5619148</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="17">
          <text>SATO TATSUHIRO, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5637284</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5637284</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="18">
          <text>IKEDA TOORU, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5762672</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5762672</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="19">
          <text>NEC CORP</text>
          <document-id>
            <country>JP</country>
            <doc-number>H01233849</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP01233849</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="1">
          <text>High Resolution Digital Phase Detector, IBM Technical Disclosure Bulletin, vol. 32, No. 3B, Aug. 1989, pp. 307-309.</text>
        </nplcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>International Business Machines Corporation</orgname>
            <address>
              <address-1>Armonk, NY, US</address-1>
              <city>Armonk</city>
              <state>NY</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>IBM</orgname>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Bronson, Timothy C.</name>
            <address>
              <address-1>Vestal, NY, US</address-1>
              <city>Vestal</city>
              <state>NY</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="2">
          <addressbook lang="en">
            <name>Rudolph, Bruce G.</name>
            <address>
              <address-1>Rochester, MN, US</address-1>
              <city>Rochester</city>
              <state>MN</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <name>Beckstrand, Shelly M</name>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Heckler, Thomas M.</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>LAPSED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      A phase error detection circuit apparatus and method for detecting phase misalignment between first clock signals operating in a slow time domain and second clock signals operating in a fast time domain.
      <br/>
      A frequency divider and shift register are clocked in the slow time domain to sequentially sample all possible alignments of the first clock signals.
      <br/>
      A second shift register is clocked in the fast time domain and operates responsive to the output of the frequency divider and shift register to generate a phase alignment error signal when the phase alignment is incorrect or the frequency divider is not switching in a correct cycle.
      <br/>
      Error detection logic clocked in the slow time domain samples and optionally masks the phase error signal.
      <br/>
      State machine logic may be provided to generate an output error signal when each possible phase alignment results in a phase alignment error signal.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="1">
      1.
      <br/>
      Technical Field of the Invention
    </p>
    <p num="2">
      This invention relates to phase error detection.
      <br/>
      More specifically, it relates to the detection of phase errors between different clock domains in application specific integrated circuit chips (ASICs).
    </p>
    <p num="3">2. Background Art</p>
    <p num="4">
      Clock phase alignment errors can occur in any application specific integrated circuit (ASIC) chip which employs multiple clocks running synchronously at different frequencies.
      <br/>
      Examples of such chips include microprocessors with high frequency internal clocks and slower bus interface clocks, memory controller chips with one clock frequency for a system bus and another clock frequency for a dedicated memory bus, and I/O bridge chips which communicate with multiple buses running at different frequencies.
    </p>
    <p num="5">
      Synchronous communications between any two clock domains requires that the phase relationship between the clocks remain constant.
      <br/>
      A phase alignment error exists when the phase relationship between two synchronous domains does not remain constant, or is not initialized to the alignment for which the cross domain circuitry is designed.
      <br/>
      This error condition results in incorrect and missing data during communications between clock domains and consequently causes multiple secondary error effects.
      <br/>
      Since existing error checking mechanisms are unable to detect phase alignment errors, one or more of the secondary errors is perceived to be a primary error.
      <br/>
      In a customer environment this results in incorrect failure isolation and unnecessary replacement of parts.
      <br/>
      In a lab bring up environment it becomes necessary to spend extra time attaching fast oscilloscopes to systems under test when phase alignment errors are suspected.
    </p>
    <p num="6">
      A particular memory and I/O controller chip, for example, communicates with processors, external memory, and I/O devices.
      <br/>
      The internal circuits of this chip are partitioned into multiple clock domains which operate at frequencies that match the associated external devices.
      <br/>
      In this specific example, internal circuits are divided into three clock domains: a processor clock domain, a memory clock domain, and an I/O clock domain.
      <br/>
      In order to minimize latencies and improve system performance, the memory and processor clock domains inside the chip operate synchronously at a frequency ratio of 2:3.
      <br/>
      Consequently, the chip is susceptible to phase alignment errors either as a result of circuit failure or incorrect phase locked loop (PLL) initialization.
    </p>
    <p num="7">Referring to FIG. 1, the correct phase relationship at a synchronous 2:3 frequency ratio is illustrated.</p>
    <p num="8">It is an object of the invention to provide a circuit for detecting clock phase alignment errors.</p>
    <p num="9">It is a further object of the invention to provide for correct failure isolation.</p>
    <p num="10">It is a further object of the invention to detect phase alignment errors in an ASIC, such as those arising from circuit failure or incorrect PLL initialization.</p>
    <p num="11">It is a further object of the invention to detect incorrect clock phase alignment between synchronous clock domains by using fully synchronous signals and not requiring sampling rates in excess of the clock frequencies in either of the two domains being monitored.</p>
    <p num="12">It is a further object of the invention to detect incorrect clock phase alignment between synchronous clock domains with detection circuitry which performs accurately over the same process range that the rest of the chip is designed to meet, and do so without placing special requirements on logic synthesis and timing tools, without custom design techniques, and without embedded analog circuits.</p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="13">
      In accordance with the invention, phase misalignment is detected between first clock signals defining a slow time domain and second clock signals defining a fast time domain.
      <br/>
      All possible alignments of clock signals operating in the slow time domain are sampled to generate a sequence of alignment signals.
      <br/>
      These alignment signals are clocked to detector logic operating in the fast time domain to generate a phase error signal when the phase alignment is incorrect.
    </p>
    <p num="14">Other features and advantages of this invention will become apparent from the following detailed description of the presently preferred embodiment of the invention, taken in conjunction with the accompanying drawings.</p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="15">
      FIG. 1 is a timing chart illustrating the correct phase relationship at a synchronous 2:3 frequency ratio.
      <br/>
      FIGS. 2A and 2B, arranged as illustrated in FIG. 2, are a logic diagram illustrating a preferred embodiment of the invention.
      <br/>
      FIGS. 3A and 3B, arranged as illustrated in FIG. 3, are a logic diagram illustrating a specific embodiment of the invention for use in detecting phase relationship errors in a circuit designed for a synchronous 2:3 frequency ratio.
      <br/>
      FIGS. 4A and 4B, arranged as illustrated in FIG. 4, are a timing chart illustrating the timing of the circuit of FIGS. 3A and 3B when operating in a correct phase relationship.
      <br/>
      FIGS. 5A and 5B, arranged as illustrated in FIG. 5, are a timing chart illustrating the timing of the circuit of FIGS. 3A and 3B when operating out of correct phase relationship.
    </p>
    <heading>BEST MODE FOR CARRYING OUT THE INVENTION</heading>
    <p num="16">In the following description:</p>
    <p num="17">OMEGA _slow is the frequency of the slow clock.</p>
    <p num="18">OMEGA _fast is the frequency of the fast clock.</p>
    <p num="19">Frequency ratio=(s/f)=( OMEGA _slow/ OMEGA _fast).</p>
    <p num="20">
      The optimal, or correct, phase relationship is defined to be one in which there is one clock cycle that begins with rising edge of the slave, or send, clocks in each domain.
      <br/>
      This cycle, referred to as cycle 1, of simultaneous rising clock edges is repeated every (s) slow cycles, which is the same as (f) fast cycles.
    </p>
    <p num="21">
      Referring to FIG. 1, clock signal c2_slow 112 is the slave signal of clock signal c1_slow 110, and c2_fast 116 is the slave signal of clock signal c1_fast 114.
      <br/>
      As illustrated, the rising edge of signal 112 cycle 1 coincides with the rising edge of signal 116 cycle 1.
      <br/>
      Consequently, clock signals 112 and 116 are in correct phase relationship.
    </p>
    <p num="22">Referring to FIGS. 2A and 2B, a logic circuit is illustrated which is able to detect incorrect clock phase alignment between synchronous clock domains.</p>
    <p num="23">
      In structure, the clock phase alignment detection circuit of this first embodiment of the invention includes frequency divider 120, divider alignment shift register 122, divider alignment selector 130, shift register 124, error detect logic 150 and error hold logic 152.
      <br/>
      Inputs to the clock phase alignment detection circuit include c1_slow clock 110, c2_slow clock 112, c1_fast clock 114, c2_fast clock 116 and reset error hold 131.
    </p>
    <p num="24">
      c1_slow clock signal line 110 is fed to frequency divider 120, shift register 122, and to the control (C) inputs of error detect L1 latch 134 and error hold L1 latch 142. c2_slow clock signal line 112 is fed to frequency divider 120, shift register 122, and to the control input of error detect L2 latch 136. c1_fast clock signal line 114 is fed to shift register 124 and to the control input of error hold L2 latch 144. c2_fast clock signal line 116 is fed to shift register 124.
      <br/>
      Reset error hold signal line 131 is inverted at invert block 132 and fed on line 127 to AND gate 140.
    </p>
    <p num="25">
      The output of frequency divider 120 is fed on line 111 to the data input of shift register 122 and to divider alignment selector 130.
      <br/>
      Outputs of shift register 122 from stage 1 on line 113, stage 2 on line 115 and stage (s) on line 117 are also fed to divider alignment selector 130, the output of which is fed as alignment signals on line 139 to the data input of shift register 124.
      <br/>
      The outputs 121, 123, 125 from shift register 124 stages 1, 2, . . . ,n, respectively, are fed to AND gate 126 and NOR gate 128, the outputs of both of which are fed to OR gate 119.
      <br/>
      The output of OR gate 119 is fed on line 129 to the data input of error detect L1 latch 134, the output of which is fed to the data input of error detect L2 latch 136, the output of which is fed on line 135 to OR gate 138, the other input to which is phase error signal line 141.
      <br/>
      The output of OR gate 138 is fed on line 137 to AND gate 140, the output of which is fed on line 143 to the data input of error hold L1 latch 142.
      <br/>
      The output of latch 142 is fed to the data input of error hold L2 latch 144, the output of which is the final output on phase error output signal line 141 of the clock phase alignment detection logic of this embodiment of the invention.
    </p>
    <p num="26">
      In operation, frequency divider 120 is constructed using latches that are clocked in the  OMEGA _slow domain by clock signals c1_slow 110 and c2_slow.
      <br/>
      The output of divider 120 has a 50% duty cycle and oscillates at a frequency of ( OMEGA _slow/(2*s)).
      <br/>
      The output 111 of frequency divider 120 must be aligned such that each transition begins in the cycle in which the rising edge of the send clocks 112, 116 in both domains occurs at the same time (or the cycle in which this would occur if no phase error were present).
      <br/>
      Since it is impossible to guarantee the cycle alignment of the frequency divider 120 output 111, a shift register 122 is provided which operates in the  OMEGA _slow domain (under control of c1_slow 110 and c2_slow 112 at inputs C1, C2, respectively) and which has (s-1) stages.
      <br/>
      This shift register 122 is thereby enabled to sequentially sample all possible alignments.
    </p>
    <p num="27">
      The output 111 of divider 120, or the shifted output of divider 120 on shift register outputs 113, 115, 117, is multiplexed through divider alignment selector 130 to alignment signal line 139 and sampled at the data input D of a shift register 124 constructed from latches clocked in the  OMEGA _fast domain by clock signals 114, 116 at shift register clock inputs C1, C2, respectively.
      <br/>
      The number of stages in shift register 124 is (f).
      <br/>
      The outputs 121, 123, 125 of shift register 124 are gated through AND gate 126, NOR gate 128 and OR gate 119 to create a signal 129 which is active (true) only when all outputs of shift register 124 are equal.
      <br/>
      Thus, signal 129 is never active at the falling edge of the sample clock c1_slow 110 in the  OMEGA _slow domain, unless: (1) the phase alignment is incorrect, or (2) the output of frequency divider 120 is not switching in the correct cycle.
      <br/>
      Shift register 124, clocked by C1_fast 114 and C2_fast 116 in the fast time domain, together with gates 126, 128 and 119, comprise one specific embodiment of detector logic for generating a phase error signal when the phase alignment is incorrect.
    </p>
    <p num="28">
      Potential phase errors can then be detected by sampling this signal 129 with an error detect 150 latch pair 134, 136 operating in the  OMEGA _slow domain under control of clock signals 110, 112.
      <br/>
      The output 135 of error detect 150 latches 134, 136 is then combined in gates 138 and 140 with masking (such as phase error signal 141) and other optional control signals (such as reset error hold signal 131) before being captured from line 143 in error hold 152 latch pair 142, 144.
    </p>
    <p num="29">
      State machine logic 118 generates divider alignment selector control signal 130 to sequentially select a different alignment 111, 113, 115, 117 of the frequency divider 120 output and samples phase error signal 141 until an alignment is found that does not result in activation of the phase error signal 141 or until all alignments 111, 113, 115, 117 have been tried.
      <br/>
      If all possible alignments result in activation of the phase error signal 141 than a phase error is reported.
      <br/>
      If an alignment 111, 113, 115, or 117 is found which does not result in activation of phase error signal 141, then selection of that alignment is maintained and any subsequent activation of phase error signal 141 is considered to be a valid error.
    </p>
    <p num="30">
      Referring to FIGS. 3A and 3B, a second preferred embodiment of the phase error detection circuit of the invention includes divide by two logic 160, cross domain sample logic 162, delayed sample logic 164, error detect logic 166 and error hold logic 168.
      <br/>
      Inputs to the clock phase alignment detection circuit include c1_slow clock 110, c2_slow clock 112, c1_fast clock 114, c2_fast clock 116, reset error hold 131, clocks running signal line 185 and error not masked signal line 187.
    </p>
    <p num="31">
      c1_slow clock signal 110 is fed to the control input (C) of divide by two L1 latch 170, error detect L1 latch 134, and error hold L1 latch 142. c2_slow clock signal 112 is fed to the control inputs (C) of divide by two L2 latch 172, error detect L2 latch 136 and error hold L2 latch 144. c1_fast clock signal 114 is fed to the control (C) inputs of cross domain sample L1 latch 180 and delayed sample L1 latch 190. c2_fast clock signal 116 is fed to the control (C) inputs of cross domain sample L2 latch 182 and delayed sample L2 latch 192.
      <br/>
      Clocks running signal line 185 and error not masked signal line 187 are fed to AND gate 204.
      <br/>
      Resent error hold signal 131 is inverted at invert block 132 and fed on line 127 to AND gate 140.
    </p>
    <p num="32">
      The output of latch 170 is fed on line 171 to the data (D) input of latch 172, the output of which on line 173 is inverted at invert block 174 and fed to the data input latches of latch 170 and cross domain sample L1 latch 180.
      <br/>
      The output of latch 180 is fed on line 181 to cross domain sample L2 latch 182, the output of which is fed on line 183 to the data input of delayed sample L1 latch 190 and XOR block 194.
      <br/>
      The output of latch 190 is fed on line 191 to the data input of delayed sample L2 latch 192, the output of which is fed on line 193 to XOR block 194.
      <br/>
      The output of XOR 194 on line 195 is inverted at block 196 and fed on line 197 to the data input of error detect L1 latch 134.
      <br/>
      The output of latch 134 on line 133 is fed to error detect L2 latch 136, the output of which is fed on line 135 to AND gate 204.
      <br/>
      The output of AND gate 204 is fed on line 205 to OR gate 206, the other input to which is phase error line 141 and the output of which is fed on line 137 to AND gate 140.
      <br/>
      The output of AND gate 140 is fed on line 143 to the data input of error hold L1 latch 142, the output of which on line 145 is fed to the data input of error hold L2 latch 144.
      <br/>
      The output of latch 144 is phase error signal 141.
    </p>
    <p num="33">
      In this second embodiment, FIGS. 3A and 3B, since the frequency ratio of the clock domains to be monitored is known to be 2:3 some simplifications to the general solution of the first embodiment, FIGS. 2A and 2b, are allowed.
      <br/>
      Specifically:
    </p>
    <p num="34">
      (1) Frequency divider 160 provides a waveform 175 of ( OMEGA _slow/(s)) instead of ( OMEGA _slow/(2*s)).
      <br/>
      Since (s)=2, this means using a divide-by-two instead of a divide-by-four frequency divider.
      <br/>
      The extra transition that occurs every two cycles does not result in a false phase error detection when (f) is 3, as is the case in this second embodiment.
    </p>
    <p num="35">
      (2) Since the output of frequency divider 160 has a transition every cycle in the  OMEGA _slow domain, there is only one possible cycle alignment.
      <br/>
      Consequently it is not necessary to sequentially check for errors on every possible alignment, allowing for the elimination of the  OMEGA _slow domain shift register 122 and the associated alignment selector (multiplexer) 130.
    </p>
    <p num="36">(3) The number of stages in the  OMEGA _fast domain shift register 124 is reduced from (f) to (f-1) in cross domain sample 162 due to the higher frequency of output 175 of divider 160.</p>
    <p num="37">
      Referring further to the second embodiment of FIG. 3 in connection with the first embodiment of FIG. 2, the first latch, L1 latch 170, in divide by two circuit 160 is the frequency divider operating in the slow domain, and corresponds to the frequency divider 120 of the first embodiment.
      <br/>
      Cross domain sample 162 and delayed sample 164 latches 180, 182, 190 and 192 comprise the  OMEGA _fast domain shift register, and correspond to shift register 124 in the first embodiment.
      <br/>
      Error detect 166 latches 134 and 136 and error hold latches 142, 144 are precisely the same as those found in the first embodiment.
      <br/>
      In this second embodiment, additional optional control signals 185, 187 are included to allow for software masking of phase error detection and automatic masking of phase error detection when the clocks in either domain are stopped.
    </p>
    <p num="38">
      The phase error detection circuit of either embodiment can be used at initialization time before cross domain operations are started, thereby eliminating false secondary errors.
      <br/>
      This is particularly advantageous when the phase error is the result of spurious initialization problems.
      <br/>
      In this case the PLL which sources the clocks can be repeatedly reset until a correct phase relationship is established or a retry threshold is reached.
      <br/>
      If the phase error is isolated after cross domain operations have begun, then the circuit of either embodiment can be used to increase the accuracy of automated failure isolation algorithms.
    </p>
    <p num="39">Referring to FIGS. 4A and 4B, the operation of the circuit of FIGS. 3A and 3B is illustrated when the clocks are in phase synchronization.</p>
    <p num="40">Referring to FIGS. 5A and 5B, the operation of the circuit of FIGS. 3A and 3B is illustrated when the clocks are out of phase.</p>
    <p num="41">
      In FIGS. 4 and 5, the error hold output 141 is not shown.
      <br/>
      This latch 144 output on line 141 is set to `1` whenever the output of the error capture latch 136 pulses.
      <br/>
      The error hold latch 144 then remains set until reset by external control line 131, such as under software control.
      <br/>
      Latch 136 is a polarity hold latch; its output changes at the rising edge of c2_slow and it captures whatever is present at its input at the fall of c1_slow.
      <br/>
      Since, for correctly aligned clocks, error detect (input) line 197 is never high at the falling edge of c1_slow line 110, no error is detected in FIG. 4.
      <br/>
      In FIG. 5, for incorrectly aligned clocks, this is not true, and an error is detected.
    </p>
    <heading>ADVANTAGES OVER THE PRIOR ART</heading>
    <p num="42">The advantages of the system and method of the preferred embodiment of this invention include the provision of an improved circuit and method for detecting clock phase alignment errors.</p>
    <p num="43">It is a further advantage of the invention that there is provided an improved circuit and method for correct failure isolation.</p>
    <p num="44">It is a further advantage of the invention that there is provided an improved circuit and method for detecting phase alignment errors in an ASIC, such as those arising from circuit failure or incorrect PLL initialization.</p>
    <p num="45">It is a further advantage of the invention that there is provided an improved circuit and method for detecting incorrect clock phase alignment between synchronous clock domains by using fully synchronous signals and not requiring sampling rates in excess of the clock frequencies in either of the two domains being monitored.</p>
    <p num="46">It is a further advantage of the invention that there is provided an improved circuit and method for detecting incorrect clock phase alignment between synchronous clock domains on a chip with detection circuitry which performs accurately over the same process range that the rest of the chip is designed to meet, and do so without placing special requirements on logic synthesis and timing tools, without requiring custom design techniques, and without requiring embedded analog circuits.</p>
    <heading>ALTERNATIVE EMBODIMENTS</heading>
    <p num="47">
      It will be appreciated that, although specific embodiments of the invention have been described herein for purposes of illustration, various modifications may be made without departing from the spirit and scope of the invention.
      <br/>
      In particular, it is within the scope of the invention to provide a memory device, such as a transmission medium, magnetic or optical tape or disc, or the like, for storing signals for controlling the operation of a computer according to the method of the invention and/or to structure its components in accordance with the system of the invention.
    </p>
    <p num="48">Accordingly, the scope of protection of this invention is limited only by the following claims and their equivalents.</p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>We claim:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A phase error detection circuit for detecting phase misalignment between first clock signals operating in a slow time domain and second clock signals operating in a fast time domain, comprising:</claim-text>
      <claim-text>a frequency divider; a first shift register responsive to the output of said frequency divider and clocked in said slow time domain for sequentially sampling all possible alignments of said first clock signals; a divider alignment selector for multiplexing the output of said frequency divider and said first shift register;</claim-text>
      <claim-text>and a second shift register clocked in said fast time domain and responsive to the output of said divider alignment selector for generating a phase error signal when the phase alignment is incorrect or said frequency divider is not switching in a correct cycle.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. The phase error detection circuit of claim 1, further comprising: state machine logic sequentially selecting frequency divider outputs and sampling said phase error signal for reporting a phase error when each possible alignment results in activation of said phase error signal.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. A phase error detection circuit for detecting phase misalignment between first clock signals operating in a slow time domain and second clock signals operating in a fast time domain, comprising: a frequency divider; a first shift register responsive to the output of said frequency divider and clocked in said slow time domain for sequentially sampling all possible alignments of said clock signals; a divider alignment selector for multiplexing the output of said frequency divider and said first shift register; a second shift register clocked in said fast time domain and responsive to the output of said divider alignment selector for generating a phase error signal when the phase alignment is incorrect or the frequency divider is not switching in a correct cycle; error detection logic clocked in said slow time domain for sampling and optionally masking said phase error signal; error hold logic responsive to the output of said error detection logic for latching said phase error signal;</claim-text>
      <claim-text>and state machine logic sequentially selecting frequency divider outputs and sampling said phase error signal for reporting a phase error when each possible alignment results in activation of said phase error signal.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. Method for detecting phase misalignment between first clock signals defining a slow time domain and second clock signals defining a fast time domain, comprising the steps of: sequentially sampling all possible alignments of clock signals operating in said slow time domain to generate a sequence of alignment signals;</claim-text>
      <claim-text>and multiplexing said sequence of alignment signals through detector logic clocked in said fast time domain to generate a phase error signal when the phase alignment is incorrect.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. A phase error detection circuit for detecting phase misalignment between first clock signals operating in a slow time domain and second clock signals operating in a fast time domain, comprising: means for sequentially sampling all possible alignments of clock signals operating in said slow time domain to generate a sequence of alignment signals;</claim-text>
      <claim-text>and means for multiplexing said sequence of alignment signals through detector logic clocked in said fast time domain to generate a phase error signal when the phase alignment is incorrect.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. A program storage device readable by a machine, tangibly embodying a program of instructions executable by a machine to perform method steps for detecting phase misalignment between first clock signals operating in a slow time domain and second clock signals operating in a fast time domain, said method steps comprising: sequentially sampling all possible alignments of clock signals operating in said slow time domain to generate a sequence of alignment signals;</claim-text>
      <claim-text>and multiplexing said sequence of alignment signals through detector logic clocked in said fast time domain to generate a phase error signal when the phase alignment is incorrect.</claim-text>
    </claim>
    <claim num="7">
      <claim-text>7. An article of manufacture comprising: a computer useable medium having computer readable program code means embodied therein for detecting phase misalignment between first clock signals operating in a slow time domain and second clock signals operating in a fast time domain, the computer readable program means in said article of manufacture comprising: computer readable program code means for causing a computer to effect sequentially sampling all possible alignments of clock signals operating in said slow time domain to generate a sequence of alignment signals;</claim-text>
      <claim-text>and computer readable program code means for causing a computer to effect multiplexing said sequence of alignment signals through detector logic clocked in said fast time domain to generate a phase error signal when the phase alignment is incorrect.</claim-text>
    </claim>
    <claim num="8">
      <claim-text>8. A phase error detection circuit for detecting phase misalignment between first clock signals operating in a slow time domain and second clock signals operating in a fast time domain, the frequency ratio of said time domains being 2:3, comprising: a divider circuit clocked in said slow time domain for dividing said first clock signals by two;</claim-text>
      <claim-text>and a shift register clocked in said fast time domain and responsive to the output of said divider circuit for generating a phase error signal when the phase alignment is incorrect.</claim-text>
    </claim>
    <claim num="9">
      <claim-text>9. The phase error detection circuit of claim 8, further comprising: error detection logic clocked in said slow time domain for sampling and optionally masking said phase error signal;</claim-text>
      <claim-text>and error hold logic responsive to the output of said error detection logic for latching said phase error signal.</claim-text>
    </claim>
    <claim num="10">
      <claim-text>10. A method for detecting phase misalignment between first clock signals operating in a slow time domain and second clock signals operating in a fast time domain, the frequency ratio of said time domains being 2:3, comprising the steps of: operating a divider circuit clocked in said slow time domain to divide said first clock signals by two;</claim-text>
      <claim-text>and operating a shift register clocked in said fast time domain and responsive to the output of said divider circuit for generating a phase error signal when the phase alignment is incorrect.</claim-text>
    </claim>
    <claim num="11">
      <claim-text>11. A phase error detection circuit for detecting phase misalignment between first clock signals operating in a slow time domain and second clock signals operating in a fast time domain, the frequency ratio of said time domains being 2:3, comprising: divider circuit means clocked in said slow time domain for dividing said first clock signals by two;</claim-text>
      <claim-text>and shift register means clocked in said fast time domain and responsive to the output of said divider circuit for generating a phase error signal when the phase alignment is incorrect.</claim-text>
    </claim>
    <claim num="12">
      <claim-text>12. A program storage device readable by a machine, tangibly embodying a program of instructions executable by a machine to perform method steps for detecting phase misalignment between first clock signals operating in a slow time domain and second clock signals operating in a fast time domain, the frequency ratio of said time domains being 2:3, said method steps comprising: operating a divider circuit clocked in said slow time domain to divide said first clock signals by two;</claim-text>
      <claim-text>and operating a shift register clocked in said fast time domain and responsive to the output of said divider circuit for generating a phase error signal when the phase alignment is incorrect.</claim-text>
    </claim>
    <claim num="13">
      <claim-text>13. An article of manufacture comprising: a computer useable medium having computer readable program code means embodied therein for detecting phase misalignment between first clock signals operating in a slow time domain and second clock signals operating in a fast time domain, the frequency ratio of said time domains being 2:3, the computer readable program means in said article of manufacture comprising: computer readable program code means for causing a computer to effect operating a divider circuit clocked in said slow time domain to divide said first clock signals by two;</claim-text>
      <claim-text>and computer readable program code means for causing a computer to effect operating a shift register clocked in said fast time domain and responsive to the output of said divider circuit for generating a phase error signal when the phase alignment is incorrect.</claim-text>
    </claim>
  </claims>
</questel-patent-document>