<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06181735B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06181735</doc-number>
        <kind>B2</kind>
        <date>20010130</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6181735</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference family-id="9482879" extended-family-id="550469">
      <document-id>
        <country>US</country>
        <doc-number>08849640</doc-number>
        <kind>A</kind>
        <date>19970813</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1996US-08849640</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>564004</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>FR</country>
        <doc-number>9511214</doc-number>
        <kind>A</kind>
        <date>19950925</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1995FR-0011214</doc-number>
      </priority-claim>
      <priority-claim kind="international" sequence="2">
        <country>WO</country>
        <doc-number>FR9601497</doc-number>
        <kind>A</kind>
        <date>19960924</date>
        <priority-linkage-type>W</priority-linkage-type>
        <priority-active-indicator>N</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="2">
        <doc-number>1996WO-FR01497</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010130</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>H04L  29/08        20060101AFI20051220RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>29</main-group>
        <subgroup>08</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051220</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>G06K  19/07        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>K</subclass>
        <main-group>19</main-group>
        <subgroup>07</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="3">
        <text>H04L  29/10        20060101ALI20051220RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>29</main-group>
        <subgroup>10</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051220</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="4">
        <text>H04M  11/00        20060101ALI20051220RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>M</subclass>
        <main-group>11</main-group>
        <subgroup>00</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051220</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="5">
        <text>H04M  11/06        20060101A I20051110RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>M</subclass>
        <main-group>11</main-group>
        <subgroup>06</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051110</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>375222000</text>
        <class>375</class>
        <subclass>222000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>380266000</text>
        <class>380</class>
        <subclass>266000</subclass>
      </further-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>H04M-011/06</text>
        <section>H</section>
        <class>04</class>
        <subclass>M</subclass>
        <main-group>11</main-group>
        <subgroup>06</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04M-011/06</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>M</subclass>
        <main-group>11</main-group>
        <subgroup>06</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>5</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>2</number-of-drawing-sheets>
      <number-of-figures>4</number-of-figures>
      <image-key data-format="questel">US6181735</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Modem equipped with a smartcard reader</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>NYSEN PAUL A, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5164985</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5164985</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>CAPUTO ANTHONY A, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5546463</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5546463</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>ROSKOWSKI STEVEN G, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5624316</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5624316</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>CAPUTO ANTHONY A, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5778071</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5778071</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="5">
          <text>COUTTS MICHAEL G, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5835603</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5835603</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <nplcit num="1">
          <text>Daniel Sternglass, "The future is in the PC cards," IEEE Spectrum, pp. 46-50, Jun. 1992.</text>
        </nplcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Gemplus S.C.A.</orgname>
            <address>
              <address-1>Gemenos, FR</address-1>
              <city>Gemenos</city>
              <country>FR</country>
            </address>
          </addressbook>
          <nationality>
            <country>FR</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>GEMALTO</orgname>
          </addressbook>
          <nationality>
            <country>FR</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Sarat, Jean-Marc</name>
            <address>
              <address-1>Nans les Pins, FR</address-1>
              <city>Nans les Pins</city>
              <country>FR</country>
            </address>
          </addressbook>
          <nationality>
            <country>FR</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <name>Plottel, Roland</name>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Chin, Stephen</name>
      </primary-examiner>
    </examiners>
    <pct-or-regional-filing-data>
      <document-id>
        <country>WO</country>
        <doc-number>FR9601497</doc-number>
        <date>19960924</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1996WO-FR01497</doc-number>
      </document-id>
    </pct-or-regional-filing-data>
    <pct-or-regional-publishing-data>
      <document-id>
        <country>WO</country>
        <doc-number>9712478</doc-number>
        <kind>A1</kind>
        <date>19970403</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>WO9712478</doc-number>
      </document-id>
    </pct-or-regional-publishing-data>
    <lgst-data>
      <lgst-status>EXPIRED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      The invention relates to modems designed to allow transmission of data between a terminal (a personal computer or PC) and a network.
      <br/>
      To improve the operating versatility of a modem or its utilization by a smartcard, the modem is equipped according to the invention with a receptacle (80) for receiving a smartcard (120), with a connector (110) for this card and a card interface circuit (100), and the microcontroller (50) of the modem (the microcontroller controlling communication with the network when commanded by the PC) also controls the card interface circuit.
      <br/>
      This microcontroller thus constitutes the kernel of the modem and at the same time the kernel of a card reader.
      <br/>
      The communication with the card is effected by commands known as "AT' and the systematic prefix sequence "AT' (whereby the microcontroller recognizes that it has to carry out an operation) is followed by a second systematic prefix sequence if a communication operation between the terminal and the card is to be effected.
      <br/>
      The second prefix sequence is "+G'.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="1">
      1.
      <br/>
      Field of the Invention
    </p>
    <p num="2">
      The invention relates to modems, namely devices that modulate and demodulate electrical signals for transmitting or receiving data (mainly digital data) between a terminal and a communications network.
      <br/>
      The network connects at least two terminals and a modem is placed between each terminal and the network.
    </p>
    <p num="3">2. Description of the Related Art</p>
    <p num="4">
      The terminal is usually a personal computer and the communications network is a telephone transmission network.
      <br/>
      In this case, the modem is a peripheral of the personal computer and can be connected between a communications port on the computer (generally a serial communications port) and the telephone network.
      <br/>
      The signal transmission protocol is such that the telephone network, originally designed to transmit analog signals representing speech, can transmit coded signals representing digital data either in the "character" mode (transmission of octets representing characters) or in "fax" mode (transmission of images as dots).
    </p>
    <p num="5">The invention will accordingly be described in the most current application which is the case of a personal computer (hereafter called PC) connected by the modem to a telephone network.</p>
    <p num="6">The modem has two main functions: modulating electrical signals to convert binary data into signals compatible with the telephone transmission network according to a well-defined protocol that allows these signals to be interpreted at the other end of the network; and demodulating signals from the network to convert them into binary data that can be processed by the PC to which the modem is connected.</p>
    <p num="7">Physically, the modem is comprised</p>
    <p num="8">
      of a line interface circuit for providing and receiving signals in the protocol corresponding to the transmission network,
      <br/>
      a PC interface circuit to provide and receive signals according to the PC protocol,
    </p>
    <p num="9">
      a modulation/demodulation circuit, sometimes called data pump, to convert the data signals of the PC protocol to the network protocol upon emission of the signals and make the reverse conversion upon reception,
      <br/>
      a microcontroller (i.e. a microprocessor with its memories, particularly with a read only memory) to control the communication, particularly to control the action of the other circuits of the modem,
      <br/>
      and fixed programs containing instructions, contained in the microcontroller memories.
    </p>
    <p num="10">
      The microcontroller executes programs contained in its read only memory (fixed programs or subprograms, generally directly executable).
      <br/>
      It executes these programs according to commands it receives from the terminal through the communications port connecting the terminal to the modem.
      <br/>
      These commands can be in high-level language and input directly at the terminal's keyboard and transmitted in ASCII format to the microcontroller.
      <br/>
      The executable instructions include all the elements necessary for commanding circuits that convert the signals in the two directions (from the PC to the network and from the network to the PC) and other elements allowing other functions of the modem (data compression, error correction, transition to fax mode or alphanumeric mode, etc.) to be commanded.
    </p>
    <p num="11">
      At the present time, a great many modems are built so that they can be controlled by a set of commands called the "AT command set" or Hayes commands.
      <br/>
      These commands allow the various functions of the modem to be controlled in plain language from the terminal.
    </p>
    <p num="12">
      The principle of AT commands is the following: if the modem's microcontroller receives a command in ASCII code starting with the letters "A" and "T" and which ends with the ASCII code corresponding to a carriage return on a keyboard, then the microcontroller considers it a modem command and executes the command requested; the command requested is defined by an ASCII character sequence introduced after the prefix sequence 'AT and before the carriage return.
      <br/>
      The command is a command corresponding to one of the communication functions (or communication-linked functions) between the PC and the network.
      <br/>
      The command may be sufficient by itself or require parameters and/or data to be executed.
      <br/>
      If there are parameters and/or data, these parameters or data follow the command before the carriage return code.
    </p>
    <p num="13">
      For example, the command can be a telephone dialing command to call a party: the name of the command in plain language is `DP` (for "Dial Pulse"); the letters DP are sent to the modem microcontroller and are followed by the telephone number requested, and a separator can be placed between the command and the number.
      <br/>
      The `DP` command is hence always followed by a datum.
      <br/>
      Thus, to call the number 40 67 11 99 from a PC keyboard, a user keys in the following sequence: ATDP40671199 and ends the command by pressing the carriage return key.
      <br/>
      The modem microcontroller then commands all the operations for the modem to send the dial pulse signal over the line to the party called by this number.
      <br/>
      The command would be DT (for "Dial Tone") if the dial signal sent over the line were not made up of series of as many pulses as numbers dialed but of different frequencies or tones party to the numbers called.
    </p>
    <p num="14">Another example of a command is "A." This is the response to an incoming call: the modem is called by a party; if one wishes it to respond, namely to enter into communication with this party on the network, one must send the microcontroller the sequence `ATA` then the carriage return ending the command.</p>
    <p num="15">
      Another example, instead of a single command, is a macrocommand defining a group of possible commands; this is the macrocommand "+F" which must be followed by the command precisely chosen from the group.
      <br/>
      The macrocommand "+F" indicates that the call to the network must be in "fax" mode and not in "character" mode.
      <br/>
      This macrocommand is hence followed by another command corresponding to a requested function, itself followed if applicable by parameters or data necessary for executing the command.
    </p>
    <p num="16">All these commands and macrocommands are hence recognized by the modem microcontroller if they start with the sequence `at` and they then trigger execution by the modem of communication functions between the network and the PC.</p>
    <p num="17">
      It has also been proposed that communications units (telephone, personal computers, communications terminals using modems) be controlled with smartcards, particularly to provide a security function protecting these units from access by unauthorized persons.
      <br/>
      This smartcard use control consists simply of adding an additional peripheral to the computer, namely a smartcard reader, or consists of adding such a peripheral to a specialized communications terminal other than a computer (e.g. a modem+keyboard+screen assembly known as "minitel").
      <br/>
      Usually this smartcard reader is used only to block or authorize utilization of the terminal, and this blockage or authorization is established either directly by inserting a smartcard or, after a dialog between the terminal and the card, entering secret codes or other security protocols.
      <br/>
      The options offered today by this combination of a terminal and a smartcard are limited, as the card reader is in practice an independent reader adjacent to the terminal to authorize it to operate.
    </p>
    <heading>BRIEF SUMMARY OF THE INVENTION</heading>
    <p num="18">The goals of the invention are: significantly increasing the functions conferred on a communications system by the presence of a smartcard; reducing the manufacturing costs of this enhancement; and, for the user, facilitating simultaneous mastery of communication with the modem and utilization of a smartcard in the context of this communication.</p>
    <p num="19">According to the invention, it is proposed that the microcontroller of a modem, which microcontroller provides the main functions of controlling communication between a PC and a network and which responds to commands from the PC, has programs providing these main communication control functions and programs controlling a circuit that interfaces with a smartcard.</p>
    <p num="20">Thus, the modem microcontroller also constitutes the kernel of a smartcard reader; the commands from the PC for controlling the modem allow the microcontroller to function as a card reader for operations that involve a card, or allow the microcontroller to function as a device controlling communication with the network.</p>
    <p num="21">According to a more detailed structural definition, the present invention provides a modem for data communication between a terminal and a data transmission network, said modem having a microcontroller with internal programs for managing this communication, these programs being activated when the terminal sends predetermined commands to the microcontroller, characterized in that the modem also has a receptacle for receiving a removable smartcard, a connector in this receptacle for establishing electrical links with contacts on the card, and a card interface circuit connected between the microcontroller and the connector to allow communication between the card and the microcontroller through the connector and the card interface circuit, said card interface circuit being controlled by the modem microcontroller and the microcontroller having other internal programs allowing communication between the terminal and the card to be managed under the control of other commands emitted by the terminal.</p>
    <p num="22">Hence the modem has the mechanical elements necessary for inserting a card, holding it in place, and an electrical connection with specialized contacts; said specialized contacts are connected by an interface circuit between the card and the microcontroller.</p>
    <p num="23">
      In addition, the programs coming from the PC have modem-type operating commands and card reader-type operating commands.
      <br/>
      However, since it is the same microcontroller that receives these two types of command, the invention provides that the commands that trigger card reader-type operation use the same language as those that command communication by the modem with the network; it is provided in particular:
      <br/>
      that all these commands begin with the same prefix sequence recognized by the microcontroller as defining a command intended for the modem, whereby the microcontroller has means for recognizing the arrival of this prefix sequence and executing a command following this prefix sequence;
      <br/>
      and that all the commands for communication with the card continue with a second prefix sequence immediately following the first and followed by a command proper, whereby the microcontroller has means for recognizing this second prefix sequence and then executing said command which is a communication command between the terminal and the card.
    </p>
    <p num="24">In the standard example of modems operating with AT commands, the first prefix sequence is the command 'AT; the second prefix sequence can be the command `+G`. Hence, all the communication instructions with the card begin with the specific sequence `AT+G`.</p>
    <p num="25">
      In the entire following description, sequences representing commands are written in alphanumeric characters (letters, numbers, and other classical ASCII symbols) and placed between quote marks.
      <br/>
      They actually correspond to what the user has to type on the keyboard if the commands are input by keyboard.
      <br/>
      The electrical signals corresponding to them and sent to the microcontroller are the binary strings corresponding to the ASCII transcription of these alphanumeric characters and symbols.
    </p>
    <p num="26">The instructions intended specifically for communication with the card are executed by the microcontroller as soon as it receives them and recognizes the command `AT+G` that prefixes these instructions.</p>
    <p num="27">
      The card can be used to provide an operating authorization to the PC or the modem, but also to ensure authentication of a party from a control authority connected to the network: for example, if access to a database connected to the network is controlled by a server, the latter can ask authentication questions in which the card plays a key role.
      <br/>
      This is also the case for validating remote transactions with the card.
    </p>
    <p num="28">Other characteristics and advantages of the invention will emerge from reading the detailed description that follows, which refers to the attached drawings wherein:</p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="29">
      FIG. 1 represents a classical PC configuration connected to a network by a modem;
      <br/>
      FIG. 2 represents the general structure of the modem;
      <br/>
      FIG. 3 represents the structure of the modem modified according to the invention;
      <br/>
      FIG. 4 shows a detail of FIG. 3.
    </p>
    <heading>DETAILED DESCRIPTION OF THE INVENTION</heading>
    <p num="30">
      FIG. 1 represents a terminal 10, which is preferably a personal computer (PC) with its keyboard and screen, connected to a communications network 20 which can simply be the telephone network.
      <br/>
      A modem 30 is classically interposed between the PC and the network to ensure that the data to be transmitted from the PC to the network conform to a standard acceptable to this network.
      <br/>
      Other terminals are disposed at other input-output points of the network and a modem is interposed between each terminal and the network.
      <br/>
      A communication can thus be established between two PCs.
    </p>
    <p num="31">The modem can be built into the PC; it is generally then a specialized peripheral card in the PC; or it can be in a housing separate from the computer, connected to a serial communications port of the PC.</p>
    <p num="32">
      The various functions of the modem are established by a microcontroller which constitutes the intelligent kernel of the modem.
      <br/>
      This microcontroller has a microprocessor (capable of receiving and executing sets of instructions) and memories, particularly at least one read only memory which contains programs or subprograms for the microprocessor.
      <br/>
      The various programs correspond to the various outgoing or incoming communication functions that the modem may have: communication establishing routines (calling, dialing, auto answer, etc.), error correction, redundancy, and data compression procedures, operating in fax mode, etc.
    </p>
    <p num="33">These programs and subprograms in the microcontroller memories are what are called the firmware of the modem, namely the fixed software physically built into the equipment.</p>
    <p num="34">
      These integrated programs are activated by a command from the PC.
      <br/>
      For this purpose the latter provides the microcontroller with commands (in the computer processing sense of the term), namely orders to run executable subprograms, and these commands can either be entered directly from the PC keyboard by the user or furnished by the memories of the PC.
      <br/>
      The microcontroller interprets these commands, usually received in ASCII format, and executes them by running the appropriate program or programs.
    </p>
    <p num="35">
      In practice, almost all modems operate with commands known as AT commands or Hayes commands.
      <br/>
      Each command has a sequence of several keyboard characters and all the sequences begin with the string of two consecutive characters, namely of the character `A` followed by the character `T`. The command ends with the character representing the "carriage return" or "enter" on a classical keyboard.
      <br/>
      As soon as the modem microcontroller receives the `AT` sequence, it knows that the command is intended for it, registers it, and waits for the end (carriage return) to execute it.
    </p>
    <p num="36">
      As previously explained, if the `AT` sequence is followed by the `+F` sequence, the microcontroller knows that it must configure the modem in "fax" mode and the programs it will execute will correspond to a fax transmission protocol.
      <br/>
      Certain modems do not have this "fax" mode.
    </p>
    <p num="37">FIG. 2 shows the classical schematic configuration of a modem with a PC communications interface circuit 40 (generally a serial communications interface circuit), a microcontroller 50, a specialized signal processor 60 constituting the data pump, namely the modulation/demodulation circuit proper controlled by the microcontroller, and a line interface circuit 70 (serial communications interface) connected to the network.</p>
    <p num="38">FIG. 3 shows schematically the configuration of a modem according to the invention.</p>
    <p num="39">
      The modem has the same elements as in FIG. 2, and also physical elements proper for constituting a smartcard reader, but the kernel of this reader is not a specific microcontroller programmed as a card reader, but is microcontroller 50 of the modem which has built-in software (firmware) appropriate for communication between the card and the PC.
      <br/>
      The additional elements added relative to FIG. 2 are, in addition to specific supplementary programs of the microcontroller firmware, a receptacle 80 for receiving a card with an insertion slot 90, a connector in this slot, and a card interface circuit controllable by the microcontroller.
    </p>
    <p num="40">FIG. 4 shows schematically card interface 100, connector 110, and card 120 with contacts 130 that can be opposite connector 110 when the card is inserted into its receptacle.</p>
    <p num="41">
      To facilitate the use of the smartcard in association with the modem, it is provided not only that the same microprocessor form the kernel of the modem and the kernel of the card reader, but it is also provided that the commands from the PC for communication with the card form a subset of the modem commands.
      <br/>
      In other words, in the typical case where the modem commands necessarily begin with the sequence `AT`, it is provided that the communication commands with the card also necessarily begin with the sequence `AT`.
    </p>
    <p num="42">
      In order for the microcontroller to determine that this is a communication command with the card, it is preferably arranged that any card communication command begin with the sequence `AT+G` and end with an ASCII character corresponding to the carriage return.
      <br/>
      The rest of the sequence, before the carriage return, precisely defines the commend requested.
    </p>
    <p num="43">It will hence be understood that the modem of the invention is provided with internal programs such that:</p>
    <p num="44">
      its microcontroller reacts to a two-character sequence `AT` by considering the next sequence as a command;
      <br/>
      the same microcontroller reacts to a four-character sequence `AT+G` by considering the next sequence up to the next carriage return character as a card communication command.
    </p>
    <p num="45">The card communication commands can be various.</p>
    <p num="46">
      The general principles adopted for card communication commands are preferably the following (other than the general principle of beginning any sequence with the sequence `AT+G` and the general principle of ending with a carriage return character):
      <br/>
      the commands are accepted in upper case or in lower case; the microcontroller thus interprets an ASCII character corresponding to a lower-case alphabetical character and the ASCII character corresponding to the same alphabetical character in upper case, identically;
      <br/>
      the `AT+G` sequence is however of a single type;
      <br/>
      interpretation of the command does not begin until after the carriage return;
      <br/>
      the card commands cannot be chained: a command is not accepted until the previous command has been fully executed and until any response has been transmitted; on the contrary, operating commands from the modem for communication with the network can be chained;
      <br/>
      the number of characters contained in one command line cannot exceed 256;
    </p>
    <p num="47">
      The command proper can be accompanied by mandatory or optional parameters allowing it to be executed;
      <br/>
      the equals sign `=` is a separator indicating the presence of parameters associated with the command; it is placed after the command proper; if there are several parameters, they are separated by a comma (`,`); a parameter can be constituted by one or more octets without a separator;
      <br/>
      the command octets received by the microcontroller are expressed in hexadecimal and each is constituted by two ASCII characters; they can be input from the PC keyboard and transmitted as such to the microcontroller.
    </p>
    <p num="48">
      The card communication commands normally evoke responses.
      <br/>
      The format of the responses sent by the modem to the terminal in the case of a communication with the smartcard is the following:
      <br/>
      the card responses are of a single type (extended) and cannot be suppressed;
      <br/>
      each response begins and ends with a carriage return followed by the sequence `lf`;
      <br/>
      a response can be constituted by one or more parameters separated by a comma
      <br/>
      an `ERROR` response is sent if the command has a syntax error or if one or more parameters are wrong.
    </p>
    <p num="49">Set of Commands</p>
    <p num="50">
      Several main commands that can be used to operate the modem according to the invention for its communication function with a smartcard will now be provided, and the associated responses will also be given.
      <br/>
      Commands between the PC and the network are classical Hayes commands.
    </p>
    <p num="51">1. Turn On and Reset</p>
    <p num="52">
      To turn on a card and reset (reinitialize) it, the `AT+GON` command is sent; it is followed by a parameter T1 (value between 0 and 255) defining the card insertion waiting time.
      <br/>
      The command is `AT+GON=T1`.
    </p>
    <p num="53">
      The response sent by the modem microcontroller to the terminal is composed of the sequence `TS` followed by at most 32 characters.
      <br/>
      These characters can be the following parameters: TO (format character), TAi, TBi, TCi, TDi (interface character), T1, T2 . . . Tk (history characters), TCK (control character).
    </p>
    <p num="54">2. Card Hot Reset</p>
    <p num="55">Hot reset (without turning off) is controlled by the sequence `AT+GWR`.</p>
    <p num="56">The response is the same as for turning on.</p>
    <p num="57">3. Sending Dialog Command</p>
    <p num="58">
      Without going into details of the communication protocols between a card reader and a card, it will be recalled that the ISO7816 standards call for dialog commands between the reader and the card; these commands are grouped under the designator APDU.
      <br/>
      By analogy, a command prefix `AT+GPDU` is created here and this, when sent by the terminal to the modem microcontroller, indicates that an APDU type command is to be sent to the card.
      <br/>
      The command sent will obey the following rules after the prefix sequence `AT+GPDU` and before the carriage return:
      <br/>
      the command includes a header and a body;
      <br/>
      the header includes successive values CLA, INS, P1, P2, each represented by an octet (two ASCII characters); each value is between 0 and 255; CLA is the instruction class; INS is the instruction code, and P1 and P2 are parameters;
      <br/>
      the body of the instruction has three fields: Lc, Data, and Le.
      <br/>
      The Lc field contains the number of words present in the data field; Data is the data field proper to be transmitted; "le" is the number of words expected in the response.
    </p>
    <p num="59">
      For example, the instruction:
      <br/>
      `AT+GPDU=OX,DA,02,A0,2,6D,6C,0,0`
    </p>
    <p num="60">- is a write request (data accept instruction DA) to address 02A0 of a field of two (2) octets including the characters 6D and 6C.</p>
    <p num="61">The response is composed of an optional body which is a data field representing a number of words received, and a mandatory ending including two octets SW1, SW2 called "command processing status" and "command processing qualifier"; these two octets represent the fact that the command is correct and there is no error in the data.</p>
    <p num="62">Other than a write request (DA), other commands of the APDU type are possible, for example a read request for a zone of the card, a signature calculation request by the card, etc.</p>
    <p num="63">4. Identification</p>
    <p num="64">
      The command is an inquiry about the type of card inserted.
      <br/>
      The command is `AT+GI`. It is not followed by parameters.
    </p>
    <p num="65">The response is a group of two octets R1, R2 representing the type of coupler and the type of card respectively.</p>
    <p num="66">5. Turning Off</p>
    <p num="67">
      Turning off is done by `AT+GOFF` command without a parameter.
      <br/>
      The response is the octet R1 defining the type of coupler.
    </p>
    <p num="68">6. Configuration</p>
    <p num="69">
      The card register configuration can be commanded by the terminal.
      <br/>
      The command is `AT+GSR` followed by the parameters S1, S2, S3 which define the registers to be activated ("set register" command).
      <br/>
      The response is a string of octets confirming this activation.
    </p>
    <p num="70">This defines the principal commands that can be sent by the terminal for the modem microcontroller and which are understood as instructions for communication with a smartcard inserted into the insertion slot associated with the modem.</p>
    <p num="71">
      Card interface circuit 100 which is controlled by the microcontroller upon reception of these commands is constituted in classical fashion (namely like a classical card reader) such as to establish signals according to a classical communication protocol between a card and its reader.
      <br/>
      Reference may be made to ISO 7816 for the format of these signals and hence for constituting the interface circuit.
      <br/>
      The card connector generally has 6 or 8 contacts including at least the following contacts: CLK (clock), I/O data, RST (reset), VCC (power supply), and GND (ground).
      <br/>
      These contacts are shown in FIG. 4.
    </p>
    <p num="72">In one application to local modem utilization security, it is the PC that manages this security, access to the modem being authorized if the PC has ascertained that a smartcard has been introduced into the modem and the secret code corresponding to this card has been keyed in by the user.</p>
    <p num="73">In this case, the procedure may be as follows: the PC security program asks the user to insert a card into the modem and for example sends an instruction of the `AT+GON` type to the modem microcontroller; when the card is present, it sends a response (in a communication protocol between reader and card) and this response is sent by the microcontroller to the PC (in the PC protocol; the PC asks the user to enter his secret code using the keyboard; it sends this code to the card by an instruction beginning with `AT+G`; the card verifies this code and sends an accept or refuse response; the modem microcontroller sends this acceptance or refusal and the PC authorizes or fails to authorize its "modem" peripheral for the network communication functions depending on acceptance or refusal.</p>
    <p num="74">
      In another application, the card is used to authorize access or transactions with a party on the network.
      <br/>
      This is not a local mode security application but a remote mode security application.
    </p>
    <p num="75">
      For example, the PC is used to access an on-line database managed by a server, with the access being authorized if the user is indeed an authorized subscriber, provided for this purpose with a smartcard and a secret code which he alone possesses.
      <br/>
      The card is then preferably a card with response calculation algorithms involving at least one secret key contained in the card.
    </p>
    <p num="76">
      The PC establishes the link with the network by `AT` commands sent to the modem (but not `AT+G` commands).
      <br/>
      The database server starts a control procedure consisting of asking the PC to furnish a response to a random datum.
      <br/>
      The correct response can be sent only if the PC user uses simultaneously the random datum, a secret key contained in the card, and a secret code possessed by the user.
      <br/>
      The correct response can be calculated by the server which knows its subscribers and thus knows the secret keys, the secret codes, and the random data they send.
      <br/>
      A comparison of responses by the server will authorize access to the database.
    </p>
    <p num="77">In this case, after the PC has received a random datum from the server, it starts a dialog with the card by commands of the `AT+G` type; the PC sends the random datum to the modem microcontroller; the latter sends it to the card in the card communication protocol; it does the same for a secret code that the PC asks the user to enter; the card calculates a response, sends it to the modem microcontroller, which transmits it in its turn to the PC; then the PC sends it to the network by an `AT` type command not followed by the prefix `+G`. The server then checks the accuracy of the response and authorizes access to the database or refuses such access.</p>
    <p num="78">The procedure would be similar for making a transaction validated by the fact that an accurate response is furnished by the card in response to a random datum.</p>
    <p num="79">
      Since it is the same microprocessor that controls the communication with the network and the communication with the card, it may be that the microcontroller responds directly to a specific command from the network (not from the PC) to transmit the random datum directly to the card, or perform other communication operations with the card without going via the PC.
      <br/>
      For example, if procedures using the card do not require entering a secret code via the keyboard, such operations may be performed directly, facilitated by the fact that it is the same microcontroller that controls both the modem and the card.
    </p>
    <p num="80">A novel modem design has been described, offering more options than in the prior art, which is less expensive, and more practical for the user since the communication syntax can be essentially the same for the modem and for the card.</p>
    <p num="81">
      Among possible applications, one may cite:
      <br/>
      remote payment by bank card; remote sale;
      <br/>
      secure access to in-house networks from outside networks such as the internet;
      <br/>
      card-controlled banking at home; bill paying; purchase and sale of securities;
      <br/>
      electronic purse;
      <br/>
      secure automatic connection to databases or to software help servers providing software upgrades, remote troubleshooting, etc.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>Modem for data communication between a terminal (10) and a data transmission network (20), said modem having a microcontroller (50) with internal programs for managing this communication, these programs being activated when the terminal sends predetermined commands to the microcontroller, characterized in that the modem also has a card interface circuit (100) to allow communication between a removable integrated circuit card and the microcontroller, said card interface circuit being controlled by the modem microcontroller and the microcontroller having other internal programs allowing communication between the terminal and the card to be managed under the control of other commands emitted by the terminal.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. Modem according to claim 1, characterized in that all the commands intended for the modem microcontroller have a first predetermined prefix sequence (`AT`), said microcontroller having means for recognizing the arrival of this sequence and executing a command following this prefix sequence.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. Modem according to claim 2, characterized in that all the communication commands between the terminal and the card have a second predetermined prefix sequence (`+G`) immediately following the first prefix sequence (`AT`), said microcontroller having means for recognizing the arrival of this second sequence and executing a command according to these two sequences.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. Modem according to claim 2, characterized in that the first prefix sequence is `AT" and a second prefix sequence is `+G".</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. A modem according to claim 1 further comprising a receptacle (80) for receiving the removable integrated circuit card (120), with a connector (110) in this receptacle for establishing electrical links with contacts on the card, and said card interface circuit connected between the microcontroller and the connector establishes communication between the card and the microcontroller through the connector (110) and the card interface circuit (100).</claim-text>
    </claim>
  </claims>
</questel-patent-document>