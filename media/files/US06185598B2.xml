<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06185598B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06185598</doc-number>
        <kind>B2</kind>
        <date>20010206</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6185598</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference family-id="21804620" extended-family-id="613237">
      <document-id>
        <country>US</country>
        <doc-number>09021506</doc-number>
        <kind>A</kind>
        <date>19980210</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1998US-09021506</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>634053</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>2150698</doc-number>
        <kind>A</kind>
        <date>19980210</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1998US-09021506</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010206</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>G06F  13/00        20060101ALI20051220RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>00</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051220</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>G06F  12/00        20060101AFI20051220RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>12</main-group>
        <subgroup>00</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051220</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="3">
        <text>G06F   9/50        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>9</main-group>
        <subgroup>50</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="4">
        <text>G06F  15/00        20060101ALI20051220RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>15</main-group>
        <subgroup>00</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051220</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="5">
        <text>G06F  17/30        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>17</main-group>
        <subgroup>30</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="6">
        <text>H04L  29/06        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>29</main-group>
        <subgroup>06</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="7">
        <text>H04L  29/08        20060101A I20070721RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>29</main-group>
        <subgroup>08</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20070721</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="8">
        <text>H04L  29/12        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>29</main-group>
        <subgroup>12</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>709200000</text>
        <class>709</class>
        <subclass>200000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>709203000</text>
        <class>709</class>
        <subclass>203000</subclass>
      </further-classification>
      <further-classification sequence="2">
        <text>709226000</text>
        <class>709</class>
        <subclass>226000</subclass>
      </further-classification>
      <further-classification sequence="3">
        <text>709233000</text>
        <class>709</class>
        <subclass>233000</subclass>
      </further-classification>
      <further-classification sequence="4">
        <text>709234000</text>
        <class>709</class>
        <subclass>234000</subclass>
      </further-classification>
      <further-classification sequence="5">
        <text>709235000</text>
        <class>709</class>
        <subclass>235000</subclass>
      </further-classification>
      <further-classification sequence="6">
        <text>709236000</text>
        <class>709</class>
        <subclass>236000</subclass>
      </further-classification>
      <further-classification sequence="7">
        <text>709237000</text>
        <class>709</class>
        <subclass>237000</subclass>
      </further-classification>
      <further-classification sequence="8">
        <text>709239000</text>
        <class>709</class>
        <subclass>239000</subclass>
      </further-classification>
      <further-classification sequence="9">
        <text>709240000</text>
        <class>709</class>
        <subclass>240000</subclass>
      </further-classification>
      <further-classification sequence="10">
        <text>709241000</text>
        <class>709</class>
        <subclass>241000</subclass>
      </further-classification>
    </classification-national>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06F-009/505</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>9</main-group>
        <subgroup>505</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131024</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06F-017/30899</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>17</main-group>
        <subgroup>30899</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131024</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06F-2209/509</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>2209</main-group>
        <subgroup>509</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20141003</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="4">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-029/06</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>29</main-group>
        <subgroup>06</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131024</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="5">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-029/12066</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>29</main-group>
        <subgroup>12066</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131024</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="6">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-029/12594</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>29</main-group>
        <subgroup>12594</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131024</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="7">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-043/065</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>43</main-group>
        <subgroup>065</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131024</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="8">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-043/0817</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>43</main-group>
        <subgroup>0817</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131024</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="9">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-043/16</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>43</main-group>
        <subgroup>16</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131024</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="10">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-061/1511</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>61</main-group>
        <subgroup>1511</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131024</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="11">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-061/301</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>61</main-group>
        <subgroup>301</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131024</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="12">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/02</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>02</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="13">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/1002</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>1002</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="14">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/1006</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>1006</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="15">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/1008</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>1008</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="16">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/101</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>101</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="17">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/1012</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>1012</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="18">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/1014</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>1014</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="19">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/1019</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>1019</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="20">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/1021</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>1021</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="21">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/1023</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>1023</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="22">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/1025</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>1025</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="23">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/1036</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>1036</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="24">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/1095</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>1095</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="25">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/125</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>125</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="26">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/28</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>28</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="27">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/2804</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>2804</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="28">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/2814</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>2814</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="29">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/2819</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>2819</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="30">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/2842</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>2842</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="31">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/2852</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>2852</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="32">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/2895</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>2895</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="33">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-067/322</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>67</main-group>
        <subgroup>322</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131017</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="34">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-2029/06054</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>2029</main-group>
        <subgroup>06054</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20131024</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>27</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>6</number-of-drawing-sheets>
      <number-of-figures>6</number-of-figures>
      <image-key data-format="questel">US6185598</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Optimized network resource location</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>PITKIN RICHARD P, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5341477</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5341477</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>DEMERS ALAN J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5603026</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5603026</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>LAGARDE KONRAD CHARLES, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5761663</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5761663</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>BRENDEL JUERGEN, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5774660</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5774660</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="5">
          <text>KIRSCH STEVEN T</text>
          <document-id>
            <country>US</country>
            <doc-number>5870546</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5870546</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="6">
          <text>PERIASAMY RAVI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>6065062</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6065062</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="7">
          <text>KITAJIMA HIROYUKI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4495570</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4495570</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="8">
          <text>OLLIVIER YVES</text>
          <document-id>
            <country>US</country>
            <doc-number>4594704</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4594704</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="9">
          <text>KRUM HARRY A, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4726017</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4726017</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="10">
          <text>EGUCHI HIROYOSHI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4839798</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4839798</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="11">
          <text>EGGERS DEREK C, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4920432</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4920432</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="12">
          <text>COHEN JASON M</text>
          <document-id>
            <country>US</country>
            <doc-number>4949187</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4949187</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="13">
          <text>CARO MARSHALL A</text>
          <document-id>
            <country>US</country>
            <doc-number>4949248</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4949248</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="14">
          <text>BRADLEY GRAHAM C, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5172413</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5172413</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="15">
          <text>ROZMANITH ANTHONY I, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5253341</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5253341</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="16">
          <text>NEWMARK RONA J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5287537</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5287537</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="17">
          <text>MORALES FERNANDO</text>
          <document-id>
            <country>US</country>
            <doc-number>5291554</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5291554</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="18">
          <text>GELMAN ALEXANDER, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5371532</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5371532</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="19">
          <text>CODDINGTON CARL D, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5410343</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5410343</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="20">
          <text>HOOPER DONALD F, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5414455</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5414455</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="21">
          <text>BLAHUT DONALD E, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5442389</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5442389</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="22">
          <text>HOOPER DONALD F, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5442390</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5442390</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="23">
          <text>NORTHCUTT J DUANE, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5442749</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5442749</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="24">
          <text>EADLINE DOUGLAS J</text>
          <document-id>
            <country>US</country>
            <doc-number>5471622</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5471622</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="25">
          <text>LIN K DAVID</text>
          <document-id>
            <country>US</country>
            <doc-number>5475615</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5475615</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="26">
          <text>BOTTOMLEY JOHN F, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5508732</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5508732</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="27">
          <text>NGUYEN TAM M, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5515511</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5515511</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="28">
          <text>ANDERSON MICHAEL H</text>
          <document-id>
            <country>US</country>
            <doc-number>5519435</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5519435</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="29">
          <text>GRADY JOHN, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5528281</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5528281</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="30">
          <text>KIKINIS DAN</text>
          <document-id>
            <country>US</country>
            <doc-number>5539621</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5539621</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="31">
          <text>SHACHNAI HADAS, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5544313</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5544313</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="32">
          <text>DAN ASIT, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5544327</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5544327</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="33">
          <text>VERBIEST WILLEM J A, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5550577</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5550577</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="34">
          <text>YURT PAUL, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5550863</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5550863</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="35">
          <text>LONG JAMES E, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5550982</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5550982</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="36">
          <text>NISHIO MAKOTO, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5557317</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5557317</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="37">
          <text>JUDSON DAVID H</text>
          <document-id>
            <country>US</country>
            <doc-number>5572643</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5572643</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="38">
          <text>CASTOR PATRICK F, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5590288</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5590288</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="39">
          <text>MIDGELY CHRISTOPHER W, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5592611</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5592611</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="40">
          <text>FILEPP ROBERT, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5594910</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5594910</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="41">
          <text>CANALE LEONARD M, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5619648</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5619648</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="42">
          <text>LYONS KENNETH B</text>
          <document-id>
            <country>US</country>
            <doc-number>5623656</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5623656</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="43">
          <text>CLINE TROY L, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5625781</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5625781</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="44">
          <text>GLEESON BRYAN J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5627829</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5627829</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="45">
          <text>KINDELL CRAIG N, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5630067</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5630067</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="46">
          <text>CLOWES RICHARD F, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5633999</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5633999</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="47">
          <text>BAUGHER MARK J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5634006</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5634006</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="48">
          <text>KIKINIS DAN</text>
          <document-id>
            <country>US</country>
            <doc-number>5644714</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5644714</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="49">
          <text>FERGUSON GREGORY J</text>
          <document-id>
            <country>US</country>
            <doc-number>5649186</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5649186</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="50">
          <text>NIELSEN JAKOB</text>
          <document-id>
            <country>US</country>
            <doc-number>5659729</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5659729</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="51">
          <text>CHEN CHENG T, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5666362</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5666362</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="52">
          <text>ELGAMAL TAHER</text>
          <document-id>
            <country>US</country>
            <doc-number>5671279</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5671279</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="53">
          <text>TETRICK R SCOTT</text>
          <document-id>
            <country>US</country>
            <doc-number>5682512</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5682512</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="54">
          <text>FEIGEN RONALD GLEN, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5699513</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5699513</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="55">
          <text>STEWART GORDON GREGORY</text>
          <document-id>
            <country>US</country>
            <doc-number>5715453</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5715453</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="56">
          <text>DEVRIES LARRY R</text>
          <document-id>
            <country>US</country>
            <doc-number>5721914</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5721914</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="57">
          <text>SANDERS JAMES B</text>
          <document-id>
            <country>US</country>
            <doc-number>5734831</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5734831</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="58">
          <text>SCHOLL THOMAS H, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5742762</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5742762</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="59">
          <text>CHOQUIER PHILIPPE, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5774668</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5774668</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="60">
          <text>DAVIS OWEN, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5796952</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5796952</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="61">
          <text>GALIPEAU KENNETH J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5799141</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5799141</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="62">
          <text>GEHR CHUCK ROYAL, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5828847</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5828847</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="63">
          <text>KENNER BRIAN, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5956716</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5956716</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="64">
          <text>KRIEGSMAN MARK E</text>
          <document-id>
            <country>US</country>
            <doc-number>5991809</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5991809</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="65">
          <text>IBM</text>
          <document-id>
            <country>GB</country>
            <doc-number>2281793</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>GB2281793</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="66">
          <text>INFONAUTICS CORP</text>
          <document-id>
            <country>WO</country>
            <doc-number>9711429</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>WO9711429</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="1">
          <text>Andresen et al., "SWEB: Towards a Scalable World Wide Web Server on Multicomputers", Proceedings of IPPS, Apr. 15, 1996, pp. 850-856.</text>
        </nplcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="2">
          <text>Mourad et al., "Scalable Web Server Architectures", Proceedings IEEE Symposium on Computers and Communications, Jul. 1, 1997, pp. 12-16.</text>
        </nplcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="3">
          <text>Adler, "Distributed Coordination Models for Client/Server Computing", Computer, vol. 28, No. 4, Apr. 1, 1995, pp. 14-22.</text>
        </nplcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="4">
          <text>International Search Report dated Jun. 8, 1999 for PCT/US99/01477.</text>
        </nplcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Digital Island, Inc.</orgname>
            <address>
              <address-1>San Francisco, CA, US</address-1>
              <city>San Francisco</city>
              <state>CA</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>DIGITAL ISLAND</orgname>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Farber, David A.</name>
            <address>
              <address-1>Oak View, CA, US</address-1>
              <city>Oak View</city>
              <state>CA</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="2">
          <addressbook lang="en">
            <name>Greer, Richard E.</name>
            <address>
              <address-1>Red Lodge, MT, US</address-1>
              <city>Red Lodge</city>
              <state>MT</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="3">
          <addressbook lang="en">
            <name>Swart, Andrew D.</name>
            <address>
              <address-1>Westlake Village, CA, US</address-1>
              <city>Westlake Village</city>
              <state>CA</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="4">
          <addressbook lang="en">
            <name>Balter, James A.</name>
            <address>
              <address-1>Santa Barbara, CA, US</address-1>
              <city>Santa Barbara</city>
              <state>CA</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <orgname>IP Group of Pillsbury Madison &amp; Sutro LLP</orgname>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Maung, Zarni</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>EXPIRED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      Resource requests made by clients of origin servers in a network are intercepted by reflector mechanisms and selectively reflected to other servers called repeaters.
      <br/>
      The reflectors select a best repeater from a set of possible repeaters and redirect the client to the selected best repeater.
      <br/>
      The client then makes the request of the selected best repeater.
      <br/>
      The resource is possibly rewritten to replace at least some of the resource identifiers contained therein with modified resource identifiers designating the repeater instead of the origin server.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>FIELD OF THE INVENTION</heading>
    <p num="1">This invention relates to replication of resources in computer networks.</p>
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="2">
      The advent of global computer networks, such as the Internet, have led to entirely new and different ways to obtain information.
      <br/>
      A user of the Internet can now access information from anywhere in the world, with no regard for the actual location of either the user or the information.
      <br/>
      A user can obtain information simply by knowing a network address for the information and providing that address to an appropriate application program such as a network browser.
    </p>
    <p num="3">
      The rapid growth in popularity of the Internet has imposed a heavy traffic burden on the entire network.
      <br/>
      Solutions to problems of demand (e.g., better accessibility and faster communication links) only increase the strain on the supply.
      <br/>
      Internet Web sites (referred to here as "publishers") must handle ever-increasing bandwidth needs, accommodate dynamic changes in load, and improve performance for distant browsing clients, especially those overseas.
      <br/>
      The adoption of content-rich applications, such as live audio and video, has further exacerbated the problem.
    </p>
    <p num="4">
      To address basic bandwidth growth needs, a Web publisher typically subscribes to additional bandwidth from an Internet service provider (ISP), whether in the form of larger or additional "pipes" or channels from the ISP to the publisher's premises, or in the form of large bandwidth commitments in an ISP's remote hosting server collection.
      <br/>
      These increments are not always as fine-grained as the publisher needs, and quite often lead times can cause the publisher's Web site capacity to lag behind demand.
    </p>
    <p num="5">
      To address more serious bandwidth growth problems, publishers may develop more complex and costly custom solutions.
      <br/>
      The solution to the most common need, increasing capacity, is generally based on replication of hardware resources and site content (known as mirroring), and duplication of bandwidth resources.
      <br/>
      These solutions, however, are difficult and expensive to deploy and operate.
      <br/>
      As a result, only the largest publishers can afford them, since only those publishers can amortize the costs over many customers (and Web site hits).
    </p>
    <p num="6">
      A number of solutions have been developed to advance replication and mirroring.
      <br/>
      In general, these technologies are designed for use by a single Web site and do not include features that allow their components to be shared by many Web sites simultaneously.
    </p>
    <p num="7">
      Some solution mechanisms offer replication software that helps keep mirrored servers up-to-date.
      <br/>
      These mechanisms generally operate by making a complete copy of a file system.
      <br/>
      One such system operates by transparently keeping multiple copies of a file system in synch.
      <br/>
      Another system provides mechanisms for explicitly and regularly copying files that have changed.
      <br/>
      Database systems are particularly difficult to replicate, as they are continually changing.
      <br/>
      Several mechanisms allow for replication of databases, although there are no standard approaches for accomplishing it.
      <br/>
      Several companies offering proxy caches describe them as replication tools.
      <br/>
      However, proxy caches differ because they are operated on behalf of clients rather than publishers.
    </p>
    <p num="8">
      Once a Web site is served by multiple servers, a challenge is to ensure that the load is appropriately distributed or balanced among those servers.
      <br/>
      Domain name-server-based round-robin address resolution causes different clients to be directed to different mirrors.
    </p>
    <p num="9">Another solution, load balancing, takes into account the load at each server (measured in a variety of ways) to select which server should handle a particular request.</p>
    <p num="10">
      Load balancers use a variety of techniques to route the request to the appropriate server.
      <br/>
      Most of those load-balancing techniques require that each server be an exact replica of the primary Web site.
      <br/>
      Load balancers do not take into account the "network distance" between the client and candidate mirror servers.
    </p>
    <p num="11">
      Assuming that client protocols cannot easily change, there are two major problems in the deployment of replicated resources.
      <br/>
      The first is how to select which copy of the resource to use.
      <br/>
      That is, when a request for a resource is made to a single server, how should the choice of a replica of the server (or of that data) be made.
      <br/>
      We call this problem the "rendezvous problem".
      <br/>
      There are a number of ways to get clients to rendezvous at distant mirror servers.
      <br/>
      These technologies, like load balancers, must route a request to an appropriate server, but unlike load balancers, they take network performance and topology into account in making the determination.
    </p>
    <p num="12">
      A number of companies offer products which improve network performance by prioritizing and filtering network traffic.
      <br/>
      Proxy caches provide a way for client aggregators to reduce network resource consumption by storing copies of popular resources close to the end users.
      <br/>
      A client aggregator is an Internet service provider or other organization that brings a large number of clients operating browsers to the Internet.
      <br/>
      Client aggregators may use proxy caches to reduce the bandwidth required to serve web content to these browsers.
      <br/>
      However, traditional proxy caches are operated on behalf of Web clients rather than Web publishers.
    </p>
    <p num="13">Proxy caches store the most popular resources from all publishers, which means they must be very large to achieve reasonable cache efficiency. (The efficiency of a cache is defined as the number of requests for resources which are already cached divided by the total number of requests.)</p>
    <p num="14">
      Proxy caches depend on cache control hints delivered with resources to determine when the resources should be replaced.
      <br/>
      These hints are predictive, and are necessarily often incorrect, so proxy caches frequently serve stale data.
      <br/>
      In many cases, proxy cache operators instruct their proxy to ignore hints in order to make the cache more efficient, even though this causes it to more frequently serve stale data.
    </p>
    <p num="15">
      Proxy caches hide the activity of clients from publishers.
      <br/>
      Once a resource is cached, the publisher has no way of knowing how often it was accessed from the cache.
    </p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="16">
      This invention provides a way for servers in a computer network to off-load their processing of requests for selected resources by determining a different server (a "repeater") to process those requests.
      <br/>
      The selection of the repeater can be made dynamically, based on information about possible repeaters.
    </p>
    <p num="17">If a requested resource contains references to other resources, some or all of these references can be replaced by references to repeaters.</p>
    <p num="18">
      Accordingly, in one aspect, this invention is a method of processing resource requests in a computer network.
      <br/>
      First a client makes a request for a particular resource from an origin server, the request including a resource identifier for the particular resource, the resource identifier sometimes including an indication of the origin server.
      <br/>
      Requests arriving at the origin server do not always include an indication of the origin server; since they are sent to the origin server, they do not need to name it.
      <br/>
      A mechanism referred to as a reflector, co-located with the origin server, intercepts the request from the client to the origin server and decides whether to reflect the request or to handle it locally.
      <br/>
      If the reflector decides to handle the request locally, it forwards it to the origin server, otherwise it selects a "best" repeater to process the request.
      <br/>
      If the request is reflected, the client is provided with a modified resource identifier designating the repeater.
    </p>
    <p num="19">The client gets the modified resource identifier from the reflector and makes a request for the particular resource from the repeater designated in the modified resource identifier.</p>
    <p num="20">
      When the repeater gets the client's request, it responds by returning the requested resource to the client.
      <br/>
      If the repeater has a local copy of the resource then it returns that copy, otherwise it forwards the request to the origin server to get the resource, and saves a local copy of the resource in order to serve subsequent requests.
    </p>
    <p num="21">
      The selection by the reflector of an appropriate repeater to handle the request can be done in a number of ways.
      <br/>
      In the preferred embodiment, it is done by first pre-partitioning the network into "cost groups" and then determining which cost group the client is in.
      <br/>
      Next, from a plurality of repeaters in the network, a set of repeaters is selected, the members of the set having a low cost relative to the cost group which the client is in.
      <br/>
      In order to determine the lowest cost, a table is maintained and regularly updated to define the cost between each group and each repeater.
      <br/>
      Then one member of the set is selected, preferably randomly, as the best repeater.
    </p>
    <p num="22">
      If the particular requested resource itself can contain identifiers of other resources, then the resource may be rewritten (before being provided to the client).
      <br/>
      In particular, the resource is rewritten to replace at least some of the resource identifiers contained therein with modified resource identifiers designating a repeater instead of the origin server.
      <br/>
      As a consequence of this rewriting process, when the client requests other resources based on identifiers in the particular requested resource, the client will make those requests directly to the selected repeater, bypassing the reflector and origin server entirely.
    </p>
    <p num="23">
      Resource rewriting must be performed by reflectors.
      <br/>
      It may also be performed by repeaters, in the situation where repeaters "peer" with one another and make copies of resources which include rewritten resource identifiers that designate a repeater.
    </p>
    <p num="24">
      In a preferred embodiment, the network is the Internet and the resource identifier is a uniform resource locator (URL) for designating resources on the Internet, and the modified resource identifier is a URL designating the repeater and indicating the origin server (as described in step B3 below), and the modified resource identifier is provided to the client using a REDIRECT message.
      <br/>
      Note, only when the reflector is "reflecting" a request is the modified resource identifier provided using a REDIRECT message.
    </p>
    <p num="25">In another aspect, this invention is a computer network comprising a plurality of origin servers, at least some of the origin servers having reflectors associated therewith, and a plurality of repeaters.</p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="26">
      The above and other objects and advantages of the invention will be apparent upon consideration of the following detailed description, taken in conjunction with the accompanying drawings, in which the reference characters refer to like parts throughout and in which:
      <br/>
      FIG. 1 depicts a portion of a network environment according to the present invention; and
      <br/>
      FIGS. 2-6 are flow charts of the operation of the present invention.
    </p>
    <heading>DETAILED DESCRIPTION OF THE PRESENTLY PREFERRED EXEMPLARY EMBODIMENTS</heading>
    <p num="27">Overview</p>
    <p num="28">
      FIG. 1 shows a portion of a network environment 100 according to the present invention, wherein a mechanism (reflector 108, described in detail below) at a server (herein origin server 102) maintains and keeps track of a number of partially replicated servers or repeaters 104a, 104b, and 104c.
      <br/>
      Each repeater 104a, 104b, and 104c replicates some or all of the information available on the origin server 102 as well as information available on other origin servers in the network 100.
      <br/>
      Reflector 108 is connected to a particular repeater known as its "contact" repeater ("Repeater B" 104b in the system depicted in FIG. 1).
      <br/>
      Preferably each reflector maintains a connection with a single repeater known as its contact, and each repeater maintains a connection with a special repeater known as its master repeater (e.g., repeater 104m for repeaters 104a, 104b and 104c in FIG. 1).
    </p>
    <p num="29">
      Thus, a repeater can be considered as a dedicated proxy server that maintains a partial or sparse mirror of the origin server 102, by implementing a distributed coherent cache of the origin server.
      <br/>
      A repeater may maintain a (partial) mirror of more than one origin server.
      <br/>
      In some embodiments, the network 100 is the Internet and repeaters mirror selected resources provided by origin servers in response to clients' HTTP hypertext transfer protocol) and FTP (file transfer protocol) requests.
    </p>
    <p num="30">A client 106 connects, via the network 100, to origin server 102 and possibly to one or more repeaters 104a etc.</p>
    <p num="31">
      Origin server 102 is a server at which resources originate.
      <br/>
      More generally, the origin server 102 is any process or collection of processes that provide resources in response to requests from a client 106.
      <br/>
      Origin server 102 can be any off-the-shelf Web server.
      <br/>
      In a preferred embodiment, origin server 102 is typically a Web server such as the Apache server or Netscape Communications Corporation's Enterprise (tm)  server.
    </p>
    <p num="32">
      Client 106 is a processor requesting resources from origin server 102 on behalf of an end user.
      <br/>
      The client 106 is typically a user agent (e.g., a Web browser such as Netscape Communications Corporation's Navigator (tm) ) or a proxy for a user agent.
      <br/>
      Components other than the reflector 108 and the repeaters 104a, 104b, etc., may be implemented using commonly available software programs.
      <br/>
      In particular, this invention works with any HTTP client (e.g., a Web browser), proxy cache, and Web server.
      <br/>
      In addition, the reflector 108 might be fully integrated into the data server 112 (for instance, in a Web Server).
      <br/>
      These components might be loosely integrated based on the use of extension mechanisms (such as so-called add-in modules) or tightly integrated by modifying the service component specifically to support the repeaters.
    </p>
    <p num="33">
      Resources originating at the origin server 102 may be static or dynamic.
      <br/>
      That is, the resources may be fixed or they may be created by the origin server 102 specifically in response to a request.
      <br/>
      Note that the terms "static" and "dynamic" are relative, since a static resource may change at some regular, albeit long, interval.
    </p>
    <p num="34">
      Resource requests from the client 106 to the origin server 102 are intercepted by reflector 108 which for a given request either forwards the request on to the origin server 102 or conditionally reflects it to some repeater 104a, 104b, etc. in the network 100.
      <br/>
      That is, depending on the nature of the request by the client 106 to the origin server 102, the reflector 108 either serves the request locally (at the origin server 102), or selects one of the repeaters (preferably the best repeater for the job) and reflects the request to the selected repeater.
      <br/>
      In other words, the reflector 108 causes requests for resources from origin server 102, made by client 106, to be either served locally by the origin server 102 or transparently reflected to the best repeater 104a, 104b, etc.
      <br/>
      The notion of a best repeater and the manner in which the best repeater is selected are described in detail below.
    </p>
    <p num="35">
      Repeaters 104a, 104b, etc. are intermediate processors used to service client requests thereby improving performance and reducing costs in the manner described herein.
      <br/>
      Within repeaters 104a, 104b, etc., are any processes or collections of processes that deliver resources to the client 106 on behalf of the origin server 102.
      <br/>
      A repeater may include a repeater cache 110, used to avoid unnecessary transactions with the origin server 102.
    </p>
    <p num="36">
      The reflector 108 is a mechanism, preferably a software program, that intercepts requests that would normally be sent directly to the origin server 102.
      <br/>
      While shown in the drawings as separate components, the reflector 108 and the origin server 102 are typically co-located, e.g., on a particular system such as data server 112. (As discussed below, the reflector 108 may even be a "plug in" module that becomes part of the origin server 102.
    </p>
    <p num="37">
      FIG. 1 shows only a part of a network 100 according to this invention.
      <br/>
      A complete operating network consists of any number of clients, repeaters, reflectors, and origin servers.
      <br/>
      Reflectors communicate with the repeater network, and repeaters in the network communicate with one another.
    </p>
    <p num="38">Uniform Resource Locators</p>
    <p num="39">
      Each location in a computer network has an address which can generally be specified as a series of names or numbers.
      <br/>
      In order to access information, an address for that information must be known.
      <br/>
      For example, on the World Wide Web ("the Web") which is a subset of the Internet, the manner in which information address locations are provided has been standardized into Uniform Resource Locators (URLs).
      <br/>
      URLs specify the location of resources (information, data files, etc.) on the network.
    </p>
    <p num="40">
      The notion of URLs becomes even more useful when hypertext documents are used.
      <br/>
      A hypertext document is one which includes, within the document itself, links (pointers or references) to the document itself or to other documents.
      <br/>
      For example, in an on-line legal research system, each case may be presented as a hypertext document.
      <br/>
      When other cases are cited, links to those cases can be provided.
      <br/>
      In this way, when a person is reading a case, they can follow cite links to read the appropriate parts of cited cases.
    </p>
    <p num="41">
      In the case of the Internet in general and the World Wide Web specifically, documents can be created using a standardized form known as the Hypertext Markup Language (HTML).
      <br/>
      In HTML, a document consists of data (text, images, sounds, and the like), including links to other sections of the same document or to other documents.
      <br/>
      The links are generally provided as URLs, and can be in relative or absolute form.
      <br/>
      Relative URLs simply omit the parts of the URL which are the same as for the document including the link, such as the address of the document (when linking to the same document), etc.
      <br/>
      In general, a browser program will fill in missing parts of a URL using the corresponding parts from the current document, thereby forming a fully formed URL including a fully qualified domain name, etc.
    </p>
    <p num="42">
      A hypertext document may contain any number of links to other documents, and each of those other documents may be on a different server in a different part of the world.
      <br/>
      For example, a document may contain links to documents in Russia, Africa, China and Australia.
      <br/>
      A user viewing that document at a particular client can follow any of the links transparently (i.e., without knowing where the document being linked to actually resides).
      <br/>
      Accordingly, the cost (in terms of time or money or resource allocation) of following one link versus another may be quite significant.
    </p>
    <p num="43">
      URLs generally have the following form (defined in detail in T. Berners-Lee et al, Uniform Resource Locators (URL), Network Working Group, Request for Comments: 1738, Category: Standards Track, December 1994, located at "http://ds.internic.net/rfc/rfc1738.txt", which is hereby incorporated herein by reference):
      <br/>
      scheme://host�port�/url-path
    </p>
    <p num="44">
      where "scheme" can be a symbol such as "file" (for a file on the local system), "ftp" (for a file on an anonymous FTP file server), "http" (for a file on a file on a Web server), and "telnet" (for a connection to a Telnet-based service).
      <br/>
      Other schemes, can also be used and new schemes are added every now and then.
      <br/>
      The port number is optional, the system substituting a default port number (depending on the scheme) if none is provided.
      <br/>
      The "host" field maps to a particular network address for a particular computer.
      <br/>
      The "url-path" is relative to the computer specified in the "host" field.
      <br/>
      A url-path is typically, but not necessarily, the pathname of a file in a web server directory.
    </p>
    <p num="45">
      For example, the following is a URL identifying a file "F" in the path "A/B/C" on a computer at "www.uspto.gov":
      <br/>
      http://www.uspto.gov/A/B/C/F
    </p>
    <p num="46">
      In order to access the file "F" (the resource) specified by the above URL, a program (e.g., a browser) running on a user's computer (i.e., a client computer) would have to first locate the computer (i.e., a server computer) specified by the host name. I.e., the program would have to locate the server "www.uspto.gov". To do this, it would access a Domain Name Server (DNS), providing the DNS with the host name ("www.uspto.gov").
      <br/>
      The DNS acts as a kind of centralized directory for resolving addresses from names.
      <br/>
      If the DNS determines that there is a (remote server) computer corresponding to the name "www.upsto.gov", it will provide the program with an actual computer network address for that server computer.
      <br/>
      On the Internet this is called an Internet Protocol (or IP) address and it has the form "123.345.456.678". The program on the user's (client) computer would then use the actual address to access the remote (server) computer.
    </p>
    <p num="47">
      The program opens a connection to the HTTP server (Web server) on the remote computer "www.uspto.gov" and uses the connection to send a request message to the remote computer (using the HTTP scheme).
      <br/>
      The message is typically an HTTP GET request which includes the url-path of the requested resource, "A/B/C/F".
      <br/>
      The HTTP server receives the request and uses it to access the resource specified by the url-path "A/B/C/F".
      <br/>
      The server returns the resource over the same connection.
    </p>
    <p num="48">Thus, conventionally HTTP client requests for Web resources at an origin server 102 are processed as follows (see FIG. 2) (This is a description of the process when no reflector 108 is installed.):</p>
    <p num="49">A1. A browser (e.g., Netscape's Navigator) at the client receives a resource identifier (i.e., a URL) from a user.</p>
    <p num="50">
      A2. The browser extracts the host (origin server) name from the resource identifier, and uses a domain name server (DNS) to look up the network (IP) address of the corresponding server.
      <br/>
      The browser also extracts a port number, if one is present, or uses a default port number (the default port number for http requests is 80).
    </p>
    <p num="51">A3. The browser uses the server's network address and port number to establish a connection between the client 106 and the host or origin server 102.</p>
    <p num="52">A4. The client 106 then sends a (GET) request over the connection identifying the requested resource.</p>
    <p num="53">
      A5. The origin server 102 receives the request and
      <br/>
      A6. locates or composes the corresponding resource.
    </p>
    <p num="54">
      A7. The origin server 102 then sends back to the client 106 a reply containing the requested resource (or some form of error indicator if the resource is unavailable).
      <br/>
      The reply is sent to the client over the same connection as that on which the request was received from the client.
    </p>
    <p num="55">A8. The client 106 receives the reply from the origin server 102.</p>
    <p num="56">
      There are many variations of this basic model.
      <br/>
      For example, in one variation, instead of providing the client with the resource, the origin server can tell the client to re-request the resource by another name.
      <br/>
      To do so, in A7 the server 102 sends back to the client 106 a reply called a "REDIRECT" which contains a new URL indicating the other name.
      <br/>
      The client 106 then repeats the entire sequence, normally without any user intervention, this time requesting the resource identified by the new URL.
    </p>
    <p num="57">System Operation</p>
    <p num="58">
      In this invention reflector 108 effectively takes the place of an ordinary Web server or origin server 102.
      <br/>
      The reflector 108 does this by taking over the origin server's IP address and port number.
      <br/>
      In this way, when a client tries to connect to the origin server 102, it will actually connect to the reflector 108.
      <br/>
      The original Web server (or origin server 102) must then accept requests at a different network (IP) address, or at the same IP address but on a different port number.
      <br/>
      Thus, using this invention, the server referred to in A3-A7 above is actually a reflector 108.
    </p>
    <p num="59">
      Note that it is also possible to leave the origin server's network address as it is and to let the reflector run at a different address or on a different port.
      <br/>
      In this way the reflector does not intercept requests sent to the origin server, but can still be sent requests addressed specifically to the reflector.
      <br/>
      Thus the system can be tested and configured without interrupting its normal operation.
      <br/>
      The reflector 108 supports the processing as follows (see FIG. 3): upon receipt of a request,
      <br/>
      B1.
      <br/>
      The reflector 108 analyzes the request to determine whether or not to reflect the request.
      <br/>
      To do this, first the reflector determines whether the sender (client 106) is a browser or a repeater.
      <br/>
      Requests issued by repeaters must be served locally by the origin server 102.
      <br/>
      This determination can be made by looking up the network (IP) address of the sender in a list of known repeater network (IP) addresses.
      <br/>
      Alternatively, this determination could be made by attaching information to a request to indicate that the request is from a specific repeater, or repeaters can request resources from a special port other than the one used for ordinary clients.
    </p>
    <p num="60">
      B2. If the request is not from a repeater, the reflector looks up the requested resource in a table (called the "rule base") to determine whether the resource requested is "repeatable".
      <br/>
      Based on this determination, the reflector either reflects the request (B3, described below) or serves the request locally (B4, described below).
    </p>
    <p num="61">
      The rule base is a list of regular expressions and associated attributes. (Regular expressions are well-known in the field of computer science.
      <br/>
      A small bibliography of their use is found in Abo, et al., "Compilers, Principles, techniques and tools", Addison-Wesley, 1986, pp. 157-158.) The resource identifier (URL) for a given request is looked up in the rule base by matching it sequentially with each regular expression.
      <br/>
      The first match identifies the attributes for the resource, namely repeatable or local.
      <br/>
      If there is no match in the rule base, a default attribute is used.
      <br/>
      Each reflector has its own rule base, which is manually configured by the reflector operator.
    </p>
    <p num="62">
      B3. To reflect a request, (to serve a request locally go to B4), as shown in FIG. 4, the reflector determines (B3-1) the best repeater to reflect the request to, as described in detail below.
      <br/>
      The reflector then creates (B3-2) a new resource identifier (URL) (using the requested URL and the best repeater) that identifies the same resource at the selected repeater.
    </p>
    <p num="63">
      It is necessary that the reflection step create a single URL containing the URL of the original resource, as well as the identity of the selected repeater.
      <br/>
      A special form of URL is created to provide this information.
      <br/>
      This is done by creating a new URL as follows:
      <br/>
      D1.
      <br/>
      Given a repeater name, scheme, origin server name and path, create a new URL.
      <br/>
      If the scheme is "http", the preferred embodiment uses the following format:
      <br/>
      http://&lt;repeater&gt;/&lt;server&gt;/&lt;path&gt;
    </p>
    <p num="64">
      If the form used is other than "http", the preferred embodiment uses the following format:
      <br/>
      http://&lt;repeater&gt;/&lt;server&gt;@proxy=&lt;scheme&gt;@/&lt;path&gt;
    </p>
    <p num="65">
      The reflector can also attach a MIME type to the request, to cause the repeater to provide that MIME type with the result.
      <br/>
      This is useful because many protocols (such as FTP) do not provide a way to attach a MIME type to a resource.
      <br/>
      The format is
      <br/>
      http://&lt;repeater&gt;/&lt;server&gt;@proxy=&lt;scheme&gt;:&lt;type&gt;@/&lt;path&gt;
    </p>
    <p num="66">This URL is interpreted when received by the repeater.</p>
    <p num="67">
      The reflector then sends (B3-3) a REDIRECT reply containing this new URL to the requesting client.
      <br/>
      The HTTP REDIRECT command allows the reflector to send the browser a single URL to retry the request.
    </p>
    <p num="68">
      B4. To serve a request locally, the request is sent by the reflector to ("forwarded to") the origin server 102.
      <br/>
      In this mode, the reflector acts as a reverse proxy server.
      <br/>
      The origin server 102 processes the request in the normal manner (A5-A7).
      <br/>
      The reflector then obtains the origin server's reply to the request which it inspects to determine if the requested resource is an HTML document, i.e., whether the requested resource is one which itself contains resource identifiers.
    </p>
    <p num="69">
      B5. If the resource is an HTML document then the reflector rewrites the HTML document by modifying resource identifiers (URLs) within it, as described below.
      <br/>
      The resource, possibly as modified by rewriting, is then returned in a reply to the requesting client 106.
    </p>
    <p num="70">
      If the requesting client is a repeater, the reflector may temporarily disable any cache-control modifiers which the origin server attached to the reply.
      <br/>
      These disabled cache-control modifiers are later re-enabled when the content is served from the repeater.
      <br/>
      This mechanism makes it possible for the origin server to prevent resources from being cached at normal proxy caches, without affecting the behavior of the cache at the repeater.
    </p>
    <p num="71">B6. Whether the request is reflected or handled locally, details about the transaction, such as the current time, the address of the requester, the URL requested, and the type of response generated, are written by the reflector to a local log file.</p>
    <p num="72">
      By using a rule base (B2), it is possible to selectively reflect resources.
      <br/>
      There are a number of reasons that certain particular resources cannot be effectively repeated (and therefore should not be reflected), for instance:
      <br/>
      the resource is composed uniquely for each request;
      <br/>
      the resource relies on a so-called cookie (browsers will not send cookies to repeaters with different domain names);
      <br/>
      the resource is actually a program (such as a Java applet) that will run on the client and that wishes to connect to a service (Java requires that the service be running on the same machine that provided the applet).
    </p>
    <p num="73">
      In addition, the reflector 108 can be configured so that requests from certain network addresses (e.g., requests from clients on the same local area network as the reflector itself) are never reflected.
      <br/>
      Also, the reflector may choose not to reflect requests because the reflector is exceeding its committed aggregate information rate, as described below.
    </p>
    <p num="74">A request which is reflected is automatically mirrored at the repeater when the repeater receives and processes the request.</p>
    <p num="75">The combination of the reflection process described here and the caching process described below effectively creates a system in which repeatable resources are migrated to and mirrored at the selected reflector, while non-repeatable resources are not mirrored.</p>
    <p num="76">Alternate Approach</p>
    <p num="77">Placing the origin server name in the reflected URL is generally a good strategy, but it may be considered undesirable for aesthetic or (in the case, e.g., of cookies) certain technical reasons.</p>
    <p num="78">
      It is possible to avoid the need for placing both the repeater name and the server name in the URL.
      <br/>
      Instead, a "family" of names may be created for a given origin server, each name identifying one of the repeaters used by that server.
    </p>
    <p num="79">
      For instance, if www.example.com is the origin server, names for three repeaters might be created:
      <br/>
      wr1.example.com
      <br/>
      wr2.example.com
      <br/>
      wr3.example.com
    </p>
    <p num="80">The name "wr1.example.com" would be an alias for repeater 1, which might also be known by other names such as "wr1.anotherExample.com" and "wr1.example.edu".</p>
    <p num="81">
      If the repeater can determine by which name it was addressed, it can use this information (along with a table that associates repeater alias names with origin server names) to determine which origin server is being addressed.
      <br/>
      For instance, if repeater 1 is addressed as wr1.example.com, then the origin server is "www.example.com"; if it is addressed as "wr1.anotherExample.com", then the origin server is "www.anotherExample.com".
    </p>
    <p num="82">
      The repeater can use two mechanisms to determine by which alias it is addressed:
      <br/>
      1.
      <br/>
      Each alias can be associated with a different IP address.
      <br/>
      Unfortunately, this solution does not scale well, as IP addresses are currently scarce, and the number of IP addresses required grows as the product of origin servers and repeaters.
      <br/>
      2. The repeater can attempt to determine the alias name used by inspecting the "host:" tag in the HTTP header of the request.
      <br/>
      Unfortunately, some old browsers still in use do not attach the "host:" tag to a request.
      <br/>
      Reflectors would need to identify such browsers (the browser identity is a part of each request) and avoid this form of reflection.
    </p>
    <p num="83">How a Repeater Handles a Request</p>
    <p num="84">
      When a browser receives a REDIRECT response (as produced in B3), it reissues a request for the resource using the new resource identifier (URL) (A1-A5).
      <br/>
      Because the new identifier refers to a repeater instead of the origin server, the browser now sends a request for the resource to the repeater which processes a request as follows, with reference to FIG. 5:
      <br/>
      C1. First the repeater analyzes the request to determine the network address of the requesting client and the path of the resource requested.
      <br/>
      Included in the path is an origin server name (as described above with reference to B3).
    </p>
    <p num="85">
      C2. The repeater uses an internal table to verify that the origin server belongs to a known "subscriber".
      <br/>
      A subscriber is an entity (e.g., a company) that publishes resources (e.g., files) via one or more origin servers.
      <br/>
      When the entity subscribes, it is permitted to utilize the repeater network.
      <br/>
      The subscriber tables described below include the information that is used to link reflectors to subscribers.
    </p>
    <p num="86">
      If the request is not for a resource from a known subscriber, the request is rejected.
      <br/>
      To reject a request, the repeater returns a reply indicating that the requested resource does not exist.
    </p>
    <p num="87">
      C3. The repeater then determines whether the requested resource is cached locally.
      <br/>
      If the requested resource is in the repeater's cache it is retrieved.
      <br/>
      On the other hand, if a valid copy of the requested resource is not in the repeater's cache, the repeater modifies the incoming URL, creating a request that it issues directly to the originating reflector which processes it (as in B1-B6).
      <br/>
      Because this request to the originating reflector is from a repeater, the reflector always returns the requested resource rather than reflecting the request. (Recall that reflectors always handle requests from repeaters locally.) If the repeater obtained the resource from the origin server, the repeater then caches the resource locally.
    </p>
    <p num="88">
      If a resource is not cached locally, the cache can query its "peer caches" to see if one of them contains the resource, before or at the same time as requesting the resource from the reflector/origin server.
      <br/>
      If a peer cache responds positively in a limited period of time (preferably a small fraction of a second), the resource will be retrieved from the peer cache.
    </p>
    <p num="89">C4. The repeater then constructs a reply including the requested resource (which was retrieved from the cache or from the origin server) and sends that reply to the requesting client.</p>
    <p num="90">C5. Details about the transaction, such as the associated reflector, the current time, the address of the requester, the URL requested, and the type of response generated, are written to a local log file at the repeater.</p>
    <p num="91">Note that the bottom row of FIG. 2 refers to an origin server, or a reflector, or a repeater, depending on what the URL in step A1 identifies.</p>
    <p num="92">Selecting the Best Repeater</p>
    <p num="93">
      If the reflector 108 determines that it will reflect the request, it must then select the best repeater to handle that request (as referred to in step B3-1).
      <br/>
      This selection is performed by the Best Repeater Selector (BRS) mechanism described here.
    </p>
    <p num="94">
      The goal of the BRS is to select, quickly and heuristically, an appropriate repeater for a given client given only the network address of the client.
      <br/>
      An appropriate repeater is one which is not too heavily loaded and which is not too far from the client in terms of some measure of network distance.
      <br/>
      The mechanism used here relies on specific, compact, pre-computed data to make a fast decision.
      <br/>
      Other, dynamic solutions can also be used to select an appropriate repeater.
    </p>
    <p num="95">
      The BRS relies on three pre-computed tables, namely the Group Reduction Table, the Link Cost Table, and the Load Table.
      <br/>
      These three tables (described below) are computed off-line and downloaded to each reflector by its contact in the repeater network.
    </p>
    <p num="96">The Group Reduction Table places every network address into a group, with the goal that addresses in a group share relative costs, so that they would have the same best repeater under varying conditions (i.e., the BRS is invariant over the members of the group).</p>
    <p num="97">
      The Link Cost Table is a two dimensional matrix which specifies the current cost between each repeater and each group.
      <br/>
      Initially, the link cost between a repeater and a group is defined as the "normalized link cost" between the repeater and the group, as defined below.
      <br/>
      Over time, the table will be updated with measurements which more accurately reflect the relative cost of transmitting a file between the repeater and a member of the group.
      <br/>
      The format of the Link Cost Table is &lt;Group ID&gt;&lt;Group ID&gt;&lt;link cost&gt;, where the Group ID's are given as AS numbers.
    </p>
    <p num="98">
      The Load Table is a one dimensional table which identifies the current load at each repeater.
      <br/>
      Because repeaters may have different capacities, the load is a value that represents the ability of a given repeater to accept additional work.
      <br/>
      Each repeater sends its current load to a central master repeater at regular intervals, preferably at least approximately once a minute.
      <br/>
      The master repeater broadcasts the Load Table to each reflector in the network, via the contact repeater.
    </p>
    <p num="99">
      A reflector is provided entries in the Load Table only for repeaters which it is assigned to use.
      <br/>
      The assignment of repeaters to reflectors is performed centrally by a repeater network operator at the master repeater.
      <br/>
      This assignment makes it possible to modify the service level of a given reflector.
      <br/>
      For instance, a very active reflector may use many repeaters, whereas a relatively inactive reflector may use few repeaters.
    </p>
    <p num="100">Tables may also be configured to provide selective repeater service to subscribers in other ways, e.g., for their clients in specific geographic regions, such as Europe or Asia.</p>
    <p num="101">Measuring Load</p>
    <p num="102">
      In the presently preferred embodiments, repeater load is measured in two dimensions, namely
      <br/>
      1. requests received by the repeater per time interval (RRPT), and
      <br/>
      2. bytes sent by the repeater per time interval (BSPT).
    </p>
    <p num="103">
      For each of these dimensions, a maximum capacity setting is set.
      <br/>
      The maximum capacity indicates the point at which the repeater is considered to be fully loaded.
      <br/>
      A higher RRPT capacity generally indicates a faster processor, whereas a higher BSPT capacity generally indicates a wider network pipe.
      <br/>
      This form of load measurement assumes that a given server is dedicated to the task of repeating.
    </p>
    <p num="104">
      Each repeater regularly calculates its current RRPT and BSPT, by accumulating the number of requests received and bytes sent over a short time interval.
      <br/>
      These measurements are used to determine the repeater's load in each of these dimensions.
      <br/>
      If a repeater's load exceeds its configured capacity, an alarm message is sent to the repeater network administrator.
    </p>
    <p num="105">
      The two current load components are combined into a single value indicating overall current load.
      <br/>
      Similarly, the two maximum capacity components are combined into a single value indicating overall maximum capacity.
      <br/>
      The components are combined as follows:
      <br/>
      current-load=B * current RRPT+(1-B) * current BSPT
      <br/>
      max-load=B * max RRPT+(1-B) * max BSPT
    </p>
    <p num="106">The factor B, a value between 0 and 1, allows the relative weights of RRPT and BSPT to be adjusted, which favors consideration of either processing power or bandwidth.</p>
    <p num="107">
      The overall current load and overall maximum capacity values are periodically sent from each repeater to the master repeater, where they are aggregated in the Load Table, a table summarizing the overall load for all repeaters.
      <br/>
      Changes in the Load Table are distributed automatically to each reflector.
    </p>
    <p num="108">While the preferred embodiment uses a two-dimensional measure of repeater load, any other measure of load can be used.</p>
    <p num="109">Combining Link Costs and Load</p>
    <p num="110">
      The BRS computes the cost of servicing a given client from each eligible repeater.
      <br/>
      The cost is computed by combining the available capacity of the candidate repeater with the cost of the link between that repeater and the client.
      <br/>
      The link cost is computed by simply looking it up in the Link Cost table.
    </p>
    <p num="111">
      The cost is determined using the following formula:
      <br/>
      threshold=K * max-load
      <br/>
      capacity=max(max-load-current-load, e)
      <br/>
      capacity=min(capacity, threshold)
      <br/>
      cost=link-cost * threshold/cacity
    </p>
    <p num="112">In this formula, e is a very small number (epsilon) and K is a tuning factor initial set to 0.5. This formula causes the cost to a given repeater to be increased, at a rate defined by K, if its capacity falls below a configurable threshold.</p>
    <p num="113">
      Given the cost of each candidate repeater, the BRS selects all repeaters within a delta factor of the best score.
      <br/>
      From this set, the result is selected at random.
    </p>
    <p num="114">
      The delta factor prevents the BRS from repeatedly selecting a single repeater when scores are similar.
      <br/>
      It is generally required because available information about load and link costs loses accuracy over time.
      <br/>
      This factor is tunable.
    </p>
    <p num="115">Best Repeater Selector (BRS)</p>
    <p num="116">The BRS operates as follows, with reference to FIG. 6:</p>
    <p num="117">
      Given a client network address and the three tables described above:
      <br/>
      E1.
      <br/>
      Determine which group the client is in using the Group Reduction Table.
    </p>
    <p num="118">E2. For each repeater in the Link Cost Table and Load Table, determine that repeater's combined cost as follows:</p>
    <p num="119">
      - E2a.
      <br/>
      Determine the maximum and current load on the repeater (using the Load Table).
      <br/>
      - E2b. Determine the link cost between the repeater and the client's group (using the Link Cost Table).
      <br/>
      - E2c. Determine the combined cost as described above.
    </p>
    <p num="120">E3. Select a small set of repeaters with the lowest cost.</p>
    <p num="121">E4. Select a random member from the set.</p>
    <p num="122">
      Preferably the results of the BRS processing are maintained in a local cache at the reflector 108.
      <br/>
      Thus, if the best repeater has recently been determined for a given client (i.e., for a given network address), that best repeater can be reused quickly without being re-determined.
      <br/>
      Since the calculation described above is based on statically, pre-computed tables, if the tables have not changed then there is no need to re-determine the best repeater.
    </p>
    <p num="123">Determining the Group Reduction and Link Cost Tables</p>
    <p num="124">
      The Group Reduction Table and Link Cost Table used in BRS processing are created and regularly updated by an independent procedure referred to herein as NetMap.
      <br/>
      The NetMap procedure is run by executing several phases (described below) as needed.
    </p>
    <p num="125">The term Group is used here to refers to an IP "address group".</p>
    <p num="126">The term Repeater Group refers to a Group that contains the IP address of a repeater.</p>
    <p num="127">
      The term link cost refers to a statically determined cost for transmitting data between two Groups.
      <br/>
      In a presently preferred implementation, this is the minimum of the sums of the costs of the links along each path between them.
      <br/>
      The link costs of primary concern here are link costs between a Group and a Repeater Group.
    </p>
    <p num="128">
      The term relative link cost refers to the link cost relative to other link costs for the same Group which is calculated by subtracting the minimum link cost from a Group to any Repeater Group from each of its link costs to a Repeater Group.
      <br/>
      The term Cost Set refers to a set of Groups that are equivalent in regard to Best Repeater Selection.
      <br/>
      That is, given the information available, the same repeater would be selected for any of them.
    </p>
    <p num="129">
      The NetMap procedure first processes input files to create an internal database called the Group Registry.
      <br/>
      These input files describe groups, the IP addresses within groups, and links between groups, and come a variety of sources, including publicly available Internet Routing Registry (IRR) databases, BGP router tables, and probe services that are located at various points around the Internet and use publicly available tools (such as "traceroute") to sample data paths.
      <br/>
      Once this processing is complete, the Group Registry contains essential information used for further processing, namely (1) the identity of each group, (2) the set of IP addresses in a given group, (3) the presence of links between groups indicating paths over which information may travel, and (4) the cost of sending data over a given link.
    </p>
    <p num="130">The following processes are then performed on the Group Registry file.</p>
    <p num="131">Calculate Repeater Group link costs</p>
    <p num="132">
      The NetMap procedure calculates a "link cost" for transmission of data between each Repeater Group and each Group in the Group Registry.
      <br/>
      This overall link cost is defined as the minimum cost of any path between the two groups, where the cost of a path is equal to the sum of the costs of the individual links in the path.
      <br/>
      The link cost algorithm presented below is essentially the same as algorithm -562 from ACM journal Transactions on Mathematical Software: "Shortest Path From a Specific Node to All Other Nodes in a Network" by U. Pape, ACM TOMS 6 (1980) pp. 450-455, http://www.netlib.org/toms/562.
    </p>
    <p num="133">
      In this processing, the term Repeater Group refers to a Group that contains the IP address of a repeater.
      <br/>
      A group is a neighbor of another group if the Group Registry indicates that there is a link between the two groups.
    </p>
    <p num="134">
      For each target Repeater Group T:
      <br/>
      Initialize the link cost between T and itself to zero.
    </p>
    <p num="135">Initialize the link cost between T and every other Group to infinity.</p>
    <p num="136">Create a list L that will contain Groups that are equidistant from the target Repeater Group T.</p>
    <p num="137">Initialize the list L to contain just the target Repeater Group T itself.</p>
    <p num="138">
      While the list L is not empty:
      <br/>
      - Create an empty list L' of neighbors of members of the list L.
      <br/>
      - For each Group G in the list L:
    </p>
    <p num="139">-  For each Group N that is a neighbor of G:</p>
    <p num="140">
      -    Let cost refer to the sum of the link cost between T and G, and the link cost between G and N. The cost between T and G was determined in the previous pass of the algorithm; the link cost between G and N is from the Group Registry.
      <br/>
      -  If cost is less than the link cost between T and N:
      <br/>
      -    Set the link cost between T and N to cost.
      <br/>
      -    Add N to L' if it is not already on it.
    </p>
    <p num="141">Set L to L'.</p>
    <p num="142">Calculate Cost Sets</p>
    <p num="143">
      A Cost Set is a set of Groups that are equivalent with respect to Best Repeater Selection.
      <br/>
      That is, given the information available, the same repeater would be selected for any of them.
    </p>
    <p num="144">
      The "cost profile" of a Group G is defined herein as the set of costs between G and each Repeater.
      <br/>
      Two cost profiles are said to be equivalent if the values in one profile differ from the corresponding values in the other profile by a constant amount.
    </p>
    <p num="145">
      Once a client Group is known, the Best Repeater Selection algorithm relies on the cost profile for information about the Group.
      <br/>
      If two cost profiles are equivalent, the BRS algorithm would select the same repeater given either profile.
    </p>
    <p num="146">A Cost Set is then a set of groups that have equivalent cost profiles.</p>
    <p num="147">The effectiveness of this method can be seen, for example, in the case where all paths to a Repeater from some Group A pass through some other Group B. The two Groups have equivalent cost profiles (and are therefore in the same Cost Set) since whatever Repeater is best for Group A is also going to be best for Group B, regardless of what path is taken between the two Groups.</p>
    <p num="148">
      By normalizing cost profiles, equivalent cost profiles can be made identical.
      <br/>
      A normalized cost profile is a cost profile in which the minimum cost has the value zero.
      <br/>
      A normalized cost profile is computed by finding the minimum cost in the profile, and subtracting that value from each cost in the profile.
    </p>
    <p num="149">
      Cost Sets are then computed using the following algorithm:
      <br/>
      For each Group G:
      <br/>
      - Calculate the normalized cost profile for G
      <br/>
      - Look for a Cost Set with the same normalized cost profile.
      <br/>
      - If such as set is found, add G to the existing Cost Set;
      <br/>
      - otherwise, create a new Cost Set with the calculated normalized cost profile, containing only G.
    </p>
    <p num="150">
      The algorithm for finding Cost Sets employs a hash table to reduce the time necessary to determine whether the desired Cost Set already exists.
      <br/>
      The hash table uses a hash value computed from cost profile of G.
    </p>
    <p num="151">
      Each Cost Set is then numbered with a unique Cost Sent Index number.
      <br/>
      Cost Sets are then used in a straightforward manner to generate the Link Cost Table, which gives the cost from each Cost Set to each Repeater.
    </p>
    <p num="152">As described below, the Group Reduction Table maps every IP address to one of these Cost Sets.</p>
    <p num="153">Build IP Map</p>
    <p num="154">
      The IP Map is a sorted list of records which map IP address ranges to Link Cost Table keys.
      <br/>
      The format of the IP map is:
      <br/>
      &lt;base IP address&gt;&lt;max IP address&gt;&lt;Link Cost Table key&gt;
    </p>
    <p num="155">
      where IP addresses are presently represented by 32-bit integers.
      <br/>
      The entries are sorted by descending base address, and by ascending maximum address among equal base addresses, and by ascending Link Cost Table key among equal base addresses and maximum addresses.
      <br/>
      Note that ranges may overlap.
    </p>
    <p num="156">
      The NetMap procedure generates an intermediate IP map containing a map between IP address ranges and Cost Set numbers as follows:
      <br/>
      For each Cost Set S:
      <br/>
      - For each Group G in S:
      <br/>
      -  For each IP address range in G:
      <br/>
      -    Add a triple (low address, high address, Cost Set number of S) to the IP map.
    </p>
    <p num="157">
      The IP map file is then sorted by descending base address, and by ascending maximum address among equal base addresses, and by ascending Cost Set number among equal base addresses and maximum addresses.
      <br/>
      The sort order for the base address and maximum address minimizes the time to build the Group Reduction Table and produces the proper results for overlapping entries.
    </p>
    <p num="158">
      Finally, the NetMap procedure creates the Group Reduction Table by processing the sorted IP map.
      <br/>
      The Group Reduction Table maps IP addresses (specified by ranges) into Cost Set numbers.
      <br/>
      Special processing of the IP map file is required in order to detect overlapping address ranges, and to merge adjacent address ranges in order to minimize the size of the Group Reduction Table.
    </p>
    <p num="159">An ordered list of address range segments is maintained, each segment consisting of a base address B and a Cost Set number N, sorted by base address B. (The maximum address of a segment is the base address of the next segment minus one.)</p>
    <p num="160">
      The following algorithm is used:
      <br/>
      Initialize the list with the elements �-infinity, NOGROUP�, �+infinity, NOGROUP�.
      <br/>
      - For each entry in the IP map, in sorted order, consisting of (b, m, s),
      <br/>
      -  Insert (b, m, s) in the list (recall that IP map entries are of the form (low address, high address Cost Set number of S))
      <br/>
      - For each reserved LAN address range (b, m): Insert (b, m, LOCAL) in the list.
      <br/>
      - For each Repeater at address a:
      <br/>
      -  Insert (a, a, REPEATER) in the list.
      <br/>
      - For each segment S in the ordered list:
      <br/>
      -  Merge S with following segments with the same Cost Set
      <br/>
      -  Create a Group Reduction Table entry with base address from the base address of S,
      <br/>
      -    max address=next segment's base-1,
      <br/>
      -    group ID=Cost Set number of S.
    </p>
    <p num="161">
      A reserved LAN address range is an address range reserved for use by LANs which should not appear as a global Internet address.
      <br/>
      LOCAL is a special Cost Set index different from all others, indicating that the range maps to a client which should never be reflected.
      <br/>
      REPEATER is a special Cost Set index different from all others, indicating that the address range maps to a repeater.
      <br/>
      NOGROUP is a special Cost Set index different from all others, indicating that this range of addresses has no known mapping.
    </p>
    <p num="162">
      Given (B, M, N), insert an entry in the ordered address list as follows:
      <br/>
      Find the last segment (AB, AN) for which AB is less than or equal to B.
    </p>
    <p num="163">If AB is less than B, insert a new segment (B, N) after (AB, AN).</p>
    <p num="164">Find the last segment (YB, YN) for which YB is less than or equal to M.</p>
    <p num="165">Replace by (XB, N) any segment (XB, NOGROUP) for which XB is greater than B and less than YB.</p>
    <p num="166">
      If YN is not N, and either YN is NOGROUP or YB is less than or equal to B,
      <br/>
      - Let (ZB, ZN) be the segment following (YB, YN).
      <br/>
      - If M+1 is less than ZB, insert a new segment (M+1, YN) before (ZB, ZN).
      <br/>
      - Replace (YB, YN) by (YB, N).
    </p>
    <p num="167">Rewriting HTML Resources</p>
    <p num="168">
      As explained above with reference to FIG. 3 (B5), when a reflector or repeater serves a resource which itself includes resource identifiers (e.g., a HTML resource), that resource is modified (rewritten) to pre-reflect resource identifiers (URLs) of repeatable resources that appear in the resource.
      <br/>
      Rewriting ensures that when a browser requests repeatable resources identified by the requested resource, it gets them from a repeater without going back to the origin server, but when it requests non-repeatable resources identified by the requested resource, it will go directly to the origin server.
      <br/>
      Without this optimization, the browser would either make all requests at the origin server (increasing traffic at the origin server and necessitating far more redirections from the origin server), or it would make all requests at the repeater (causing the repeater to redundantly request and copy resources which could not be cached, increasing the overhead of serving such resources).
    </p>
    <p num="169">
      Rewriting requires that a repeater has been selected (as described above with reference to the Best Repeater Selector).
      <br/>
      Rewriting uses a so-called BASE directive.
      <br/>
      The BASE directive lets the HTML identify a different base server. (The base address is normally the address of the HTML resource.)
    </p>
    <p num="170">
      Rewriting is performed as follows:
      <br/>
      F1.
      <br/>
      A BASE directive is added at the beginning of the HTML resource, or modified where necessary.
      <br/>
      Normally, a browser interprets relative URLs as being relative to the default base address, namely, the URL of the HTML resource (page) in which they are encountered.
      <br/>
      The BASE address added specifies the resource at the reflector which originally served the resource.
      <br/>
      This means that unprocessed relative URLs (such as those generated by Javascript (tm)  programs) will be interpreted as relative to the reflector.
      <br/>
      Without this BASE address, browsers would combine relative addresses with repeater names to create URLs which were not in the form required by repeaters (as described above in step D1).
    </p>
    <p num="171">
      F2. The rewriter identifies directives, such as embedded images and anchors, containing URLs.
      <br/>
      If the rewriter is running in a reflector, it must parse the HTML file to identify these directives.
      <br/>
      If it is running in a repeater, the rewriter may have access to pre-computed information that identifies the location of each URL (placed in the HTML file in step F4).
    </p>
    <p num="172">
      F3. For each URL encountered in the resource to be re-written, the rewriter must determine whether the URL is repeatable (as in steps B1-B2).
      <br/>
      If the URL is not repeatable, it is not modified.
      <br/>
      On the other hand, if the URL is repeatable, it is modified to refer to the selected repeater.
    </p>
    <p num="173">
      F4. After all URLs have been identified and modified, if the resource is being served to a repeater, a table is appended at the beginning of the resource that identifies the location and content of each URL encountered in the resource. (This step is an optimization which eliminates the need for parsing HTML resources at the repeater.)
      <br/>
      F5. Once all changes have been identified, a new length is computed for the resource (page).
      <br/>
      The length is inserted in the HTTP header prior to serving the resource.
    </p>
    <p num="174">
      An extension of HTML, known as XML, is currently being developed.
      <br/>
      The process of rewriting URLs will be similar for XML, with some differences in the mechanism that parses the resource and identifies embedded URLs.
    </p>
    <p num="175">Handling Non-HTTP Protocols</p>
    <p num="176">
      This invention makes it possible to reflect references to resources that are served by protocols other than HTTP, for instance, the File Transfer Protocol (FTP) and audio/video stream protocols.
      <br/>
      However, many protocols do not provide the ability to redirect requests.
      <br/>
      It is, however, possible to redirect references before requests are actually made by rewriting URLs embedded in HTML pages.
      <br/>
      The following modifications to the above algorithms are used to support this capability.
    </p>
    <p num="177">
      In F4, the rewriter rewrites URLs for servers if those servers appear in a configurable table of cooperating origin server or so-called co-servers.
      <br/>
      The reflector operator can define this table to include FTP servers and other servers.
      <br/>
      A rewritten URL that refers to a non-HTTP resource takes the form:
      <br/>
      http://&lt;repeater&gt;/&lt;origin server&gt;@proxy=&lt;scheme&gt;�:&lt;type&gt;�@/resource
    </p>
    <p num="178">
      where &lt;scheme&gt; is a supported protocol name such as "ftp".
      <br/>
      This URL format is an alternative to the form shown in B3.
    </p>
    <p num="179">
      In C3, the repeater looks for a protocol embedded in the arriving request.
      <br/>
      If a protocol is present and the requested resource is not already cached, the repeater uses the selected protocol instead of the default HTTP protocol to request the resource when serving it and storing it in the cache.
    </p>
    <p num="180">System Configuration and Management</p>
    <p num="181">
      In addition to the processing described above, the repeater network requires various mechanisms for system configuration and network management.
      <br/>
      Some of these mechanisms are described here.
    </p>
    <p num="182">
      Reflectors allow their operators to synchronize repeater caches by performing publishing operations.
      <br/>
      The process of keeping repeater caches synchronized is described below.
      <br/>
      Publishing indicates that a resource or collection of resources has changed.
    </p>
    <p num="183">
      Repeaters and reflectors participate in various types of log processing.
      <br/>
      The results of logs collected at repeaters are collected and merged with logs collected at reflectors, as described below.
    </p>
    <p num="184">Adding Subscribers to the Repeater Network</p>
    <p num="185">
      When a new subscriber is added to the network, information about the subscriber is entered in a Subscriber Table at the master repeater and propagated to all repeaters in the network.
      <br/>
      This information includes the Committed Aggregate Information Rate (CAIR) for servers belonging to the subscriber, and a list of the repeaters that may be used by servers belonging to the subscriber.
    </p>
    <p num="186">Adding Reflectors to the Repeater Network</p>
    <p num="187">When a new reflector is added to the network, it simply connects to and announces itself to a contact repeater, preferably using a securely encrypted certificate including the repeater's subscriber identifier.</p>
    <p num="188">
      The contact repeater determines whether the reflector network address is permitted for this subscriber.
      <br/>
      If it is, the contact repeater accepts the connection and updates the reflector with all necessary tables (using version numbers to determine which tables are out of date).
    </p>
    <p num="189">The reflector processes requests during this time, but is not "enabled" (allowed to reflect requests) until all of its tables are current.</p>
    <p num="190">Keeping Repeater Caches Synchronized</p>
    <p num="191">Repeater caches are coherent, in the sense that when a change to a resource is identified by a reflector, all repeater caches are notified, and accept the change in a single transaction.</p>
    <p num="192">
      Only the identifier of the changed resource (and not the entire resource) is transmitted to the repeaters; the identifier is used to effectively invalidate the corresponding cached resource at the repeater.
      <br/>
      This process is far more efficient than broadcasting the content of the changed resource to each repeater.
    </p>
    <p num="193">A repeater will load the newly modified resource the next time it is requested.</p>
    <p num="194">A resource change is identified at the reflector either manually by the operator, or through a script when files are installed on the server, or automatically through a change detection mechanism (e.g., a separate process that checks regularly for changes).</p>
    <p num="195">
      A resource change causes the reflector to send an "invalidate" message to its contact repeater, which forwards the message to the master repeater.
      <br/>
      The invalidate message contains a list of resource identifiers (or regular expressions identifying patterns of resource identifiers) that have changed. (Regular expressions are used to invalidate a directory or an entire server.) The repeater network uses a two-phase commit process to ensure that all repeaters correctly invalidate a given resource.
    </p>
    <p num="196">The invalidation process operates as follows:</p>
    <p num="197">The master broadcasts a "phase 1" invalidation request to all repeaters indicating the resources and regular expressions describing sets of resources to be invalidated.</p>
    <p num="198">When each repeater receives the phase 1 message, it first places the resource identifiers or regular expressions into a list of resource identifiers pending invalidation.</p>
    <p num="199">
      Any resource requested (in C3) that is in the pending invalidation list may not be served from the cache.
      <br/>
      This prevents the cache from requesting the resource from a peer cache which may not have received an invalidation notice.
      <br/>
      Were it to request a resource in this manner, it might replace the newly invalidated resource by the same, now stale, data.
    </p>
    <p num="200">The repeater then compares the resource identifier of each resource in its cache against the resource identifiers and regular expressions in the list.</p>
    <p num="201">
      Each match is invalidated by marking it stale and optionally removing it from the cache.
      <br/>
      This means that a future request for the resource will cause it to retrieve a new copy of the resource from the reflector.
    </p>
    <p num="202">
      When the repeater has completed the invalidation, it returns an acknowledgment to the master.
      <br/>
      The master waits until all repeaters have acknowledged the invalidation request.
    </p>
    <p num="203">
      If a repeater fails to acknowledge within a given period, it is disconnected from the master repeater.
      <br/>
      When it reconnects, it will be told to flush its entire cache, which will eliminate any consistency problem. (To avoid flushing the entire cache, the master could keep a log of all invalidations performed, sorted by date, and flush only files invalidated since the last time the reconnecting repeater successfully completed an invalidation.
      <br/>
      In the presently preferred embodiments this is not done since it is believed that repeaters will seldom disconnect.)
    </p>
    <p num="204">
      When all repeaters have acknowledged invalidation (or timed out) the repeater broadcasts a "phase 2" invalidation request to all repeaters.
      <br/>
      This causes the repeaters to remove the corresponding resource identifiers and regular expressions from the list of resource identifiers pending invalidation.
    </p>
    <p num="205">
      In another embodiment, the invalidation request will be extended to allow a "server push".
      <br/>
      In such requests, after phase 2 of the invalidation process has completed, the repeater receiving the invalidation request will immediately request a new copy of the invalidated resource to place in its cache.
    </p>
    <p num="206">Logs and Log Processing</p>
    <p num="207">
      Web server activity logs are fundamental to monitoring the activity in a Web site.
      <br/>
      This invention creates "merged logs" that combine the activity at reflectors with the activity at repeaters, so that a single activity log appears at the origin server showing all Web resource requests made on behalf of that site at any repeater.
    </p>
    <p num="208">This merged log can be processed by standard processing tools, as if it had been generated locally.</p>
    <p num="209">
      On a periodic basis, the master repeater (or its delegate) collects logs from each repeater.
      <br/>
      The logs collected are merged, sorted by reflector identifier and timestamp, and stored in a dated file on a per-reflector basis.
      <br/>
      The merged log for a given reflector represents the activity of all repeaters on behalf of that reflector.
      <br/>
      On a periodic basis, as configured by the reflector operator, a reflector contacts the master repeater to request its merged logs.
      <br/>
      It downloads these and merges them with its locally maintained logs, sorting by timestamp.
      <br/>
      The result is a merged log that represents all activity on behalf of repeaters and the given reflector.
    </p>
    <p num="210">
      Activity logs are optionally extended with information important to the repeater network, if the reflector is configured to do so by the reflector operator.
      <br/>
      In particular, an "extended status code" indicates information about each request, such as:
      <br/>
      1. request was served by a reflector locally;
      <br/>
      2. request was reflected to a repeater;*
      <br/>
      3. request was served by a reflector to a repeater;*
      <br/>
      4. request for non-repeatable resource was served by repeater;*
      <br/>
      5. request was served by a repeater from the cache;
      <br/>
      6. request was served by a repeater after filling cache;
      <br/>
      7. request pending invalidation was served by a repeater.
    </p>
    <p num="211">(The activities marked with "*" represent intermediate states of a request and do not normally appear in a final activity log.)</p>
    <p num="212">
      In addition, activity logs contain a duration, and extended precision timestamps.
      <br/>
      The duration makes it possible to analyze the time required to serve a resource, the bandwidth used, the number of requests handled in parallel at a given time, and other quite useful information.
      <br/>
      The extended precision timestamp makes it possible to accurately merge activity logs.
    </p>
    <p num="213">
      Repeaters use the Network Time Protocol (NTP) to maintain synchronized clocks.
      <br/>
      Reflectors may either use NTP or calculate a time bias to provide roughly accurate timestamps relative to their contact repeater.
    </p>
    <p num="214">Enforcing Committed Aggregate Information Rate</p>
    <p num="215">
      The repeater network monitors and limits the aggregate rate at which data is served on behalf of a given subscriber by all repeaters.
      <br/>
      This mechanism provides the following benefits:
      <br/>
      1. provides a means of pricing repeater service;
      <br/>
      2. provides a means for estimating and reserving capacity at repeaters;
      <br/>
      3. provides a means for preventing clients of a busy site from limiting access to other sites.
    </p>
    <p num="216">
      For each subscriber, a "threshold aggregate information rate" (TAIR) is configured and maintained at the master repeater.
      <br/>
      This threshold is not necessarily the committed rate, it may be a multiple of committed rate, based on a pricing policy.
    </p>
    <p num="217">
      Each repeater measures the information rate component of each reflector for which it serves resources, periodically (typically about once a minute), by recording the number of bytes transmitted on behalf of that reflector each time a request is delivered.
      <br/>
      The table thus created is sent to the master repeater once per period.
      <br/>
      The master repeater combines the tables from each repeater, summing the measured information of each reflector over all repeaters that serve resources for that reflector, to determine the "measured aggregate information rate" (MAIR) for each reflector.
    </p>
    <p num="218">If the MAIR for a given reflector is greater than the TAIR for that reflector, the MAIR is transmitted by the master to all repeaters and to the respective reflector.</p>
    <p num="219">
      When a reflector receives a request, it determines whether its most recently calculated MAIR is greater than its TAIR.
      <br/>
      If this is the case, the reflector probabilistically decides whether to suppress reflection, by serving the request locally (in B2).
      <br/>
      The probability of suppressing the reflection increases as an exponential function of the difference between the MAIR and the CAIR.
    </p>
    <p num="220">Serving a request locally during a peak period may strain the local origin server, but it prevents this subscriber from taking more than allocated bandwidth from the shared repeater network.</p>
    <p num="221">
      When a repeater receives a request for a given subscriber (in C2), it determines whether the subscriber is running near its threshold aggregate information rate.
      <br/>
      If this is the case, it probabilistically decides whether to reduce its load by redirecting the request back to the reflector.
      <br/>
      The probability increases exponentially as the reflector's aggregate information rate approaches its limit.
    </p>
    <p num="222">
      If a request is reflected back to a reflector, a special character string is attached to the resource identifier so that the receiving reflector will not attempt to reflect it again.
      <br/>
      In the current system, this string has the form
      <br/>
      "src=overload".
    </p>
    <p num="223">The reflector tests for this string in B2.</p>
    <p num="224">
      The mechanism for limiting Aggregate Information Rate described above is fairly coarse.
      <br/>
      It limits at the level of sessions with clients (since once a client has been reflected to a given repeater, the rewriting process tends to keep the client coming back to that repeater) and, at best, individual requests for resources.
      <br/>
      A more fine-grained mechanism for enforcing TAIR limits within repeaters operates by reducing the bandwidth consumption of a busy subscriber when other subscribers are competing for bandwidth.
    </p>
    <p num="225">
      The fine-grained mechanism is a form of data "rate shaping".
      <br/>
      It extends the mechanism that copies resource data to a connection when a reply is being sent to a client.
      <br/>
      When an output channel is established at the time a request is received, the repeater identifies which subscriber the channel is operating for, in C2, and records the subscriber in a data field associated with the channel.
      <br/>
      Each time a "write" operation is about to be made to the channel, the Metered Output Stream first inspects the current values of the MAIR and TAIR, calculated above, for the given subscriber.
      <br/>
      If the MAIR is larger than the TAIR, then the mechanism pauses briefly before performing the write operation.
      <br/>
      The length of the pause is proportional to the amount the MAIR exceeds the TAIR.
      <br/>
      The pause ensures that tasks sending other resources to other clients, perhaps on behalf of other subscribers, will have an opportunity to send their data.
    </p>
    <p num="226">Repeater Network Resilience</p>
    <p num="227">The repeater network is capable of recovering when a repeater or network connection fails.</p>
    <p num="228">
      A repeater cannot operate unless it is connected to the master repeater.
      <br/>
      The master repeater exchanges critical information with other repeaters, including information about repeater load, aggregate information rate, subscribers, and link cost.
    </p>
    <p num="229">
      If a master fails, a "succession" process ensures that another repeater will take over the role of master, and the network as a whole will remain operational.
      <br/>
      If a master fails, or a connection to a master fails through a network problem, any repeater attempting to communicate with the master will detect the failure, either through an indication from TCP/IP, or by timing out from a regular "heartbeat" message it sends to the master.
    </p>
    <p num="230">When any repeater is disconnected from its master, it immediately tries to reconnect to a series of potential masters based on a configurable file called its "succession list".</p>
    <p num="231">
      The repeater tries each system on the list in succession until it successfully connects to a master.
      <br/>
      If in this process, it comes to its own name, it takes on the role of master, and accepts connections from other repeaters.
      <br/>
      If a repeater which is not at the top of the list becomes the master, it is called the "temporary master".
    </p>
    <p num="232">
      A network partition may cause two groups of repeaters each to elect a master.
      <br/>
      When the partition is corrected, it is necessary that the more senior master take over the network.
      <br/>
      Therefore, when a repeater is temporary master, it regularly tries to reconnect to any master above it in the succession list.
      <br/>
      If it succeeds, it immediately disconnects from all of the repeaters connected to it.
      <br/>
      When they retry their succession lists, they will connect to the more senior master repeater.
    </p>
    <p num="233">
      To prevent losses of data, a temporary master does not accept configuration changes and does not process log files.
      <br/>
      In order to take on these tasks, it must be informed that it is primary master by manual modification of its successor list.
      <br/>
      Each repeater regularly reloads its successor list to determine whether it should change its idea of who the master is.
    </p>
    <p num="234">
      If a repeater is disconnected from the master, it must resynchronize its cache when it reconnects to the master.
      <br/>
      The master can maintain a list of recent cache invalidations and send to the repeater any invalidations it was not able to process while disconnected.
      <br/>
      If this list is not available for some reason (for instance, because the reflector has been disconnected too long), the reflector must invalidate its entire cache.
    </p>
    <p num="235">
      A reflector is not permitted to reflect requests unless it is connected to a repeater.
      <br/>
      The reflector relies on its contact repeater for critical information, such as load and Link Cost Tables, and current aggregate information rate.
      <br/>
      A reflector that is not connected to a repeater can continue to receive requests and handle them locally.
    </p>
    <p num="236">If a reflector loses its connection with a repeater, due to a repeater failure or network outage, it continues to operate while it tries to connect to a repeater.</p>
    <p num="237">
      Each time a reflector attempts to connect to a repeater, it uses DNS to identify a set of candidate repeaters given a domain name that represents the repeater network.
      <br/>
      The reflector tries each repeater in this set until it makes a successful contact.
      <br/>
      Until a successful contact is made, the reflector serves all requests locally.
      <br/>
      When a reflector connects to a repeater, the repeater can tell it to attempt to contact a different repeater; this allows the repeater network to ensure that no individual repeater has too many contacts.
    </p>
    <p num="238">
      When contact is made, the reflector provides the version number of each of its tables to its contact repeater.
      <br/>
      The repeater then decides which tables should be updated and sends appropriate updates to the reflector.
      <br/>
      Once all tables have been updated, the repeater notifies the reflector that it may now start reflecting requests.
    </p>
    <p num="239">Using a Proxy Cache within a Repeater</p>
    <p num="240">
      Repeaters are intentionally designed so that any proxy cache can be used as a component within them.
      <br/>
      This is possible because the repeater receives HTTP requests and converts them to a form recognized by the proxy cache.
    </p>
    <p num="241">
      On the other hand, several modifications to a standard proxy cache have been or may be made as optimizations.
      <br/>
      This includes, in particular, the ability to conveniently invalidate a resource, the ability to support cache quotas, and the ability to avoid making an extra copy of each resource as it passes from the proxy cache through the repeater to the requester.
    </p>
    <p num="242">
      In a preferred embodiment, a proxy cache is used to implement C3.
      <br/>
      The proxy cache is dedicated for use only by one or more repeaters.
      <br/>
      Each repeater requiring a resource from the proxy cache constructs a proxy request from the inbound resource request.
      <br/>
      A normal HTTP GET request to a server contains only the pathname part of the URL--the scheme and server name are implicit. (In an HTTP GET request to a repeater, the pathname part of the URL includes the name of the origin server on behalf of which the request is being made, as described above.) However, a proxy agent GET request takes an entire URL.
      <br/>
      Therefore, the repeater must construct a proxy request containing the entire URL from the path portion of the URL it receives.
      <br/>
      Specifically, if the incoming request takes the form:
      <br/>
      GET/&lt;origin server&gt;/&lt;path&gt;
    </p>
    <p num="243">
      then the repeater constructs a proxy request of the form:
      <br/>
      GET http://&lt;origin server&gt;/&lt;path&gt;
    </p>
    <p num="244">
      and if the incoming request takes the form:
      <br/>
      GET&lt;origin server&gt;@proxy=&lt;scheme&gt;:&lt;type&gt;@/&lt;path&gt;
    </p>
    <p num="245">
      then the repeater constructs a proxy request of the form:
      <br/>
      GET&lt;scheme&gt;://&lt;origin server&gt;/&lt;path&gt;
    </p>
    <p num="246">Cache Control</p>
    <p num="247">
      HTTP replies contain directives called cache control directives, which are used to indicate to a cache whether the attached resource may be cached and if so, when it should expire.
      <br/>
      A Web site administrator configures the Web site to attach appropriate directives.
      <br/>
      Often, the administrator will not know how long a page will be fresh, and must define a short expiration time to try to prevent caches from serving stale data.
      <br/>
      In many cases, a Web site operator will indicate a short expiration time only in order to receive the requests (or hits) that would otherwise be masked by the presence of a cache.
      <br/>
      This is known in the industry as "cache-busting".
      <br/>
      Although some cache operators may consider cache-busting to be impolite, advertisers who rely on this information may consider it imperative.
    </p>
    <p num="248">
      When a resource is stored in a repeater, its cache directives can be ignored by the repeater, because the repeater receives explicit invalidation events to determine when a resource is stale.
      <br/>
      When a proxy cache is used as the cache at the repeater, the associated cache directives may be temporarily disabled.
      <br/>
      However, they must be re-enabled when the resource is served from the cache to a client, in order to permit the cache-control policy (including any cache-busting) to take effect.
    </p>
    <p num="249">The present invention contains mechanisms to prevent the proxy cache within a repeater from honoring cache control directives, while permitting the directives to be served from the repeater.</p>
    <p num="250">
      When a reflector serves a resource to a repeater in B4, it replaces all cache directives by modified directives that are ignored by the repeater proxy cache.
      <br/>
      It does this by prefixing a distinctive string such as "wr-" to the beginning of the HTTP tag.
      <br/>
      Thus, "expires" becomes "wr-expires", and "cache-control" becomes "wr-cache-control".
      <br/>
      This prevents the proxy cache itself from honoring the directives.
      <br/>
      When a repeater serves a resource in C4, and the requesting client is not another repeater, it searches for HTTP tags beginning with "wr-" and removes the "wr-".
      <br/>
      This allows the clients retrieving the resource to honor the directives.
    </p>
    <p num="251">Resource Revalidation</p>
    <p num="252">
      There are several cases where a resource may be cached so long as the origin server is consulted each time it is served.
      <br/>
      In one case, the request for the resource is attached to a so-called "cookie".
      <br/>
      The origin server must be presented with the cookie to record the request and determine whether the cached resource may be served or not.
      <br/>
      In another case, the request for the resource is attached to an authentication header (which identifies the requester with a user id and password).
      <br/>
      Each new request for the resource must be tested at the origin server to assure that the requester is authorized to access the resource.
    </p>
    <p num="253">
      The HTTP 1.1 specification defines a reply header titled "Must-Revalidate" which allows an origin server to instruct a proxy cache to "revalidate" a resource each time a request is received.
      <br/>
      Normally, this mechanism is used to determine whether a resource is still fresh.
      <br/>
      In the present invention, Must-Revalidate makes it possible to ask an origin server to validate a request that is otherwise served from a repeater.
    </p>
    <p num="254">
      The reflector rule base contains information that determines which resources may be repeated but must be revalidated each time they are served.
      <br/>
      For each such resource, in B4, the reflector attaches a Must-Revalidate header.
      <br/>
      Each time a request comes to a repeater for a cached resource marked with a Must-Revalidate header, the request is forwarded to the reflector for validation prior to serving the requested resource.
    </p>
    <p num="255">Cache Quotas</p>
    <p num="256">
      The cache component of a repeater is shared among those subscribers that reflect clients to that repeater.
      <br/>
      In order to allow subscribers fair access to storage facilities, the cache may be extended to support quotas.
    </p>
    <p num="257">Normally, a proxy cache may be configured with a disk space threshold T. Whenever more than T bytes are stored in the cache, the cache attempts to find resources to eliminate.</p>
    <p num="258">
      Typically a cache uses the least-recently-used (LRU) algorithm to determine which resources to eliminate; more sophisticated caches use other algorithms.
      <br/>
      A cache may also support several threshold values-for instance, a lower threshold which, when reached, causes a low priority background process to remove items from the cache, and a higher threshold which, when reached, prevents resources from being cached until sufficient free disk space has been reclaimed.
    </p>
    <p num="259">
      If two subscribers A and B share a cache, and more resources of subscriber A are accessed during a period of time than resources of subscriber B, then fewer of B's resources will be in the cache when new requests arrive.
      <br/>
      It is possible that, due to the behavior of A, B's resources will never be cached when they are requested.
      <br/>
      In the present invention, this behavior is undesirable.
      <br/>
      To address this issue, the invention extends the cache at a repeater to support cache quotas.
    </p>
    <p num="260">The cache records the amount of space used by each subscriber in DS, and supports a configurable threshold TS for each subscriber.</p>
    <p num="261">
      Whenever a resource is added to the cache (at C3), the value DS is updated for the subscriber providing the resource.
      <br/>
      If DS is larger than TS, the cache attempts to find resources to eliminate, from among those resources associated with subscriber S. The cache is effectively partitioned into separate areas for each subscriber.
    </p>
    <p num="262">
      The original threshold T is still supported.
      <br/>
      If the sum of reserved segments for each subscriber is smaller than the total space reserved in the cache, the remaining area is "common" and subject to competition among subscribers.
    </p>
    <p num="263">Note, this mechanism might be implemented by modifying the existing proxy cache discussed above, or it might also be implemented without modifying the proxy cache--if the proxy cache at least makes it possible for an external program to obtain a list of resources in the cache, and to remove a given resource from the cache.</p>
    <p num="264">Rewriting from Repeaters</p>
    <p num="265">
      When a repeater receives a request for a resource, its proxy cache may be configured to determine whether a peer cache contains the requested resource.
      <br/>
      If so, the proxy cache obtains the resource from the peer cache, which can be faster than obtaining it from the origin server (the reflector).
      <br/>
      However, a consequence of this is that rewritten HTML resources retrieved from the peer cache would identify the wrong repeater.
      <br/>
      Thus, to allow for cooperating proxy caches, resources are preferably rewritten at the repeater.
    </p>
    <p num="266">
      When a resource is rewritten for a repeater, a special tag is placed at the beginning of the resource.
      <br/>
      When constructing a reply, the repeater inspects the tag to determine whether the resource indicates that additional rewriting is necessary.
      <br/>
      If so, the repeater modifies the resource by replacing references to the old repeater with references to the new repeater.
    </p>
    <p num="267">It is only necessary to perform this rewriting when a resource is served to the proxy cache at another repeater.</p>
    <p num="268">Repeater-Side Include</p>
    <p num="269">
      Sometimes, an origin server constructs a custom resource for each request (for instance, when inserting an advertisement based on the history of the requesting client).
      <br/>
      In such a case, that resource must be served locally rather than repeated.
      <br/>
      Generally, a custom resource contains, along with the custom information, text and references to other, repeatable, resources.
    </p>
    <p num="270">
      The process that assembles a "page" from a text resource and possibly one or more image resources is performed by the Web browser, directed by HTML.
      <br/>
      However, it is not possible using HTML to cause a browser to assemble a page using text or directives from a separate resource.
      <br/>
      Therefore, custom resources often necessarily contain large amounts of static text that would otherwise be repeatable.
    </p>
    <p num="271">
      To resolve this potential inefficiency, repeaters recognize a special directive called a "repeater side include".
      <br/>
      This directive makes it possible for the repeater to assemble a custom resource, using a combination of repeatable and local resources.
      <br/>
      In this way, the static text can be made repeatable, and only the special directive need be served locally by the reflector.
    </p>
    <p num="272">
      For example, a resource X might consist of custom directives selecting an advertising banner, followed by a large text article.
      <br/>
      To make this resource repeatable, the Web site administrator must break out a second resource, Y, to select the banner.
      <br/>
      Resource X is modified to contain a repeater-side include directive identifying resource Y, along with the article.
      <br/>
      Resource Y is created and contains only the custom directives selecting an ad banner.
      <br/>
      Now resource X is repeatable, and only resource Y, which is relatively small, is not repeatable.
    </p>
    <p num="273">
      When a repeater constructs a reply, it determines whether the resource being served is an HTML resource, and if so, scans it for repeater-side include directives.
      <br/>
      Each such directive includes a URL, which the repeater resolves and substitutes in place of the directive.
      <br/>
      The entire resource must be assembled before it is served, in order to determine its final size, as the size is included in a reply header ahead of the resource.
    </p>
    <p num="274">
      Thus, a method and apparatus for dynamically replicating selected resources in computer networks is provided.
      <br/>
      One skilled in the art will appreciate that the present invention can be practiced by other than the described embodiments, which are presented for purposes of illustration and not limitation, and the present invention is limited only by the claims that follow.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A method of processing resource requests in a computer network, the method comprising,</claim-text>
      <claim-text>(i) by a client:</claim-text>
      <claim-text>- (A) making a request for a particular resource from an origin server, the request including a resource identifier for the particular resource; (ii) by a reflector: - (B) intercepting the request from the client to the origin server; - (C) selecting a repeater to process the request, wherein the repeater is selected based on a predicted cost or speed of transmission between the repeater and the client; - (D) providing to the client a modified resource identifier designating the repeater; (iii) by the client: - (E) receiving the modified resource identifier from the reflector;</claim-text>
      <claim-text>and - (F) making a request for the particular resource from the repeater designated in the modified resource identifier; (iv) by the repeater: - (G) receiving the request from the client;</claim-text>
      <claim-text>and - (H) returning the requested resource to the client.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. A method as in claim 1 further comprising, by the repeater: (I) making a request for the resource from the origin server;</claim-text>
      <claim-text>and (J) receiving the resource from the origin server.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. A method as in claim 1 wherein the selecting of a repeater by the reflector comprises: (C1) partitioning the network into groups; (C2) determining which group the client is in; (C3) selecting, from a plurality of repeaters in the network, a set of repeaters having a lowest cost relative to the group which the client is in;</claim-text>
      <claim-text>and (C4) selecting as the repeater a member of the selected set of repeaters.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. A method as in claim 3, wherein the cost of a repeater is a value based on that repeater's current load and a maximum load for that repeater.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. A method as in claim 3, wherein the cost of a repeater is a value based on a predicted cost or speed of transmission between the repeater and a client in the group.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. A method as in claim 1 wherein the particular resource itself contains at least one other resource identifier of at least one other resource, the method further comprising: rewriting the particular resource to replace at least some of the resource identifiers contained therein with modified resource identifiers designating a repeater instead of the origin server.</claim-text>
    </claim>
    <claim num="7">
      <claim-text>7. A method as in claim 6 wherein the rewriting is performed by one of the repeater, the reflector or another repeater.</claim-text>
    </claim>
    <claim num="8">
      <claim-text>8. A method of processing resource requests in a computer network, the method comprising, (i) by a client: - (A) making a request for a particular resource from an origin server, the request including a resource identifier for the particular resource; (ii) by a reflector: - (B) intercepting the request from the client to the origin server; - (C) determining whether to reflect the request to a repeater; - (D) when the reflector determines not to reflect the request, forwarding the request to the origin server, otherwise</claim-text>
      <claim-text>-  (D1) selecting a repeater to process the request, wherein the repeater is selected based on a predicted cost or speed of transmission between the repeater and the client; -  (D2) providing to the client a modified resource identifier designating the repeater.</claim-text>
    </claim>
    <claim num="9">
      <claim-text>9. A method as in claim 8, further comprising, when the reflector determines to reflect the request, (iii) by the client: - (E) receiving the modified resource identifier from the reflector;</claim-text>
      <claim-text>and - (F) making a request for the particular resource from the repeater designated in the modified resource identifier; (iv) by the repeater: - (G) receiving the request from the client;</claim-text>
      <claim-text>and - (H) returning the requested resource to the client.</claim-text>
    </claim>
    <claim num="10">
      <claim-text>10. A method as in claim 8 wherein the reflector determines whether to reflect a request by comparing the resource identifier with regular expression patterns of repeatable resources.</claim-text>
    </claim>
    <claim num="11">
      <claim-text>11. A method as in claim 8, wherein the reflector has a threshold aggregate information rate (TAIR) associated therewith, and wherein the determining of whether to reflect the request to a repeater comprises: determining whether the TAIR of the reflector is exceeded by a measured aggregate information rate (MAIR) for the reflector, wherein the reflector determines not to reflect the request when the MAIR exceeds the TAIR for the reflector.</claim-text>
    </claim>
    <claim num="12">
      <claim-text>12. A method as in claim 8, wherein the reflector has a threshold aggregate information rate (TAIR) associated therewith, and wherein the determining of whether to reflect the request to a repeater comprises: probabilistically determining whether the TAIR of the reflector is exceeded by a measured aggregate information rate (MAIR) for the reflector, wherein the reflector determines not to reflect the request as an exponential function of the difference between the MAIR and the TAIR.</claim-text>
    </claim>
    <claim num="13">
      <claim-text>13. A method as in any of claims 11-12, wherein the MAIR is obtained from repeaters according to the rate at which they have transmitted data on behalf of the reflector during a given time interval.</claim-text>
    </claim>
    <claim num="14">
      <claim-text>14. A method as in any one of claims 1-12 wherein the network is the Internet and wherein the resource identifier is a uniform resource locator (URL) for designating resources on the Internet, and wherein the modified resource identifier is a URL designating the repeater and indicating the reflector or origin server, and wherein the modified resource identifier is provided to the client using a REDIRECT message.</claim-text>
    </claim>
    <claim num="15">
      <claim-text>15. In a computer network wherein clients request resources from origin servers, a method comprising: providing at least one repeater; providing reflectors at some of the origin servers, each reflector intercepting client resource requests made to its respective origin server;</claim-text>
      <claim-text>and each reflector selectively redirecting client resource requests for certain resources to one of the repeaters, wherein a reflector determines whether or not to redirect a client resource to a repeater based on a predicted cost or speed of transmission between the repeater and the client making the resource request.</claim-text>
    </claim>
    <claim num="16">
      <claim-text>16. A method as in claim 15 further comprising, by repeaters in the network: servicing redirected client resource requests;</claim-text>
      <claim-text>and selectively maintaining copies of requested resources, whereby resources corresponding to redirected resource requests are selectively migrated from their origin servers to one or more repeaters.</claim-text>
    </claim>
    <claim num="17">
      <claim-text>17. A computer network comprising: a plurality of origin servers, at least some of the origin servers having reflectors associated therewith; a plurality of repeaters;</claim-text>
      <claim-text>and a plurality of clients, wherein each reflector is adapted to intercept resource requests made to its respective origin server and to selectively redirect the resource requests to a dynamically selected repeater, wherein a repeater is selected based on a predicted cost or speed of transmission between the repeater and the client making the resource request.</claim-text>
    </claim>
    <claim num="18">
      <claim-text>18. In a computer network wherein clients request resources from origin servers, a reflector mechanism associated with an origin server, the reflector mechanism comprising: means for intercepting a resource request made by client of an origin server; means for analyzing the resource request to determine whether to service the request locally at the origin server; means for determining a best repeater in the network to service the request when the analyzing means determines that the request should not be serviced locally;</claim-text>
      <claim-text>and means for redirecting the client to the best repeater, wherein a repeater is selected based on a predicted cost or speed of transmission between the repeater and the client making the resource request.</claim-text>
    </claim>
    <claim num="19">
      <claim-text>19. A reflector mechanism as in claim 18 wherein the network is partitioned into groups and the means for determining the best repeater comprises: means for determining which group the client is in; means for selecting, from a plurality of repeaters in the network, a set of repeaters having a lowest cost relative to the group the client is in;</claim-text>
      <claim-text>and means for selecting as the best repeater a member of the set of repeaters.</claim-text>
    </claim>
    <claim num="20">
      <claim-text>20. A reflector mechanism as in claim 19, wherein the cost of a repeater is a value based on a predicted cost or speed of transmission between the repeater and a client in the group.</claim-text>
    </claim>
    <claim num="21">
      <claim-text>21. A mechanism as in claim 19, wherein the cost of a repeater is a value based on that repeaters current load and a maximum load for that repeater.</claim-text>
    </claim>
    <claim num="22">
      <claim-text>22. A reflector as in claim 18 wherein the resource itself contains resource identifiers, the repeater further comprising: means for rewriting the resource to replace at least some of the resource identifiers contained therein with modified resource identifiers designating the repeater instead of the origin server.</claim-text>
    </claim>
    <claim num="23">
      <claim-text>23. A reflector as in claim 18 wherein the resource itself contains resource identifiers, the reflector further comprising: means for rewriting the resource to replace at least some of the resource identifiers contained therein with modified resource identifiers designating the best repeater instead of the origin server.</claim-text>
    </claim>
    <claim num="24">
      <claim-text>24. In a computer network wherein clients request resources from origin servers, a repeater mechanism comprising: means for receiving a resource request from a client; means for determining whether the resource is available locally; means for, when it is determined that the resource is not available locally, obtaining the resource from an origin server, wherein the origin server is selected based on a predicted cost or speed of transmission between the origin server and the client;</claim-text>
      <claim-text>and means for providing the resource to the client.</claim-text>
    </claim>
    <claim num="25">
      <claim-text>25. A method of processing resource requests in a computer network, the method comprising, by a client, making a request for a particular resource from an origin server, the request including a resource identifier for the particular resource, and wherein the particular resource itself contains at least one other resource identifier of at least one other resource; a reflector intercepting the request from the client to the origin server; selecting a repeater to process the request, wherein the repeater is selected based on a predicted cost or speed of transmission between the repeater and the client; rewriting the particular resource to replace at least some of the resource identifiers contained therein with modified resource identifiers designating a repeater instead of the origin server; providing to the client a modified resource identifier designating the repeater; the client receiving the modified resource identifier from the reflector;</claim-text>
      <claim-text>and making a request for the particular resource from the repeater designated in the modified resource identifier; the repeater receiving the request from the client;</claim-text>
      <claim-text>and returning the requested resource to the client.</claim-text>
    </claim>
    <claim num="26">
      <claim-text>26. A method as in claim 25 wherein the rewriting is performed by one of the repeater, the reflector or another repeater.</claim-text>
    </claim>
    <claim num="27">
      <claim-text>27. A method as in any one of claims 25-26 wherein the network is the Internet and wherein the resource identifier is a uniform resource locator (URL) for designating resources on the Internet, and wherein the modified resource identifier is a URL designating the repeater and indicating the reflector or origin server, and wherein the modified resource identifier is provided to the client using a REDIRECT message.</claim-text>
    </claim>
  </claims>
</questel-patent-document>