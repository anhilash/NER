<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06181676B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06181676</doc-number>
        <kind>B2</kind>
        <date>20010130</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6181676</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference is-representative="YES" family-id="21776479" extended-family-id="42108274">
      <document-id>
        <country>US</country>
        <doc-number>09016309</doc-number>
        <kind>A</kind>
        <date>19980130</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1998US-09016309</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>43164693</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>1630998</doc-number>
        <kind>A</kind>
        <date>19980130</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1998US-09016309</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010130</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>H04B  17/40        20150101A I20150212RMEP</text>
        <ipc-version-indicator>
          <date>20150101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>B</subclass>
        <main-group>017</main-group>
        <subgroup>40</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20150212</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>H04J   1/10        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>J</subclass>
        <main-group>1</main-group>
        <subgroup>10</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="3">
        <text>H04J   3/08        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>J</subclass>
        <main-group>3</main-group>
        <subgroup>08</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="4">
        <text>H04J   3/16        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>J</subclass>
        <main-group>3</main-group>
        <subgroup>16</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="5">
        <text>H04L   1/00        20060101A N20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>1</main-group>
        <subgroup>00</subgroup>
        <classification-value>N</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>370226000</text>
        <class>370</class>
        <subclass>226000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>370217000</text>
        <class>370</class>
        <subclass>217000</subclass>
      </further-classification>
      <further-classification sequence="2">
        <text>370228000</text>
        <class>370</class>
        <subclass>228000</subclass>
      </further-classification>
      <further-classification sequence="3">
        <text>370243000</text>
        <class>370</class>
        <subclass>243000</subclass>
      </further-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>H04L-001/00B7E</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>001</main-group>
        <subgroup>00B7E</subgroup>
      </classification-ecla>
      <classification-ecla sequence="2">
        <text>H04B-017/02</text>
        <section>H</section>
        <class>04</class>
        <subclass>B</subclass>
        <main-group>17</main-group>
        <subgroup>02</subgroup>
      </classification-ecla>
      <classification-ecla sequence="3">
        <text>H04J-001/10</text>
        <section>H</section>
        <class>04</class>
        <subclass>J</subclass>
        <main-group>1</main-group>
        <subgroup>10</subgroup>
      </classification-ecla>
      <classification-ecla sequence="4">
        <text>H04J-003/08</text>
        <section>H</section>
        <class>04</class>
        <subclass>J</subclass>
        <main-group>3</main-group>
        <subgroup>08</subgroup>
      </classification-ecla>
      <classification-ecla sequence="5">
        <text>H04J-003/16A2</text>
        <section>H</section>
        <class>04</class>
        <subclass>J</subclass>
        <main-group>003</main-group>
        <subgroup>16A2</subgroup>
      </classification-ecla>
      <classification-ecla sequence="6">
        <text>H04L-001/20E</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>001</main-group>
        <subgroup>20E</subgroup>
      </classification-ecla>
      <classification-ecla sequence="7">
        <text>H04L-001/22</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>1</main-group>
        <subgroup>22</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-001/0061</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>1</main-group>
        <subgroup>0061</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20150123</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04B-017/40</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>B</subclass>
        <main-group>17</main-group>
        <subgroup>40</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20150119</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04J-001/10</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>J</subclass>
        <main-group>1</main-group>
        <subgroup>10</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20150123</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="4">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04J-003/08</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>J</subclass>
        <main-group>3</main-group>
        <subgroup>08</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20150123</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="5">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04J-003/1611</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>J</subclass>
        <main-group>3</main-group>
        <subgroup>1611</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20150123</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="6">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-001/203</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>1</main-group>
        <subgroup>203</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20150123</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="7">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-001/22</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>1</main-group>
        <subgroup>22</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20150123</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>25</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>18</number-of-drawing-sheets>
      <number-of-figures>23</number-of-figures>
      <image-key data-format="questel">US6181676</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">System protection switching</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>TAKATSU KAZUO</text>
          <document-id>
            <country>US</country>
            <doc-number>5311501</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5311501</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>TADA KATSUYUKI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5532862</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5532862</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>TOMIZAWA MASAHITO, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5574717</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5574717</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>SUGIYAMA TAKATOSHI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5862175</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5862175</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="5">
          <text>TAKETOMI HISASHI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5978354</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5978354</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="6">
          <text>HENRY CHARLES HOWARD, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>6035080</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6035080</doc-number>
          </document-id>
        </patcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Nortel Networks Limited</orgname>
            <address>
              <address-1>Montreal, CA</address-1>
              <city>Montreal</city>
              <country>CA</country>
            </address>
          </addressbook>
          <nationality>
            <country>CA</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>NORTEL NETWORKS</orgname>
          </addressbook>
          <nationality>
            <country>CA</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Yao, Liqian</name>
            <address>
              <address-1>Kanata, CA</address-1>
              <city>Kanata</city>
              <country>CA</country>
            </address>
          </addressbook>
          <nationality>
            <country>CA</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="2">
          <addressbook lang="en">
            <name>d'Anjou, Martin</name>
            <address>
              <address-1>Gatineau, CA</address-1>
              <city>Gatineau</city>
              <country>CA</country>
            </address>
          </addressbook>
          <nationality>
            <country>CA</country>
          </nationality>
        </inventor>
      </inventors>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Vu, Huy D.</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>LAPSED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      A radio communication network comprising a plurality of communication terminals and a plurality of repeaters intermediate the communication terminals, with wayside communication paths being established between pairs of the repeaters via two radio channels carrying the same data.
      <br/>
      Protection switching of a wayside path is determined, in a preferred embodiment, by using one common wayside path to calculate the FEC (Forward Error Correction) and PEC (Parity Error Count).
      <br/>
      Switching to the better of said two channels is effected if FEC or PEC exceed predetermined thresholds.
      <br/>
      The common wayside path is defined as follows:(a) SIGMA wayside A path+SIGMA wayside B path-SIGMA (wayside A ||wayside B), if waysides A and B are overlapped (||indicates overlapped portions of the two parameters.)(b) wayside A path OR wayside B path, if waysides A and B are not overlapped.In another embodiment, each wayside tributary's path FEC and PEC is calculated by adding up the main traffic sections FEC and PEC on the wayside path.
      <br/>
      In yet another embodiment, main traffic section FEC and PEC are used to trigger wayside protection switching.
      <br/>
      The actual protection switching is performed by hardware in less time than the duration of a wayside data bit.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="1">This invention relates to wayside protection switching for a SONET/SDH radio communication network comprising a plurality of radio communication terminals and a plurality of repeaters intermediate the communication terminals.</p>
    <p num="2">
      SONET and SDH are standards for a multiplexing format for a Synchronous Optical Network.
      <br/>
      SDH is a Synchronous Digital Hierarchy.
    </p>
    <p num="3">
      In a SONET/SDH radio system, besides the main traffic, additional traffic can also be transmitted and carried in the main traffic overhead bytes, such as wayside (DS-1 capacity), Service channel (DS-0 capacity) etc.
      <br/>
      See ITU-RF 751-1, section 4.1.2., 1992-94. In the present invention, protection switching of wayside traffic is used as described hereinafter.
    </p>
    <p num="4">
      The additional traffic could consist of more than one tributary depending on the main traffic overhead capacity.
      <br/>
      To simplify the description, protection switching of two wayside tributaries is discussed and illustrated herein as examples.
    </p>
    <p num="5">The main traffic's protection switching mode is 1:n, where n is an integer greater than 1, e.g. 1 for 11. The wayside protection switching mode of this invention is 1+1.</p>
    <p num="6">
      In the present invention, when a wayside signal enters an ADD site, it is bridged to two radio channels, resulting in two adjacent channels carrying the same wayside data.
      <br/>
      This redundant configuration makes protection switching possible by selecting the better of the two radio channels when dropping the wayside traffic to a customer.
      <br/>
      The wayside radio path is protected by using unused bandwidth from an adjacent radio channel to transport a copy of the wayside data.
      <br/>
      This constitutes a redundant radio path for the wayside data.
      <br/>
      The SOA (Service Overhead Access) circuit pack is protected by having a redundant SOA circuit pack from which the wayside can be selected at a site where the wayside is dropped.
    </p>
    <p num="7">
      A radio communication network is subject to radio channel impairment from a variety of causes such as electrical interference, faulty equipment or radio fading.
      <br/>
      In such cases, it is necessary to have affected communication channels switched to a radio protection channel.
      <br/>
      In the case of a pair of main radio traffic terminals, switching to the protection channel (1 for n channels) is performed by a radio signal processor at the receive terminal site if a threshold value is exceeded for either line FEC (Forward Error Correction) or line PEC (Parity Error Count).
      <br/>
      FEC is a count of the number of corrected errors.
      <br/>
      The line FEC and line PEC are calculated based on the entire traffic, namely payload and overhead, and are an accumulation of section FEC and PEC from the start terminal to the end terminal.
    </p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="8">
      The present invention is concerned with non-hitless protection switching (to a different path) in the case of wayside radio traffic which involves communications between repeaters forming part of a channel between two main traffic terminals.
      <br/>
      Because wayside paths could be shorter than the main traffic path, it is inappropriate to make a switching decision for wayside traffic based on line FEC and line PEC or accumulation of section FEC and section PEC from the start terminal.
      <br/>
      Rather, according to the present invention, there are three ways to separate the wayside switching decision-making from that of the main traffic:
    </p>
    <p num="9">
      a. use different radio overhead (ROH) bits to calculate each wayside tributary's path FEC and PEC by adding up the main traffic's section FEC and PEC on the wayside path.
      <br/>
      For each tributary, eight bits are used for FEC and four bits for PEC.
      <br/>
      If there are n wayside tributaries, then the total necessary bits for this calculation will be:
      <br/>
      N(total bits)=n*(8+4)=12n
    </p>
    <p num="10">
      In accordance with method "a":
      <br/>
      1) At any ADD site, the FEC and PEC count bits corresponding to the tributary to be added are set to zero.
      <br/>
      2) At any THRU site, the section FEC and PEC are accumulated to the existing counts.
      <br/>
      3) At any DROP site, the accumulated FEC and PEC corresponding to the tributary to be dropped are compared with thresholds to determine a protection switching.
      <br/>
      b. use radio overhead bits to calculate a common wayside path FEC and PEC.
      <br/>
      Eight bits are used for FEC and four bits for PEC plus other necessary bits.
      <br/>
      If there are n wayside tributaries, there needs to be one bit to indicate a start, two bits to represent FEC and PEC quality and n bits for tributary IDs.
      <br/>
      The total necessary radio overhead bits for this calculation will be:
      <br/>
      N(total bits)=(8+4)=12, when n=1;=(8+4)+1+2+n=15+n, when n&gt;1.
    </p>
    <p num="11">A site where one wayside is dropped and the other passed through is referred to as a DROP &amp; THRU herein, while a site where one wayside is dropped and the other not in use is called a DROP.</p>
    <p num="12">
      In accordance with method "b", the currently preferred embodiment of the invention, a switching decision is made by using one common wayside path to calculate FEC (Forward Error Correction) and PEC (Parity Error Count), switching being effected if FEC or PEC exceed predetermined thresholds, the common wayside path, taking two paths as an example, being defined as follows:
      <br/>
      (a)  SIGMA  wayside A path+ SIGMA  wayside B path
      <br/>
      - SIGMA  (wayside A .vertline..vertline.wayside B), if waysides A and B are overlapped (.vertline..vertline.indicates overlapped portions of the two parameters.)
      <br/>
      (b) wayside A path OR wayside B path, if waysides A and B are not overlapped.
    </p>
    <p num="13">
      Fundamentally, wayside path operation is merely setting values to the above introduced ROH bytes to initiate correct wayside protection switching.
      <br/>
      The important point here is that with one common wayside path operation, it is necessary to perform switching of two waysides as independently as possible, i.e. if two waysides are not dropped at the same site, the one affected by failures should be switched individually.
      <br/>
      A simple solution to this concern is to use Poor FEC, Poor PEC and Stream Indicator bits to record whether a wayside stream and only this stream has a failure, while utilizing FEC and PEC count bits to record the path quality after the failure (if there is one) till the drop site.
      <br/>
      By doing so, the two waysides can be easily switched separately when needed.
      <br/>
      Details of a wayside path operation are given below:
    </p>
    <p num="14">ADD Site</p>
    <p num="15">If both waysides are added together, set the Start Indicator bit to start a wayside path and all other bits in both bytes to 0.</p>
    <p num="16">
      If waysides are added separately, set the Start Indicator bit and all other bits to 0 at the first add site. (If one wayside is added with the other one passed thru, the site will be considered as the second add site; otherwise, it will be the first add site on a wayside path.) At the second add site, check if the accumulated FEC and accumulated PEC are above the threshold.
      <br/>
      If not, no action is needed.
      <br/>
      If yes, there will be three actions:
      <br/>
      1. set Poor FEC and/or Poor PEC bit(s) depending on which one exceeds the threshold;
      <br/>
      2. set Stream Indicator bit corresponding to the wayside which has poor FEC and/or PEC;
      <br/>
      3. set all FEC and/or PEC count bits to 0.
    </p>
    <p num="17">
      The reason for these three actions is to cope with a scenario in which a radio channel failure occurs before the second wayside stream is added.
      <br/>
      The above three actions ensure that a protection switching is performed at the drop site for the first added wayside (the Stream Indicator bit identifies the "bad" stream).
      <br/>
      It also ensures no switching for the second added wayside if the accumulated FEC and accumulated PEC (recorded by the FEC and PEC bits) are below the threshold (since all FEC and PEC bits are reset to 0 at the start of its individual path).
    </p>
    <p num="18">DROP Site</p>
    <p num="19">At a drop site, a protection switching is based on the following conditions:</p>
    <p num="20">Poor FEC and/or poor PEC bits(s) set to 1 AND the dropped wayside Stream Indicator(s) set to 1.</p>
    <p num="21">If both wayside streams are dropped together, the Start Indicator bit should be cleared.</p>
    <p num="22">
      If they are dropped separately, the Start Indicator bit should be cleared at a DROP site.
      <br/>
      At a DROP &amp; THRU site, the protection switching is considered in accordance with Poor FEC and/or Poor PEC bit(s), and these two bits must be cleared at this site. (The site where one wayside is dropped and the other passed thru is referred to as DROP &amp; THRU here; while the site where one wayside is dropped and the other not in use is called DROP.) This protects the following drop sites from unnecessary switching, especially when the wayside path is a "chain-style".
      <br/>
      The Start Indicator should not be cleared at this moment.
    </p>
    <p num="23">Other Sites</p>
    <p num="24">
      For non-add and non-drop sites, if the Start Indicator bit is set, the section FEC and PEC should be accumulated.
      <br/>
      If not, no action is required.
      <br/>
      c. use main traffic section FEC and PEC to trigger wayside protection switching.
      <br/>
      In this case, there needs to be 2 bits for each tributary to indicate the FEC and PEC quality.
      <br/>
      If there are n wayside tributaries, then the total necessary bits for this calculation will be:
      <br/>
      N(total bits)=2*n=2n.
    </p>
    <p num="25">
      In accordance with method "c", main traffic section FEC (Forward Error Correction) and PEC (Parity Error Count) are used to trigger wayside protection switching, two bits of radio overhead being used for each wayside tributary to indicate FEC and PEC quality.
      <br/>
      At each THRU site and DROP site, set these two bits for each wayside tributary according to the following table:
    </p>
    <heading>--      TABLE</heading>
    <p num="26">
      --      For one wayside
      <br/>
      --      stream
      <br/>
      --      bit 2  bit 1         Description
      <br/>
      --      0      0             The section FEC and PEC below the
      <br/>
      --                           switching threshold and the wayside path
      <br/>
      --                           is normal.
      <br/>
      --      0      1             The section FEC/PEC above the SF
      <br/>
      --                           threshold.
      <br/>
      --      1      0             The section FEC/PEC above the SD
      <br/>
      --                           threshold but below the SF threshold and
      <br/>
      --                           the protection switching threshold is
      <br/>
      --                           set to SF.
      <br/>
      --      1      1             The section FEC/PEC above the SD
      <br/>
      --                           threshold but below the SF threshold and
      <br/>
      --                           the protection switching threshold is
      <br/>
      --                           set to SD.
      <br/>
      where SF is signal failure and SD is signal degradation.
    </p>
    <p num="27">
      According to a broad aspect of the invention there is provided an a SONET/SDH radio communication network comprising a plurality of main radio communication terminals and a plurality of repeaters intermediate the communication terminals, with wayside communication paths being established between pairs of said repeaters via two radio channels carrying the same data, a method for determining whether to effect protection switching of a wayside path to the better of said two channels, comprising using different radio overhead bits to record, for each of a plurality n of wayside tributary paths, FEC (Forward Error Correction) and PEC (Parity Error Count) using 12 bits for each tributary path (8 for FEC and 4 for PEC), subject to the following conditions:
      <br/>
      (1) at an ADD site, set to zero the entire 12 bits corresponding to the added tributary,
      <br/>
      (2) at a DROP or THRU site, accumulate the section FEC and PEC by adding the main traffic's section FEC and PEC to the FEC bits and the PEC bits corresponding to the wayside stream to be passed through or dropped,
      <br/>
      (3) at any DROP site, compare the FEC and PEC corresponding to the tributary to be dropped with predetermined thresholds to determine whether protection switching is required.
    </p>
    <p num="28">
      According to another broad aspect of the invention there is provided in a SONET/SDH radio communication network comprising a plurality of main radio communication terminals and a plurality of repeaters intermediate the communication terminals, with wayside communication paths being established between pairs of said repeaters via two radio channels carrying the same data, a method for determining whether to effect protection switching of a wayside path to the better of said two channels, comprising making a switching decision by using one common wayside path to calculate FEC (Forward Error Correction) and PEC (Parity Error Count), switching being effected if FEC or PEC exceed predetermined thresholds, said common wayside path being defined as follows:
      <br/>
      (a)  SIGMA  wayside A path+ SIGMA  wayside B path
    </p>
    <p num="29">
      - - SIGMA  (wayside A .vertline..vertline.wayside B), if waysides A and B are overlapped (.vertline..vertline.indicates overlapped portions of the two parameters.)
      <br/>
      (b) wayside A path OR wayside B path, if waysides A and B are not overlapped.
    </p>
    <p num="30">According to another broad aspect of the invention there is provided in a SONET/SDH radio communication network comprising a plurality of main radio communication terminals and a plurality of repeaters intermediate the communication terminals, with wayside communication paths being established between pairs of said repeaters via two radio channels carrying the same data, a method for determining whether to effect protection switching of a wayside path to the better of said two channels, comprising using main traffic section FEC (Forward Error Correction) and PEC (Parity Error Count) to trigger wayside protection switching, two bits of a wayside path signal flag byte being used for each wayside tributary to indicate FEC and PEC quality, 2 n bits being used in the case of n wayside tributaries, both bits for an added wayside stream being set to 0 at an ADD site and said bits being set at a THRU or DROP site as shown in the following table:</p>
    <heading>--      TABLE</heading>
    <p num="31">
      --      For one wayside
      <br/>
      --      stream
      <br/>
      --      bit 2  bit 1         Description
      <br/>
      --      0      0             The section FEC and PEC below the
      <br/>
      --                           switching threshold and the wayside path
      <br/>
      --                           is normal.
      <br/>
      --      0      1             The section FEC/PEC above the SF
      <br/>
      --                           threshold.
      <br/>
      --      1      0             The section FEC/PEC above the SD
      <br/>
      --                           threshold but below the SF threshold and
      <br/>
      --                           the protection switching threshold is
      <br/>
      --                           set to SF.
      <br/>
      --      1      1             The section FEC/PEC above the SD
      <br/>
      --                           threshold but below the SF threshold and
      <br/>
      --                           the protection switching threshold is
      <br/>
      --                           set to SD.
    </p>
    <p num="32">
      According to another broad aspect of the invention there is provided in a SONET/SDH radio communication network comprising a plurality of main radio communication terminals and a plurality of repeaters intermediate the communication terminals, with wayside communication paths being established between pairs of said repeaters via two radio channels carrying the same data, a system for protection switching of said wayside paths, comprising, for each repeater, duplicated software and hardware on first and second service overhead access(SOA) units, said software determining if protection switching is required and signalling said hardware to effect protection switching, said switching being effected in a "break before make" manner as follows:
      <br/>
      (1) the software enables ENABLE bits on a first SOA, which results in the hardware sending a signal to disable both ENABLE bits on the second SOA,
      <br/>
      (2) the output drivers of the second SOA are turned off based on the ENABLE bits control after which their status is fed back to the first SOA,
      <br/>
      (3) the output drivers of the first SOA are switched on based on its own ENABLE.
    </p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="33">
      FIG. 1 is a block diagram of a radio network,
      <br/>
      FIG. 2 schematically illustrates a line of repeaters with wayside paths,
      <br/>
      FIGS. 3 to 6 are illustrations of how repeater failures may affect wayside traffic,
      <br/>
      FIG. 7 illustrates a byte used in ROH (Radio Overhead) for FEC accumulation,
      <br/>
      FIG. 8 illustrates a byte used for wayside information and PEC count,
      <br/>
      FIG. 9 illustrates one situation, thought to be rare, which may not be correctly handled by the present invention,
      <br/>
      FIG. 10 is a block diagram of a wayside protection switching arrangement according to the present invention,
      <br/>
      FIG. 11 is a table of two condition records maintained by the wayside protection switching system to compare wayside conditions on the two channels in order to make a switching decision,
      <br/>
      FIG. 12 is a table explaining how ENABLE and MATE13 OUTPUT13 STATUS bits are used to control the wayside stream output drivers,
      <br/>
      FIG. 13 is a table showing the MATE13 OUTPUT_STATUS bit settings for different output statuses of two wayside streams A and B,
      <br/>
      FIG. 14 is a diagram of the concepts of message exchanges between two channels via a local area network referred to herein as an "FNet",
      <br/>
      FIG. 15 illustrates three examples of wayside switching scenarios,
      <br/>
      FIG. 16 is a flow chart of the algorithm used by the wayside protection switching system,
      <br/>
      FIG. 17 is a diagram explaining the "Determine Quality &amp; View" process of FIG. 16,
      <br/>
      FIG. 18 is a diagram of a wayside path signal flag byte used in method "c" referred to above,
      <br/>
      FIG. 19 is a block diagram of the wayside channel overhead access cards for channels A and B for further explaining the operation thereof,
      <br/>
      FIG. 20 is a state diagram for explaining the operation of the state machines shown in FIG. 1,
      <br/>
      FIG. 21 is a block diagram of the protection switching system,
      <br/>
      FIG. 22 is a block diagram of the interconnections of the two radio channels, and
      <br/>
      FIG. 23 is a diagram of switching activity.
    </p>
    <heading>DESCRIPTION OF THE PREFERRED EMBODIMENT</heading>
    <p num="34">
      Referring to FIG. 1, main traffic protection in a terminal to terminal network will be briefly described before discussing wayside protection.
      <br/>
      The terminal comprises two communicating main traffic terminals T1 and T2 and intermediate repeaters R1, R2--Rn--1.
      <br/>
      The main traffic is added at one terminal and dropped at the other terminal.
      <br/>
      Also indicated are radio signal "hops" between the terminals via the repeaters.
      <br/>
      For a network with n hops, as shown in FIG. 1, the section FEC (FEC(i)) and section PEC (PEC(i)) for the entire traffic, including payload and overhead bytes, at each hop are checked by a radio signal processor (RSP), not shown, and accumulated along the way (from terminal T1 to terminal T2) using two ROH (radio overhead) bytes.
      <br/>
      The sum of the section FEC's and the sum of the section PEC's from T1 to T2 are defined as the line FEC and the line PEC, i.e.  (Equation image '1' not included in text)
    </p>
    <p num="35">
      A radio signal processor at the receive terminal T2 compares the line FEC and the line PEC with a signal failure or signal degradation threshold.
      <br/>
      If either of them is above the threshold, an interrupt SF (signal failure) or SD (signal degradation) will be set and the main traffic will be transferred to a protection channel.
      <br/>
      At repeater sites, the interrupts SF and SD are masked.
    </p>
    <p num="36">
      A wayside may have a shorter path than that of the main traffic.
      <br/>
      As shown in FIG. 1, a wayside can be added at repeater R2 and dropped at repeater Rn-1.
      <br/>
      FIG. 2 schematically illustrates a line of repeaters with a number of wayside paths.
      <br/>
      There are three basic types of a wayside site: ADD, THRU and DROP.
      <br/>
      An ADD site means a wayside tributary will be added to the main traffic overhead at this site, a THRU site means a wayside tributary is added previously and will pass through this site, and a DROP site indicates a wayside tributary will be abstracted from the main traffic's overhead at this site.
      <br/>
      When there are more than one wayside stream, a site is sometimes named with the type combinations, e.g. ADD-AND-THRU, indicating some tributaries are added while some are passed through.
      <br/>
      In the case of FIG. 1, wayside protection switching caused by radio channel interferences or fading can not be performed according to SF or SD based on the accumulated FEC and PEC for the main traffic starting from terminal T1, because the radio channel failure may happen at a hop which is not on the wayside path, e.g. hop 2 in FIG. 1.
      <br/>
      Obviously, unnecessary switching may arise if the line FEC or line PEC is used to indicate the radio channel quality for the wayside.
      <br/>
      Thus, the FEC and PEC on the wayside path (in FIG. 1 it is from R2 to Rn-1) must be recorded independently in order to be able to interrupt the RSP and activate protection software at any wayside drop site.
    </p>
    <p num="37">In order to perform protection switching properly, the following situations need to be taken into account:</p>
    <p num="38">
      (1) A failure occurs on the radio channel but outside the wayside path, as shown in FIG. 3.
      <br/>
      In this case, the failure should not cause a wayside protection switching.
      <br/>
      (2) A failure on the radio channel affects one wayside stream only, e.g. wayside A as shown in FIG. 4.
      <br/>
      In this case, the failure in wayside A should not cause a protection switching for the other wayside stream B.
      <br/>
      (3) A failure occurs on one wayside stream but two waysides are dropped together, as shown in FIG. 5.
      <br/>
      In this case, the uncontaminated wayside B has to be switched simultaneously with wayside A. This is because the hardware automatically switches the two waysides at the same time.
      <br/>
      (4) A failure occurs at a point where two wayside stream paths are overlapped, as shown in FIG. 6.
      <br/>
      In this case, a protection switching should be performed at drop site(s) for both waysides.
    </p>
    <p num="39">WPSF (wayside path signal failure) and WPSD (wayside path signal degradation) are defined as two bits which indicate an FEC (forward error correction) or a PEC level on a wayside path. (PEC is parity error count.) Thresholds for setting these two bits are the same as for SF and SD in terminal-to-terminal protection switching as mentioned above.</p>
    <p num="40">There are three methods according to the invention for determining a wayside radio path quality and switching based on the wayside path FEC and PEC.</p>
    <p num="41">Method A</p>
    <p num="42">
      Each wayside path is defined separately.
      <br/>
      Twelve bits (8 for FEC and 4 for PEC) in the radio overhead are used to record wayside path FEC and PEC (referred to as FEC bits and PEC bits) for each wayside tributary.
      <br/>
      These bits are independent from those used for recording the main traffic's FEC and PEC.
    </p>
    <p num="43">a. Total Bits Needed</p>
    <p num="44">
      If there are "n" wayside tributaries carried in the main traffic overhead, there is needed:
      <br/>
      N(total bits)=n * 12=12 n bits
    </p>
    <p num="45">to record FEC and PEC for all wayside streams.</p>
    <p num="46">b. Bits Settings</p>
    <p num="47">At an ADD site, set the entire 12 bits corresponding to the added wayside stream to zero.</p>
    <p num="48">At a DROP or a THRU site, accumulate the FEC and PEC by adding the main traffic's section FEC and PEC to the FEC bits and the PEC bits corresponding to the wayside stream to be passed through or dropped.</p>
    <p num="49">c. Wayside Path Quality Determination</p>
    <p num="50">
      At a DROP site, the WPSF and WPSD bits will be set according to the following conditions:
      <br/>
      WPSF=1, if the FEC and/or PEC recorded by FEC bits and PEC bits for the dropped wayside tributary are above the predetermined signal failure threshold;
      <br/>
      WPSD=1, if the FEC and/or PEC recorded by FEC bits and PEC bits for the dropped wayside tributary is above the predetermined signal degradation threshold;
      <br/>
      =0, if both of them are below the threshold.
    </p>
    <p num="51">A wayside protection switching process is triggered when WPSF or WPSD is set to 1. (Please refer to the software implementation in the later part of this section).</p>
    <p num="52">Method B</p>
    <p num="53">
      A common wayside path is defined in case of a limited availability of radio overhead bytes.
      <br/>
      Taking two waysides as an example, the common path (refer to FIG. 2) is defined as follows:
      <br/>
      (a)  SIGMA  wayside A path+ SIGMA  wayside B path- SIGMA  (wayside A.vertline..vertline.wayside B), if waysides A and B are overlapped. (.vertline..vertline.indicates the overlapped portion of the two parameters.)
      <br/>
      (b) wayside A path OR wayside B path, if waysides A and B are not overlapped.
    </p>
    <p num="54">a. Total Bits Needed</p>
    <p num="55">
      If there is one wayside tributary carried by the main traffic's overhead, the total bits in the radio overhead for recording wayside path FEC and PEC are:
      <br/>
      N (total bits)=12 n bits (actually this case is covered in Method "a" and will not be described hereafter).
    </p>
    <p num="56">
      If there is more than one wayside tributary carried by the main traffic's overhead, the total bits in the radio overhead for recording wayside path FEC and PEC are:
      <br/>
      N (total bits)=8+4+1+2+n=15+n bits
    </p>
    <p num="57">
      Eight bits are used for wayside path FEC accumulation and 4 bits for PEC accumulation.
      <br/>
      Other bits are needed to derive the path quality.
      <br/>
      One bit is used to indicate a start of the path and two bits are for the poor FEC flag and poor PEC flag to indicate the accumulated FEC and/or PEC value above the threshold at a certain point on the path.
      <br/>
      It also needs "n" bits to define stream IDs with each of them corresponding to a stream, as shown in FIG. 7 and FIG. 8.
    </p>
    <p num="58">b. Bits Settings</p>
    <p num="59">At an ADD site</p>
    <p num="60">If all wayside streams are added into the main traffic overhead together, set the Start Indicator bit to 1 to start a wayside path and all other bits (refer to FIG. 7 and FIG. 8) to 0.</p>
    <p num="61">
      If wayside streams are added separately, set the Start Indicator bit to 1 and all other bits to 0 at the first ADD site (if one wayside is added with others passed through, the site is considered as not the first ADD site.
      <br/>
      It is referred to as a following ADD or an ADD and THRU site hereafter).
      <br/>
      At following ADD sites, check if the accumulated FEC and accumulated PEC are above the threshold.
      <br/>
      If not, no action is needed.
      <br/>
      However, if yes, there are three actions:
      <br/>
      1. set Poor FEC and/or Poor PEC bit(s) to 1 depending on which one exceeds the threshold;
      <br/>
      2. set Stream Indicator corresponding to the wayside stream(s) having poor FEC and/or poor PEC to 1;
      <br/>
      3. set the FEC and/or PEC count bits which exceed the threshold to 0.
    </p>
    <p num="62">
      The reason for these three actions is to cope with the scenario illustrated in FIG. 4.
      <br/>
      In this case, a radio channel failure occurs before the second wayside stream is added.
      <br/>
      The above three actions ensure that a protection switching is performed at the drop site for the first added wayside.
      <br/>
      It also ensures no switching for the second added wayside stream if the FEC and PEC recorded later are below the thresholds.
    </p>
    <p num="63">
      At a DROP site, the main traffic's section FEC and PEC are added to the FEC count bits and PEC count bits.
      <br/>
      Set the Poor FEC and/or Poor PEC bits to 1 as well as Stream Indicator bits corresponding to the dropped streams to 1 if the accumulated FEC and/or PEC are above the threshold(s).
    </p>
    <p num="64">If all wayside streams are dropped together, the Start Indicator bit is cleared, namely set to 0.</p>
    <p num="65">If they are dropped separately, the Start Indicator bit is cleared when no other wayside streams are passed through at this site.</p>
    <p num="66">At other sites</p>
    <p num="67">
      If the Start Indicator bit is set to 1, the main traffic's section FEC and PEC are accumulated.
      <br/>
      If not, no action is required.
    </p>
    <p num="68">c. Wayside Path Quality Determination</p>
    <p num="69">At a DROP site, a poor wayside path quality is determined if the following condition is true:</p>
    <p num="70">Poor FEC and/or Poor PEC bit(s) are set to 1 AND the dropped wayside Stream Indicator(s) is set to 1.</p>
    <p num="71">A wayside protection switching process is triggered when the above condition is satisfied. (Please refer to the software implementation in the later part of this section.)</p>
    <p num="72">Method C</p>
    <p num="73">
      This method uses main traffic section FEC and PEC to determine the wayside radio path quality.
      <br/>
      The section FEC and section PEC are not accumulated, instead two bits in the radio overhead are used as flags to record section FEC and section PEC status for each wayside stream.
      <br/>
      See FIG. 18 and the table (supra).
    </p>
    <p num="74">a. Total Bits Needed</p>
    <p num="75">
      If there are "n" wayside tributaries, then the total necessary bits in the radio overhead are:
      <br/>
      N(total bits)=2 * n=2 n
    </p>
    <p num="76">
      b.
      <br/>
      Bits Settings
    </p>
    <p num="77">At an ADD site, set both bits for the added wayside streams to 0.</p>
    <p num="78">At a THRU or DROP site, set the two bits to a value indicated in the table, supra, based on the described situation.</p>
    <p num="79">c. Wayside Path Quality Determination</p>
    <p num="80">
      At a DROP site, the WPSF and WPSD bits will be set according to the following conditions:
      <br/>
      WPSF=1, if flag bits of the dropped wayside stream are:
      <br/>
      +bit2, bit1}=+0, 1}
    </p>
    <p num="81">
      - 0 if otherwise
      <br/>
      WPSD=1, if flag bits of the dropped wayside stream are:
      <br/>
      +bit2, bit1}=+1, 1}
      <br/>
      - 0, if otherwise.
    </p>
    <p num="82">A wayside protection switching process is triggered when WPSF or WPSD is set to 1. (Please refer to the software implementation in the later part of this section.)</p>
    <p num="83">There is one scenario which can not be covered by methods "b" and "c", but is covered by method "a".</p>
    <p num="84">
      In the case illustrated in FIG. 9, there is no burst failure appearing on the wayside path.
      <br/>
      In other words, each section FEC and PEC are below the thresholds.
      <br/>
      However, the accumulated FEC and/or PEC could be above the threshold.
      <br/>
      Remember when there is no burst failure and method "b" is used, the FEC and PEC are accumulated from the first wayside stream add site till the drop site.
      <br/>
      Therefore, for the three wayside A paths, the FEC and PEC are accumulated from the wayside B's add site until their drop sites X1, X2 and X3.
      <br/>
      These FEC and PEC values could be much higher, even above the threshold, than the ones accumulated from their own add sites.
      <br/>
      In consequence, unnecessary switching could be initiated.
      <br/>
      If method "c" is used in this situation there will be no flag raised.
      <br/>
      As a result, protection switching could be missed.
    </p>
    <p num="85">
      This problem remains as an open issue for wayside protection switching using methods "b" and "c" due to ROH bytes limitation.
      <br/>
      There is no suitable solution for it currently.
      <br/>
      The probability of this scenario in a network is to be determined, but is thought to be extremely small.
    </p>
    <p num="86">
      Wayside protection switching is only available in a protected system configuration.
      <br/>
      The overall protection strategy is: at the transmit site, the wayside signal is bridged to two service channel overhead access (SOA) cards, shown in FIG. 10 as SOA A and SOA B, then carried on two radio channels, channels A and B; at the receive end, the better one of the two wayside channels is selected to be outputted by an auto-controlled switching, i.e. protection switching.
    </p>
    <p num="87">
      This redundant configuration makes protection switching possible by selecting the better of the two radio channels when dropping the wayside traffic to the customer.
      <br/>
      The radio path is protected by using a redundant radio channel to transport a copy of the wayside data, and the SOA circuit pack is protected by having a redundant SOA circuit pack from which the wayside can be selected at the site where the wayside is dropped.
    </p>
    <p num="88">
      The protection switching preferably satisfies the following requirements:
      <br/>
      (a) protection switching less than 50 ms,
      <br/>
      (b) delay between make and break less than 100  MU s,
      <br/>
      (c) customer choice of output enabling and disabling threshold, either SF or SD, set by a terminal to program a desired selection, and
      <br/>
      (d) hooks for future modifications, such as manual switching.
    </p>
    <p num="89">However, these requirements are not essential to the basic invention.</p>
    <p num="90">
      FIG. 10 is a block diagram of the wayside protection switching arrangement according to the present invention.
      <br/>
      The switching software is mainly composed of a Wayside Protection Switching (WPS) algorithm, i.e. WPS 10 in the Radio Signal Processor A (RSP A) in channel A, and WPS 12 in RSP B. The hardware contains a handshake (HS) unit 14 on SOA A and 15 on SOA B, each with the same state machine.
      <br/>
      The software interacts with the hardware via control signals on a bus marked RBus on FIG. 10 and data lines under common control CC.
    </p>
    <p num="91">
      It is proposed in the following description to use "wayside stream A (or B)" and "wayside A (or B)" to refer to the two different wayside flows on the same SOA and use "wayside A (or B) left" and "wayside A (or B) right" and "wayside channel A/B" for the duplicated wayside flows on two different SOA's.
      <br/>
      Also, to simplify the description, focus will be on one wayside stream and will not point out if it is the wayside stream A or B since they are equally handled.
    </p>
    <p num="92">
      For each wayside, three types of control bits, ENABLE_A(or B), OUTPUT_STATUS_A(or B) (hereinafter called ENABLE and OUTPUT_STATUS) and MATE_OUTPUT_STATUS, are applied to interface the hardware and the software.
      <br/>
      Four backplane (b/p) traces are involved to connect the two SOA cards to complete the handshaking protocol.
    </p>
    <p num="93">
      The ENABLE bit controls the output driver, shown as switches 16 in FIG. 10. It can be either written by the WPS or set by the mate SOA via backplane lines x1 or x2.
      <br/>
      If it is set by the WPS, separate values are allowed to the bits corresponding to different wayside streams if only one of them is in use.
      <br/>
      However, if it is set by the mate SOA, two ENABLE bits can only be set with the same value.
    </p>
    <p num="94">
      The OUTPUT_STATUS bit is used to report to the software the current wayside switches' on/off status on the own SOA.
      <br/>
      This bit can only be read by the RSP.
    </p>
    <p num="95">
      The MATE_OUTPUT_STATUS bit indicates if both output drivers on the mate SOA are turned off.
      <br/>
      This information is bridged between SOAs through backplane lines y1 and Y2.
      <br/>
      Furthermore, it participates in controlling the wayside output on the own SOA.
    </p>
    <p num="96">
      The "turn-on-own and turn-off-mate" switching operation in a "break before make" manner can be summarized as follows:
      <br/>
      Step 1: The WPS enables the ENABLE BIT(s) on the own SOA, which results in a signal going through backplane line Xi to disable both ENABLE bits on the mate SOA.
    </p>
    <p num="97">
      Step 2: The mate output drivers are then turned off based on its ENABLE bits.
      <br/>
      The driver(s) status is afterwards fedback to the own SOA via backplane line yi.
    </p>
    <p num="98">Step 3: The own output driver(s) are now switched on based on the own ENABLE.</p>
    <p num="99">
      It can be seen that the "make" action is done based on a successful "break" action.
      <br/>
      The handshake unit HS not only controls the own output drivers but also is able to reset both mate ENABLE bits via the backplane.
      <br/>
      In other words, the software on one RSP may control the output drivers on two SOA printed circuit boards via the hardware.
    </p>
    <p num="100">
      It is obvious that the basic task of the WPS is to determine when and to what values the ENABLE bits should be set.
      <br/>
      To do so, the WPS needs to obtain and compare the wayside conditions of both wayside left and wayside right, then to decide if there is a need of switching.
    </p>
    <p num="101">
      Whether the signals xi and yi are called x1 or x2, or y1 or y2, depends on whether the observer is considering the own SOA or the mate SOA.
      <br/>
      Referring to FIG. 19, a block diagram of the wayside channel access cards for channels A and B, as well as FIG. 10, a more detailed description of the operation is as follows:
      <br/>
      Step 1: The WPS enables the ENABLE bit(s) on the own SOA, which results in a signal going through backplane line xi to disable both ENABLE bits on the mate SOA.
      <br/>
      At the same time it starts a timer (stop watch) 100, 101.
    </p>
    <p num="102">
      Step 2a: The mate SOA receives the xi signal (also called DISABLE_OUTPUTS) and clears its ENABLE bits.
      <br/>
      The mate output drivers are turned off as a consequence of this.
    </p>
    <p num="103">
      Step 2b: Once the output drivers are turned off, the mate SOA drivers status is fedback to the own SOA via a backplane line yi.
      <br/>
      If the output drivers are not turned off, their status is also fedback.
    </p>
    <p num="104">Step 3: The SOA that originated the switching activity receives the status of the mate on the yi line.</p>
    <p num="105">
      If the status says the mate SOA output drivers have been turned off before the timer expires, the timer is reset and the own drivers are turned on based on the local ENABLE bits value.
      <br/>
      Otherwise, if the timer expires before the mate SOA output drivers are turned off, the SWITCH_FAIL signal is raised and reported to the RSP to let it know the protection switching failed.
    </p>
    <p num="106">NOTE: The timer expires when it reaches 100  MU s. The timer is needed to prevent the system from being locked if the mate SOA does not turn off its output drivers.</p>
    <p num="107">
      In order to make a switching decision, the WPS needs to maintain two condition records, local channel record (L-Record) and mate channel record (M-Record), which will be used to compare wayside conditions on the two channels.
      <br/>
      As shown in FIG. 11, each record contains 6 condition items.
      <br/>
      Each item is represented by one bit, indicating either a normal or a failure condition.
      <br/>
      It is noted that some conditions cover a group of monitoring points, such as CC I/F status (Common Control Interface status) and Wayside A OR B alarms status.
      <br/>
      In this case, the bit should be set if one or more alarms are true.
      <br/>
      The severity level in the table of FIG. 11 suggests a degree of influence on the wayside receive caused by the failure condition.
      <br/>
      The smaller the number, the worse it is.
    </p>
    <p num="108">
      An FNet message between the WPSes contains the L-Record and the switch request (if a protection switching is determined).
      <br/>
      Basically, the standby channel sends an Fnet message (L-record only) when any content of the L-Record changes; and the active channel transmits an Fnet message (a switch request plus the L-record) when a protection switching is decided.
      <br/>
      See FIG. 14.
    </p>
    <p num="109">
      The WPS on both active and standby channels are activated based on the following conditions:
      <br/>
      FNet message interrupt
      <br/>
      Monitoring points interrupt or change
    </p>
    <p num="110">
      The response to the FNet message activation on an active channel is to update the M-Record; on an inactive channel, besides changing the M-Record it also prepares for a switching.
      <br/>
      The response to the monitoring points activation on an inactive channel is to update the L-Record and send an FNet message to the active channel; while on an active channel the response is to update the L-Record and send an FNet message including the switching request if it is necessary.
    </p>
    <p num="111">
      While the protection switching is determined by the active channel algorithm, it is confirmed and performed by the standby channel.
      <br/>
      The switching control method is summarized as below:
      <br/>
      1.
      <br/>
      When any content of the monitoring points on the standby channel changes, the WPS is activated.
      <br/>
      It updates the L-Record and sends an Fnet message to the active channel.
      <br/>
      2. For an ideal Fnet communication, the active channel should always have the latest information on the inactive channel which is stored in the M-Record.
      <br/>
      3. When any state of the monitoring points on the active channel changes, the WPS is activated.
      <br/>
      It updates the L-Record and compares the L-Record with the M-Record to decide if there should be a protection switching.
      <br/>
      4. If a protection switching is determined, the active channel sends an FNet message including the switch request and the L-Record to the mate channel, and checks if the switching is done within a time limit of, for example, 100  MU s. If not, the WPS reports failure to the RSP.
      <br/>
      5. The mate (inactive channel) WPS confirms the correctness of the switch request by comparing the L-Record and the M-Record one more time.
      <br/>
      This step prevents a wrong switching decision made by the active channel due to FNet message problems, such as message collision or delay in the queue.
      <br/>
      6. If the switch request is confirmed, the inactive channel WPS sets the ENABLE bit(s) to 1 which through the backplane trace Xi switches off the mate outputs.
      <br/>
      When this is done successfully, the own MATE_OUTPUT_STATUS will be set by the mate-output-monitoring signal via another backplane line yi.
      <br/>
      The own wayside output(s) is enabled based on a combination of ENABLE and MATE_OUTPUT_STATUS bits.
      <br/>
      Details for the bits definition are given in the next section.
      <br/>
      Then the WPS reports success to the RSP.
      <br/>
      7. If the switch request is denied, the inactive WPS reports failure to the RSP.
    </p>
    <p num="112">
      Regarding the ENABLE bit definition, three points should be noted:
      <br/>
      1.
      <br/>
      The output switches of two wayside streams on each SOA are independently controlled by the two corresponding ENABLE bits.
      <br/>
      2. Both ENABLE bits can be set or cleared by the own WPS and can be cleared by the mate SOA through the backplane.
      <br/>
      3. The last entry (by RSP or mate SOA) to set (or clear) the ENABLE bit overrides the previous state.
    </p>
    <p num="113">The ENABLE and MATE_OUTPUT_STATUS bits which control the wayside stream output drivers are defined in FIG. 12 and MATE_OUTPUT_STATUS bit value definitions are shown in FIG. 13.</p>
    <p num="114">
      When the ENABLE bit is set to 1 for a wayside stream, the state machine sends out a signal through the backplane to set both mate ENABLE bits to 0 which turns off the mate output drivers.
      <br/>
      The feedback signal MATE_OUTPUT_STATUS from the mate SOA combines with the own ENABLE bit value to turn on the own output driver.
      <br/>
      When the ENABLE bit is set to 0, the state machine does not send any signal to the mate SOA, instead it only switches off the own output driver.
      <br/>
      It should be pointed out that the control signal from the state machine to the mate SOA will set two mate ENABLE bits to zero simultaneously.
      <br/>
      The reason to do so attempts to simplify the backplane application.
    </p>
    <p num="115">This ENABLE bit definition satisfies the three required switching scenarios, as shown in FIG. 15. Note the figure only takes wayside stream A as an example since the two wayside streams are controlled independently by the corresponding ENABLE bits.</p>
    <p num="116">
      Case 1 is an example of a protection switching.
      <br/>
      Wayside A left was an active channel first.
      <br/>
      When wayside A left decided a protection switching, wayside A right (the inactive channel) set ENABLE bit to 1, which made the left channel become inactive and the right channel active.
      <br/>
      Case 2 is an example of changing a drop site to a thru site.
      <br/>
      If the ENABLE bit is set to 0 on the left channel, the own output driver is turned off and there is no signal going to the mate channel.
      <br/>
      Thus both output drivers are disconnected.
      <br/>
      Case 3 is an example of changing a thru site to a drop site.
      <br/>
      This can be done by setting the ENABLE bit on left channel to 1, which results in setting the mate ENABLE bit to 0 (no influence) and turning on own switch.
      <br/>
      As a consequence, the site is changed to a drop site.
    </p>
    <p num="117">Referring to the WPS algorithm of FIG. 16, Determine Quality &amp; View processes determine the quality of the active channels, and examines the various alarms and statuses to determine whether or not Protection switching is needed.</p>
    <p num="118">Referring to FIG. 17, the Determine Quality process determines the quality of the wayside channels being received by its own SOA unit and examines the various alarms and status to generate one rating that describes the combined quality of both wayside channels.</p>
    <p num="119">
      The Determine View process compares the own quality with the mate quality to determine its own view of which SOA unit should be outputting the wayside channels.
      <br/>
      The Negotiate View process sends the own quality and the own view to the mate RSP for agreement.
      <br/>
      Both RSPs must agree to a common view before they perform any SOA control actions.
    </p>
    <p num="120">
      Once a common view has been agreed to, the wayside channel must coordinate any changes to the SOA unit output control.
      <br/>
      This coordination prevents both SOA units from outputting their wayside channels at the same time.
    </p>
    <p num="121">
      The switching decision is made by the active channel only (checked by the mate) and the output switching is controlled by both software and hardware.
      <br/>
      It should be mentioned here that if failures occur on both left and right channels for a wayside stream, the WPS does not switch the system back and forth.
      <br/>
      The system is stable in this situation.
    </p>
    <p num="122">
      The other steps necessary for completing a wayside protection switching include the following procedures:
      <br/>
      1.
      <br/>
      When the WPS is activated, the algorithm should check depending on the activation source whether the L-Record or M-Record needs to be updated.
      <br/>
      2. The customer request handling in the next step is a hook for possible future use.
      <br/>
      3. For the active channel, the WPS examines whether the mate RSP is missing since this information is not included in the condition record and must be checked first.
    </p>
    <p num="123">If the mate RSP is missing, there must not be any action on the active channel, even if there could be alarms.</p>
    <p num="124">
      If the mate RSP is not missing, the WPS checks if the mate SOA is missing and sets bit PRT_UNPRT in a Wayside Control Register if necessary.
      <br/>
      The value in this bit controls the application of backplane lines in protection switching.
      <br/>
      This bit is set to 1 when the mate SOA is present (protected configuration) and to 0 when the mate SOA is missing (unprotected configuration).
    </p>
    <p num="125">After processing mate SOA present status, the RSP checks both L-Record and M-Record to determine the channels quality and make a switching decision.</p>
    <p num="126">
      If the protection switching is required, the WPS will send an FNet message including the switch request and the L-Record to the mate channel.
      <br/>
      If the switching is necessary, the WPS sub-routine returns to the caller routine.
    </p>
    <p num="127">
      If the switch request is made, the active channel checks if the switching action is done within 100  MU s. If not, it will report failure to the RSP.
      <br/>
      If yes, switching has been performed.
      <br/>
      4. For the inactive channel, if the mate RSP is missing, the WPS must perform a switching immediately by setting the ENABLE bit(s) to 1.
      <br/>
      If the mate RSP is present, it looks at the mate SOA present status and checks
      <br/>
      if there is the switch request from the active channel.
      <br/>
      If no, it sends an FNet message with L-Record only to the mate channel.
      <br/>
      If the switch request is true, it goes through the procedure of determining the channels quality and switching view one more time to confirm the correctness of making a protection switch.
      <br/>
      if the protection switching is confirmed, it sets the ENABLE bit(s) to one and checks the OUTPUT_STATUS bit(s) to see if the switching is done within 100  MU s. If yes, it reports success to the RSP; if no, it reports failure.
      <br/>
      If the protection switching is denied by DETERMINE QUALITY &amp; VIEW, it reports to the RSP and exits.
    </p>
    <p num="128">
      NOTE: it is not necessary to reply to the mate (former active) WSP whether or not the switching is performed since:
      <br/>
      a. if the switching is successfully done, the active WPS will know by the own OUTPUT_STATUS and MATE_OUTPUT_STATUS bits change and the success will be reported to the RSP by the inactive channel;
      <br/>
      b. if the switching is not performed due to failing in the mate confirmation, both the active and the inactive WPS will report to the RSPs (the active WSP will know the failure by checking if the OUTPUT_STATUS bits have not been cleared within a certain amount of time);
      <br/>
      c. if the switching is not done due to losing the FNet message, the active WSP will know this (as described in the above) and report to its RSP by itself only.
    </p>
    <p num="129">State Machine Description</p>
    <p num="130">Referring to FIG. 20, the state machine will now be described.</p>
    <p num="131">
      INPUTS (not shown, except for reset)
      <br/>
      reset: Reset at startup
      <br/>
      clk: Clock
    </p>
    <p num="132">
      enable_a: This bit is used in controlling the local output driver's status as well as the xi (DISABLE_MATE) signal going to the mate SOA.
      <br/>
      When set to `1`, this triggers the state machine to initiate a protection switch.
      <br/>
      When set to `0`, the local output driver for wayside stream A is turned off.
    </p>
    <p num="133">enable B: See enable_a, but when set to `0`, turns off stream B.</p>
    <p num="134">output_status_a: This signal reports the actual status of the output driver A.</p>
    <p num="135">
      output_status_b: Status of output driver B. When reporting `1` the local output drivers are turned ON.
      <br/>
      When reporting `0` the local output drivers are turned OFF.
    </p>
    <p num="136">
      mate_output_status: This signal reports the status of the mate SOA output drivers.
      <br/>
      When reporting `1`, either or both output drivers on the mate SOA are turned on.
      <br/>
      When reporting a `0`, both output drivers on the mate SOA are turned off.
    </p>
    <p num="137">
      disable_output: This is a signal coming from the mate SOA.
      <br/>
      When `1`, the mate SOA and RSP want to take control by initiating a switch (see step 2a, supra).
      <br/>
      When `0`, the mate SOA and RSP are not requesting a switch.
    </p>
    <p num="138">
      timeout: This reports the status of the timer to the state machine.
      <br/>
      When `1`, the timer has exceeded its limit.
      <br/>
      When `0`, the timer has not exceeded its limit or is inactive.
    </p>
    <p num="139">outputs (Shown in Rectangular Blocks in FIG. 20)</p>
    <p num="140">clear_ena: This signal will effectively cause the ENABLE_A bit to be cleared.</p>
    <p num="141">clear_enb: This signal will effectively cause the ENABLE_B bit to be cleared.</p>
    <p num="142">Both clear_ena and clear_enb are active high signals.</p>
    <p num="143">control_a: This is a control signal to the local output driver A (stream A).</p>
    <p num="144">
      control_B: This is a control signal to the local output driver B (stream B).
      <br/>
      When `1`, turns on the output driver (of stream A or B or both).
      <br/>
      When `0`, turns off the output driver (of stream A or B or both).
    </p>
    <p num="145">
      output_status: This reports the local output driver status to the mate.
      <br/>
      It is actually the result of ORing the local drivers statuses.
    </p>
    <p num="146">
      disable_mate: This is a signal sent to the mate SOA to tell it to turn its output drivers off so that the local SOA can turn its own drivers on.
      <br/>
      This is an active high signal.
    </p>
    <p num="147">start_timer: This signal causes the timer to start counting.</p>
    <p num="148">clear_timer: This signal causes the timer to stop counting and to be reset to 0.</p>
    <p num="149">switch_fail: This signal is set to '1' if the mate SOA does not turn off its drivers before the timer expires.</p>
    <p num="150">
      NOTE: The state machine is synchronous and the inputs are synchronized to the clock before entering the state machine.
      <br/>
      This means that input signals may have been synchronized by a process external to the state machine.
    </p>
    <p num="151">The protection switching state machine activity can be described as follows:</p>
    <p num="152">
      The clock input signal (clk) synchronizes the operations of the state machine.
      <br/>
      Transitions from one state to another occur on the rising edge of the clock only.
      <br/>
      In FIG. 20 the circles represent states.
    </p>
    <p num="153">When the power has been applied to the system and has stabilized, the reset signal puts the state machine in the Init state, where all the output signals are set to zero (block 50).</p>
    <p num="154">
      The next state, Idle, is reached by default.
      <br/>
      In this state, the machine waits for commands from either the mate SOA (disable_outputs) or the local RSP (ENABLE_A or ENABLE_B).
      <br/>
      When a command is received, the current output status for outputs A and B are compared with the command and actions are taken.
      <br/>
      During this state the timer control signals are set to their default values (timer stopped), and the signals to clear the ENABLE_A and ENABLE_B bits are de-activated (clear_ena and clear_enb are de-activated, box 51).
    </p>
    <p num="155">
      If the external command disable_outputs is received, and if the local output statuses show that either or both drivers are turned ON, the machine proceeds to the External Command Received state.
      <br/>
      Otherwise, no action is taken and the machine remains in the Idle state.
    </p>
    <p num="156">
      In the External Command Received state, the machine sends a clear_ena and a clear_enb signal to the ENABLE_A and ENABLE_B control bits to clear them.
      <br/>
      At the same time, it sends the control signal control_a to the output driver A to physically turn it off, and control_b to the output driver B to physically turn it off.
      <br/>
      See box 52. Normally, the drivers should turn off within a few nanoseconds.
      <br/>
      The output_status_a and output_status_b signals should be updated to reflect that the output drivers are turned off.
      <br/>
      This in turn causes the output_status signal to be updated.
      <br/>
      Note that these two signals are continuously reporting the output status of the drivers during all states, not only during this state.
      <br/>
      Then the state machine proceeds back to the Idle state (arrow 43).
    </p>
    <p num="157">
      In the case that an internal command is received from the RSP, it is validated to see if the command differs from the actual status of the drivers.
      <br/>
      If the following equation is true (=logic 1), (enable_a xor output_stat_a) or (enable_b xor output_stat_b), then a new order has been received and the state machine proceeds, arrow 33, to the Internal Command Received state to see in detail which driver to turn on or off.
    </p>
    <p num="158">
      In the Internal Command Received state, there are three possible scenarios.
      <br/>
      The first two scenarios are similar.
      <br/>
      Either wayside stream A or B should be turned off.
      <br/>
      In this case the state machine proceeds to Turn A off, arrow 32, if ENABLE_A is 0, or Turn B Off, arrow 35, if ENABLE_B is 0.
      <br/>
      If both are to be turned off, the state machine will loop a second time (go back to Idle, Internal Command Received and Turn A(B) Off) to turn the other one off.
      <br/>
      The order in which they are turned off is irrelevant.
    </p>
    <p num="159">In the Turn A Off state, the control_a signal is set to 0, box 53, to physically turn off output driver A. Normally, the output driver A is turned off and the output_status_a and output_status_b are updated.</p>
    <p num="160">The Turn B Off state is similar to the Turn A Off state, but for the B output driver.</p>
    <p num="161">
      The third scenario, where the command is to turn on either A or B or both, is more complex.
      <br/>
      Before turning on the local output drivers, the local SOA must be certain the mate SOA output drivers are no longer active, otherwise permanent electrical damage to the invention's equipment or to other equipment connected thereto may be incurred.
      <br/>
      To prevent damage, the state machine guarantees the drivers will never be turned on on the local SOA until the mate has turned off its drivers.
      <br/>
      So if ENABLE_A or ENABLE_B are set to 1 (either or both), the machine proceeds to the next state which is Initiate Prot.
      <br/>
      Switch.
    </p>
    <p num="162">
      In the Initiate Prot.
      <br/>
      Switch state, the disable_mate signal is sent to the mate SOA using the backplane traces xi.
      <br/>
      The mate SOA should receive this signal as the disable_outputs signal and since it runs the same state machine, it should enter the External Command Received state.
      <br/>
      But let's concentrate on the local SOA.
      <br/>
      At the same time the disable_mate signal is sent, a timer is started.
      <br/>
      The next state depends on how quickly the mate SOA turns its drivers off.
      <br/>
      If the mate SOA turns its drivers off before the timer expires (i.e. mate_output_status from the Yi line becomes a 0 before timeout becomes a 1), the switching activity can be completed and the machine transitions, arrow 36, to the Switch Succeeded state.
      <br/>
      Otherwise, if the timer expires (timeout goes to 1) then the switching activity fails.
      <br/>
      A transition, arrow 38, to the Switch Failed state occurs in this case.
    </p>
    <p num="163">
      In the Switch Succeeded state, the switching activity can be completed.
      <br/>
      The timer is stopped and cleared, the disable_mate signal can be set back to 0 to be ready for the next time and the local output driver control signals are set to be equal to the ENABLE_A and ENABLE_B control bits.
      <br/>
      See box 54. The machine proceeds, arrow 40, to the Idle state by default after this state.
    </p>
    <p num="164">
      In the Switch Failed state, the switching activity must be interrupted.
      <br/>
      A failure to switch and to turn on the local output drivers is reported to the RSP using the switch_fail signal.
      <br/>
      The timer is cleared and stopped.
      <br/>
      The disable_mate is cleared in preparation for possibly a next trial.
      <br/>
      See box 55. The local output drivers are not turned on.
      <br/>
      The machine proceeds, arrow 42, to the Idle state by default after this state.
    </p>
    <p num="165">Note that in the case where the mate SOA is not present, a pull-down resistor 17, 18 on the mate_status line will guarantee the switch will happen since the absence of the mate SOA is equivalent to having its drivers turned off.</p>
    <p num="166">
      FIG. 21 illustrates two radio channels, channels left and right, receiving the same data.
      <br/>
      This is a redundant configuration with path and equipment protection.
    </p>
    <p num="167">
      The following list explains the meaning of the abbreviations used in FIG. 21:
      <br/>
      OD: Output Drivers
      <br/>
      OS: Output Sensor
      <br/>
      OC: Output Control
      <br/>
      RX: Radio Receiver
      <br/>
      DEMUX: Demultiplexer extracting the two tributaries
      <br/>
      PSSM: Protection Switching State Machine
      <br/>
      DM: Disable Mate Signal (to Mate)
      <br/>
      OST: Output Status Signal (to Mate)
      <br/>
      EN: Enable Local Output Drivers
      <br/>
      data: data (payload).
      <br/>
      Contains the 2 tributaries
      <br/>
      LIU: Line Interface Unit
    </p>
    <p num="168">A software runs on both channels and monitors the quality of the data received by the SOA.</p>
    <p num="169">The two RSPs exchange the quality level of the data and control the two LIUs to always send to the customer the highest quality signal.</p>
    <p num="170">When the quality level of a channel becomes lower than the other channel, a protection switch is made to the higher quality channel, i.e. the output drivers on the low quality channel are opened and the output drivers (OD) on the higher quality channel are closed, and the customer receives the higher quality data signal.</p>
    <p num="171">
      The operation just described (open drivers on low quality channel and close drivers on higher quality channel) used to be under the control of the radio channel software (S/W).
      <br/>
      The S/W used to send the command to turn the drivers off on its local channel, wait for the output sensor to confirm this by polling the SOA, send a message on the FNet to the mate channel S/W.
      <br/>
      Then the mate channel RSP took over and sent a command to its SOA to close its drivers.
      <br/>
      At this point, the hardware switch from one SOA to the other was done.
      <br/>
      This whole process was, however, leaving the customer without data for several milliseconds (amount of time between opening the first drivers and closing the drivers on the other SOA).
    </p>
    <p num="172">
      To reduce this long delay, a hardware solution was necessary.
      <br/>
      A protection switching state machine was designed.
    </p>
    <p num="173">
      Its main feature is that once the system software has decided which channel has the higher quality, only ONE software operation is required to switch channel.
      <br/>
      No more polling or messaging on the FNET.
      <br/>
      The only command from S/W is sent to the SOA it wants to use, and the SOA will take care of turning OFF the other card before it turns on its own drivers.
    </p>
    <p num="174">
      Switching is handled by a state machine running in hardware thousands of times faster than when run in software.
      <br/>
      The state machine is described above in connection with FIG. 20.
    </p>
    <p num="175">FIG. 22 shows the interconnections of two SOA's.</p>
    <p num="176">
      Advantages of the Hardware Method Over the Software Controlled One
      <br/>
      Switching actually performed in nanoseconds instead of milliseconds.
    </p>
    <p num="177">Results in minimal hit duration for the customer.</p>
    <p num="178">
      At 2Mb/s --&gt; 1 ms=2000 bits are hit when SWITCHING in S/W
      <br/>
      1  MU s=2 bits are hit when SWITCHING in H/W
      <br/>
      500 ns=0.5  MU s=1 bit is hit when SWITCHING in H/W.
    </p>
    <p num="179">(The H/W examples assume a 20 MHz clock.)</p>
    <p num="180">
      Reduces by a factor of 20 the number of bit errors.
      <br/>
      When the state machine of FIG. 20 is used: switching is done in 3 clock cycles --&gt; i.e. 50 ns --&gt; less than one bit
    </p>
    <p num="181">
      The switching time is the time elapsed between the opening of the switch on channel A and the closing of the switch on channel B. During this short period of time, the data is not sent to the customer equipment.
      <br/>
      In this situation it can be said that the traffic is "hit", and the switching operation is qualified as non-hitless, as opposed to a "hitless" switching action that does not interrupt traffic.
    </p>
    <p num="182">
      Two factors contribute to the fact that the wayside protection switching is non-hitless: the switching time and the differential delays between adjacent radio channels.
      <br/>
      In the present case, the switching time has been reduced to less than one data bit, so the switching time is not causing traffic hits.
      <br/>
      However, there is no differential delay adjustment between two adjacent wayside radio paths, which might cause the protection switching operation to be non-hitless.
      <br/>
      Note that there is differential delay adjustment between radio sites in a SDH/SONET radio network, but not at the wayside traffic level.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>We claim:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>In a SONET/SDH radio communication network comprising a plurality of main radio communication terminals and a plurality of repeaters intermediate the communication terminals, with wayside communication paths being established between pairs of said repeaters via two radio channels carrying the same data, a method for determining whether to effect protection switching of a wayside path to the better of said two channels, comprising using different radio overhead bits to record, for each of a plurality n of wayside tributary paths, FEC (Forward Error Correction) and PEC (Parity Error Count) using t=f+p bits for each tributary path (f for FEC and p for PEC), subject to the following conditions:</claim-text>
      <claim-text>(1) at an ADD site, set to zero the entire t bits corresponding to the added tributary, (2) at a DROP or THRU site, accumulate the section FEC and PEC by adding the main traffic's section FEC and PEC to the FEC bits and the PEC bits corresponding to the wayside stream to be passed through or dropped, and (3) at any DROP site, compare the FEC and PEC corresponding to the tributary to be dropped with predetermined thresholds to determine whether protection switching is required.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. A method as claimed in claim 1, wherein, at a drop site, WPSF (Wayside Protection Signal Failure) and WPSD (Wayside Protection Signal Degradation) bits are set according to the following conditions: WPSF=1, if the FEC and/or PEC recorded by FEC bits and PEC bits for the dropped wayside tributary are above a predetermined signal failure threshold;</claim-text>
      <claim-text>- =0, if both of them are below the predetermined signal failure threshold; WPSD=1, if the FEC and/or PEC recorded by FEC bits and PEC bits for the dropped wayside tributary is above a predetermined signal degradation threshold; - =0, if both of them are below the predetermined signal degradation threshold;</claim-text>
      <claim-text>and wherein a wayside protection switching process is triggered when WPSF or WPSD is set to 1.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. In a SONET/SDH radio communication network comprising a plurality of main radio communication terminals and a plurality of repeaters intermediate the communication terminals, with wayside communication paths being established between pairs of said repeaters via two radio channels carrying the same data, a method for determining whether to effect protection switching of a wayside path to the better of said two channels, comprising making a switching decision by using one common wayside path to calculate FEC (Forward Error Correction) and PEC (Parity Error Count), switching being effected if FEC or PEC exceed predetermined thresholds, said common wayside path being defined as follows: (a)  SIGMA  wayside A path+ SIGMA  wayside B path - SIGMA  (wayside A .vertline..vertline.wayside B), if waysides A and B are overlapped (.vertline..vertline.indicates overlapped portions of the two parameters.) (b) wayside A path OR wayside B path, if waysides A and B are not overlapped.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. A method as claimed in claim 3 wherein, for one wayside tributary carried by the main traffic's overhead, the total bits in the radio overhead for recording wayside path FEC and PEC are:</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5.</claim-text>
      <claim-text>A method as claimed in claim 3, wherein, for n wayside tributaries carried by the main traffic's overhead, the total bits in the radio overhead for recording wayside path FEC and PEC are:</claim-text>
      <claim-text>eight bits being used for FEC accumulation, four bits for PEC accumulation, one bit to indicate the start of a path, two bits for a poor FEC flag and poor PEC flag to indicate the accumulated FEC and/or PEC value above the threshold at a certain point on the path and n bits to define stream ID's.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. A method as claimed in claim 5 wherein, at an ADD site at which all wayside streams are added into the main traffic overhead together, the start indicator bit is set to 1 to start a wayside path and all other of said bits are set to zero.</claim-text>
    </claim>
    <claim num="7">
      <claim-text>7. A method as claimed in claim 5 wherein wayside streams are added separately, the start indicator bit being set to 1 and all other bits to 0 at a first ADD site.</claim-text>
    </claim>
    <claim num="8">
      <claim-text>8. A method as claimed in claim 7 wherein, at following ADD sites, a check is made as to whether the accumulated FEC and accumulated PEC are above a threshold, no action being taken if they are not.</claim-text>
    </claim>
    <claim num="9">
      <claim-text>9. A method as claimed in claim 8 wherein, if the accumulated FEC and accumulated PEC are above a threshold the following actions are taken: 1. set Poor FEC and/or Poor PEC bit(s) to 1 depending on which one exceeds the threshold; 2. set Stream Indicator corresponding to the wayside stream(s) having poor FEC and/or poor PEC to 1; 3. set the FEC and/or PEC count bits which exceed the threshold to 0.</claim-text>
    </claim>
    <claim num="10">
      <claim-text>10. A method as claimed in claim 9 wherein, at a DROP site, the main traffic's section FEC and PEC are added to the FEC count bits and PEC count bits.</claim-text>
    </claim>
    <claim num="11">
      <claim-text>11. A method as claimed in claim 10 wherein, if the accumulated FEC and/or PEC are above the threshold(s), the poor FEC and/or poor PEC bits are set to 1 together with the stream indicator bits corresponding to the stream dropped at said DROP site.</claim-text>
    </claim>
    <claim num="12">
      <claim-text>12. A method as claimed in claim 11 wherein, if all wayside streams are dropped together, the start indicator bit is cleared, i.e. set to 0.</claim-text>
    </claim>
    <claim num="13">
      <claim-text>13. A method as claimed in claim 12 wherein, at sites other than ADD and DROP sites, the main traffic's section FEC and PEC are accumulated if the start indicator bit is set to 1, whereas no action is taken if the start indicator bit is set to 0.</claim-text>
    </claim>
    <claim num="14">
      <claim-text>14. A method as claimed in claim 13 wherein, at a DROP site, a wayside protection switching process is triggered if the poor FEC and/or poor PEC bit(s) are set to 1 AND the dropped wayside stream indicators) is set to 1.</claim-text>
    </claim>
    <claim num="15">
      <claim-text>15. In a SONET/SDH radio communication network comprising a plurality of main radio communication terminals and a plurality of repeaters intermediate the communication terminals, with wayside communication paths being established between pairs of said repeaters via two radio channels carrying the same data, a method for determining whether to effect protection switching of a wayside path to the better of said two channels, comprising: setting 2 bits (bit 1, bit 2) of a wayside path signal flag byte to 0 at an ADD site to indicate FEC (Forward Error Correction) and PEC (Parity Error Count) quality for each wayside tributary, 2 n bits being used in the case of n wayside tributaries;</claim-text>
      <claim-text>and setting at a THRU or DROP site the two bits for a particular wayside tributary to bit 1=0,bit 2=0 if the section FEC and PEC are below a switching threshold and the wayside path is normal;</claim-text>
      <claim-text>to bit 1=0,bit 2=1 if the section FEC and PEC are above a SF (Signal Failure) threshold;</claim-text>
      <claim-text>to bit 1=1,bit 2=0 if the section FEC and PEC are above a SD (Signal Degradation) threshold but below the SF threshold and the protection switching threshold is set to SF;</claim-text>
      <claim-text>and to bit 1=1 , bit 2=1 if the section FEC and PEC are above the SD threshold but below the SF threshold and the protection switching threshold is set to SD.</claim-text>
    </claim>
    <claim num="16">
      <claim-text>16. A method as claimed in claim 15 wherein, for a particular wayside tributary, WPSP (Wayside Protection Signal Failure) and WPSD (Wayside Protection Signal Degradation) bits are set at a DROP site according to the following conditions: WPSF=1, if flag bits of the dropped wayside stream are: - 0, if otherwise, WPSD=1, if flag bits of the dropped wayside stream are: - 0, if otherwise.</claim-text>
    </claim>
    <claim num="17">
      <claim-text>17. A method as claimed in claim 16, wherein a wayside protection switching process is triggered when WPSF or WPSD is set to 1.</claim-text>
    </claim>
    <claim num="18">
      <claim-text>18. In a SONET/SDH radio communication network comprising a plurality of main radio communication terminals and a plurality of repeaters intermediate the communication terminals, with wayside communication paths being established between pairs of said repeaters via two radio channels carrying the same data, a system for protection switching of said wayside paths, comprising, for each repeater, duplicated software and hardware on first and second service overhead access (SOA) units, said software determining if protection switching is required and signalling said hardware to effect protection switching, said switching being effected in a "break before make" manner as follows: (1) the software enables ENABLE bits on a first SOA, which results in the hardware sending a signal to disable both ENABLE bits on the second SOA, (2) the output drivers of the second SOA are turned off based on the ENABLE bits control after which their status is fed back to the first SOA, (3) the output drivers of the first SOA are switched on based on its own ENABLE.</claim-text>
    </claim>
    <claim num="19">
      <claim-text>19. A system as claimed in claim 18, wherein said steps (1), (2) and (3) have a duration which is less than the duration of a wayside data bit.</claim-text>
    </claim>
    <claim num="20">
      <claim-text>20. A system as claimed in claim 18, wherein said hardware on each SOA unit includes means for receiving control signals and data bits from said software, an enable input and output for each of said two radio channels, a mate output status input and output, and two outputs indicating the status of each of its own two channels, said hardware also comprising a handshake unit including a state machine which receives the mate output status and said two outputs indicating the status of its own two channels and outputs for setting both enable inputs on the mate SOA and means for closing its own output drivers.</claim-text>
    </claim>
    <claim num="21">
      <claim-text>21. A method as claimed in claim 1, wherein the f bits for FEC and the p bits for PEC are 8 and 4 respectively.</claim-text>
    </claim>
    <claim num="22">
      <claim-text>22. A drop site repeater arranged to be implemented within a radio communication network comprising a plurality of main radio communication terminals and a plurality of repeaters intermediate the communication terminals, with at least one wayside communication path being established between an add site repeater and said drop site repeater via two radio channels carrying the same data, the drop site repeater determining whether to effect protection switching of a wayside path to the better of said two channels by operating to: accumulate section FEC (Forward Error Correction) and PEC (Parity Error Count) by adding the main traffic's section FEC and PEC to the FEC bits and the PEC bits corresponding to the wayside stream to be dropped;</claim-text>
      <claim-text>and compare the FEC and PEC corresponding to the tributary to be dropped with predetermined thresholds to determine whether protection switching is required.</claim-text>
    </claim>
    <claim num="23">
      <claim-text>23. A drop site repeater as claimed in claim 22 further operating to set WPSF (Wayside Protection Signal Failure) and WPSD (Wayside Protection Signal Degradation) bits according to the following conditions: WPSF=1, if the FEC and/or PEC recorded by FEC bits and PEC bits for the dropped wayside tributary are above a predetermined signal failure threshold; - =0, if both of them are below the predetermined signal failure threshold; WPSD =1, if the FEC and/or PEC recorded by FEC bits and PEC bits for the dropped wayside tributary is above a predetermined signal degradation threshold; - =0, if both of them are below the predetermined signal degradation threshold;</claim-text>
      <claim-text>and wherein a wayside protection switching process is triggered when WPSF or WPSD is set to 1.</claim-text>
    </claim>
    <claim num="24">
      <claim-text>24. A drop site repeater arranged to be implemented within a radio communication network comprising a plurality of main radio communication terminals and a plurality of repeaters intermediate the communication terminals, with at least one wayside communication path being established between a pair of an add site repeater and said drop site repeater via two radio channels carrying the same data, said add site repeater setting 2 bits (bit 1, bit 2) of a wayside path signal flag byte to 0 to indicate FEC (Forward Error Correction) and PEC (Parity Error Count) quality for the wayside tributary, the drop site repeater determining whether to effect protection switching of a wayside path to the better of said two channels by operating to: set the two bits for the wayside tributary to bit 1=0,bit 2=0 if the section FEC and PEC are below a switching threshold and the wayside path is normal; set the two bits for the wayside tributary to bit 1=0,bit 2=1 if the section FEC and PEC are above a SF (Signal Failure) threshold; set the two bits for the wayside tributary to bit 1=1,bit 2=0 if the section FEC and PEC are above a SD (Signal Degradation) threshold but below the SF threshold and the protection switching threshold is set to SF;</claim-text>
      <claim-text>and set the two bits for the wayside tributary to bit 1=1,bit 2=1 if the section FEC and PEC are above the SD threshold but below the SF threshold and the protection switching threshold is set to SD.</claim-text>
    </claim>
    <claim num="25">
      <claim-text>25. A drop site repeater as claimed in claim 24 further operating to set WPSP (Wayside Protection Signal Failure) and WPSD (Wayside Protection Signal Degradation) bits according to the following conditions: WPSF=1, if flag bits of the dropped wayside stream are: - 0, if otherwise, WPSD=1, if flag bits of the dropped wayside stream are: - 0, if otherwise;</claim-text>
      <claim-text>and wherein the drop site repeater triggers a wayside protection switching process when WPSF or WPSD is set to 1.</claim-text>
    </claim>
  </claims>
</questel-patent-document>