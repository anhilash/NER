<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06188778B1.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as first publication">
      <document-id>
        <country>US</country>
        <doc-number>06188778</doc-number>
        <kind>B1</kind>
        <date>20010213</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6188778</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B1</original-publication-kind>
    <application-reference is-representative="YES" family-id="26810594" extended-family-id="74160950">
      <document-id>
        <country>US</country>
        <doc-number>09466215</doc-number>
        <kind>A</kind>
        <date>19991217</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1999US-09466215</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>68289517</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>46621599</doc-number>
        <kind>A</kind>
        <date>19991217</date>
        <priority-active-indicator>N</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1999US-09466215</doc-number>
      </priority-claim>
      <priority-claim kind="international" sequence="2">
        <country>WO</country>
        <doc-number>JP9700020</doc-number>
        <kind>A</kind>
        <date>19970109</date>
        <priority-linkage-type>W</priority-linkage-type>
        <priority-active-indicator>N</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="2">
        <doc-number>1997WO-JP00020</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="3">
        <country>US</country>
        <doc-number>26598099</doc-number>
        <kind>A</kind>
        <date>19990311</date>
        <priority-linkage-type>3</priority-linkage-type>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="3">
        <doc-number>1999US-09265980</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="4">
        <country>US</country>
        <doc-number>11298998</doc-number>
        <kind>A</kind>
        <date>19980710</date>
        <priority-linkage-type>3</priority-linkage-type>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="4">
        <doc-number>1998US-09112989</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010213</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>G08G   1/04        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>08</class>
        <subclass>G</subclass>
        <main-group>1</main-group>
        <subgroup>04</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>382104000</text>
        <class>382</class>
        <subclass>104000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>340934000</text>
        <class>340</class>
        <subclass>934000</subclass>
      </further-classification>
      <further-classification sequence="2">
        <text>348149000</text>
        <class>348</class>
        <subclass>149000</subclass>
      </further-classification>
      <further-classification sequence="3">
        <text>382274000</text>
        <class>382</class>
        <subclass>274000</subclass>
      </further-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>G08G-001/04</text>
        <section>G</section>
        <class>08</class>
        <subclass>G</subclass>
        <main-group>1</main-group>
        <subgroup>04</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G08G-001/04</classification-symbol>
        <section>G</section>
        <class>08</class>
        <subclass>G</subclass>
        <main-group>1</main-group>
        <subgroup>04</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>1</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>44</number-of-drawing-sheets>
      <number-of-figures>49</number-of-figures>
      <image-key data-format="questel">US6188778</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Traffic congestion measuring method and apparatus and image processing method and apparatus</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>MAYEAUX PAUL H, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5161107</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5161107</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>KUDOH KATSUHIRO</text>
          <document-id>
            <country>US</country>
            <doc-number>5243663</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5243663</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>RATHI RAJENDRA P</text>
          <document-id>
            <country>US</country>
            <doc-number>5296852</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5296852</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>BRADY MARK J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5684898</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5684898</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="5">
          <text>OLESEN LYKKE</text>
          <document-id>
            <country>US</country>
            <doc-number>4214265</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4214265</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="6">
          <text>MICHALOPOULOS PANOS G, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4847772</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4847772</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="7">
          <text>TOYAMA MASAKAZU, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5301239</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5301239</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="8">
          <text>AOKI MASANORI</text>
          <document-id>
            <country>US</country>
            <doc-number>5402118</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5402118</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="9">
          <text>TOYAMA MASAKAZU, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5509082</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5509082</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="10">
          <text>ASADA KAZUYOSHI</text>
          <document-id>
            <country>US</country>
            <doc-number>5554983</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5554983</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="11">
          <text>TOYAMA MASAKAZU</text>
          <document-id>
            <country>US</country>
            <doc-number>5590217</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5590217</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="12">
          <text>UNIV LONDON</text>
          <document-id>
            <country>EP</country>
            <doc-number>0403193</doc-number>
            <kind>A2</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>EP-403193</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="13">
          <text>OMRON TATEISI ELECTRONICS CO</text>
          <document-id>
            <country>JP</country>
            <doc-number>S5636799</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP56036799</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="14">
          <text>NEC CORP</text>
          <document-id>
            <country>JP</country>
            <doc-number>H02284297</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP02284297</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="15">
          <text>MATSUSHITA ELECTRIC IND CO LTD</text>
          <document-id>
            <country>JP</country>
            <doc-number>H04123199</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP04123199</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="16">
          <text>HITACHI LTD</text>
          <document-id>
            <country>JP</country>
            <doc-number>H0540896</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP05040896</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="17">
          <text>OMRON TATEISI ELECTRONICS CO</text>
          <document-id>
            <country>JP</country>
            <doc-number>H0554294</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP05054294</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="18">
          <text>HITACHI LTD, et al</text>
          <document-id>
            <country>JP</country>
            <doc-number>H064795</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP06004795</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="1">
          <text>English translation of International Preliminary Examination Report from WIPO.</text>
        </nplcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="2">
          <text>Rourke et al., "Road Traffic Monitoring Using Image Processing", 3rd Int. Conf. on Road Traffic Control, 1990, pp. 163-167.</text>
        </nplcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="3">
          <text>Gloyer et al., "Vehicle Detection and Tracking for Freeway Traffic Monitoring", IEEE Conf. Record of the 28th Asilomar Conf. on Signals, Systems &amp; Computers, Oct. 31-Nov. 21, 1994, pp. 970-974.</text>
        </nplcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="4">
          <text>Siyal et al., "Real-Time Image Measurement of Traffic Queue Parameters by Using Image Processing Techniques", Image Processing and its Applications, Jul. 4-6, 1995, pp. 450-454.</text>
        </nplcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="5">
          <text>Fathy et al., "Real-Time Image Processing Approach to Measure Traffic Queue Parameters", IEE Proc.-Vis. Image Signal Process., vol. 142, No. 5, Oct. 1995, pp. 297-303.</text>
        </nplcit>
      </citation>
    </references-cited>
    <related-documents>
      <division>
        <relation>
          <parent-doc>
            <document-id>
              <country>US</country>
              <doc-number>26598099</doc-number>
              <kind>A</kind>
              <date>19990311</date>
            </document-id>
          </parent-doc>
        </relation>
        <relation>
          <parent-doc>
            <document-id>
              <country>US</country>
              <doc-number>11298998</doc-number>
              <kind>A</kind>
              <date>19980710</date>
            </document-id>
          </parent-doc>
        </relation>
        <relation>
          <parent-doc>
            <document-id>
              <country>US</country>
              <doc-number>6075874</doc-number>
              <kind>A</kind>
            </document-id>
          </parent-doc>
        </relation>
        <relation>
          <parent-doc>
            <document-id>
              <country>US</country>
              <doc-number>5999635</doc-number>
              <kind>A</kind>
            </document-id>
          </parent-doc>
        </relation>
      </division>
      <continuation>
        <relation>
          <parent-doc>
            <document-id>
              <country>WO</country>
              <doc-number>PCT/JP97/00020</doc-number>
              <date>19970109</date>
            </document-id>
          </parent-doc>
        </relation>
      </continuation>
    </related-documents>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Sumitomo Electric Industries, Ltd.</orgname>
            <address>
              <address-1>Osaka, JP</address-1>
              <city>Osaka</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>SUMITOMO ELECTRIC INDUSTRIES</orgname>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Higashikubo, Masakatsu</name>
            <address>
              <address-1>Osaka, JP</address-1>
              <city>Osaka</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="2">
          <addressbook lang="en">
            <name>Ito, Yoshiyuki</name>
            <address>
              <address-1>Osaka, JP</address-1>
              <city>Osaka</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <orgname>Pillsbury Madison &amp; Sutro LLP</orgname>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Johns, Andrew W.</name>
      </primary-examiner>
    </examiners>
    <pct-or-regional-filing-data>
      <document-id>
        <country>WO</country>
        <doc-number>JP9700020</doc-number>
        <date>19970109</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1997WO-JP00020</doc-number>
      </document-id>
    </pct-or-regional-filing-data>
    <pct-or-regional-publishing-data>
      <document-id>
        <country>WO</country>
        <doc-number>9725700</doc-number>
        <kind>A1</kind>
        <date>19970717</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>WO9725700</doc-number>
      </document-id>
    </pct-or-regional-publishing-data>
    <lgst-data>
      <lgst-status>LAPSED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      The present invention measures traffic congestion by utilizing a video camera to capture images of vehicles travelling on a road and analyzing sample points that are assigned to different aspects of the images.
      <br/>
      For example, presence and movement sample points correspond to the expected location and motion of the vehicles respectively.
      <br/>
      The sample points adjacent to one another from either movement or congestion blocks.
      <br/>
      The blocks that have a ratio of movement sample points to all other sample points within the block greater than a predetermined level are moveable blocks.
      <br/>
      The remaining presence sample points in the image signify congestion sample points and form congestion blocks.
      <br/>
      Congestion blocks have a ratio of congestion sample points to all other sample points within the block greater than a predetermined level.
      <br/>
      Therefore, the state of traffic congestion is measured based upon the resultant movement and congestion blocks.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <p num="1">
      This is a division of application Ser.
      <br/>
      No. 09/265,980, filed Mar. 11, 1999, now U.S. Pat. No. 6,075,874, which is a Div. of appln.
      <br/>
      Ser. No. 09/112,989, filed Jul. 10, 1998, now U.S. Pat. No. 5,999,635, which is a Con't of Appln.
      <br/>
      No. PCT/JP97/0020.
    </p>
    <heading>FIELD OF THE INVENTION</heading>
    <p num="2">
      The present invention relates to method and apparatus for measuring a state of traffic congestion on a road on the basis of brightness levels of sample points which are set in a motion picture representing the road and vehicles coming and going on the road.
      <br/>
      The present invention also relates to image processing method and apparatus for setting sample points in an image and processing the image.
    </p>
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="3">
      There are a wide variety of systems for measuring a state of traffic congestion for the purpose of smoothing traffic on roads.
      <br/>
      Such traffic congestion measuring systems include two well known measuring systems, one of the two measuring systems being of a supersonic type and the other of the two measuring systems being of a loop-coil type.
      <br/>
      The supersonic type of traffic congestion measuring system adopts a supersonic sensor as means for sensing the presence and movement of vehicles, while the loop-coil type of traffic congestion measuring system adopts a loop-coil as means for sensing the presence and the movement of the vehicles.
    </p>
    <p num="4">
      The supersonic type of traffic congestion measuring system uses the supersonic sensor, which is positioned above the road at a predetermined height, to detect the presence and velocity of a passing vehicle.
      <br/>
      Based on results of the detection by the supersonic sensor, the state of traffic congestion is measured.
      <br/>
      On the other hand, the loop-coil type of traffic congestion measuring system uses the loop-coil, which is buried under the road, to detect the presence and the velocity of the vehicle passing above the loop-coil on the basis of the variation in magnetism above the loop-coil caused by the passing vehicle.
      <br/>
      Based on results of the detection by the loop-coil, the state of traffic congestion is measured.
    </p>
    <p num="5">
      In the supersonic sensor type and loop-coil type of traffic congestion measuring systems thus designed, the supersonic sensor and the loop-coil are merely operated to obtain information of only the vehicles lying directly under the supersonic sensor and directly above the loop-coil, respectively.
      <br/>
      In point of fact, the supersonic sensor type and the loop-coil type of traffic congestion measuring systems are merely operated to indirectly measure the state of traffic congestion on the basis of the number of the passing vehicles during a certain period or the velocities of sampled vehicles corresponding to extremely small part of the vehicles passing over the supersonic sensor and the loop-coil, respectively.
      <br/>
      For this reason, the supersonic sensor and the loop-coil of traffic congestion measuring systems have difficulty in automatically measuring, in real time, traffic congestion ranges with high accuracy.
      <br/>
      For instance, if the supersonic sensor type and loop-coil type of traffic congestion measuring systems are adopted for the purpose of controlling traffic signals in accordance with the length of a traffic queue extending from an intersection, a drawback is encountered in that the supersonic sensor type and loop-coil type of traffic congestion measuring systems have difficulty in controlling the traffic signals so as to quickly relieve the traffic congestion.
    </p>
    <p num="6">
      There are also two traffic congestion measuring systems adopting video cameras, which are superior to the supersonic sensor type and loop-coil type of traffic congestion measuring systems in that the state of traffic congestion is measured in real time with high accuracy.
      <br/>
      One of the traffic congestion measuring systems is disclosed in "INPACTS: A New TV Image Processing System for Monitoring Traffic Conditions," by Wootton Jeffreys CONSULTANTS or European Patent publication No. 0403193. In the disclosed measuring system, an image of a road taken by a video camera is divided into a plurality of blocks for each traffic lane.
      <br/>
      The size of each block is roughly equal in length to each of the vehicles represented in the image.
      <br/>
      By processing the image, the blocks are classified into three different block groups.
      <br/>
      The first block group includes blocks in which no vehicle is detected.
      <br/>
      The second block group includes blocks in which a moving vehicle is detected.
      <br/>
      The third block group includes blocks in which a stationary vehicle is detected.
      <br/>
      According to the arrangement of the three different type blocks, the state of traffic congestion is measured indicating, for instance, conditions substantially stationary, slowly moving, and smoothly moving.
    </p>
    <p num="7">
      Other traffic congestion measuring systems are disclosed in Kitamura et al., "Traffic Congestion Measuring System Using Image Processing", Annual Conference sponsored by The Institute of Electrical Engineers of Japan, Industry Application Society, 1991.
      <br/>
      The traffic congestion measuring system operates in a manner which comprising the steps of abstracting three different feature values representative of the density of vehicles, the movement quantities of vehicles and the brightness of a road surface, respectively, from images taken by video camera, inputting the feature values into an input layer partially forming a neural network, calculating an output value stepwise varied between "0" and "1" by 0.2, and detecting, on the basis of the output value, the state of traffic congestion.
      <br/>
      The state of traffic congestion is any of five different conditions; a first condition that there is no traffic, a second condition that the vehicles are smoothly moving, a third condition that the vehicles are moving but crowded, a fourth condition that there is produced a slight traffic congestion, and fifth condition that there is produced a serious traffic congestion.
    </p>
    <p num="8">
      The conventional traffic congestion measuring systems using the video camera, however, also encounter drawbacks.
      <br/>
      In the former traffic congestion measuring system adopting the video camera, a correlation of the arrangement pattern of the blocks classified into three types and the state of traffic congestion in each of measurement points is required to be previously learned.
      <br/>
      In addition, the former traffic congestion measuring system must perform a process of dividing each of the traffic lanes into the blocks.
      <br/>
      For this reason, the traffic congestion occurring over two or more traffic lanes cannot be detected and, as a result, the state of traffic congestion cannot be measured with accuracy.
      <br/>
      Furthermore, the size of the vehicle represented in the image becomes smaller as a distance from the video camera to the vehicle becomes larger.
      <br/>
      The block size is, therefore, adjusted with difficulty to the size of vehicle spaced apart from the video camera at a long distance.
      <br/>
      Consequently, the former traffic congestion measuring system adopting the video camera cannot measure the state of traffic congestion over a long distance.
    </p>
    <p num="9">
      In the traffic congestion measuring system adopting the video camera, the traffic congestion measuring system is limited in forming the neural network based on a large amount of data for the sake of learning.
      <br/>
      The process of forming the neural network takes much time and labor and is a difficult task.
      <br/>
      In addition, the neural network must be re-formed whenever road circumstances are changed.
      <br/>
      Furthermore, the whole image is processed in the lump in order to measure the state of traffic congestion, so that detailed traffic information for each part of the image cannot be detected.
      <br/>
      The detailed traffic information includes, for instance, information pertain to traffic queue length expressed as "there is a traffic congestion of y meter length extending from point X1 to point X2 on the road".
    </p>
    <p num="10">
      The above traffic congestion measuring systems which use the video cameras encounter the foregoing drawbacks and, for this reason, are put to practical use with difficulty.
      <br/>
      In the view of the foregoing surroundings, the present invention is made and has an objective of providing a traffic congestion measuring method and apparatus capable of reducing the previous learning, detecting the traffic congestion traversing two or more traffic lanes, stably measuring the state of traffic congestion independently of the changes in circumstances such as changes of measurement points and periods, weather and traffic quantity, and detecting the traffic queue length.
    </p>
    <p num="11">The present invention has another objective of providing a traffic congestion measuring method and apparatus capable of accurately measuring the state of traffic congestion produced by a group of vehicles which are moving at a speed lower than 20 km/h, and also suitable for measurement in a highway or an expressway, in addition to the foregoing capabilities of the method and apparatus provided for the purpose of attaining the first object of the present invention.</p>
    <p num="12">The present invention has a further objective of providing an image processing method and apparatus that utilize processing techniques adopted by the foregoing traffic congestion measuring method and apparatus provided for the purpose of attaining the first object of the present invention.</p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="13">
      A first aspect of the present invention describes a traffic congestion measuring method of measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles travelling on the road.
      <br/>
      The motion picture is formed by a series of images taken by a video camera.
      <br/>
      The traffic congestion measuring method comprises setting a plurality of sample points in the motion picture, each of the sample points having a brightness level; detecting, as presence sample points, the sample points which are situated in one of the series of images taken at a predetermined time and at each of which the vehicle is expected to be present; detecting, as movement sample points, the sample points which are situated in the image taken at the predetermined time and at each of which the vehicle in motion is expected to be present; detecting movement blocks each formed by part of the sample points adjacent to one another and including part of the movement sample points, a ratio of the movement sample points to all of the sample points contained in each movement block being larger than a predetermined level; detecting, as congestion sample points, the presence sample points excluded from the movement blocks; detecting congestion blocks each formed by part of the sample points adjacent to one another and including part of the congestion sample points, a ratio of the congestion sample points to all of the sample points contained in each congestion block being larger than a predetermined level; and measuring the state of traffic congestion on the road at the predetermined time on the basis of the congestion blocks.
    </p>
    <p num="14">
      A second aspect of the present invention describes a traffic congestion measuring apparatus for measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles travelling on the road.
      <br/>
      The motion picture is formed by a series of images taken by a video camera.
      <br/>
      The traffic congestion measuring apparatus comprises first means for setting a plurality of sample points in the motion picture, each of the sample points having a brightness level, second means for detecting, as presence sample points, the sample points which are situated in one of the series of images taken at a predetermined time and at each of which the vehicle is expected to be present, third means for detecting, as movement sample points, the sample points which are situated in the image taken at the predetermined time and at each of which the vehicle in motion is expected to be present, fourth means for detecting movement blocks each formed by part of the sample points adjacent to one another and including part of the movement sample points, a ratio of the movement sample points to all of the sample points contained in each movement block being larger than a predetermined level, fifth means for detecting, as congestion sample points, the presence sample points excluded from the movement blocks, sixth means for detecting congestion blocks each formed by part of the sample points adjacent to one another and including part of the congestion sample points, a ratio of the congestion sample points to all of the sample points contained in each congestion block being larger than a predetermined level, and seventh means for measuring the state of traffic congestion on the road at the predetermined time on the basis of the congestion blocks.
    </p>
    <p num="15">
      A third aspect of the present invention describes a traffic congestion measuring method of measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles travelling on the road.
      <br/>
      The motion picture is formed by a series of images taken by a video camera.
      <br/>
      The traffic congestion measuring method comprises the steps (a) setting a plurality of sample lines in the motion picture, each of the sample lines being formed by a plurality of sample points aligned on a line perpendicular to a direction in which the road extends, and each of the sample points having a brightness level, (b) forming a criterion brightness image, in which no vehicle is expected to be present, taken by the video camera, (c) calculating a difference image indicative of a difference in brightness between one of the series of images taken at a predetermined time and the criterion brightness image by calculating brightness difference values each indicative of a difference in brightness between each of the sample points in the image taken at the predetermined time and each of the sample points in the criterion brightness image corresponding in position to each other, (d) detecting, as difference sample lines, the sample lines which are situated in the image taken at the predetermined time and each of which has a brightness level having a difference larger than a predetermined level from each of the sample lines in the criterion brightness image, on the basis of the brightness difference values of the sample points in the difference image, (e) spatially differentiating the difference image to calculate differentiation values respectively belonging to the sample points in the difference image, (f) detecting, as edge sample lines, the sample lines which are situated in the image taken at the predetermined time and each of which has a brightness level having a difference larger than a predetermined level from one of two sample lines in the direct neighborhood of each of the sample lines, on the basis of the differentiation values of the sample points in the spatially differentiated difference image, (g) detecting, as presence sample lines on each of which the vehicle is expected to be present, the difference sample lines detected in the step (d) and the edge sample lines detected in the step (f), and (h) measuring the state of traffic congestion on the basis of the presence sample lines.
    </p>
    <p num="16">
      A fourth aspect of the present invention describes a traffic congestion measuring method of measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles travelling on the road.
      <br/>
      The motion picture is formed by a series of images taken by a video camera.
      <br/>
      The traffic congestion measuring method comprises (a) setting a plurality of sample lines in the motion picture, each of the sample lines being formed by a plurality of sample points aligned on a line perpendicular to a direction in which the road extends, and each of the sample points having a brightness level, (b) detecting, as presence sample lines, the sample lines, on each of which the vehicle is expected to be present, on the basis of the brightness levels of the sample points on one of the series of images taken at a predetermined time, (c) estimating shadow areas including shadows of the vehicles represented in the image taken at the predetermined time, (d) correcting the presence sample lines on the basis of the shadow areas, and (e) measuring the state of traffic congestion on the basis of the presence sample lines corrected in the step (d).
    </p>
    <p num="17">
      A fifth aspect of the present invention describes a traffic congestion measuring method of measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles travelling on the road.
      <br/>
      The motion picture is formed by a series of images taken by a video camera.
      <br/>
      The traffic congestion measuring method comprises (a) setting a plurality of sample lines in the motion picture, each of the sample lines being formed by a plurality of sample points aligned on a line perpendicular to a direction in which the road extends, and each of the sample points having a brightness level, (b) detecting, as movement sample lines, the sample lines on each of which the vehicle in motion is expected to be present, and (c) measuring the state of traffic congestion on the basis of the movement sample lines.
    </p>
    <p num="18">
      A sixth aspect of the present invention describes a traffic congestion measuring method of measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles travelling on the road.
      <br/>
      The motion picture is formed by a series of images taken by a video camera.
      <br/>
      The traffic congestion measuring method comprises (a) setting a plurality of sample lines in the motion picture, each of the sample lines being formed by a plurality of sample points aligned on a line perpendicular to a direction in which the road extends, and each of the sample points having a brightness level, (b) detecting, as presence sample lines, the sample lines on each of which the vehicle is expected to be present on the basis of the brightness levels of the sample points in one of the series of images taken at a predetermined time, (c) calculating a density of the vehicles lying on the road at the predetermined time on the basis of the presence sample lines, (d) estimating a large-sized vehicle ratio indicative of a ratio of large-sized vehicles larger than a predetermined vehicle size to all of the vehicles represented in the image taken at the predetermined time, (e) correcting the density of the vehicles on the basis of the large-sized vehicle ratio estimated in the step (d), and (f) measuring the state of traffic congestion on the basis of the density of the vehicles corrected in the step (e).
    </p>
    <p num="19">
      A seventh aspect of the present invention describes a traffic congestion measuring method of measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles travelling on the road.
      <br/>
      The motion picture is formed by a series of images taken by a video camera.
      <br/>
      The traffic congestion measuring method comprises the steps (a) setting a plurality of sample lines in the motion picture, each of the sample lines being formed by a plurality of sample points aligned on a line perpendicular to a direction in which the road extends, and each of the sample points having a brightness level, (b) calculating mean brightness levels each indicative of a mean of brightness levels of the sample points situated on each of the sample lines in the image taken at time t, (c) calculating mean brightness levels each indicative of a mean of brightness levels of the sample points contained in each of the sample lines in the image taken at time t+ GAMMA ,  GAMMA  being a positive time interval, (d) detecting, as movement sample lines, the sample lines which are included in the image taken at the time t and in each of which the vehicle in motion is expected to be present, (e) detecting, as prospective post-movement sample lines, the sample lines which are included in the image taken at the time t+ GAMMA  and to each of which each of the movement sample lines in the image taken at the time t is expected to be transferred, (f) calculating line velocities each indicative of a velocity of the movement sample line based on the positive time interval  GAMMA  and an actual route distance between two locations on the road respectively corresponding to each of the movement sample lines and each of the post-movement sample lines, and (g) measuring the state of traffic congestion on the road on the basis of the line velocities of the movement sample lines calculated in the step (f).
    </p>
    <p num="20">
      An eighth aspect of the present invention describes a traffic congestion measuring method of measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles travelling on the road.
      <br/>
      The motion picture is formed by a series of images taken by a video camera.
      <br/>
      The traffic congestion measuring method comprises the steps (a) forming a criterion brightness image which is taken by the video camera and in which the vehicle is expected to be absent, (b) detecting the vehicles represented in one of the series of images taken at a predetermined time on the basis of the criterion brightness image and the image taken at the predetermined time, (c) renewing the criterion brightness image after the step (b), and (d) repeating the steps (b) and (c) at predetermined regular intervals, the criterion brightness image being renewed in the step (c) by an equation described as follows:
      <br/>
      Bn+1 =Bn + ETA  * (Xn -Bn)
    </p>
    <p num="21">wherein Xn is a brightness level of each of picture elements forming the image taken at time tn, Bn is a brightness level of each of picture elements forming the criterion brightness image which is utilized for detecting the vehicles represented in the image taken at the time tn, Bn+1 is a brightness level of each of picture elements forming the criterion brightness image which is utilized for detecting the vehicles represented in the image taken at time tn+1, each of the predetermined regular intervals is equal to tn+1 -tn, and  ETA  is a variable coefficient decreased in proportion as .vertline.xn -Bn.vertline. becomes large and as a level of the traffic congestion on the road is increased.</p>
    <p num="22">
      A ninth aspect of the present invention describes a traffic congestion measuring method of measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles travelling on the road.
      <br/>
      The motion picture is formed by a series of images taken by a video camera.
      <br/>
      The traffic congestion measuring method comprises calculating spatial velocities each indicative of a mean of velocities of the vehicles represented in each of mesh sections into which the road represented in image taken at a predetermined time is divided, detecting, on the basis of the spatial velocities, a traffic congestion range occupied by the mesh sections in each of which the traffic congestion occurs, and detecting a tail position of the traffic congestion range.
    </p>
    <p num="23">
      A tenth aspect of the present invention describes a traffic congestion measuring apparatus for measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles travelling on the road.
      <br/>
      The motion picture is formed by a series of images taken by a video camera.
      <br/>
      The traffic congestion measuring apparatus comprises means for setting a plurality of sample lines in the motion picture, each of the sample lines being formed by a plurality of sample points aligned on a line perpendicular to a direction in which the road extends, and each of the sample points having a brightness level, means for forming a criterion brightness image, in which no vehicle is expected to be present, taken by the video camera, means for calculating a difference image indicative of a difference in brightness between one of the series of images taken at a predetermined time and the criterion brightness image by calculating brightness difference values each indicative of a difference in brightness between each of the sample points in the image taken at the predetermined time and each of the sample points in the criterion brightness image corresponding in position to each other, means for detecting, as difference sample lines, the sample lines which are situated in the image taken at the predetermined time and each of which has a brightness level having a difference larger than a predetermined level from each of the sample lines in the criterion brightness image, on the basis of the brightness difference values of the sample points in the difference image, means for spatially differentiating the difference image to calculate differentiation values respectively belonging to the sample points in the difference image, means for detecting, as edge sample lines, the sample lines which are situated in the image taken at the predetermined time and each of which has a brightness level having a difference larger than a predetermined level from one of two sample lines in the direct neighborhood of each of the sample lines, on the basis of the differentiation values of the sample points in the spatially differentiated difference image, means for detecting, as presence sample lines on each of which the vehicle is expected to be present, the difference sample lines and the edge sample lines, and means for measuring the state of traffic congestion on the basis of the presence sample lines.
    </p>
    <p num="24">
      An eleventh aspect of the present invention describes a traffic congestion measuring apparatus for measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles travelling on the road.
      <br/>
      The motion picture is formed by a series of images taken by a video camera.
      <br/>
      The traffic congestion measuring apparatus comprises means for setting a plurality of sample lines in the motion picture, each of the sample lines being formed by a plurality of sample points aligned on a line perpendicular to a direction in which the road extends, and each of the sample points having a brightness level, mean for detecting, as movement sample lines, the sample lines on each of which the vehicle in motion is expected to be present in the image taken at a predetermined time, and means for measuring the state of traffic congestion on the basis of the movement sample lines.
    </p>
    <p num="25">
      A twelfth aspect of the present invention describes a traffic congestion measuring apparatus for measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles travelling on the road.
      <br/>
      The motion picture is formed by a series of images taken by a video camera.
      <br/>
      The traffic congestion measuring apparatus comprises means for setting a plurality of sample lines in the motion picture, each of the sample lines being formed by a plurality of sample points aligned on a line perpendicular to a direction in which the road extends, and each of the sample points having a brightness level, means for detecting, as presence sample lines, the sample lines on each of which the vehicle is expected to be present on the basis of the brightness levels of the sample points in one of the series of images taken at a predetermined time, means for calculating a density of the vehicles lying on the road at the predetermined time on the basis of the presence sample lines, means for estimating a large-sized vehicle ratio indicative of a ratio of large-sized vehicles larger than a predetermined vehicle size to all of the vehicles represented in the image taken at the predetermined time, and means for correcting the density of the vehicles on the basis of the large-sized vehicle ratio.
    </p>
    <p num="26">
      A thirteenth aspect of the present invention describes a traffic congestion measuring apparatus for measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles travelling on the road.
      <br/>
      The motion picture is formed by a series of images taken by a video camera.
      <br/>
      The traffic congestion measuring apparatus comprises means for setting a plurality of sample lines in the motion picture, each of the sample lines being formed by a plurality of sample points aligned on a line perpendicular to a direction in which the road extends, and each of the sample points having a brightness level, means for calculating mean brightness levels each indicative of a mean of brightness levels of the sample points situated on each of the sample lines in the image taken at time t, means for calculating mean brightness levels each indicative of a mean of brightness levels of the sample points situated on each of the sample lines in the image taken at time t+ GAMMA ,  GAMMA  being a positive time interval, means for detecting, as movement sample lines, the sample lines which are included in the image taken at the time t and in each of which the vehicle in motion is expected to be present, means for detecting, as prospective post-movement sample lines, the sample lines which are included in the image taken at the time t+ GAMMA  and to each of which each of the movement sample lines in the image taken at the time t is expected to be transferred, means for calculating line velocities each indicative of a velocity of the movement sample line based on the positive time interval  GAMMA  and an actual route distance between two locations on the road respectively corresponding to each of the movement sample lines and each of the post-movement sample lines, and means for measuring the state of traffic congestion on the road on the basis of the line velocities of the movement sample lines.
    </p>
    <p num="27">A fourteenth aspect of the present invention describes an image processing method of processing an image taken by a camera and representing an object and a background, comprising forming a criterion brightness image representing only the background, calculating a difference image indicative of a difference in brightness between the image and the criterion brightness image, judging whether a brightness level of each of picture elements forming the difference image is larger than a predetermined level or not, and varying the predetermined level, which is utilized for judging each of the picture elements, in accordance with an actual distance from the camera to an actual location corresponding to a position of each of the picture elements in the image.</p>
    <p num="28">A fifteenth aspect of the present invention describes an image processing method comprising calculating a first difference image indicative of a difference in brightness between an image at time t and another image at time t- ALPHA ,  ALPHA  being a predetermined positive time interval, and the image at the time t and another image at the time t- ALPHA  being contained in a series of images taken by a video camera, binarizing the first difference image with a first predetermined threshold level to form a first feature abstractive image containing only picture elements each having a level of "0" or "1", calculating a second difference image indicative of a difference in brightness between the image at the time t and a further image at time t+ BETA ,  BETA  being a predetermined positive time interval, and the further image at the time t+ BETA  being contained in the series of images, binarizing the second difference image with a second predetermined threshold level to form a second character abstractive image containing only picture elements each having a level of "0" or "1", calculating a product of the first feature abstractive image and the second feature abstractive image to form a product image, varying  ALPHA  and  BETA , which are utilized for discriminating each of picture elements among the series of images, in accordance with an actual distance from the video camera to an actual location corresponding to a position of each of the picture elements in the image taken at the time t.</p>
    <p num="29">A sixteenth aspect of the present invention describes an image processing method comprising separating picture elements included in an image taken by a camera into two picture element groups on the basis of brightness levels of the picture elements, one of the picture element groups consisting of a plurality of first picture elements, and the other of the picture element groups consisting of a plurality of second picture elements, calculating first picture element ratios each indicative of a ratio of the first picture elements to all of the picture elements contained in each of candidate blocks which partially forms the image, detecting the candidate blocks each having the first picture element ratio larger than a predetermined level, and varying the predetermined level, which is utilized for judging each of the candidate blocks, in accordance with an actual distance from the camera to an actual location corresponding to a position of each of the candidate blocks in the image.</p>
    <p num="30">A seventeenth aspect of the present invention describes an image processing method comprising separating picture elements included in an image taken by a camera into two picture element groups on the basis of brightness levels of the picture elements, one of the picture element groups consisting of a plurality of first picture elements, and the other of the picture element groups consisting of a plurality of second picture elements, calculating first picture element ratios each indicative of a ratio of the first picture elements to all of the picture elements contained in each of the candidate blocks which partially forms the image, detecting the candidate blocks each having the first picture element ratio larger than a predetermined level, and varying, in size, each of the candidate blocks in accordance with an actual distance from the camera to an actual location corresponding to a position of each of the candidate blocks in the image.</p>
    <p num="31">An eighteenth aspect of the present invention describes an image processing apparatus for processing an image taken by a camera and representing an object and a background, comprising means for forming a criterion brightness image representing only the background, means for calculating a difference image indicative of a difference in brightness between the image and the criterion brightness image, means for judging whether a brightness level of each of picture elements forming the difference image is larger than a predetermined level or not, and means for varying the predetermined level, which is utilized for judging each of the picture elements, in accordance with an actual distance from the camera to an actual location corresponding to a position of each of the picture elements in the image.</p>
    <p num="32">A nineteenth aspect of the present invention describes an image processing apparatus comprising means for calculating a first difference image indicative of a difference in brightness between an image at time t and another image at time t- ALPHA ,  ALPHA  being a predetermined positive time interval, and the image at the time t and another image at the time t- ALPHA  being included in a series of images taken by a video camera, means for binarizing the first difference image with a first predetermined threshold level to form a first feature abstractive image containing only picture elements each having a level of "0" or "1", means for calculating a second difference image indicative of a difference in brightness between the image at the time t and a further image at time t+ BETA ,  BETA  being a predetermined positive time interval, and the further image at the time t+ BETA  being included in the series of images, means for binarizing the second difference image with a second predetermined threshold level to form a second feature abstractive image containing only picture elements each having a level of "0" or "1", means for calculating a product of the first feature abstractive image and the second feature abstractive image to form a product image, and means for varying  ALPHA  and  BETA , which are utilized for discriminating each of picture elements among the series of images, in accordance with an actual distance from the video camera to an actual location corresponding to a position of each of the picture elements in the image taken at the time t.</p>
    <p num="33">A twentieth aspect of the present invention describes an image processing apparatus comprising means for separating picture elements included in an image taken by a camera into two picture element groups on the basis of brightness levels of the picture elements, one of the picture element groups consisting of a plurality of first picture elements, and the other of the picture element groups consisting of a plurality of second picture elements, means for calculating first picture element ratios each indicative of a ratio of the first picture elements to all of the picture elements contained in each of candidate blocks which partially forms the image, means for detecting the candidate blocks each having the first picture element ratio larger than a predetermined level, and means for varying the predetermined level, which is utilized for judging each of the candidate blocks, in accordance with an actual distance from the camera to an actual location corresponding to a position of each of the candidate blocks in the image.</p>
    <p num="34">A twenty-first aspect of the present invention describes an image processing apparatus comprising means for separating picture elements included in an image taken by a camera into two picture element groups on the basis of brightness levels of the picture elements, one of the picture element groups consisting of a plurality of first picture elements, and the other of the picture element groups consisting of a plurality of second picture elements, means for calculating first picture element ratios each indicative of a ratio of the first picture elements to all of the picture elements contained in each of candidate blocks which partially forms the image, means for detecting the candidate blocks each having the first picture element ratio larger than a predetermined level, and means for varying, in size, each of the candidate blocks in accordance with an actual distance from the camera to an actual location corresponding to a position of each of the candidate blocks in the image.</p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="35">
      The above and other objects, features and advantages of the present invention will be apparent from the following detailed description of the preferred embodiments of the invention in conjunction with the accompanying drawings, in which:
      <br/>
      FIG. 1 is a schematic view showing a first preferred embodiment of a traffic control system utilizing traffic congestion measuring method and apparatus according to the present invention;
      <br/>
      FIG. 2 is a perspective view showing an area shot by a video camera shown in FIG. 1;
      <br/>
      FIG. 3 is a block diagram showing the traffic congestion measuring apparatus shown in FIG. 1.
      <br/>
      FIG. 4 is a flowchart showing traffic congestion measuring steps performed by the traffic congestion measuring system shown in FIG. 1;
      <br/>
      FIG. 5 is a view showing relationships between results of the calculation and the detection obtained in the steps of the flowchart shown in FIG. 4;
      <br/>
      FIG. 6 is a view showing sample points set in the image taken by the video camera shown in FIG. 1;
      <br/>
      FIG. 7 is a flowchart showing detailed steps as a whole defining the step S2 of the flowchart shown in FIG. 4;
      <br/>
      FIG. 8 is a view showing a sample point image formed in the step S2b of the flowchart shown in FIG. 7;
      <br/>
      FIG. 9 is a view showing presence sample points detected in the step S2 of the flowchart shown in FIG. 4;
      <br/>
      FIG. 10 is a flowchart showing detailed steps as a whole defining the step S3 of the flowchart shown in FIG. 4;
      <br/>
      FIG. 11 is a view showing relationships between images formed in the steps S3a through S3k of the flowchart shown in FIG. 10;
      <br/>
      FIG. 12 is a view showing relationships between first and second feature abstractive images formed in the steps S3j and S3k, respectively, of the flowchart shown in FIG. 10 and a product image formed in the step S3l of the flowchart shown in FIG. 10;
      <br/>
      FIG. 13 is a flowchart showing detailed steps as a whole forming the step S4 of the flowchart shown in FIG. 4;
      <br/>
      FIG. 14 is a view showing movement blocks detected in the step S4 of the flowchart shown in FIG. 10;
      <br/>
      FIG. 15 is a view illustrated for explaining a manner in which congestion sample points are detected in the step S5 of the flowchart shown in FIG. 4;
      <br/>
      FIG. 16 is a flowchart showing detailed steps as a whole forming the step S6 of the flowchart shown in FIG. 4;
      <br/>
      FIG. 17 is a view showing congestion blocks detected in the step S6 of the flowchart shown in FIG. 4;
      <br/>
      FIG. 18 is a flowchart showing the detailed steps as a whole defining the step S7 of the flowchart shown in FIG. 4;
      <br/>
      FIG. 19 is a view showing relationships between traffic congestion ranges detected in the step S7a of the flowchart shown in FIG. 18 and the corrected traffic congestion ranges obtained in the step S7c of the flowchart shown in FIG. 18;
      <br/>
      FIG. 20 is a schematic view showing a second preferred embodiment of a traffic control system utilizing traffic congestion measuring method and apparatus according to the present invention;
      <br/>
      FIG. 21 is a view showing relationships between a spatial measurement area and a traffic flow measurement area which are measured by the traffic congestion measuring apparatus shown in FIG. 20;
      <br/>
      FIG. 22 is a flowchart showing steps of measuring spatial densities in the traffic congestion measuring system shown in FIG. 20;
      <br/>
      FIG. 23 is a view showing relationships between results of the calculation and the detection obtained in the steps of the flowchart shown in FIG. 22;
      <br/>
      FIG. 24 is a view showing relationships between a sample point image formed in the step P1 of the flowchart shown in FIG. 22 and sample lines set in the same step;
      <br/>
      FIG. 25 is a flowchart showing a first example of detailed steps as a whole defining the step P4 of the flowchart shown in FIG. 22;
      <br/>
      FIG. 26 is a flowchart showing a second example of detailed steps as a whole defining the step P4 of the flowchart shown in FIG. 22;
      <br/>
      FIG. 27 is a flowchart showing a first example of detailed steps as a whole defining the step P5 of the flowchart shown in FIG. 22;
      <br/>
      FIG. 28 is a flowchart showing a second example of detailed steps as a whole defining the step P5 of the flowchart shown in FIG. 22;
      <br/>
      FIG. 29 is a flowchart showing detailed steps as a whole defining the step P7 of the flowchart shown in FIG. 22;
      <br/>
      FIG. 30 is a view showing the changes of presence sample lines before, while and after the presence sample lines are corrected in the step P7 of the flowchart shown in FIG. 22;
      <br/>
      FIG. 31 is a flowchart showing detailed steps as a whole defining the step P8 of the flowchart shown in FIG. 22;
      <br/>
      FIG. 32 is a flowchart showing detailed steps as a whole defining the steps P9 of the flowchart shown in FIG. 22;
      <br/>
      FIG. 33 is a flowchart showing detailed steps as whole defining the step P10 of the flowchart shown in FIG. 22;
      <br/>
      FIG. 34 is a view showing the changes of presence sample lines before and after the presence sample lines are corrected in the step P10 of the flowchart shown in FIG. 22;
      <br/>
      FIG. 35 is a view showing spatial densities of mesh sections obtained in the step P12 of the flowchart shown in FIG. 22;
      <br/>
      FIG. 36 is a view illustrated for explaining grounds that the spatial density is required to be corrected depending upon a ratio of large-sized vehicles to all of the vehicles in the step P15 of the flowchart shown in FIG. 22;
      <br/>
      FIG. 37 is a flowchart showing steps of measuring spatial velocities in the traffic congestion measuring system shown in FIG. 20;
      <br/>
      FIG. 38 is a view showing relationships between results of the calculation and the detection obtained in the steps of the flowchart shown in FIG. 37;
      <br/>
      FIG. 39 is a flowchart showing a first example of detailed steps as a whole defining the step Q4 of the flowchart shown in FIG. 37;
      <br/>
      FIG. 40 is a flowchart showing a second example of detailed steps as a whole defining the step Q4 of the flowchart shown in FIG. 37;
      <br/>
      FIG. 41 is a view showing relationships between a movement sample line, two sample lines immediately before and after the movement sample lines, and prospective post-movement areas into which the movement sample line detected in the step Q4J of the flowchart shown in FIG. 40 and the two sample lines are expected to be respectively transferred;
      <br/>
      FIG. 42 is a flowchart showing a first example of steps of measuring the tail position of a traffic congestion range detected by the traffic congestion measuring apparatus shown in FIG. 20;
      <br/>
      FIG. 43 is a flowchart showing a second example of steps of measuring the tail position of the traffic congestion range detected by the traffic congestion measuring apparatus shown in FIG. 20;
      <br/>
      FIG. 44 is a view showing relationships between results of the calculation and the detection obtained in the steps of the flowcharts shown in FIGS. 42 and 43; and
      <br/>
      FIG. 45 is a view the tail position of the traffic congestion range measured in accordance with the steps of the flowchart shown in FIG. 42.
    </p>
    <heading>DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
    <p num="36">&lt;First Embodiment&gt;</p>
    <p num="37">Referring to FIGS. 1 to 19 of the drawings, a first preferred embodiment of a traffic control system adopting traffic congestion measuring method and apparatus according to the present invention will be described in detail hereinafter.</p>
    <p num="38">
      The traffic control system is shown in FIG. 1 and includes video cameras 11 to 14, traffic congestion measuring units 21 to 24, traffic signals 31 to 34, signal control units 41 to 44 and a repeating installation unit 50.
      <br/>
      All of these units and devices are located in the neighborhood of an intersection IS.
      <br/>
      The traffic control system further comprises a central control unit 60 that is located in a traffic control center built in remotely spaced relationship to the intersection IS.
      <br/>
      As shown in FIG. 2, the video cameras 11 to 14 are spaced apart from a road surface near the intersection IS, for example, at 10 meters, and set to shoot a road area Y covering three traffic lanes and each extending from a certain position in the neighborhood of the intersection over a distance of 150 meters.
      <br/>
      In the present embodiment, each of the video cameras 11 to 14 is positioned on the downstream side of each of the roads and directed toward the upstream side of each of the roads.
    </p>
    <p num="39">
      The traffic congestion measuring units 21 to 24 are designed to measure not only traffic quantity but also traffic congestion ranges or traffic queue lengths on the basis of the number, the velocities and the types of vehicles that are approaching the intersection IS.
      <br/>
      Each of the traffic congestion measuring units 21 to 24 is shown in FIG. 3 and includes a CPU 2, an image memory 3, an input device 4, a display unit 5, a data storage unit 6, a transmitting unit 7, a RAM (Random Access Memory) 8 and a ROM (Read-only Memory) 9.
    </p>
    <p num="40">
      When each of the video cameras 11 to 14 are operated to obtain image data, the image data are transmitted to the CPU 2 of each of the traffic congestion measuring units 21 to 24.
      <br/>
      The image data is further transmitted from the CPU 2 and stored in the image memory 3.
      <br/>
      The ROM 9 previously stores various programs to be read and executed by the CPU 2.
      <br/>
      When the programs are executed by the CPU 2, the RAM 8 serves as a work area and outputs the required image data from the image memory 3.
      <br/>
      Based on the required image data, various calculations are carried out and, finally, the following measurement results pertinent to the state of traffic congestion are calculated.
      <br/>
      The calculation values produced during the execution of the programs are temporarily stored in the image memory 3.
      <br/>
      The measurement results pertinent to the state of traffic congestion are transmitted to the display unit 5, the data storage unit 6 and the transmitting unit 7.
      <br/>
      The display unit 5 displays the inputted measurement results pertinent to the state of traffic congestion on its own screen.
      <br/>
      The data storage unit 6 is operated to store therein the inputted measurement results pertinent to the state of traffic congestion.
      <br/>
      The transmitting unit 7 transmits the inputted measurement results pertinent to the state of traffic congestion to the central control unit 60 in the traffic control center shown in FIG. 1 by way of the repeating installation unit 50.
      <br/>
      The input device 4 serves as an input means for allowing set values and threshold values to be inputted therein and allowing the present values to be replaced with new values.
    </p>
    <p num="41">
      Returning back to FIG. 1 of the drawings, the central control unit 60 in the traffic control center is adapted to transmit signal control patterns, which are produced on the basis of the measurement results of the traffic congestion measuring units 21 to 24, to the signal control units 41 to 44 through the repeating installation unit 50.
      <br/>
      If, for instance, the traffic congestion measuring units 21 and 23 receiving the image data from the video cameras 11 and 13 detects traffic congestion ranges respectively having lengths which are longer than those by the traffic congestion measuring units 22 and 24 receiving the image data from the video cameras 12 and 14, the central control unit 60 is operated to transmit, to the signal control units 41 to 44, the signal control patterns indicating that green light periods in the signal control units 31 and 32 are longer than those in the signal control units 33 and 34, thereby relieving the traffic congestion on the roads shot by the video cameras 11, and 13.
    </p>
    <p num="42">The traffic congestion measuring method performed by the traffic congestion measuring units thus constructed is described hereinlater with reference to FIG. 4 showing a flowchart and formed by steps S1 through S8.</p>
    <p num="43">
      In step S1, a plurality of sample points are set in a series of the images taken by the video camera.
      <br/>
      As seen in FIG. 6, assuming that the video camera takes an image 71 the sample points are denoted by ".circle-solid.". In step S2, the sample points, which are set in the image taken at time tn and at each of which the vehicle is expected to be present, are detected as presence sample points.
      <br/>
      In step S3, the sample points, which are set in the image taken at the time tn and at each of which the vehicle in motion is expected to be present, are detected as movement sample points.
      <br/>
      In step S4, rectangular blocks each formed by the sample points adjacent to one another are detected as movement blocks.
      <br/>
      Each of the detected movement blocks includes the movement sample points.
      <br/>
      A ratio of the movement sample points to all of the sample points contained in each of the movement blocks is larger than a predetermined level.
      <br/>
      In step S5, the presence sample points which are excluded from the movement blocks are detected as congestion sample points.
      <br/>
      In step S6, rectangular blocks each formed by the sample points adjacent to one another are detected as congestion blocks.
      <br/>
      Each of the detected congestion blocks includes the congestion sample points.
      <br/>
      A ratio of the congestion sample points to all of the sample points contained in each of the congestion blocks is larger than a predetermined level.
      <br/>
      In step S7, the state of traffic congestion in the measurement area at the time tn is measured depending upon the congestion blocks.
      <br/>
      In step S8, n is replaced n+1 and the control is returned from step S8 to step S2.
      <br/>
      Note that n is a positive integer and that .vertline.tn+1 -tn.vertline. is constant.
      <br/>
      Steps S2 through S7 are repeated at regular time intervals.
    </p>
    <p num="44">
      FIG. 5 summarily shows relationships between results of the calculation and the detection in steps S1 through S7.
      <br/>
      The results of the calculation and the detection will be apparent from the following detailed explanations of steps S1 through S7.
    </p>
    <p num="45">Step S1 of setting the sample points is described in detail hereinlater.</p>
    <p num="46">
      The image 71 shown in FIG. 6 has a lower portion representing an area portion near the video camera and an upper portion representing an area portion remote from the video camera.
      <br/>
      The image 71 represents three traffic lanes with the vehicles as rectangles shown by solid lines.
      <br/>
      As seen in FIG. 6, the sample points on each line perpendicular to a direction in which the road extends are positioned in the image to correspond to actual locations aligned at regular actual space intervals on the road.
      <br/>
      The reason why the sample points are thus positioned is that distortions in each line perpendicular to the direction in which the road extends is small and that a distance in the image between two sample points aligned on the line perpendicular to the direction in which the road represented in the image extends can be transformed into an actual distance with ease.
    </p>
    <p num="47">
      On the other hand, the sample points on each line parallel to the direction in which the road extends are aligned at space intervals.
      <br/>
      The space interval between two adjoining sample points aligned on each line parallel to the direction becomes smaller as two actual locations on the road respectively corresponding to the two adjoining sample points are more remote from the video camera.
      <br/>
      The reason why the sample points on each line parallel to the direction in which the road extends are thus aligned is described below.
      <br/>
      In an image area corresponding to an actual area near to the video camera, the image of the vehicle is large.
      <br/>
      For this reason, the travel condition of the vehicle can be detected with ease even if the sample points are sparsely arranged.
      <br/>
      On the contrary, in an image area corresponding to an actual area remote from the video camera, the image of the vehicle is small.
      <br/>
      For this reason, it is difficult to detect the vehicle's travel condition if sample points are sparsely arranged.
      <br/>
      For example, in a faraway image area corresponding to an area most remote from the video camera, the space interval between two sample points aligned in a direction in which the vehicle is travelling is corresponding to that between two adjoining picture elements in the image.
      <br/>
      In the image areas nearer to the video camera, as two actual locations corresponding to the two sample points are nearer to the video camera, the space interval between the two sample points becomes larger to the extent that the travel condition of the vehicle can be detected.
      <br/>
      In this case, the space intervals of the sample points may be determined depending upon a predetermine limit value indicative of the total number of the sample points.
      <br/>
      By determining the space intervals of the sample points in this way, not only can be detected the travel conditions of the vehicles remote from the video camera, but the required processing time can be reduced.
      <br/>
      When the measuring system ensures that the detection capability in the measurement area most remote from the video camera is increased to the upper limit level indigenous to the input image, and when the total number of the sample points are restricted, the measuring system is capable of enhancing the detection process in speed and performing the detection process without expensive specific hardware.
      <br/>
      If the resolution of the video camera in the measuring system is set to a constant value, other video cameras having various resolutions can be adopted with ease.
      <br/>
      When the sample points are set, the data storage unit 6 stores, in a distance table formed in its own memory area, distance values and space intervals.
      <br/>
      The distance values are indicative of an actual route distance along each traffic lane from the video camera to an actual location on the road corresponding to each of the sample points.
      <br/>
      The space intervals are indicative of the actual space interval between the two adjoining sample points aligned along each traffic lane.
    </p>
    <p num="48">The process of detecting the presence sample points performed in step S2 shown in FIG. 4 is described in detail hereinlater with reference to FIG. 7 showing a flowchart formed by steps S2a through S2g.</p>
    <p num="49">
      In step S2a, threshold levels TH1 are utilized for binarizing brightness level of each of the sample points.
      <br/>
      The binarization manner is determined in accordance with distance values that are indicative of an actual route distance from the video camera to an actual location on the road corresponding to a position of each of the sample points in the image.
      <br/>
      In step S2b, a sample point image represented by only picture elements corresponding to the sample points is formed.
      <br/>
      FIG. 8 shows an example of the sample point image.
      <br/>
      As seen in FIG. 8, the sample point image is formed by mapping the sample points in the image at the time tn into a rectangular coordinate system.
      <br/>
      The sample points forming the sample point image are stored in the form of a two-dimensional data format corresponding to the arrangement of the sample points shown in FIG. 8.
      <br/>
      Each of the brightness levels of the picture elements corresponding to the sample points is represented in the form of 8 bit data format.
    </p>
    <p num="50">
      Step S2b leads to step S2c in which a difference image is calculated by calculating brightness difference values which are each indicative of a difference in brightness level between each of the sample points in the sample point image and each of the sample points in a criterion brightness image corresponding in position to each other.
      <br/>
      The criterion brightness image used in the initial control flow shown in FIG. 7 may represent a background with respect to the vehicles and be taken by the video camera on the same condition as the initial measurement.
      <br/>
      Most preferably, the firstly formed criterion brightness image may represent no vehicles within the measurement area.
      <br/>
      However, the most preferable criterion brightness image can be scarcely formed because of the fact that the brightness level in the image is varied every minute in accordance with the weather and the elapsed time.
      <br/>
      Practically, the criterion brightness image may be an image having picture element data approximate to that of the most preferable image representing no vehicles even if the image represents several vehicles.
      <br/>
      Similarly to the aforesaid sample point image, the criterion brightness image is represented by only picture elements corresponding to the sample points, respectively.
    </p>
    <p num="51">In step S2d, the criterion brightness image which is utilized for calculating the difference image with respect to the sample point image at time tn+1 is renewed by the following equation on the basis of the difference image calculated in step S2c.</p>
    <p num="52">Bn+1 =Bn + ETA  * (Xn -Bn)  (i)</p>
    <p num="53">
      wherein Xn is a brightness level of each of sample points forming the sample point image taken at time tn.
      <br/>
      Bn is a brightness level of each of sample points forming the criterion brightness image which is utilized for calculating the difference image with respect to the sample point image taken at time tn.
      <br/>
      Bn+1 is a brightness level which is utilized for calculating the difference image with respect to the sample point image taken at time tn+1.  ETA  is a variable coefficient decreased in proportion as .vertline.Xn -Bn.vertline. becomes large and as traffic congestion level on the road is increased.
      <br/>
      The reason why  ETA  is inversely proportional to .vertline.Xn -Bn.vertline. is that a possibility that the vehicle is present is increased in proportion as the variation in brightness is increased.
      <br/>
      In this case,  ETA  is set for each of the sample points.
      <br/>
      On the other hand, in order to prevent the brightness level of the vehicle caught by the traffic congestion from being inputted into the system,  ETA  is decreased in proportion to the increase in the traffic congestion level on the road.
      <br/>
      In this case,  ETA  is set for each of the traffic lanes or each of predetermined areas in the image.
      <br/>
      The traffic congestion level is determined depending upon traffic congestion ranges described below.
    </p>
    <p num="54">
      Because the criterion brightness image is renewed in accordance with the equation (i) described hereinbefore, the criterion brightness image can be automatically varied in accordance with the variation in weather and the variation of the sunlight due to elapsed-time.
      <br/>
      In addition, since the criterion brightness image is renewed in accordance with the equation (i), "Xn -Bn " calculated in step S2c can be appropriated for the renewal of the criterion brightness image, thereby making it possible to reduce the calculations in quantity.
      <br/>
      If the calculation is increased, the criterion brightness image is renewed by another equation describe as follows:
      <br/>
      Bn+1 =Bn + ETA  * (Xn+1 -Bn)  (ii)
    </p>
    <p num="55">
      In step S2e, the difference image is spatially differentiated with so-called Sobel operators.
      <br/>
      Step S2e is followed by step S2f in which each of the differentiation values of the sample points in the differentiated difference image is binarized or thresholded with each of the threshold levels TH1 determined in step S2a.
      <br/>
      Therefore, the sample points in the differentiated difference image each has a level of "0" or "1".
      <br/>
      In step S2g, the sample points having the level of "1" are detected as the presence sample points because of the fact that, on each of the sample points having the level of "1", the vehicle is expected to be present.
      <br/>
      The arrangement of the presence sample points thus detected is, by way of example, shown in FIG. 9.
    </p>
    <p num="56">
      Each of the threshold levels TH1 may be determined in step S2a as follows.
      <br/>
      The smaller of the threshold levels TH1 used for judging each of the sample points becomes smaller as an actual route distance from the video camera to a location on the road corresponding to a position of each of the sample points in the image becomes larger.
      <br/>
      The reason why the threshold levels TH1 are thus set is that the image representing an actual area remote from the video camera grows dimmer in comparison with that representing an actual area in the neighborhood of the video camera and accordingly that a difference in brightness between the vehicles and the background is decreased.
      <br/>
      Because each of the threshold levels is set for each of the sample points in accordance with the actual route distance from the video camera to the actual location on the road corresponding to the position of each of the sample points, the presence sample points in any position can be detected on an accurate level with one another.
    </p>
    <p num="57">
      The process of detecting the movement sample points performed in step S3 shown in FIG. 4 is described in detail hereinlater with reference to FIG. 10 showing a flowchart formed by steps S3a through S3m.
      <br/>
      The process will be understood with ease, provided that FIGS. 11 and 12 are referred to in each step.
    </p>
    <p num="58">
      In step S3a, the sample point image is divided into a plurality of image zones, the number of which is designated by "M".
      <br/>
      In the present embodiment, the sample point image is divided into three different image zones consisting of a faraway image zone which corresponds to an actual area remote from the video camera, a neighboring image zone which corresponds to an actual area near to the video camera, an intermediate image zone located between the faraway image zone and the neighboring image zone.
      <br/>
      M is, therefore, equal to 3 in the present embodiment.
      <br/>
      Step S3b determines time intervals  ALPHA m and  BETA m that are used for judging the mth image zone and threshold levels TH1 and TH2 that are used for the following binarization process.
      <br/>
      Note that the time intervals  ALPHA m and  BETA m are positive,  ALPHA 1 &lt; ALPHA 2 &lt; ALPHA 3, and  BETA 1 &lt; BETA 2 &lt; BETA 3.
      <br/>
      The reason why the time intervals  ALPHA m and  BETA m are thus determined is described hereinlater.
      <br/>
      In appearance, the velocity of the vehicle represented in an image zone corresponding to an actual area near to the video camera is higher than that of the vehicles represented in an image zone corresponding to an actual area remote from the video camera.
      <br/>
      For this reason, in the image zone near to the video camera, the velocity of the vehicle can be detected with easy by comparing the sample point images taken at different times between which there is a short time interval.
      <br/>
      Consequently, the time intervals  ALPHA m and  BETA m used for selecting the sample points in the neighboring image zone corresponding to the actual area near to the video camera may be short.
      <br/>
      On the other hand, in the faraway zone corresponding to the actual area remote from the video camera, the velocity of the vehicle can be scarcely detected by comparing the sample point images taken at different times between which there is a short time interval.
      <br/>
      Consequently, the time intervals  ALPHA m and  BETA m use for selecting the sample points in the faraway image zone corresponding to the actual area remote from the video camera may be long.
      <br/>
      The time intervals  ALPHA m and  BETA m may be different from each other however, the time intervals  ALPHA m and  BETA m are preferably equal to each other.
    </p>
    <p num="59">
      When step S3b leads to step S3c, the sample point images are formed from the images taken at times tn, tn - ALPHA m and tn + BETA m. Step S3d calculates a first difference image zone indicative of a difference in brightness between the mth image zone of the sample point image taken at the time tn and the mth image zone of the sample point image taken at the time tn - ALPHA m. The first difference image zone is binarized with the threshold level TH1 determined in step S3b to calculate a first feature abstractive image zone in step S3e.
      <br/>
      This results in the fact that each of the sample points in the first feature abstractive image zone has a level of "0" or "1".
    </p>
    <p num="60">
      Step S3f calculates a second difference image zone indicative of a difference in brightness between the mth image zone of the sample point image taken at the time tn and the mth image zone of the sample point image taken at the time tn + BETA m. Step S3f leads to step S3g in which the second difference image zone is binarized with the threshold level TH2 determined in step S3b to calculate a second feature abstractive image zone.
      <br/>
      This means that each of the sample points in the second feature abstractive image zone has a level of "0" or "1".
    </p>
    <p num="61">
      By virtue of steps S3h and S3i following step S3g, steps S3b through S3g are repeated until m is equal to M. Accordingly, three first feature abstractive image zones and three second feature abstractive image zones are calculated.
      <br/>
      In step S3j, all of the first feature abstractive image zones are combined to form a first feature abstractive image.
      <br/>
      Likewise, in step S3k, all of the second feature abstractive image zones are combined to form a second feature abstractive image.
    </p>
    <p num="62">
      In step S3l, a product image is formed by calculating a product of the first feature abstractive image and the second feature abstractive image.
      <br/>
      The sample points each having the level indicated by "1" are detected as the movement sample points in step S3m.
      <br/>
      FIG. 12 shows the relationships between the product image and the first and second feature abstractive images.
    </p>
    <p num="63">
      The reason why the movement sample points are detected on the basis of the sample point image taken at the time tn and the two sample point images respectively taken before and after the time tn is described below.
      <br/>
      If the movement sample points are detected on the basis of the sample point image taken at the time tn and only one of two sample point images taken before and after the time tn, the sample points indicative of the moving vehicle not represented in the sample point image at the time tn remain in the feature abstractive image as will be understood from the first or second feature abstractive image shown in FIG. 12. This means that the movement sample points cannot be detected on the basis of only one of the first and second feature abstractive images.
    </p>
    <p num="64">
      If the time intervals  ALPHA m and  BETA m are appropriately controlled in the process of detecting the movement sample points, it is possible that the sample points indicative of the low speed moving vehicle, which is moving at 20 km/h or lower, are prevented from being detected as the movement sample points.
      <br/>
      The present embodiment, therefore, can be applied to measurement for the traffic congestion caused by the low speed vehicles by appropriately controlling the time intervals  ALPHA m and  BETA m.
    </p>
    <p num="65">The process of detecting the movement blocks in step S4 shown in FIG. 4 is described in detail hereinlater with reference to FIG. 13 showing a flowchart formed by steps S4a through S4j.</p>
    <p num="66">
      In step S4a, a calculation start point is set to the sample point located at the top left-hand corner of the sample point image.
      <br/>
      It is assumed that candidate blocks which might be detected as the movement blocks are rectangular blocks each partially forming the sample point image and formed by a plurality of sample points adjacent to one another and arranged in the form of a matrix array.
      <br/>
      In step S4b, the size of each of the candidate blocks and a threshold level TH1 utilized for binarizing the sample points in each of the candidate blocks are determined in accordance with an actual route distance from the video camera to an actual location on the road corresponding to a position of each of the candidate blocks in the image.
      <br/>
      Step S4c calculates a ratio of the movement sample points included in the candidate block to all of the sample points contained in the same candidate block.
      <br/>
      In step S4d, a judgment is made upon whether the ratio of the movement sample points to all of the sample point in the candidate block is larger than the threshold level TH1 determined in step S4b.
      <br/>
      If the answer in step S4d is an affirmative "YES", step S4d leads to step S4e in which the candidate block is detected as the movement block.
      <br/>
      If the answer in step S4d is a negative "NO", step S4d leads to step S4f.
      <br/>
      By virtue of steps S4f and S4g, steps S4c through S4e are repeated until judgments whether all of the candidate blocks aligned in a row by one sample point pitch are movement blocks or not are finished.
    </p>
    <p num="67">
      Step S4f is followed by step S4h in which the calculation start point is shifted to the left side end in the sample point image.
      <br/>
      By virtue of steps S4i and S4j, steps S4b through S4h are repeated.
      <br/>
      In the other hand, the calculation point is shifted to a lower side of the sample point image (the downstream side toward which the vehicles run) in the detecting process for the candidate blocks aligned in a row and the process is repeated.
      <br/>
      This results in the fact that the judgments whether all of the candidate blocks aligned in a row are movement blocks or not are repeated all over the rows, thereby making it possible to detect all of the movement blocks included in the sample point image.
    </p>
    <p num="68">
      FIG. 14 shows, by way of example, two detected movement blocks overlapping with each other.
      <br/>
      Each of the movement blocks shown in FIG. 14 is formed by five columns of three sample points.
      <br/>
      The movement sample points are denoted by ".circle-solid." and the sample points except the movement sample points are denoted by " (large circle) ". The ratio of the movement sample points to all of the sample points contained in each of the movement blocks shown in FIG. 14 is 60%. In this case, the threshold level TH1 used for judging the candidate block is 55%.
      <br/>
      As shown in FIG. 14, the movement sample points excluded from the movement blocks are eliminated as noises.
    </p>
    <p num="69">
      In the aforesaid step S4b, the size of each of the candidate blocks i.e., the total number of the sample points contained in each of the candidate blocks, and the threshold level TH1 may be determined as follows.
      <br/>
      Each of the candidate blocks may be substantially equal in size to an average vehicle represented in the image and, accordingly, roughly indicative of the outline of one vehicle in the sample point image.
      <br/>
      In the faraway image zone corresponding to the actual area remote from the video camera, the candidate block becomes smaller because of the fact that the vehicle image becomes smaller.
      <br/>
      In the neighboring image zone corresponding to the actual area near to the video camera, the candidate block becomes larger because of the fact that the vehicle image becomes larger.
      <br/>
      In the meantime, the threshold level TH1 used for judging the candidate blocks in the faraway image zone remote from the video camera is decreased because of the fact that a difference in brightness between the adjoining picture elements in the candidate block is small.
      <br/>
      Conversely, the threshold level TH1 used for judging the candidate blocks in the neighboring image zone near to the video camera is increased.
      <br/>
      If the size of the candidate block and the threshold level TH1 are thus determined, the movement blocks in the whole image can be detected with the same accuracy independently of an actual route distance between the video camera and a location on the road corresponding to a position of each of the candidate blocks.
    </p>
    <p num="70">
      In step S5 of the flowchart shown in FIG. 4, the presence sample points excluded from the movement blocks are detected as the congestion sample points.
      <br/>
      FIG. 15 shows, by way of example, the process of detecting the congestion sample points.
      <br/>
      The presence sample points are denoted by ".circle-solid.", the sample points except the presence sample points are denoted by " (large circle) " and the congestion sample points are denoted by ".circle-solid.".
    </p>
    <p num="71">The process of detecting the congestion blocks performed in step S6 shown in FIG. 4 is described in detail hereinlater with reference to FIG. 16 showing a flowchart formed by steps S6a through S6j.</p>
    <p num="72">
      In step S6a, a calculation start point is set to the sample point located at the top left-hand corner of the sample point image.
      <br/>
      It is assumed that candidate blocks which might be detected as the congestion blocks are rectangular blocks each partially forming the sample point image and formed by a plurality of sample points adjacent to one another and arranged in the form of a matrix array.
      <br/>
      In step S6b, the size of each of the candidate blocks and a threshold level TH1 utilized for judging the sample points in each of the candidate blocks are determined in accordance with an actual route distance from the video camera to a location on the road corresponding to a position of each of the candidate blocks.
    </p>
    <p num="73">
      Step S6c calculates a ratio of the congestion sample points included in the candidate block to all of the sample points included in the same candidate block.
      <br/>
      In step S6d, a judgment is made upon whether the ratio of the congestion sample points to all of the sample points in the candidate block is larger than the threshold level TH1 determined in step S6b.
      <br/>
      If the answer in step S6d is an affirmative "YES" step S6d leads to step S6e in which the candidate block is detected as the congestion block.
      <br/>
      If the answer in step S6d is a negative "NO", step S6d leads to step S6f.
    </p>
    <p num="74">By virtue of steps S6f and S6g, steps S6c through S6e are repeated until judgments whether all of the candidate blocks aligned in a row by one sample point pitch are congestion blocks or not are finished.</p>
    <p num="75">
      Step S6f is followed by step S6h in which the calculation start point is shifted to the left side end in the sample point image.
      <br/>
      By virtue of steps S6i and S6j, steps S6b through S6h are repeated.
      <br/>
      In the other hand, the calculation point is shifted to a lower side of the sample point image (the downstream side toward which the vehicles run) in the detecting process for the candidate blocks aligned in a row and the process is repeated.
      <br/>
      This results in the fact that the judgments whether all of the candidate blocks aligned in a row are congestion blocks or not are repeated all over the rows, thereby making it possible to detect all of the congestion blocks included in the sample point image.
    </p>
    <p num="76">
      FIG. 17 shows, by way of example, two detected congestion blocks overlapping with each other.
      <br/>
      Each of the congestion blocks shown in FIGS. 17 is formed by five columns of three sample points.
      <br/>
      The congestion sample points are denoted by ".circle-solid." and the sample points except the congestion sample points are denoted by " (large circle) ". In this case, the threshold level TH1 used for judging the congestion blocks is 45%.
      <br/>
      The ratio of the congestion sample points of all of the sample points contained in each of the congestion blocks shown in FIG. 17 is 47%. As shown in FIG. 17, the congestion sample points excluded from the congestion blocks are eliminated as noises.
    </p>
    <p num="77">
      In step S6b, the size of each of the candidate blocks i.e., the total number of the sample points contained in each of the candidate blocks, and the threshold level TH1 may be determined as follows.
      <br/>
      Each of the candidate blocks may be substantially equal in size to an average vehicle represented in the image and, accordingly, roughly indicative of the outline of one vehicle in the sample point image.
      <br/>
      In the faraway image zone corresponding to the actual area remote from the video camera, the candidate block becomes smaller because of the fact that the vehicle image becomes smaller.
      <br/>
      In the neighboring image zone corresponding to the actual area near to the video camera, the candidate block becomes larger because of the fact that the vehicle image becomes larger.
      <br/>
      In the meantime, the threshold level TH1 used for judging the candidate block in the faraway image zone remote from the video camera is decreased because of the fact that a difference in brightness between the adjoining picture elements in the candidate block is small.
      <br/>
      Conversely, the threshold level TH1 used for judging the candidate blocks in the neighboring image zone near to the video camera is increased.
      <br/>
      If the size of the candidate block and the threshold level TH1 are thus determined, the congestion blocks in the whole image can be detected with the same accuracy independently of an actual route distance between the video camera and a location on the road corresponding to a position of each of the candidate blocks.
    </p>
    <p num="78">The process of measuring the state of traffic congestion in step S7 shown in FIG. 4 is described in detail hereinlater with reference to FIG. 18 showing a flowchart formed by steps S7a through S7c.</p>
    <p num="79">
      In step S7a, the congestion blocks in each of the traffic lanes is detected as traffic congestion ranges per traffic lane.
      <br/>
      Each of the traffic congestion ranges contains a single congestion block or a plurality of congestion blocks connected to or overlapping with one another.
      <br/>
      FIG. 19 shows, by way of example, a measurement area including the congestion blocks.
      <br/>
      If there is one congestion block included in both of two traffic lanes, it is determined that the congestion block belongs to one of the traffic lanes including a larger part of the congestion block.
    </p>
    <p num="80">
      In step S7b, the traffic congestion ranges per traffic lane is transformed to actual traffic queue lengths on the road with reference to the foregoing distance table.
      <br/>
      In step S7c, the abrupt variations of the traffic congestion ranges in position are eliminated as noises on the basis of a profile indicating the positions of past traffic congestion.
      <br/>
      At the same time, the positions of the current traffic congestion are corrected through smoothing process.
      <br/>
      As a result, the traffic congestion ranges are corrected and outputted as conclusive measurement results.
    </p>
    <p num="81">
      According to the aforesaid embodiment, not all of the picture elements contained in the image but the sample points corresponding to part of the picture elements contained in the image are processed, so that data produced in the calculation process can be extremely decreased in quantity.
      <br/>
      Hence, the traffic congestion measuring apparatus can be simplified in hardware and reduced in cost.
      <br/>
      In addition, the traffic congestion measuring apparatus can process the image at high speed and, accordingly, measure the state of traffic congestion in real time.
      <br/>
      More specifically, the measurement result can be outputted within one or two seconds, i.e., (the longest time interval)+(processing time).
      <br/>
      The present invention is, therefore, extremely suitable for the present embodiment of the traffic control system designed to control the green or yellow light of the traffic signals.
      <br/>
      As will be appreciated from the foregoing description of the embodiment, it is possible that the traffic congestion measuring apparatus starts to measure the state of the traffic congestion without the previously learning and with accuracy immediately after the setup of the apparatus is completed.
      <br/>
      In addition, the traffic congestion measuring apparatus can be stably operated to measure the state of the traffic congestion independently of the variations in circumstances such as locations, time, weather and traffic densities.
      <br/>
      The traffic congestion measuring apparatus can also measure the traffic queue length with ease.
    </p>
    <p num="82">
      Each of the various parameters serving as criterion levels in the various judgments is varied in accordance with an actual route distance from the video camera to a location on the road corresponding to a position of each of the sample points, so that the resulting measurement is extremely enhanced in accuracy.
      <br/>
      Since the various parameters are automatically determined in accordance with the actual route distance from the video camera to the location on the road corresponding to position of each of the sample points, the traffic control system is managed with great facility.
      <br/>
      There is no need for the traffic congestion measuring apparatus to consider the traffic lanes until the final output timing.
      <br/>
      The vehicle which is present over both of two traffic lanes can be detected as a vehicle caught up in the traffic congestion, so that the traffic congestion measuring apparatus is stably operated to measure the state of the traffic congestion.
      <br/>
      Based on the detected movement sample points and the detected congestion sample points, a moving vehicle and a vehicle caught up in the traffic congestion are detected as the movement block and the congestion block, respectively.
      <br/>
      Hence, the movement sample point and the congestion sample point respectively excluded from the movement block and the congestion block are eliminated as noises with facility.
      <br/>
      When a plurality of video cameras and a plurality of traffic congestion measuring units are arranged along the road and when the adjoining video cameras spaced apart from each other at a distance covered by the video camera, the traffic control system can be operated to measure the state of traffic congestion over a long distance range.
      <br/>
      In the present embodiment, the state of traffic congestion in the whole measurement area is not estimated from measurement results in a local part of the measurement area but directly measured, thereby enabling the traffic control system to quickly detect various accidents such as traffic accidents or vehicular accidents.
    </p>
    <p num="83">As will be appreciated from the foregoing description, the present embodiment is also a preferred embodiment of the image processing method and apparatus according to the present invention.</p>
    <p num="84">
      The aforesaid traffic congestion measuring units were set at two locations in Tokyo and Osaka, respectively, in 1995 and are operated practically.
      <br/>
      The measurement results of the field test will be described hereinafter.
    </p>
    <p num="85">(Measurement Results of Field Test in Tokyo)</p>
    <p num="86">
      (A) Measurement condition
      <br/>
      Location: Uchisaiwai-cho Intersection in Tokyo
      <br/>
      Environment: The field test was carried out under six different measurement conditions in view of various possible environments such as the weather (fine, cloudy and rainy), measurement time (daytime, twilight and night), traffic quantity (light traffic and heavy traffic).
    </p>
    <p num="87">
      - (1) August 2nd, 15:00-17:00 (daytime, cloudy to rainy, heavy traffic)
      <br/>
      - (2) August 2nd, 18:30-20:30 (twilight and night, cloudy, heavy traffic)
      <br/>
      - (3) August 3rd, 14:45-16:45 (daytime, fine, heavy traffic)
      <br/>
      - (4) August 3rd, 18:30-20:30 (twilight and night, fine, heavy traffic)
      <br/>
      - (5) August 5th, 15:00-17:00 (daytime, cloudy, light traffic)
      <br/>
      - (6) August 5th, 18:30-20:30 (twilight and night, cloudy, light traffic)
    </p>
    <p num="88">
      (B) Measurement Method
      <br/>
      Measurement area: An area covering two traffic lanes and having a length of 150 meters from the position at which the video camera is placed.
    </p>
    <p num="89">
      Judgment of traffic congestion: Vehicles in low speed motion are considered to be vehicles caught by traffic congestion;
      <br/>
      - When part of the vehicles caught by the traffic congestion is moving and when traffic queue following the moving vehicles is stationary, the position of the traffic congestion most remote from the intersection is judged to be a tail position of the traffic congestion;
      <br/>
      - The tail position of the traffic congestion is outputted every second and the average of peaks of the traffic queue lengths calculated every 5 minutes is considered as an average of peaks of the measurement values.
    </p>
    <p num="90">(C) Standard Evaluation of Measurement Results</p>
    <p num="91">
      The precision of the traffic congestion measurement results of are calculated by the following equation.
      <br/>
      Note that the following average of peaks of true value is an average of peaks of traffic queue lengths calculated every 5 minutes, the traffic queue lengths being calculated in simultaneous relationship to signal cycle.
      <br/>
      Traffic Congestion Measurement Precision (%)=+Average of Peaks of Measured Traffic Queue Length (meter)} / +Average of Peaks of True Values of Traffic queue length (meter)} * 100  (iii)
    </p>
    <p num="92">(D) Evaluation of Precision</p>
    <p num="93">The precision of the traffic congestion measurement results under the aforementioned conditions (1)-(6) are described as follows:</p>
    <p num="94">
      --
      <br/>
      -- (1): 95.4%              (2): 96.4% (3): 98.6%
      <br/>
      -- (4): 95.5%              (5): 98.2% (6): 95.7%
    </p>
    <p num="95">
      This means that the state of traffic congestion approximate to the true valve can be measured under every conditions.
      <br/>
      The peaks of the traffic queue length has the measurement precision higher than 95%.
    </p>
    <p num="96">(Measurement Results of Field Test in Osaka)</p>
    <p num="97">
      (A) Measurement condition
      <br/>
      Location: Deyashiki-minami Intersection on JP Route 1 in Hirakata
      <br/>
      Environment: The field test was carried out under five different measurement conditions in view of various possible environments such as the weather (fine and rainy), measurement time (daytime, twilight and night).
      <br/>
      - (1) August 30th, 20:45-21:15 (night, rainy)
      <br/>
      - (2) August 31st, 10:20-10:50 (daytime, rainy)
      <br/>
      - (3) September 4th, 11:00-11:30 (daytime, fine)
      <br/>
      - (4) September 4th, 18:20-18:50 (twilight, fine)
      <br/>
      - (5) September 4th, 19:30-20:00 (night, fine)
    </p>
    <p num="98">
      (B) Measurement Method
      <br/>
      Measurement area: An area covering two traffic lanes and having a length of 100 meters from the position at which the video camera is placed.
    </p>
    <p num="99">
      Judgment of traffic congestion: Vehicles in low speed motion are considered to be a vehicle caught by traffic congestion.
      <br/>
      - When part of the vehicles caught by the traffic congestion is moving and when traffic queue following the moving vehicles is stationary, the position of the traffic congestion most remote from the intersection is judged to be a tail position of the traffic congestion;
      <br/>
      Position of Traffic Congestion: One of two head positions of two traffic queues on the two traffic lanes nearer to the video camera is detected as the head position of the traffic congestion.
      <br/>
      One of two tail positions of two traffic queues on two traffic lanes more remote from the video camera is detected as the tail position of the traffic congestion.
      <br/>
      - The head and tail positions of traffic congestion are replaced with any of several output values described below, in accordance with a route distance from the video camera to the position of the traffic congestion.
    </p>
    <p num="100">
      --
      <br/>
      --         Distance x(m) from
      <br/>
      --         Camera Position  Output Value (meter)
      <br/>
      --          0 &lt; x  &lt;=  10 10
      <br/>
      --         10 &lt; x  &lt;=  20 20
      <br/>
      --         20 &lt; x  &lt;=  30 30
      <br/>
      --         30 &lt; x  &lt;=  40 40
      <br/>
      --         40 &lt; x  &lt;=  50 50
      <br/>
      --         50 &lt; x  &lt;=  60 60
      <br/>
      --         60 &lt; x  &lt;=  75 75
      <br/>
      --          75 &lt; x  &lt;=  100 100
      <br/>
      -- The head and tail positions of the traffic congestion are outputted every
      <br/>
      --  second.
    </p>
    <p num="101">(C) Measurement of True Value</p>
    <p num="102">In August 30th and 31st, true values indicative of head and tail positions of the traffic congestion indicated by any of distances of 10, 20, 30, 40, 50, 60 and 100 meters are measured with the eye from the image taken by the video camera.</p>
    <p num="103">
      In September 4th, true values indicative of head and tail positions of the traffic congestion are measured by measurement staff members stood at the locations of the route distances 50, 75 and 100 meters, respectively.
      <br/>
      The true head and tail positions of the traffic congestion indicated by any of distances of 10, 20, 30, 40 and 60 meters are measured with the eye from the image taken by the video camera.
    </p>
    <p num="104">(D) Standard Evaluation of Measurement Results</p>
    <p num="105">
      Based on the measurement results obtained through the traffic congestion measuring method according to the present invention, a measured total stagnating period is calculated depending upon upper one of two equations described below.
      <br/>
      Based on the true values of the head and tail positions of the traffic congestion, a true total stagnating period is calculated depending upon the upper equation.
      <br/>
      A ratio of the measured total stagnating period to the true total stagnating period is calculated depending upon lower one of the two equations.
      <br/>
      Total Stagnating Period (meter * sec)=Traffic Queue Length (meter) * Time(sec)=+Tail Position of Traffic Congestion (meter)}-+Head Position of Traffic Congestion (meter)} * time(sec) (iv)
    </p>
    <p num="106">Traffic Congestion Measurement Precision (%)=+Measured Value of Total Stagnating Period (meter * sec)} / +True Value of Total Stagnating Period (meter * sec)} * 100  (v)</p>
    <p num="107">(E) Evaluation of Precision</p>
    <p num="108">The results of the measured value of the total stagnating duration (a), the true value of the total stagnating duration (b) and the traffic congestion measurement precision (c) under the aforementioned conditions (1)-(5) are described as follows:</p>
    <p num="109">
      --
      <br/>
      --           (a) (m  *  sec) (b) (m  *  sec) (c) (%)
      <br/>
      --        (1)  42350                43775       96.7
      <br/>
      --        (2)  36620                37135       98.6
      <br/>
      --        (3)  38755                39030       99.3
      <br/>
      --        (4)  45940                46695       98.4
      <br/>
      --        (5)  44690                46465       96.2
    </p>
    <p num="110">
      This means that the state of traffic congestion approximate to the true value can be measured under every conditions.
      <br/>
      The total stagnating duration has the measurement precision higher than 96%.
    </p>
    <p num="111">Resulting from the evaluation of precision described above, the stable measurement of the traffic congestion queue length and the head and tail of the traffic congestion can be performed without respect to the measurement position, measurement time, the weather and the traffic quantity.</p>
    <p num="112">&lt;Second Embodiment&gt;</p>
    <p num="113">Referring to FIGS. 20 to 45 of the drawings, a second preferred embodiment of a traffic control system adopting traffic congestion measuring method and apparatus according to the present invention will be described in detail hereinafter.</p>
    <p num="114">
      The second embodiment of the traffic control system is shown in FIG. 20 as comprising video cameras 81, traffic congestion measuring units 82, an information display board 91, a display control unit 92 and a central control unit 100 that is located in a traffic control center.
      <br/>
      The video cameras 81 are positioned above a highway in spaced relationship to each other at a certain distance.
      <br/>
      As shown in FIG. 21, each of the video cameras 81 is directed from the upstream side of the highway toward the downstream side of the highway.
      <br/>
      This means that each of the video cameras 81 is intended to shoot rear side portions of the vehicles.
      <br/>
      Because the video cameras are thus fixed in the present embodiment, the traffic control system is able to measure the tail position of the traffic congestion range with accuracy.
      <br/>
      If, reversely, the traffic control system is intended to measure the head position of the traffic congestion range with accuracy, the video camera may be directed from the downstream side of the highway toward the upstream side of the highway, i.e., the video camera may be fixed so as to shoot front side portions of the vehicles.
    </p>
    <p num="115">
      The information display board 91 is positioned above the highway on the upstream side of the left side end video camera 81 shown in FIG. 20 and directed toward the upstream side of the highway.
      <br/>
      Each of the traffic congestion measuring units 82 is designed similarly to the traffic congestion units 21 to 24 of the first embodiment shown in FIG. 3.
      <br/>
      Although the repeated description of the traffic congestion measuring units 82 is omitted, various programs and initial setting values used for the measurement of the present embodiment differ from those used for the measurement of the first embodiment.
      <br/>
      Each of the traffic congestion measuring units 82 is designed to measure the state of the traffic congestion in both of a spatial measurement area E and a traffic flow measurement area F shown in FIG. 21. The traffic flow measurement area F extends over a distance of 30 meters from a line spaced apart from the video camera 81 at 10 meters and covers four traffic lanes.
      <br/>
      In the traffic flow measurement area F, the traffic congestion measuring unit is operated not only to detect the vehicles which are present in the area F but also to detect the number, the velocities, the lengths and the types of the vehicles which crosses a sense line DL.
      <br/>
      The measurement method in the traffic flow measurement area F is disclosed in detail in Japanese Patent Laid-open Publication No. 5-307695 and, for this reason, the description of the measurement method is omitted herein.
    </p>
    <p num="116">
      In the meantime, the spatial measurement area E extends over a distance of 200 meters from a line spaced apart from the video camera at 10 meters and covers two traffic lanes.
      <br/>
      In the spatial measurement area E, are measured spatial densities, spatial velocities and tail positions of traffic congestion.
      <br/>
      The manner of calculating these values will be apparent as the description proceeds.
    </p>
    <p num="117">
      The results of the measurement by the traffic congestion measuring units 82 are transmitted to the central control unit 100 in the traffic control center.
      <br/>
      The central control unit 100 is designed to produce traffic information, that is useful to drivers driving on the highway, on the basis of the received measurement results.
      <br/>
      The traffic information is transmitted from the central control unit 100 to the display control unit 92 and displayed on the screen of the information display board 91.
    </p>
    <p num="118">The process of calculating the spatial densities performed by the traffic congestion measuring unit 82 thus constructed will be summarily described hereinlater with reference to FIG. 22 showing a flowchart formed by steps P1 through P16.</p>
    <p num="119">
      In step P1, a sample point image is formed from the image taken at time tn and, subsequently, a plurality of sample lines are set in the sample point image.
      <br/>
      Because the sample point image of the present embodiment is formed similarly to that of the aforesaid first embodiment, the description of the manner of forming the sample point image is omitted herein.
      <br/>
      Each of the sample lines is formed by a plurality of sample points aligned on a line perpendicular to a direction in which the road extends.
      <br/>
      FIG. 24 shows relationships between the sample points and the sample lines in the sample point image.
    </p>
    <p num="120">
      Step P1 is followed by steps P2 and P3 which are similar to steps S2c and S2d, respectively, as shown in FIG. 7.
      <br/>
      The description of steps P2 and P3 is omitted herein with the intention of avoiding the repeated description.
    </p>
    <p num="121">
      In steps P4 and P5, difference sample lines and edge sample lines, respectively, are detected on the basis of the difference image.
      <br/>
      In step P6, presence sample lines are detected depending upon the difference sample lines and the edge sample lines detected in steps P4 and P5, respectively.
      <br/>
      Step P6 leads to step P7 in which the presence sample points are corrected on the basis of the arrangement of the presence sample lines.
      <br/>
      In step P8, the presence sample lines are further corrected on the basis of the arrangement of the difference sample lines detected in step P4.
    </p>
    <p num="122">In step P9, movement sample lines are detected as a function of three sample images taken at time tn, time tn - ALPHA m, and time tn + BETA m. In step P10, the presence sample lines are further corrected on the basis of arrangement of the movement sample lines.</p>
    <p num="123">
      In step P11, the measurement area is divide into a plurality of mesh sections.
      <br/>
      In step P12, the spatial density in each of the mesh sections at the time tn is calculated depending upon the presence sample line corrected in step P10.
    </p>
    <p num="124">
      Step P13 calculates a ratio of large-sized vehicles of all of the vehicles which are present in the measurement area at the time tn.
      <br/>
      Step P14 calculates an inter vehicle gap of vehicles which are present in the measurement area at the time tn.
      <br/>
      In step P15, the spatial density in each of the mesh sections is corrected depending upon the calculated large-sized vehicle ratio and the calculated inter vehicle gap.
    </p>
    <p num="125">
      In step P16, n is replaced with n+1 and the control is returned from step P16 to step P1.
      <br/>
      Note that n is a positive integer and that .vertline.tn+1 -tn.vertline. is constant.
      <br/>
      Steps P1 to P16 are, therefore, repeated at regular time intervals.
    </p>
    <p num="126">
      FIG. 23 is a view summarily showing relationships between the detection and the calculation results in steps P1 through P15.
      <br/>
      The detection and the calculation results will be apparent from the following detailed explanations of steps P1 through P15.
    </p>
    <p num="127">A first example of the process of detecting the difference sample lines performed in step P4 of FIG. 22 will be described in detail hereinlater with reference to FIG. 25 showing a flowchart formed by steps P4a through P4j.</p>
    <p num="128">
      In step P4a, a positive threshold level TH1, a negative threshold level TH2 and a positive integer threshold level TH3 are determined in accordance with an actual route distance from the video camera to a location on the road corresponding to kth sample line formed by M sample points.
      <br/>
      In step P4b, a judgment is made upon whether a brightness difference value of the mth sample point on the kth sample line is larger than the positive threshold level TH1 or not.
      <br/>
      Note that the brightness difference values belong to the sample points, respectively, in the difference image calculated in step P2 of FIG. 22.
    </p>
    <p num="129">
      If the answer in step P4b is an affirmative "YES", step P4b leads to step P4d.
      <br/>
      If the answer in step P4b is a negative "NO", step P4b leads to step P4c.
      <br/>
      In step P4c, a judgment is made upon whether the brightness difference value of the mth sample point on the kth sample line is smaller than the negative threshold level TH2 or not.
      <br/>
      If the answer in step P4c is an affirmative "YES", step P4c leads to step P4d.
      <br/>
      If the answer in step P4c is a negative "NO", step P4c leads to step P4e.
    </p>
    <p num="130">
      In step P4d, a flag relevant to the mth sample point on the kth sample line is set to "ON" condition and, subsequently, the control proceeds to step P4e.
      <br/>
      By virtue of steps P4e and P4f, steps P4b through P4d are repeated until m is equal to M. The repetition of steps P4b through P4d has the effect of judging whether the brightness difference values of all of the sample points on the kth sample line are larger than the positive level TH1 or not and smaller than the negative level TH2 or not.
    </p>
    <p num="131">
      In step P4g, a judgment is made upon whether the number of the flags set to "ON" condition exceeds the positive integer threshold level TH3 or not.
      <br/>
      If the answer in step P4g is an affirmative "YES", step P4g leads to step P4h in which the kth sample line is detected as the difference sample line.
      <br/>
      If the answer in step P4g is a negative "NO", step P4g leads to step P4i.
      <br/>
      By virtue of steps P4i and P4j, steps P4a through P4h are repeated until k is equal to K. Note that K is indicative of the number of all of the sample lines contained in one traffic lane within the measurement area.
      <br/>
      The repetition of steps P4a through P4h has the effect of detecting all of the difference sample lines included in one traffic lane within the measurement area.
    </p>
    <p num="132">
      The positive threshold level TH1 may be determined in step P4a as described below.
      <br/>
      The positive threshold value TH1 used for judging each of the sample lines becomes smaller as an actual route distance from the video camera to a location on the road corresponding to a position of each of the sample lines in the image becomes larger.
      <br/>
      Reversely, the negative threshold value TH2 used for judging each of the sample lines becomes larger as the actual route distance from the video camera to the location on the road corresponding to a position of each of the sample lines in the image becomes larger.
      <br/>
      The reason why the positive threshold value TH1 and the negative threshold value TH2 are thus determined is that an image area corresponding to an actual area remote from the video camera grows dimmer in comparison with that near to the video camera and, consequently, that a difference in brightness between the vehicle and the background represented in the image is decreased.
      <br/>
      Because the positive and negative threshold values TH1 and TH2 utilized for judging each of the sample lines are determined in accordance with the actual route distance from the video camera to the location on the road corresponding to the position of each of the sample lines in the image, all of the presence sample lines can be detected on an accuracy level with one another.
      <br/>
      The positive integer threshold level TH3 may be determined in step P4a as described below.
      <br/>
      The positive integer threshold value TH3 used for judging each of the sample lines becomes smaller as the actual route distance from the video camera to the location on the road corresponding to the position of each of the sample lines becomes larger, i.e., as a difference in brightness between the adjoining sample points on the sample line becomes smaller.
      <br/>
      Reversely, the positive integer threshold value TH3 becomes larger as the actual route distance from the video camera to the location on the road corresponding to the position of each of the sample lines becomes smaller, i.e., as the difference in brightness between the adjoining sample points on the sample line becomes larger.
      <br/>
      By determining the positive integer threshold level TH3 in this way, the difference sample lines in any position can be detected on an accuracy level with one another.
    </p>
    <p num="133">A second example of the process of detecting the difference sample lines performed in step P4 of FIG. 22 will be described in detail hereinlater with reference to FIG. 26 showing a flowchart formed by steps P4A through P4H.</p>
    <p num="134">
      In step P4A, first and second positive threshold levels TH1 and TH2 and first and second negative threshold levels TH3 and TH4 are determined in accordance with an actual route distance from the video camera to a location on the road corresponding to the position of the kth sample line.
      <br/>
      Note that TH4&lt;TH3&lt;0&lt;TH1&lt;TH2.
      <br/>
      The reason why both of the positive threshold levels and the negative threshold levels are required to be thus prepared is described as follows.
      <br/>
      There is a possibility that part of the brightness difference values of the sample points on one sample line assume positive levels and the remains of the brightness difference values assume negative levels.
      <br/>
      If the brightness difference values are processed without distinction of positive or negative, the positive and negative brightness difference values cancel each other.
      <br/>
      In addition, the results of the processing are liable to include noises.
      <br/>
      The cancellation and noises are liable to result in the fact that there are produced inaccurate measurement results.
      <br/>
      In order to prevent such inaccurate measurement results from being produced, the positive brightness difference values are thresholded with the positive threshold levels, while the negative brightness difference values are thresholded with the negative threshold levels.
    </p>
    <p num="135">
      Step P4B calculates a mean value PM indicative of a mean of the brightness difference values which belong to the sample points on the kth sample line and each of which is larger than the first positive threshold level TH1.
      <br/>
      Step P4C calculates a mean value NM indicative of a mean of the brightness difference values which belong to the sample points on the kth sample line and each of which is smaller than the first negative threshold level TH3.
    </p>
    <p num="136">
      Step P4C leads to step P4D in which a judgment is made upon whether the mean value PM exceeds the second positive threshold level TH2 or not.
      <br/>
      If the answer in step P4D is an affirmative "YES", step P4D leads to step P4F.
      <br/>
      If the answer in step P4D is a negative "NO", step P4D leads to step P4E in which a judgment is made upon whether the mean value NM is smaller than the second negative threshold level TH4 or not.
      <br/>
      If the answer in step P4E is an affirmative "YES", step P4E leads to step P4F in which the kth sample line is detected as the difference sample line.
      <br/>
      If the answer in step P4E is a negative "NO", step P4E leads to step P4G.
      <br/>
      By virtue of steps P4G and P4H, steps P4A through P4F are repeated until k is equal to K. The repetition of steps P4A through P4F has the effect of detecting all of the difference sample lines included in one traffic lane within the measurement area.
    </p>
    <p num="137">
      The first positive threshold levels TH1 and TH2 may be determined in step P4A as described below.
      <br/>
      The first and second positive threshold levels TH1 and TH2 used for judging each of the sample lines may become smaller as an actual route distance from the video camera to a location on the road corresponding to a position of each of the sample lines in the image becomes larger.
      <br/>
      Reversely, the first and second negative threshold levels TH3 and TH4 used for judging each of the sample lines may become larger as the actual route distance from the video camera to the location on the road corresponding to the position of each of the sample lines in the image may become larger.
      <br/>
      If the threshold values TH1 to TH4 are determined in accordance with the aforesaid actual route distance from the video camera, the difference sample lines in any position can be detected on an accuracy level with one another.
    </p>
    <p num="138">A first example of the process of detecting the edge sample lines performed in step P5 shown in FIG. 22 will be described in detail hereinlater with reference to FIG. 27 showing a flowchart formed by steps P5a through P5k.</p>
    <p num="139">
      In step P5a, the difference image calculated in step P2 of FIG. 22 is spatially differentiated with Sobel operators to calculate the spatial differentiation values belonging to the sample points, respectively.
      <br/>
      In step P5b, a positive threshold level TH1, a negative threshold level TH2 and a positive integer threshold level TH3 are determined in accordance with an actual route distance from the video camera to a location on the road corresponding to a position of the kth sample line.
    </p>
    <p num="140">
      Step P5b is followed by step P5c in which a judgment is made upon whether the spatial differentiation value of the mth sample point on the kth sample line exceeds the positive threshold level TH1 or not.
      <br/>
      If the answer in step P5c is an affirmative "YES", step P5c leads to step P5e.
      <br/>
      If the answer in step P5c is a negative "NO", step P5c leads to step P5d.
      <br/>
      In step P5d, a judgment is made upon whether the spatial differentiation value of the mth sample point on the kth sample line is smaller than the negative threshold level TH2 or not.
      <br/>
      If the answer in step P5d is an affirmative "YES", step P5d leads to step P5e.
      <br/>
      If the answer in step P5d is a negative "NO", step P5d leads to step P5f.
    </p>
    <p num="141">
      Step P5c or P5d leads to step P5e in which a flag relevant to the mth sample point on the kth sample line is set to "ON" condition and, subsequently, the control proceeds to step P5f.
      <br/>
      By virtue of steps P5f and P5g, steps P5c through P5e are repeated until m is equal to M. The repetition of steps P5c through P5e has the effect of judging whether the spatial differentiation values of all of the sample points on the kth sample line are larger than the positive threshold level TH1 or not and smaller than the negative threshold level TH2 or not.
    </p>
    <p num="142">
      When step P5f leads to step P5h, a judgment is made upon whether the number of the flags set to "ON" condition exceeds the positive integer threshold level TH3.
      <br/>
      If the answer in step P5h is an affirmative "YES", step P5h leads to step P5i in which the kth sample line is detected as the edge sample line.
      <br/>
      If the answer in step P5h is a negative "NO", step P5h leads to step P5j.
      <br/>
      By virtue of steps P5j and P5k, steps P5b through P5i are repeated until k is equal to K. The repetition of steps p5b through pSi has the effect of detecting all of the edge sample lines included in one traffic lane within the measurement area.
    </p>
    <p num="143">
      The positive threshold level TH1 may be determined in step P5b as described below.
      <br/>
      The positive threshold value TH1 used for judging each of the sample lines may become smaller as an actual route distance from the video camera to a location on the road corresponding to a position of each of the sample lines becomes larger.
      <br/>
      Reversely, the negative threshold value TH2 used for judging each of the sample lines may become larger as the actual route distance from the video camera to the location on the road corresponding to the position of each of the sample lines becomes larger.
      <br/>
      If the positive and negative threshold values TH1 and TH2 are determined in accordance with the actual route distance from the video camera, all of the edge sample lines can be detected on an accuracy level with one another.
      <br/>
      The positive integer threshold level TH3 may be determined in step P5b as described below.
      <br/>
      The positive integer threshold level TH3 used for judging each of the sample lines may become smaller as the actual route distance from the video camera to the location on the road corresponding to the position of each of the sample lines becomes longer, i.e., as a difference in brightness between the adjoining sample points on each of the sample lines becomes smaller.
      <br/>
      Reversely, the positive integer threshold value TH3 may become larger as the actual route distance from the video camera to the location on the road corresponding to the position of each of the sample lines becomes smaller, i.e., as the difference in brightness between the adjoining sample points on the sample line becomes larger.
      <br/>
      By determining the positive integer threshold level TH3 in this way, the edge sample lines in any position can be detected on an accuracy level with one another.
    </p>
    <p num="144">A second example of the process of detecting the edge sample lines performed in step P5 of FIG. 22 will be described in detail hereinlater with reference to FIG. 28 showing a flowchart formed by steps P5A through P5I.</p>
    <p num="145">In step P5A, the difference image calculated in step P2 of FIG. 22 is spatially differentiated with Sobel operators to calculate the spatial differentiation values belonging to the sample points, respectively.</p>
    <p num="146">
      In step P5B, first and second positive threshold levels TH1 and TH2 and first and second negative threshold levels TH3 and TH4 are determined in accordance with an actual route distance from the video camera to a location on the road corresponding to a position of the kth sample line in the image.
      <br/>
      Note that TH4&lt;TH3&lt;0&lt;TH1&lt;TH2.
      <br/>
      The reason why both of the positive threshold levels and the negative threshold levels are required to be thus prepared is described as follows.
      <br/>
      There is a possibility that part of the spatial differentiation values of the sample points on each of the sample lines assume positive levels and the remains of the spatial differentiation values assume negative levels.
      <br/>
      If the spatial differentiation value is processed without distinction of positive or negative, the positive and negative spatial differentiation values cancel each other.
      <br/>
      In addition, the results of the processing are liable to include noises.
      <br/>
      The cancellation and noises are liable to result in the fact that there are produced inaccurate measurement results.
      <br/>
      In order to prevent such inaccurate measurement results from being produced, the positive spatial differentiation values are thresholded with the positive threshold level, while the negative spatial differentiation values are thresholded with the negative threshold level.
    </p>
    <p num="147">
      Step P5C calculates a mean value PM indicative of a mean of the spatial differentiation values which belong to the sample points, respectively, on the kth sample line and each of which exceeds the first positive threshold level TH1.
      <br/>
      Step P5D calculates a mean value NM indicative of a mean of the spatial differentiation values which belong to the sample points on the kth sample line and each of which is smaller than the first negative threshold level TH3.
    </p>
    <p num="148">
      Step P5D leads to step P5E in which a judgment is made upon whether the mean value PM exceeds the second threshold level TH2 or not.
      <br/>
      If the answer in step P5E is an affirmative "YES", step P5E leads to step P5G.
      <br/>
      If the answer in step P5E is a negative "NO", step P5E leads to step P5F in which a judgment is made upon whether the mean value NM is smaller than the second negative threshold level TH4 or not.
      <br/>
      If the answer in step P5F is an affirmative "YES", step P5F leads to step P5G in which the kth sample line is detected as the edge sample line.
      <br/>
      If the answer in step P5F is a negative "NO", step P5F leads to step P5H.
      <br/>
      By virtue of steps P5H and P5I, steps P5B through P5G are repeated until k is equal to K. The repetition of steps P5B through P5G has the effect of detecting all of the edge sample lines included in one traffic lane within the measurement area.
    </p>
    <p num="149">
      In step P5B, the first and second positive threshold levels TH1 and TH2 may be determined as described below.
      <br/>
      The first and second positive threshold levels TH1 and TH2 used for judging each of the sample lines may become smaller as an actual route distance from the video camera to a location on the road corresponding to a position of each of the sample lines becomes larger.
      <br/>
      Reversely, the first and second negative threshold levels TH3 and TH4 used for judging each of the sample lines may become larger as the actual route distance from the video camera to the location on the road corresponding to the position of each of the sample lines becomes larger.
      <br/>
      If the threshold levels TH1 to TH4 are determined in accordance with the foregoing actual route distance from the video camera, the edge sample lines in any position can be detected on an accuracy level with one another.
    </p>
    <p num="150">
      The process of detecting the presence sample lines performed in step P6 of FIG. 22 will be described as follows.
      <br/>
      Both of the difference sample lines detected in step P4 and the edge sample lines detected in step P5 are detected as the presence sample lines.
    </p>
    <p num="151">
      The process of correcting the presence sample lines on the basis of the arrangement of thereof performed in step P7 shown in FIG. 22 will be described in detail hereinlater with reference to FIG. 29 showing a flowchart formed by steps P7a through P7m.
      <br/>
      The first half of the correction process formed by steps P7a through P7e intends the unnoticed presence sample lines caused within image zones respectively representing vehicle bodies to be corrected.
      <br/>
      The second half of the correction process formed by steps P7g through P7m intends the mistakenly detected presence sample lines caused within image zones each representing no vehicle body to be corrected.
    </p>
    <p num="152">
      In step P7a, a threshold level TH1 is determined in accordance with an actual route distance from the video camera to locations on the road respectively corresponding to positions of the kth and (k+1)th presence sample lines.
      <br/>
      In step P7b, the sample lines between the kth and (k+1)th presence sample lines are counted.
    </p>
    <p num="153">
      Step P7b is followed by step P7c in which a determination is made upon whether the counted number of the sample lines is smaller than the threshold level TH1 or not.
      <br/>
      If the answer in step P7c is an affirmative "YES", step P7c leads to step P7d in which the sample lines between the kth and (k+1)th presence sample lines are detected as the presence sample lines and added to the previously detected the presence sample lines.
      <br/>
      If the answer in step P7c is a negative "NO", step P7c leads to step P7e.
      <br/>
      By virtue of steps P7e and P7f, steps P7a through P7d are repeated until k is equal to K. The repetition of steps P7a through P7d has the effect of correcting all of the presence sample lines which are included in one of the traffic lanes on the basis of the arrangement of the presence sample lines detected in step P6 shown in FIG. 22.
    </p>
    <p num="154">
      If the presence sample lines detected in step P6 are positioned as shown in FIG. 30(a), the number of the sample lines between the kth and (k+1)th presence sample lines is as follows.
      <br/>
      Between the first presence sample line or the uppermost presence sample line in FIG. 30(a) and the second presence sample line, there, and between the second and third presence sample lines, there is no sample line.
      <br/>
      Between the third and fourth presence sample lines, there are two sample lines in a range L1.
      <br/>
      Between the fourth and fifth presence sample lines, there is no sample line.
      <br/>
      Between the fifth and sixth presence sample lines, there are five sample lines in a range L2.
      <br/>
      Between the sixth and seventh presence sample lines, there are seven sample lines in a range L3.
      <br/>
      Between the seventh and eighth presence sample lines and between the eighth and ninth presence sample lines, there is no sample line.
      <br/>
      When, therefore, the threshold level TH1 is determined to be equal to 3 and constant, only the two sample lines in the range L1 are detected as the presence sample lines and added to the previously detected presence sample lines as understood from FIGS. 30(a) and 30(b).
    </p>
    <p num="155">
      Returning back to FIG. 29 of the drawings, step P7e is followed by step P7g in which the presence sample lines are classified into a plurality of line groups.
      <br/>
      Each of the line groups contains a series of presence sample lines and never includes other types of sample lines.
      <br/>
      In step P7h, the threshold level TH2 utilized for judging the rth line group is determined in accordance with an actual route distance from the video camera to a location on the road corresponding to a position of each of the line groups.
      <br/>
      In step P7i, the presence sample lines contained in the rth line group are counted.
    </p>
    <p num="156">
      Step P7i leads to step P7j in which a judgment is made upon whether the counted number of the presence sample lines is smaller than the threshold level TH2 or not.
      <br/>
      If the answer in step P7j is an affirmative "YES", step P7j leads to step P7k in which all of the presence sample lines contained in the rth line group are eliminated.
      <br/>
      If the answer in step P7j is a negative "NO", step P7j leads to step P7l.
      <br/>
      By virtue of steps P7l and P7m, steps P7g through P7k are repeated until r is equal to R. Note that R is the total number of the line groups contained in one of the traffic lanes within the measurement area.
      <br/>
      The repetition of steps P7g through P7k has the effect of further correcting all of the presence sample lines included in one of the traffic lanes on the basis of the arrangement of the presence sample lines corrected in step P7d.
    </p>
    <p num="157">
      If the presence sample lines detected after step P7d are positioned as shown in FIG. 30(b), the number of the presence sample lines of the rth line group is as follows.
      <br/>
      In the first line group denoted by L4, there are seven presence sample lines.
      <br/>
      In the second line group denoted by L5, there is one presence sample line.
      <br/>
      In the third line group denoted by L6, there are three presence sample lines.
      <br/>
      When, therefore, the threshold level TH2 is determined to be equal to 3 and constant, the presence sample lines of the second line group denoted by L5 are canceled as shown in FIGS. 30(b) and 30(c).
    </p>
    <p num="158">
      The threshold levels TH1 and TH2 determined in steps P7a and P7h may be equal to the number of the sample lines corresponding to quarter of the length of an average vehicle represented in the image.
      <br/>
      As a result, the threshold levels TH1 and TH2 for judging each of the line groups may become smaller as an actual route distance from the video camera to a location on the road corresponding to a position of each of the line groups becomes larger.
      <br/>
      The reason is that the vehicle represented in the image becomes smaller as an actual route distance from the video camera to the vehicle becomes larger.
      <br/>
      While, the threshold levels TH1 and TH2 may become larger as the actual route distance from the video camera to the location on the road corresponding to the position of each of the line groups becomes smaller.
      <br/>
      The reason is that the vehicle represented in the image becomes larger as the actual route distance from the video camera to the vehicle becomes smaller.
      <br/>
      If the threshold levels TH1 and TH2 are determined in this way, the mistakenly detected presence sample lines in any position and the unnoticed presence sample lines in any position can be eliminated and newly detected, respectively, on an accuracy level with one another independently of the actual route distance from the video camera.
    </p>
    <p num="159">
      An example of the process of correcting the presence sample lines on the basis of the arrangement of the difference sample lines, performed in step P8 of FIG. 22, will be described in detail hereinafter with reference to FIG. 31 showing a flowchart formed by steps P8a through P8i.
      <br/>
      The correction process based on the arrangement of the difference sample lines is intended to eliminating the presence sample lines which are detected by mistaking shadows of the vehicles and buildings for the vehicles.
      <br/>
      More specifically, the difference sample lines are simply detected depending upon a difference in brightness between the sample point image taken at the time tn and the criterion brightness image, so that image areas representing the shadows of the vehicles and the shadows of the buildings suddenly produced due to a sharp variation of sunlight are liable to be detected as the presence sample lines.
      <br/>
      For this reason, the presence sample lines mistakenly detected owing to the shadows of the vehicles and buildings are required to be corrected on the basis of the arrangement of the difference sample lines.
    </p>
    <p num="160">
      Step P8a detects line groups each formed by a series of difference sample lines and including no edge sample line.
      <br/>
      The reason why the line groups including no edge sample line are required to be detected is described below.
      <br/>
      In general, edges in the image areas representing shadows can be scarcely detected.
      <br/>
      In addition, brightness levels of the sample points positioned in the image areas representing shadows are relatively small.
      <br/>
      As a result, no edge sample line is usually detected in the image areas representing shadows.
      <br/>
      This means that the image area including edge sample lines may be thought to represent no shadow.
      <br/>
      In step P8b, the threshold level TH1 used for judging the kth line group is determined depending upon an actual route distance from the video camera to a location on the road corresponding to a position of the kth line group.
      <br/>
      In step P8b, the threshold level TH2 is also determined.
      <br/>
      The threshold level TH2 is representative of a certain brightness level.
      <br/>
      In step P8c, the difference sample lines contained in kth line group are counted.
    </p>
    <p num="161">
      Step P8c is followed by step P8d in which a judgment is made upon whether the counted number of the difference sample lines exceeds the threshold level TH1 or not.
      <br/>
      If the answer in step P8d is an affirmative "YES", step P8d leads to step P8e.
      <br/>
      Step P8e calculates a mean value BM indicative of a mean of the brightness levels of the sample lines which is in the sample point image taken at the time tn and which corresponds to the difference sample lines contained in the kth line group.
      <br/>
      If the answer in step P8d is a negative "NO", step P8d leads to step P8h.
    </p>
    <p num="162">
      Step P8e leads to step P8f in which a judgment is made upon whether the mean value BM is smaller than the threshold level TH2.
      <br/>
      If the answer in step P8f is an affirmative "YES", step P8f leads to step P8g in which the presence sample lines corresponding in position to the difference sample lines, respectively, contained in the kth line group are eliminated.
      <br/>
      If the answer in step P8f is a negative "NO", step P8f leads to step P8h.
      <br/>
      By virtue of steps P8h and P8i, steps P8b through P8g are repeated until k is equal to K. The repetition of steps P8b through P8i has the effect of correcting all of the presence sample lines contained in one of the traffic lanes within the measurement area, on the basis of the arrangement of the difference sample lines.
    </p>
    <p num="163">
      The threshold level TH1 determined in step P8b may be equal to the number of the sample lines corresponding to quarter of the length of an average vehicle represented in the image.
      <br/>
      As a result, the threshold level TH1 for judging each of the line groups may become smaller as an actual route distance from the video camera to a location on the road corresponding to a position of each of the line groups in the image becomes larger.
      <br/>
      The reason is that the vehicle represented in the image becomes smaller as an actual route distance from the video camera to the vehicle becomes larger.
      <br/>
      While, the threshold level TH1 may become larger as the actual route distance from the video camera to the location on the road corresponding to the position of each of the line groups in the image becomes smaller.
      <br/>
      The reason is that the vehicle represented in the image becomes larger as the actual route distance from the video camera to the vehicle becomes smaller.
      <br/>
      If the threshold level TH1 is determined in this way, the presence sample lines mistakenly detected due to the shadows can be eliminated on an accuracy level with one another independently of the actual route distance from the video camera.
    </p>
    <p num="164">The process of detecting the movement sample points performed in step P9 of FIG. 22 will be described in detail with reference to FIG. 32 showing a flowchart formed by steps P9a through P9g.</p>
    <p num="165">
      In step P9a, the movement sample points are detected.
      <br/>
      Because the detection process is described in detail in the aforesaid first embodiment with reference to FIG. 10, the description of the detection process will be omitted herein to avoid the repeating the description.
    </p>
    <p num="166">
      In step P9b, a threshold level TH1 used for judging the kth sample line is determined on the basis of an actual route distance from the video camera to a location on the road corresponding to a position of the kth sample line.
      <br/>
      In step P9c, the movement sample points on the kth sample line are counted.
    </p>
    <p num="167">
      Step P9c is followed by step P9d in which a judgment is made upon whether the counted number of the movement sample points exceeds the threshold level TH1 or not.
      <br/>
      If the answer in step P9d is an affirmative "YES", step P9d leads to step P9e in which the kth sample line is detected as the movement sample line.
      <br/>
      If the answer in step P9d is a negative "NO", step P9d leads to step P9f.
      <br/>
      Steps P9f and P9g cause steps P9b through P9e to be repeated until k is equal to K. The repetition of steps P9b through P9e has the effect of detecting all of the movement sample lines contained in one of the traffic lanes within the measurement area.
    </p>
    <p num="168">
      The threshold level TH1 in step P9b may be determined as follows.
      <br/>
      The threshold level TH1 for judging each of the sample lines may become smaller as an actual route distance from the video camera to a location on the road corresponding to a position of each of the sample lines becomes larger.
      <br/>
      If the threshold level TH1 is thus varied in accordance with the position of each sample line, the movement sample lines in any position can be detected on an accurate level with one another independently of the actual route distance from the video camera to the location on the road corresponding to the position of each of the sample lines.
    </p>
    <p num="169">
      An example of the process of correcting the presence sample lines performed in step P10 of FIG. 22 in accordance with the arrangement of the movement sample lines will be described in detail hereinafter with reference to FIG. 33 showing a flowchart formed by steps P10a through P10g.
      <br/>
      The correction process based on the arrangement of the movement sample lines is performed with the intention of compensating the presence sample lines which are omitted in steps P7a through P7f shown in FIG. 29 and which are located within an image area representing a vehicle body.
      <br/>
      If, more specifically, there is a vehicle on the road having a body image which forms a small contrast with the criterion brightness image and within which the variation in brightness is small, the presence of the vehicle can be scarcely detected as the difference sample lines or edge sample lines.
      <br/>
      The omitted detection cannot be compensated through the foregoing steps P7a to P7f.
      <br/>
      Because there is a possibility that the presence of the vehicle thus omitted can be detected as the movement sample lines, the omitted present sample lines are compensated on the basis of the arrangement of the movement sample lines.
    </p>
    <p num="170">
      In step P10a, threshold levels TH1 and TH2 for judging the kth and (k+1)th presence sample lines are determined depending upon at least one of two actual route distances, one of the two actual route distances being from the video camera to a location on the road corresponding to a position of the kth presence sample line in the image, and the other of the two actual route distances being from the video camera to a location on the road corresponding to a position of the (k+1)th presence sample line in the image.
      <br/>
      Note that TH1&lt;TH2 and that the threshold level TH1 in step P10a may be equal to that in step P7a shown in FIG. 29. If both the threshold levels TH1 are equal to each other, an object of the compensation through steps P10a to P10g can be limited to the omitted presence sample lines which cannot be compensated through steps P7a to P7f, thereby making it possible to prevent useless correction processes from being performed and prevent essential correction processes from being omitted.
    </p>
    <p num="171">
      Step P10b counts the sample lines between the kth and (k+1)th presence sample lines.
      <br/>
      In step P10c, a judgment is made upon whether the counted number of the sample lines is equal to or larger than the threshold level TH1 or not and smaller than the threshold level TH2 or not.
      <br/>
      If the answer in step P10c is an affirmative "YES", step P10c leads to step P10d.
      <br/>
      If the answer in step P10c is a negative "NO", step P10c leads to step P10f.
    </p>
    <p num="172">
      Step P10c leads to step P10d in which a judgment is made upon whether there is at least one movement sample line between the kth and (k+1)th presence sample lines or not.
      <br/>
      If the answer in step P10d is an affirmative "YES", step P10d leads to step P10e.
      <br/>
      In step P10e, the sample lines interposed between the kth and (k+1)th presence sample lines and comprising the movement sample line are newly detected as the presence sample lines and added to the previously detected presence sample lines.
      <br/>
      If the answer in step P10d is a negative "NO", step P10d leads to step P10f.
      <br/>
      By virtue of steps P10f and P10g, steps P10a through P10e are repeated until k is equal to K. The repetition of steps P10a through P10e has the effect of correcting all of the presence sample lines in one of the traffic lanes located within the measurement area, on the basis of the arrangement of the movement sample lines.
    </p>
    <p num="173">
      The presence sample lines and the movement sample line obtained in steps P8 and P9 are positioned as shown in FIG. 34(a).
      <br/>
      The number of the sample lines between the kth and (k+1)th presence sample lines is as follows.
      <br/>
      There is no sample line between any two adjoining presence sample lines of the first or uppermost through the seventh presence sample lines.
      <br/>
      There are three sample lines between the seventh and eighth presence sample lines, i.e., in a range denoted by "L7".
      <br/>
      There is no sample line between any two adjoining presence sample lines of the eighth through tenth presence sample lines.
      <br/>
      There are six sample lines between the tenth and eleventh presence sample lines, i.e., in a range denoted by L8.
      <br/>
      There is no sample line between any two adjoining presence sample lines of the eleventh through fourteenth presence sample lines.
      <br/>
      In the meantime, there is one movement sample line in the range L7 and there is no movement sample line in the range L8.
      <br/>
      If, therefore, the threshold level TH1 is determined to be equal to 3 and be constant and threshold level TH2 is determined to be equal to 5 and be constant, the sample lines in the range L7 are newly detected as the presence sample lines as shown in FIGS. 34(a) and 34(b).
    </p>
    <p num="174">
      In step P10a, the threshold levels TH1 and TH2 may be determined to be equal to the number of the sample lines corresponding to a quarter and a half, respectively, of the length of an average vehicle represented in the image.
      <br/>
      As a result, the threshold levels TH1 and TH2 used for judging the sample lines between the kth and (k+1)th presence sample lines may become smaller as an actual route distance from the video camera to a location on the road corresponding to a position of the kth or (k+1)th of the presence sample line becomes larger.
      <br/>
      The reason is that the vehicle represented in the image becomes smaller as an actual route distance from the video camera to the vehicle becomes larger.
      <br/>
      While, the threshold levels TH1 and TH2 may become larger as the actual route distance from the video camera to the location on the road corresponding to the position of the kth or (k+1)th of the presence sample line becomes smaller.
      <br/>
      The reason is that the vehicle represented in the image becomes larger as the actual route distance from the video camera to the vehicle becomes smaller.
      <br/>
      If the threshold levels TH1 and TH2 are determined in this way, the omitted presence sample lines can be newly detected on an accuracy level with one another independently of the actual route distance from the video camera.
    </p>
    <p num="175">
      FIG. 35 shows the mesh sections into which the measurement area divided in step P11 shown in FIG. 22. Each of the mesh sections may become larger in longitudinal length as an actual route distance from the video camera to a location on the road corresponding to a position of each of the mesh sections in the image becomes smaller.
      <br/>
      If the size of each of the mesh sections is thus determined depending upon the actual route distance from the video camera to the location on the road corresponding to the position of each of the mesh sections, the mesh sections respectively represents actual road sections which are substantially equal in size to one another.
    </p>
    <p num="176">In step P12 of FIG. 22, the spatial density of each of the mesh sections is calculated by an equation described below.</p>
    <p num="177">D(m)=PSL(m)/TSL(m)  (vi)</p>
    <p num="178">
      wherein D(m) is a spatial density of the mth mesh section, PSL(m) is the number of the presence sample lines included in the mth mesh section, TSL(m) is the total number of the sample lines contained in the mth mesh section.
      <br/>
      If the presence sample lines are positioned as shown in FIG. 35, the spatial density of each of the mesh sections are as follows.
      <br/>
      The spatial density of the mesh section denoted by M1 is 33%, the spatial densities of the mesh sections respectively denoted by M2, M3 and M4 are 100%, the spatial density of the mesh section denoted by M5 is 75%, the spatial density of the mesh section denoted by M6 is 0% and the spatial density of the mesh section denoted by M7 is 80%.
    </p>
    <p num="179">In step P13 of FIG. 22, the ratio of the large-sized vehicles to all of the vehicles is calculated in a manner described below.</p>
    <p num="180">By the following equation, is firstly calculated a ratio Rt of the large-sized vehicles to all of the vehicles which are lying in the traffic flow measurement area F shown in FIG. 21 for a predetermined time such as 5 or 10 minutes.</p>
    <p num="181">Rt=NL /NT  (vii)</p>
    <p num="182">
      wherein NL is the number of the large-sized vehicles passing over the sense line DL shown in FIG. 21, and NT is the number of all of the vehicles passing over the sense line DL.
      <br/>
      In the traffic flow measurement area F shown in FIG. 21, not only the number of vehicles passing over the are F is detected but also the vehicles passing over the area F are judged to be large-sized or average-sized.
      <br/>
      The ratio Rt is calculated depending upon the results of the detection and the judgment.
    </p>
    <p num="183">
      In step P14 of FIG. 22, the inter vehicle gaps of the vehicles are calculated as follows.
      <br/>
      The inter vehicle gaps of the vehicles can be scarcely measured directly depending upon the image information from the video camera.
      <br/>
      For this reason, in practice the velocities of the vehicles or the number of the passing vehicles per predetermined time are substituted for the inter vehicle gaps because of the fact that the velocities of the vehicle or the number of the passing vehicles per predetermined time are expected to be in proportion to the inter vehicle gaps.
    </p>
    <p num="184">
      In step P15 of FIG. 22, the spatial densities are corrected depending upon the ratio of the large-sized vehicles to all of the vehicles and the inter vehicle gaps in the following manner.
      <br/>
      The correction process based on the ratio of the large-sized vehicles to all of the vehicle is performed with the intention of correcting the spatial densities calculated depending upon a seeming vehicle presence space.
    </p>
    <p num="185">
      If the vehicle shown by a hatched area shown in FIG. 36 is a large-sized vehicle, the seeming vehicle presence space seemingly occupied by the vehicle is extremely larger than an actual vehicle presence spaces shown by the hatched area.
      <br/>
      The spatial densities based on the seeming vehicle presence area are corrected in the present step P15.
    </p>
    <p num="186">
      If the average height and average length of all of the vehicles is represented by ha and la, respectively, which are calculated by equations defined as follows:
      <br/>
      ha=Rt * hL +(1-Rt) * hs  (viii)
      <br/>
      la=Rt * lL +(1-Rt) * ls  (ix)
    </p>
    <p num="187">wherein hL is the height of the large-sized vehicle, hS is the height of the average-sized vehicle, lL is the length of the large-sized vehicle, and lS is the length of the average-sized vehicle.</p>
    <p num="188">
      As shown in FIG. 36, the vehicle represented by the hatched area makes a hiding area lh defined by the following equation.
      <br/>
      lh=ha * L/(H-ha)  (x)
    </p>
    <p num="189">wherein H is a height from a road surface to the video camera and L is a distance from the video camera to the forward end of the large-sized vehicle.</p>
    <p num="190">By the following equation with lh and la, is calculated a correction coefficient Re which are used for correcting the seeming vehicle presence space to the actual vehicle presence space.</p>
    <p num="191">Re=la/(la+lh)  (xi)</p>
    <p num="192">
      The number, the types such as large-sized type and average-sized type, and the lengths of the passing vehicles can be measured in the traffic flow measurement area F shown in FIG. 21 as described hereinbefore.
      <br/>
      Based on the results of the measurement in the traffic flow measurement area F, the correction coefficient Re may be calculated.
      <br/>
      In addition, the correction coefficient Re thus calculated may be used for correcting the measurement result in part of the spatial measurement area E that does not lap on the traffic flow measurement area F. In the traffic flow measurement area F, since the length of each individual vehicle can be directly measured, the correction coefficients may be calculated for each individual vehicle.
    </p>
    <p num="193">
      If the inter vehicle gaps are relatively large, the correction coefficient Re may be used as it is.
      <br/>
      If, however, the inter vehicle gaps are relatively small, i.e., if the vehicles represented in the image taken by the video camera are overlapping with one another, the correction coefficient Re calculated by the equation (xi) is required to be increased.
      <br/>
      Specifically, the correction coefficient Re may be set more approximately to the value calculated by the equation (xi) as the inter vehicle gaps become larger.
      <br/>
      In addition, the correction coefficient Re may be set more approximately to "1" as the inter vehicle gaps become smaller.
    </p>
    <p num="194">
      In the spatial measurement area E, the traffic congestion measuring unit cannot derive traffic data from sensing devices except the video camera.
      <br/>
      If, therefore, the inter vehicle gaps are relatively small, i.e., if the vehicles represented in the image taken by the video camera are overlapping with one another, the traffic congestion measuring unit cannot detect the inter vehicle gaps.
      <br/>
      For this reason, other measurement values varied in proportion to the inter vehicle gaps may be substituted for the inter vehicle gaps.
      <br/>
      The other measurement values include, for example, the following spatial velocities and the number of the passing vehicles per predetermined time detected in the traffic flow measurement area F. Specifically, the correction coefficient Re may be set more approximately to the value calculated by the equation (xi) as the spatial velocity becomes larger.
      <br/>
      As the spatial velocity becomes smaller, the coefficient Re may be set more approximately to "1".
      <br/>
      On the other hand, the correction coefficient Re may be set more approximately to the value calculated by the equation (xi) as the number of the passing vehicles becomes smaller.
      <br/>
      As the number of the passing vehicles becomes larger, the correction coefficient Re may be set more approximately to "1".
    </p>
    <p num="195">In step P15 of FIG. 22, the spatial density is corrected by multiplying the spatial density of each mesh section by the correction coefficient Re calculated and corrected in the foregoing manner.</p>
    <p num="196">The process of calculating the spatial velocities performed by the traffic congestion measuring unit 82 will be summarily described with reference to FIG. 37 showing a flowchart formed by steps Q1 through Q15.</p>
    <p num="197">
      In step Q1, the sample point images are formed from two images respectively taken at time tn and time tn + GAMMA .
      <br/>
      In step Q2, is calculated, line brightness mean values each indicative of a mean of the brightness levels of the sample points on each of the sample lines for each sample point image.
    </p>
    <p num="198">
      In step Q3, movement sample lines are detected from the sample point image taken at the time tn.
      <br/>
      The process of detecting the movement sample lines is shown by the foregoing flowchart shown in FIG. 32, so that the description of the detection process will be omitted herein with the intention of avoiding the repeated description thereof.
    </p>
    <p num="199">
      In step Q4, are detected as post-movement sample lines, the sample lines in the image taken at the time tn + GAMMA , to which the movement sample lines is expected to be respectively transferred from the image taken at the time tn.
      <br/>
      In step Q5, are calculated, velocities of the movement sample lines on the basis of which the post-movement sample lines, respectively, can be detected.
    </p>
    <p num="200">
      In step Q6, the sample point image taken at the time tn is divided into a plurality of mesh sections.
      <br/>
      In step Q7, is calculated, mean velocities each indicative of a mean of the velocities of the movement sample lines included in each of the mesh section.
      <br/>
      In step Q8, is calculated a ratio of the movement sample lines to all of the sample lines contained in the kth mesh section.
      <br/>
      At this time, objects of the ratio calculations are not all of the movement sample lines but only the movement sample lines on the basis of which the post-movement sample lines, respectively, can be detected.
    </p>
    <p num="201">
      Step Q8 is followed by step Q9 in which a judgment is made upon whether the calculated ratio of the movement sample lines included in the kth mesh section is larger than a predetermined threshold level or not.
      <br/>
      If the answer in step Q9 is an affirmative "YES", step Q9 leads to step Q10 in which the mean velocity of the movement sample lines included in the kth mesh section is detected as the spatial velocity in the kth mesh section.
      <br/>
      If the answer in step P9 is a negative "NO", step Q9 leads to step Q11 in which the spatial velocity in the kth mesh section is set to 0 km/h.
    </p>
    <p num="202">
      When step Q10 leads to step Q12, the spatial velocity in the kth mesh section is smoothed through exponential smoothing techniques.
      <br/>
      By virtue of steps Q13 and Q14, steps Q7 through Q12 are repeated until k is equal to K. The repetition of steps Q7 through Q12 has the effect of calculating the spatial velocities of all of the mesh sections in the sample point image taken at the time tn.
    </p>
    <p num="203">
      Steps Q1 through Q15 are repeated at regular intervals.
      <br/>
      FIG. 38 summarily shows relationships between the results of the detection and the calculation in steps Q1 through Q15.
    </p>
    <p num="204">A first example of the process of detecting the post-movement sample lines performed in step Q4 shown in FIG. 37 will be described in detail hereinlater with reference to FIG. 39 showing a flowchart formed by steps Q4a through Q4g.</p>
    <p num="205">
      In step Q4a, a prospective post-movement area in the sample point image taken at the time tn + GAMMA  is calculated depending upon the time interval  GAMMA  and the position of the kth movement sample line in the sample point image taken at the time tn.
      <br/>
      The kth movement sample line is expected to be transferred from the sample point image taken at the time tn into the prospective post-movement area in the sample point image taken at the time tn + GAMMA .
      <br/>
      In step Q4b, is calculated, absolute brightness difference values each indicative of an absolute value of a difference in brightness between the kth movement sample line in the sample point image taken at the time tn and each of the sample lines contained in the prospective post-movement area in the sample point image taken at the time tn+ GAMMA .
    </p>
    <p num="206">
      Step Q4b is followed by step Q4c in which a judgment is made upon whether the smallest one of the absolute brightness difference values is smaller than a predetermined threshold level or not.
      <br/>
      If the answer in step Q4c is an affirmative "YES", step Q4c leads to step Q4d in which the sample line in the prospective post-movement area taking part in a production of the smallest absolute brightness difference value is detected as the post-movement sample line to which the kth movement sample line is expected to be transferred.
      <br/>
      If the answer in step Q4c is a negative "NO", step Q4c leads to step Q4e in which a decision that there is no post-movement sample point to which the kth movement sample line is expected to be transferred is made.
      <br/>
      By virtue of steps Q4f and Q4g following steps Q4d and Q4e, steps Q4a through Q4e are repeated until k is equal to K. The repetition of steps Q4a through Q4e has the effect of making judgments whether or not there is a post-movement sample line to which each of all the movement sample lines is expected to be transferred and detecting the position of the post-movement sample line.
    </p>
    <p num="207">A second example of the process of detecting the post-movement sample lines performed in step Q4 shown in FIG. 37 will be described in detail hereinlater with reference to FIG. 40 showing a flowchart formed by steps Q4A through Q4M.</p>
    <p num="208">
      In step Q4A, a first prospective post-movement area in the sample point image taken at the time tn + GAMMA  is calculated depending upon the time interval  GAMMA  and the position of the kth movement sample line in the sample point image taken at the time tn.
      <br/>
      The kth movement sample line is expected to be transferred from the sample point image taken at the time tn into the first prospective post-movement area in the sample point image taken at the time tn + GAMMA .
      <br/>
      In step Q4B, second and third prospective post-movement areas are determined.
      <br/>
      The second prospective post-movement area partially forms the sample point image taken at the time tn + GAMMA  and is deviated upstream by one line pitch from the first prospective post-movement area.
      <br/>
      The third prospective post movement area partially forms the sample point image taken at the time tn + GAMMA  and is deviated downstream from the first prospective post-movement area by one line pitch.
    </p>
    <p num="209">In step Q4C, is calculated an absolute brightness difference value U1 indicative of an absolute value of a difference in brightness between the kth movement sample line in the sample point image taken at the time tn and the mth sample line contained in the first prospective post-movement area in the sample point image taken at the time tn + GAMMA .</p>
    <p num="210">In step Q4D, is calculated an absolute brightness difference value U2 indicative of an absolute value of a difference in brightness between the sample line immediately adjacent to and positioned on the upstream side of the kth movement sample line in the sample point image taken at the time tn and the mth sample line included in the second prospective post-movement area in the sample point image taken at the time tn + GAMMA .</p>
    <p num="211">In step Q4E, is calculated an absolute brightness difference value U3 indicative of an absolute value of a difference in brightness between the sample line immediately adjacent to and positioned on the downstream side of the kth movement sample line in the sample point image taken at the time tn and the mth sample line included in the third prospective post-movement area in the sample point image taken at the time tn + GAMMA .</p>
    <p num="212">
      In step Q4F, the absolute brightness difference values U1, U2 and U3 are added to calculate a sum Um.
      <br/>
      Owing to steps Q4G and Q4H, steps Q4C through Q4F are repeated until m is equal to M. The repetition of steps Q4C through Q4F has the effect of calculating all of the absolute brightness difference values U1 resulting from the movement sample line and all of the sample lines contained in the first prospective post-movement area, all of the absolute brightness difference values U2 resulting from the sample line upstream adjoining the movement sample line and all of the sample lines contained in the second prospective post-movement area, and all of the absolute brightness difference values U3 resulting from the sample line downstream adjoining the movement sample line and all of the sample lines contained in the third prospective post-movement area.
      <br/>
      The repetition further has the effect of calculating all of the sums each indicative of a sum of each absolute brightness difference value U1, U2 and U3.
    </p>
    <p num="213">
      In step Q4I, a judgment is made upon whether the smallest one of the sums Um is smaller than a predetermined threshold level or not.
      <br/>
      If the answer in step Q4I is an affirmative "YES", step Q4I leads to step Q4J in which the sample line in the first prospective post-movement area taking part in a production of the smallest sum Um is detected as the post-movement sample line to which the kth movement sample line is expected to be transferred.
      <br/>
      If the answer in step Q4I is a negative "NO", step Q4I leads to step Q4K in which a decision that there is no sample line expected to be transferred from the kth movement sample line is made.
    </p>
    <p num="214">By virtue of steps Q4L and Q4M, steps Q4A through Q4K are repeated until k is equal to K. The repetition of steps Q4A through Q4K has the effect of detecting all of the post-movement sample lines in the sample point image at the time tn + GAMMA , to which the movement sample line in the sample point image taken at the time tn are expected to transferred.</p>
    <p num="215">
      If one movement sample line MVd is positioned as shown in FIG. 41(a), a first post-movement area PA1 into which the movement sample line is expected to be transferred positions as shown in FIG. 41(b).
      <br/>
      At the same time, second and third post-movement areas PA2 and PA3 are positioned as shown in FIG. 41(b).
      <br/>
      If three sample lines located at positions b, b-1 and b+1, respectively, in the sample point image taken at the time tn + GAMMA  shown in FIG. 41(b), take part in a production of the smallest one of the sums calculated in step Q4F, the sample line located at the position b is representative of a post-movement sample line to which the movement sample line MVd is expected to be transferred.
    </p>
    <p num="216">In step Q5 shown in FIG. 37, the velocity Vk of each of the movement sample lines is calculated in accordance with an equation described below.</p>
    <p num="217">Vk=(Lb-La)/ GAMMA   (xii)</p>
    <p num="218">wherein La is indicative of a coordinate of each of the sample lines in an axis which is formed on sample point image at the time tn and which extends along the road, and Lb is indicative of a coordinate of each of locations, to which each of the movement sample lines is expected to be transferred, in an axis formed on sample point image at the time tn + GAMMA  and extending along the road.</p>
    <p num="219">In step Q12 shown in FIG. 37, the exponential smoothing process for the spatial velocity is performed in accordance with an equation described below.</p>
    <p num="220">V(m,tn)=(1- THETA ) * V(m,tn-1)+ THETA  * V(m,tn) (xiii)</p>
    <p num="221">
      wherein V(m,tn) is a spatial velocity in the mth mesh section at the time tn, V(m,tn-1) is a spatial velocity in the mth mesh section at the time tn-1, and  THETA  is an exponential coefficient and defined 0&lt; THETA &lt;1.
      <br/>
      By performing the exponential smoothing process, noises can be eliminated.
    </p>
    <p num="222">A first example of the process of detecting the tail position of the traffic congestion range performed by the traffic congestion measuring unit 82 will be described in detail hereinlater with reference to FIG. 42 showing a flowchart formed by steps Z1 through Z4.</p>
    <p num="223">In step Z1, the spatial velocity of each mesh section is calculated in either of the following two calculation manners.</p>
    <p num="224">One of the calculation manners is represented by the flowchart shown in FIG. 37.</p>
    <p num="225">In the other of the calculation manners, the spatial velocity V(m,tn) is calculated by the following equation as using the spatial density calculated in accordance with the flowchart shown in FIG. 22 and the traffic quantity measured in the traffic flow measurement area F shown in FIG. 21.</p>
    <p num="226">V(m,tn)=(q(tn) * la)/d(m,tn)  (ix)</p>
    <p num="227">wherein q(tn) is traffic quantity per predetermined time in the spatial measurement area at the time tn, la is an average length of the vehicles lying in the spatial measurement area at the time tn, and d(m,tn) is a spatial density of the mth mesh section.</p>
    <p num="228">In order to eliminate noises, the spatial velocity V(m,tn) is smoothed through exponential smoothing techniques according to an equation described below.</p>
    <p num="229">V(m,tn)=(1- MU ) * V(m,tn-1)+ MU  * V(m,tn)  (xv)</p>
    <p num="230">wherein  MU  is an exponential coefficient and defined by 0&lt; MU &lt;1.</p>
    <p num="231">In step Z2, an averaged spatial velocity is calculated by the following equation in order to eliminate noises and an influence of the distribution of the traffic congestion.  (Equation image '1' not included in text)</p>
    <p num="232">wherein Mv(m) is averaged spatial velocity in the mth mesh section, and M is the total number of the mesh sections.</p>
    <p num="233">
      In step Z3, the mesh sections each having Mv(m) smaller than Cv are detected as a traffic congestion range.
      <br/>
      Note that Cv is a predetermined velocity.
      <br/>
      If the road shot by the video camera is a highway, Cv is set to 40 km/h.
      <br/>
      If the road shot by the video camera is a street, Cv is set to 20 km/h.
      <br/>
      In step Z4, the upstream end of the traffic congestion range is detected as a tail position of the traffic congestion.
      <br/>
      FIG. 45 shows relationships between the mesh sections, traffic congestion range, and the tail position of the traffic congestion.
    </p>
    <p num="234">A second example of the process of detecting the tail position of the traffic congestion range performed by the traffic congestion measuring unit 82 will be described in detail hereinlater with reference to FIG. 43 showing a flowchart formed by steps Z1' through Z4'.</p>
    <p num="235">
      Step Z1' counts the movement sample points included in each of the mesh sections.
      <br/>
      In step Z2', a movement density Mr(m) is calculated by dividing the counted number of the movement sample points included in each mesh section by the total number of the sample points contained in each mesh section.
    </p>
    <p num="236">
      In step Z3', the mesh sections each having the spatial density D(m) larger than a predetermined threshold level C1 and the movement density Mr(m) smaller than a predetermined threshold level C2 are detected as a traffic congestion range.
      <br/>
      In step Z4', the upstream end of the traffic congestion range is detected as a tail position of the traffic congestion.
    </p>
    <p num="237">
      Steps Z1 through Z4 shown in FIG. 42 and steps Z1' through Z4 shown in FIG. 43 are repeated at regular intervals.
      <br/>
      FIG. 44 summarily shows relationships between the required image data, and the results of the detection and the calculation in steps Z1 through Z4 and Z1' through Z4'.
    </p>
    <p num="238">
      The traffic congestion measuring units 82 shown in FIG. 20 are operated to transmit, to the central control unit 100 in the traffic control center, the spatial densities measured in accordance with the flowchart shown in FIG. 22, the spatial velocities measured in accordance with the flowchart shown in FIG. 37, the tail position of the traffic congestion measured in accordance with the flowchart shown in FIG. 42 or 43, and the various measurement results derived from the traffic flow measurement area F shown in FIG. 21. The central control unit 100 is operated to produce traffic information useful to vehicle drivers who are driving on the highway shot by the video cameras 81 and transmit the traffic information to the display control unit 92.
      <br/>
      The information display board 91 is controlled by the display control unit 92 to display the traffic information on its own screen.
    </p>
    <p num="239">
      According to the second embodiment, not all of the picture elements contained in the image but the sample points corresponding to part of the picture elements contained in the image are processed, so that data produced during the calculation processes can be extremely decreased in quantity.
      <br/>
      Hence, the traffic congestion measuring apparatus can be simplified in hardware and reduced in cost.
      <br/>
      In addition, the traffic congestion measuring apparatus can process the image at high speed and, accordingly, measure the state of traffic congestion in real time.
    </p>
    <p num="240">
      Because the presence and the movement of the vehicle is detected by processing brightness per sample line, the spatial velocity and the spatial density in each of the mesh sections can be detected.
      <br/>
      If the traffic congestion measuring apparatus is regulated so as to result in the fact that an area occupied by the vehicle which is moving at 40 km/h or lower is detected as a traffic congestion range, the traffic congestion measuring apparatus can directly measure, in real time, the velocities and the density of the vehicles lying in the measurement area, thereby making it possible to produce the detailed traffic information.
      <br/>
      The second embodiment has a great advantage in traffic control system for highways.
    </p>
    <p num="241">
      It is possible that the traffic congestion measuring apparatus starts to measure the state of the traffic congestion without the previously leaning and with accuracy immediately after the setup of the apparatus is completed.
      <br/>
      In addition, the traffic congestion measuring apparatus can be stably operated to measure the state of the traffic congestion independently of the variations in circumstances such as locations, time, weather and traffic densities.
      <br/>
      The traffic congestion measuring apparatus can also measure the traffic queue length with ease.
    </p>
    <p num="242">
      Each of the various parameters serving as criterion levels in the various judgments is varied in accordance with an actual route distance from the video camera to a location on the road corresponding to a position of each of the sample points, so that the results of the measurement is enhanced in accuracy.
      <br/>
      Since the various parameters are automatically determined in accordance with the actual route distance from the video camera to the location on the road corresponding to the position of each of the sample points, the traffic control system is managed with great facility.
    </p>
    <p num="243">
      If a large number of video cameras and traffic congestion measuring apparatuses are arranged along the road at regular space intervals each corresponding to the length of the measurement area of each video camera, the state of traffic congestion can be measured over long distance.
      <br/>
      In the present embodiment, the state of traffic congestion in the whole measurement area is not estimated from measurement results in a local part of the measurement area but directly measured, thereby enabling the traffic control system to quickly detect various accidents such as traffic accidents or vehicular accidents.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A traffic congestion measuring method of measuring a state of traffic congestion on the basis of a motion picture which represents a road and vehicles coming and going on said road and is formed by a series of images taken by a video camera, comprising the steps of:</claim-text>
      <claim-text>(a) forming a criterion brightness image which is taken by said video camera and in which the vehicle is expected to be absent; (b) detecting the vehicles represented in one of said series of images taken at a predetermined time on the basis of said criterion brightness image and the image taken at said predetermined time; (c) renewing said criterion brightness image after said step (b);</claim-text>
      <claim-text>and (d) repeating said steps (b) and (c) at predetermined regular intervals, said criterion brightness image being renewed in said step (c) by an equation described as follows:  wherein Xn is a brightness level of each of picture elements forming the image taken at time tn, Bn is a brightness level of each of picture elements forming the criterion brightness image which is utilized for detecting the vehicles represented in the image taken at said time tn, Bn+1 is a brightness level of each of picture elements forming the criterion brightness image which is utilized for detecting the vehicles represented in the image taken at time tn+1, each of said predetermined regular intervals is equal to tn+1 -tn, and  ETA  is a variable coefficient decreased in proportion as .vertline.xn -Bn.vertline. becomes large and as a level of the traffic congestion on said road is increased.</claim-text>
    </claim>
  </claims>
</questel-patent-document>