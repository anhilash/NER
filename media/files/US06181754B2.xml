<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06181754B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06181754</doc-number>
        <kind>B2</kind>
        <date>20010130</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6181754</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference is-representative="YES" family-id="22257915" extended-family-id="42108415">
      <document-id>
        <country>US</country>
        <doc-number>09096555</doc-number>
        <kind>A</kind>
        <date>19980612</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1998US-09096555</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>43164867</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>9655598</doc-number>
        <kind>A</kind>
        <date>19980612</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1998US-09096555</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010130</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>H04B   1/30        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>B</subclass>
        <main-group>1</main-group>
        <subgroup>30</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>H04L  27/00        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>27</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>375350000</text>
        <class>375</class>
        <subclass>350000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>375325000</text>
        <class>375</class>
        <subclass>325000</subclass>
      </further-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>H04B-001/30</text>
        <section>H</section>
        <class>04</class>
        <subclass>B</subclass>
        <main-group>1</main-group>
        <subgroup>30</subgroup>
      </classification-ecla>
      <classification-ecla sequence="2">
        <text>H04L-027/00</text>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>27</main-group>
        <subgroup>00</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04L-027/00</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>L</subclass>
        <main-group>27</main-group>
        <subgroup>00</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04B-001/30</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>B</subclass>
        <main-group>1</main-group>
        <subgroup>30</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>1</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>17</number-of-drawing-sheets>
      <number-of-figures>22</number-of-figures>
      <image-key data-format="questel">US6181754</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">System and method for modeling mixed signal RF circuits in a digital signal environment</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>REITMEIER GLENN A, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4432009</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4432009</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>DAPPER MARK J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5878089</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5878089</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="1">
          <text>H.B. Poza, et al., A Wideband Data Link Computer Simulation Model, Proc. NAECON Conf., 1975, pp. 71-78.</text>
        </nplcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="2">
          <text>A. A. Saleh, Frequencey-Independent and Frequency-Dependent Nonlinear Models of TWT Amplifiers, IEEE Trans. Commu., vol. COM29, No. 11, Nov. 1981, pp. 1751-1720.</text>
        </nplcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="3">
          <text>R. Blum, et al., Modeling Nonlinear Amplifiers for Communication Simulation, Conference Record, IEEE Intern. Conf. On Commu., ICC '89, Boston MA, Jun. 1989, pp. 1468-1472.</text>
        </nplcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Cadence Design Systems, Inc.</orgname>
            <address>
              <address-1>San Jose, CA, US</address-1>
              <city>San Jose</city>
              <state>CA</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>CADENCE DESIGN SYSTEMS</orgname>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Chen, Jesse E.</name>
            <address>
              <address-1>Sunnyvale, CA, US</address-1>
              <city>Sunnyvale</city>
              <state>CA</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <orgname>Lyon &amp; Lyon LLP</orgname>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Chin, Stephen</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>EXPIRED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      A behavioral model for mixed signal RF circuits.
      <br/>
      The model approximates non-linear filtering effects for base-band (i.e. suppressed carrier) end-to-end systems analysis.
      <br/>
      The new model, the K-model, is a linear MIMO (multi-input-multi-output) model with output radius corrected by a non-linear SISO (single-input-single output) model and output angle corrected by a non-linear rotation.
      <br/>
      The SISO model uses a multi-tanh structure to synthesize a non-linear filter.
      <br/>
      The multi-tanh structure simulates non-linear behavior by gently switching between transfer functions as the base-band input varies.
      <br/>
      For excursions well into the steady state non-linear region of operation the K-model simulates large-signal base-band transients to within about 10 percent of those simulated with detailed unsuppressed-carrier models.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="1">
      1.
      <br/>
      Field of the Invention
    </p>
    <p num="2">The present invention relates to the field of circuit simulation and more particularly to modeling mixed signal radio frequency (RF) circuits in a digital signal or mixed signal environment.</p>
    <p num="3">2. Description of Background Art</p>
    <p num="4">
      Modern communications systems are digital in nature but they require some analog circuitry.
      <br/>
      Unlike data traveling over traces on a chip, data traveling between geographically different locations must ride on "carriers" that propagate over cables, air, or space.
      <br/>
      Carriers are electromagnetic AC signals with frequencies suited for propagation over long distances.
      <br/>
      The transmitter encodes blocks of digital data into "base-band" analog signals which then modulate a carrier.
      <br/>
      The carrier frequency is much higher than the maximum base-band frequency.
      <br/>
      Modulation and transmission require analog circuitry.
      <br/>
      On the receiver end, analog circuitry amplifies and demodulates the carrier to recover the base-band signal.
      <br/>
      Analog circuitry is a crucial part of a communications link but does not always work perfectly.
      <br/>
      Analog circuitry on either end can distort the signal.
      <br/>
      Various analog and digital signal processing (DSP) techniques reduce and correct distortion.
      <br/>
      Each technique has benefits and costs relative to the system at hand.
      <br/>
      The optimal balance of DSP and analog expense is usually not obvious and hardware iterations cost a lot.
      <br/>
      The means to simulate DSP algorithms and analog circuitry together can reduce the number of hardware iterations by exposing problems early.
    </p>
    <p num="5">
      Ideally one would simulate DSP and analog subsystems together with the analog system modeled in detail.
      <br/>
      But should one use a DSP simulator or an analog simulator? The purely analog approach leads to impractical run times and requires cumbersome analog models of DSP algorithms.
      <br/>
      Since DSP simulators cannot solve analog non-linear differential equations, simulating the analog subsystem in detail requires DSP and analog simulators running in parallel.
      <br/>
      The parallel simulator approach is called "co-simulation".
      <br/>
      The problem with co-simulation is that DSP algorithms operate on the base-band signals while the analog circuit operates on the carrier.
      <br/>
      The wide difference between carrier and base-band time scales makes co-simulation extremely slow at best.
      <br/>
      There is another problem with co-simulation: the necessary detailed analog models reveal design secrets.
      <br/>
      Although vendors of analog intellectual property (IP) would like to supply models to potential customers they do not want to expose their IP to competitors.
    </p>
    <p num="6">
      The most practical alternative to co-simulation is to model the analog circuitry for a DSP simulator.
      <br/>
      The challenge is to capture the relevant base-band distortion in a behavioral model that is easy to extract and implement.
      <br/>
      An extra benefit of behavioral models is that they simulate behavior without revealing design secrets.
      <br/>
      With respect to conventional systems, "relevant base-band distortion" refers to linear distortion, uniform gain compression, frequency-dependent gain compression, and AM-PM conversion.
      <br/>
      The last three distortions are non-linear behaviors.
    </p>
    <p num="7">
      The relevant linear distortion is due to dynamics, the circuit's dependence on input history.
      <br/>
      Models described by linear differential/integral equations are dynamic.
      <br/>
      In contrast, a model described by time-invariant algebraic equations is static: the present output depends only on the present input; there is no dependence on input history; the model has no memory.
      <br/>
      Typical symptoms of linear distortion are dispersion (group delay) and intersymbol interference, things associated with a low pass filter.
    </p>
    <p num="8">
      Uniform gain compression refers to a loss of small signal gain when the input has a large DC offset (a large bias).
      <br/>
      Here, "uniform" implies the gain drops by the same percentage regardless of the frequency of an input sinusoidal perturbation.
      <br/>
      In contrast, "frequency-dependent gain compression" refers to gain compression that varies with perturbation frequency; gain loss still increases with increasing input bias but the loss is not uniform.
    </p>
    <p num="9">AM-PM conversion refers to a phase modulation (PM) of the output caused by an amplitude modulation of the input; the phase of the base-band output varies with the amplitude of the input carrier.</p>
    <p num="10">What is needed is a modeling system for a mixed signal RF circuit in a DSP or mixed signal environment that (1) captures gain compression and static am-pm conversion, (2) captures linear distortion, (3) captures frequency-dependent gain compression and (4) is easy to extract and implement.</p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="11">
      The invention is a system and method for a behavioral model for mixed signal RF circuits.
      <br/>
      The model approximates non-linear filtering effects for base-band (i.e. suppressed carrier) end-to-end systems analysis.
      <br/>
      The new model, the K-model, is a linear MIMO (multi-input-multi-output) model with output radius corrected by a non-linear SISO (single-input-single output) model and output angle corrected by a non-linear rotation.
      <br/>
      The non-linear SISO model uses a multi-tanh structure to synthesize a non-linear filter.
      <br/>
      The multi-tanh structure simulates non-linear behavior by gently switching between transfer functions as the base-band input varies.
      <br/>
      For excursions well into the steady state non-linear region of operation the K-model simulates large-signal base-band transients to within about 10 percent of those simulated with detailed unsuppressed-carrier models
    </p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="12">
      FIG. 1 is an illustration of a set of transfer functions for an RF receiver.
      <br/>
      FIG. 2 is a graphical and mathematical description of a portion of the operation of the non-linear SISO model according to one embodiment of the present invention.
      <br/>
      FIGS. 3(a)-(c) are graphical illustrations of the multi-tanh approximation procedure according to one embodiment of the present invention.
      <br/>
      FIG. 4 is an illustration of the K-model according to a preferred embodiment of the present invention.
      <br/>
      FIG. 4a is an illustration of a technique for implementing the rotation according to one embodiment of the present invention
      <br/>
      FIG. 4b is an illustration of the linear MIMO filter according to one embodiment of the present invention.
      <br/>
      FIG. 4c is an illustration of one embodiment of the non-linear SISO filter.
      <br/>
      FIG. 4d is an illustration of a piece-wise linear function that can be used in an alternate embodiment.
      <br/>
      FIG. 5 is an illustration of the first circuit used to test the preferred embodiment of the present invention.
      <br/>
      FIG. 6 is an illustration of the DC transfer curve, the relationship between base-band output radius and unmodulated input carrier amplitude resulting from the testing of the first circuit.
      <br/>
      FIG. 7 is an illustration of the radial transfer functions extracted at several input biases resulting from the testing of the first circuit using the present invention.
      <br/>
      FIG. 8 is an illustration of the transfer functions normalized for unity DC gain according to the results of the testing of the first circuit using the present invention.
      <br/>
      FIGS. 9a and 9b are illustrations comparing I-Q output trajectories for small and large in-band signals using SpectreRF model and the K-model of the present invention.
      <br/>
      FIGS. 10a and 10b are illustrations of the trajectories for small and large signals at higher frequencies according to the present invention.
      <br/>
      FIG. 11 is an illustration of an RF receiver used during a second test of the present invention.
      <br/>
      FIG. 12 is an illustration of the radial DC transfer curve using the second test circuit computed with SpectreRF and the K-model according to the preferred embodiment of the present invention.
      <br/>
      FIG. 13 is an illustration of a comparison of K-model and SpectreRF simulations for several input levels on the second test circuit according to the preferred embodiment of the present invention.
      <br/>
      FIG. 14 is an illustration comparing simulations using SpectreRF, a linear model, a cascade model, and the K-model of the present invention.
    </p>
    <heading>DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
    <p num="13">
      A preferred embodiment of the present invention is now described with reference to the figures where like reference numbers indicate identical or functionally similar elements.
      <br/>
      Also in the figures, the left most digit of each reference number corresponds to the figure in which the reference number is first used.
    </p>
    <p num="14">
      Wireless receivers have analog circuitry between the antenna and digital signal processing (DSP) components and algorithms.
      <br/>
      The analog front end can introduce linear and non-linear distortion.
      <br/>
      Matched filters, encoders, and equalizers hopefully mitigate noise and distortion.
      <br/>
      The optimal balance of digital and analog complexity is not always obvious or easily specified.
      <br/>
      The only thing obvious is that "optimal" is defined in an end-to-end context.
      <br/>
      This paper describes a way to model the entire analog front end for analysis in a DSP design environment.
      <br/>
      One objective is to see if an existing analog front end design will work in the end-to-end system.
    </p>
    <p num="15">
      There are at least four kinds of behavioral models: linear models, as described in Crols and Steyaert, CMOS Wireless Transceiver Design, Kluwer Academic Publishers, 1997 which is incorporated by reference herein in its entirety, for example, static non-linear models as described in Struble et al., Understanding Linearity in Wireless Communications Amplifiers, IEEE Journal of Solid-State Circuits, September, 1997 which is incorporated by reference herein in its entirety, for example, cascaded models that are described in greater detail herein, and models based on the Volterra series as described in Schetzen, The Volterra &amp; Wiener Theories of Non-Linear Systems, Krieger Publishing Company, 1980 which is incorporated by reference herein in its entirety, for example.
      <br/>
      Linear models simulate linear distortion over a small range of input amplitudes.
      <br/>
      A lone linear model does not exhibit gain compression.
      <br/>
      Static models scale and rotate the complex base-band input signal to generate base-band output.
      <br/>
      The complex plane is a convenient space for representing base-band signals because one carrier has two phases and each phase can be modulated independently.
      <br/>
      If the degree of scaling and rotation depends on the magnitude of the input base-band signal, the static model is non-linear.
      <br/>
      Static non-linear models capture uniform gain compression and static am-pm conversion but not linear distortion.
      <br/>
      One fairly obvious thing to do is to cascade a static non-linear model with a single linear model. "Single linear model" means all outputs have similar impulse responses, i.e., all transfer functions have common poles.
      <br/>
      The cascaded model produces linear distortion, gain compression, and am-pm conversion but not frequency-dependent gain compression.
    </p>
    <p num="16">
      In addition to the effects mentioned above, the K-model also simulates frequency-dependent gain compression.
      <br/>
      The key elements of the K-model are a set of linear filters and a set of hyperbolic tangent functions.
      <br/>
      The K-model drives the linear filters with a multi-tanh structure as described in Gilbert, The Multi-tanh Principle: A Tutorial Overview, IEEE Journal of Solid-State Circuits, January 1998 which is incorporated by reference herein in its entirety, for example.
      <br/>
      The multi-tanh structure was originally developed to synthesize static non-linear functions using transistor circuits.
      <br/>
      The multi-tanh structure in Gilbert, The Multi-tanh Principle: A Tutorial Overview, IEEE Journal of Solid-State Circuits, January 1998 was not developed as general method for modeling linear and non-linear distortion of complex signals.
    </p>
    <p num="17">
      Models based on the Volterra series capture all the effects above but require multi-dimensional convolution.
      <br/>
      The kernels of such convolutions are hard to extract and the integrals are hard to implement.
      <br/>
      The K-model uses only one-dimensional convolutions because its dynamics come from a set of linear models.
      <br/>
      One-dimensional convolutions are far easier to implement than multi-dimensional convolutions.
      <br/>
      The general Wiener model and Gate model, that are described in Schetzen, The Volterra &amp; Wiener Theories of Non-Linear Systems, Krieger Publishing Company, 1980 and referenced above, are variations of the Volterra series expansion.
      <br/>
      They use cascaded one-dimensional convolutions.
      <br/>
      However, the Wiener and Gate models are still harder to extract and implement than the K-model.
    </p>
    <p num="18">
      Communications systems engineers primarily use data flow simulators.
      <br/>
      When a data flow model executes, it receives inputs, generates output, then awaits the next complete set of fresh inputs.
      <br/>
      Data flow through the system determines when each model executes.
      <br/>
      The only possible "convergence" problem occurs when a feedback loop has no delay.
      <br/>
      The only notion of time comes from the sample rate.
      <br/>
      DSP algorithms typically operate only on the information impressed on the RF carrier.
      <br/>
      Consequently, data flow models usually suppress RF carriers.
      <br/>
      Complex variables represent RF signals.
      <br/>
      The real part represents the amplitude of the "in-phase" component of the carrier and the imaginary part represents the amplitude of the quadrature component.
      <br/>
      For example if rf(t) is the instantaneous RF signal and
      <br/>
      rf(t)=a(t)cos(wc t)-b(t)sin(wc t)  Eq. (1)
    </p>
    <p num="19">where wc is the carrier frequency, then the base-band representation is a(t)+jb(t) where</p>
    <p num="20">rf(t)=Re�a(t)+jb(t))exp(jwc t)�  Eq. (2)</p>
    <p num="21">
      Non-linear models of RF circuits are not new.
      <br/>
      It is relatively easy to fit a polynomial to an analytic function.
      <br/>
      Common terms like "IP3" and "IP2", which measure intermodulation distortion, are based on polynomial models as described in Ha, Solid-State Microwave Amplifier Design, Krieger Publishing Company, 1991 which is incorporated by reference herein in its entirety.
      <br/>
      Another approach is to measure the complex gain at several signal levels then interpolate on-the-fly to vary the gain with input signals as described in Struble et al., Understanding Linearity in Wireless Communications Amplifiers, IEEE Journal of Solid-State Circuits, September, 1997 which has been incorporated by reference above.
      <br/>
      Here, gain is defined as a ratio of output to input, not the ratio of incremental output to incremental input.
      <br/>
      One disadvantage of these first two models is that they do not filter the base-band signal--the present output depends only on the present input.
      <br/>
      Such models have no memory and no filtering effects.
      <br/>
      Filtering effects make intermodulation distortion dependent on bit rate as described in Heutmaker et. al, Using Digital Modulation to Measure and Model RF Amplifier Distortion, Applied Microwave and Wireless, March/April 1997 which is incorporated by reference herein in its entirety.
    </p>
    <p num="22">
      Memory can be introduced by cascading a memoryless non-linear model with a linear filter.
      <br/>
      However, the cascade model does not capture amplitude-dependent poles and zeroes.
      <br/>
      FIG. 1 is an illustration of a set of transfer functions for an RF receiver.
      <br/>
      Each transfer function corresponds to a different input signal bias. "Bias" is the amplitude of the unmodulated carrier.
      <br/>
      The transfer functions are defined in terms of incremental quantities.
      <br/>
      A transfer function describes the small signal base-band response to small signal perturbations in the amplitude of the input RF carrier.
      <br/>
      Pole/zero movement is evident because gain compression depends on frequency.
    </p>
    <p num="23">
      Previous work on behavioral models with memory are based on the Volterra series as described in Ha, Solid-State Microwave Amplifier Design, Krieger Publishing Company, 1991, Schetzen, The Volterra &amp; Wiener Theories of Non-Linear Systems, Krieger Publishing Company, 1980, and Verbeyst and Bossche, VIOMAP, the S-Parameter Equivalent for Weakly Nonlinear RF and Microwave Devices, IEEE Transactions on Microwave Theory and Techniques, Vol. 42, No. 12, December, 1994 which are all incorporated by reference herein in their entirety, for example.
      <br/>
      One application of the Volterra series is to derive a frequency-dependent expression for IP3.
      <br/>
      The Volterra series has at least three drawbacks when applied to time-domain simulation: (a) it is difficult to extract, (b) it does not always converge, and (c) it can be as computationally intensive as co-simulation.
      <br/>
      The Wiener model as described in Schetzen, The Volterra &amp; Wiener Theories of Non-Linear Systems, Krieger Publishing Company, 1980 is similar to the Volterra series except the functionals in the expansion are orthogonal when driven by white Gaussian noise.
      <br/>
      Orthogonality circumvents some convergence problems associated with the Volterra series but does not substantially alleviate the difficulties with extraction or implementation.
      <br/>
      In contrast, the K-model of the present invention is a heuristic model and is much easier to extract and implement.
    </p>
    <p num="24">
      FIG. 4 is an illustration of the K-model according to a preferred embodiment of the present invention.
      <br/>
      The K-model consists of three main blocks: a non-linear SISO block 407, a linear MIMO block 406, and a rotation block 405.
      <br/>
      Each of these blocks are described in greater detail below.
    </p>
    <p num="25">
      The K-model includes a non-linear SISO model 407.
      <br/>
      The SISO model can be understood by first considering a memoryless non-linearity, x(r).
      <br/>
      Instead of approximating x(r) directly we start with dx/dr.
      <br/>
      We use fuzzy logic basis functions as described in Li-Xin Wang, Adaptive Fuzzy Systems and Control Design and Stability Analysis, pp. 49-52, PTR Prentice Hall, 1994 which is incorporated by reference herein in its entirety, for example, as a basis to interpolate between dx/dr measurements, then integrate the basis functions with respect to x to obtain an approximation to x(r).
      <br/>
      The integrated basis functions are tanh curves.
      <br/>
      The particular bases, g(r), are somewhat arbitrary.
      <br/>
      FIG. 2 is a graphical and mathematical description of a portion of the operation of the non-linear SISO model according to one embodiment of the present invention.
    </p>
    <p num="26">
      FIGS. 3(a)-(c) are graphical illustrations of the multi-tanh approximation procedure according to one embodiment of the present invention.
      <br/>
      FIG. 3(a) is the original non-linearity shown with short lines that represent slope measurements dx(rk)/dr. FIG. 3(b) shows the weighted tanh curves.
      <br/>
      FIG. 3(c) shows the reconstructed x(r), given by equation (3), along with the original x(r).
      <br/>
      The error is barely noticeable.
      <br/>
      x(r)= SIGMA �(c)tanh �(r-rk)/c� dx(rk)/dr�  Eq. (3)
    </p>
    <p num="27">
      The multi-tanh structure has been used to design programmable amplifiers as described in Gilbert, The Multi-tanh Principle: A Tutorial Overview, IEEE Journal of Solid-State Circuits, January 1998 which was incorporated by reference supra.
      <br/>
      The present invention uses this concept in the modeling arena.
      <br/>
      One approach is to synthesize a non-linear filter, i.e., a non-linear element that has memory, such that the filter's small signal transfer function matches that of the original system regardless of bias.
      <br/>
      The filter is non-linear because the transfer function changes with bias.
    </p>
    <p num="28">To synthesize a non-linear filter we replace the tangent slopes, dx(rk)/dr in equation (3), with small signal transfer functions extracted at the appropriate bias--hk is extracted with the input biased to rk.</p>
    <p num="29">
      The inverse Fourier transform of kth transfer function is the impulse response hk(t).
      <br/>
      Multiplication of the slopes and tanh functions in equation (3) becomes convolution of the impulse responses with the tanh functions.
      <br/>
      Mathematically,
      <br/>
      x(r)= SIGMA K=-N to N.intg.hk ( TAU ) (c)tanh((r(t- TAU )-rk)/c)d TAU   Eq. (4)
    </p>
    <p num="30">
      where 2N+1 is the number of tanh functions, k is the summation index,  TAU  is the integration variable, rk is where the kth tanh function crosses zero, and c equals rN /(2N).
      <br/>
      The tanh curves gently switch between transfer functions as the base-band input signal varies.
    </p>
    <p num="31">
      One objective of the K-model is to simulate an RF front end in a DSP design environment.
      <br/>
      The DSP design environment works primarily with base-band representations of RF signals.
      <br/>
      As indicated above the base-band representation of an RF signal is a complex number.
      <br/>
      Complex numbers can be represented by rectangular coordinates (real and imaginary parts) or polar coordinates (radius and angle), for example.
      <br/>
      In either case the K-model of the preferred embodiment uses two inputs and two outputs.
      <br/>
      The linear MIMO filter 406 gives the K-model its basic filtering properties in a general rectangular fashion.
      <br/>
      Rectangular coordinates avoid the angular discontinuities caused by input trajectories crossing the negative real axis or diving through the origin.
      <br/>
      However, as described infra, non-linear behavior is more conveniently introduced in polar coordinates if one assumes the dominant non-linearity has polar symmetry.
    </p>
    <p num="32">
      The equations below describe a general linear relationship between two inputs and two outputs:
      <br/>
      Yi(t)=K11(t)*Xi(t)+K12(t)*Xq(t)  Eq. (5)
      <br/>
      Yq(t)=K21(t)*Xi(t)+K22(t)*Xq(t)  Eq. (6)
    </p>
    <p num="33">
      where "*" denotes time-domain convolution, X is the base-band input, and Y is the base-band output.
      <br/>
      The linear MIMO filter 406 described in this way is referred to as a complex filter in Crols and Steyaert, CMOS Wireless Transceiver Design, Kluwer Academic Publishers, 1997, referenced above.
      <br/>
      K11, K12, K21, and K22 are elements in a matrix that when post multiplied by the single column matrix �xi xq� results in the single column matrix �yi yq�. K11 is extracted by setting the RF carrier phase to zero, setting the signal bias to early zero, and measuring the small signal transfer function from modulation to "in-phase" base-band output, Yi.
      <br/>
      K21 can be extracted from the same simulation by measuring the transfer function to the "quadrature" output, Yq.
      <br/>
      K22 and K12 are extracted in the same manner but with the carrier phase set to 90 degrees.
    </p>
    <p num="34">
      The rotation block 405 captures static AM-PM conversion as described in Ha, Solid-State Microwave Amplifier Design, Krieger Publishing Company, 1991, for example.
      <br/>
      In contrast, the non-linear SISO block 407 captures AM-PM conversion due to pole zero movement.
      <br/>
      As the unmodulated input carrier amplitude increases, the receiver's output phase can change.
      <br/>
      In terms on the complex plane, as the input vector runs out along the positive real axis, the output vector runs radially outward at an angle.
      <br/>
      At larger input radii, that angle can depend on input radius.
      <br/>
      If the base-band signal is a+jb, the radius is equal to the square root of �a2 +b2 �.
    </p>
    <p num="35">
      The rotation block 405 rotates the input base-band vector according to steady state data taken at several input radii.
      <br/>
      The rotation is a static non-linear function of input radius.
      <br/>
      The next section describes the complete K-model.
    </p>
    <p num="36">
      In many RF receivers the dominant non-linearities depends only on input radius.
      <br/>
      As indicated above FIG. 4, is an illustration of the K-model according to a preferred embodiment of the present invention.
      <br/>
      The K-model operates on base-band input to compute base-band output.
      <br/>
      The K-model is a linear MIMO model with radial and rotational corrections that introduce non-linear behavior.
      <br/>
      Radial and rotational corrections both depend only on input radius.
    </p>
    <p num="37">
      To determine the radial correction the K-model determines the input radius then filters it with two SISO models, one linear 408 and one non-linear 407.
      <br/>
      Both SISO models operate on input radius and compute an output radius.
      <br/>
      The transfer function of the linear SISO model can be a copy of one of the transfer functions inside the non-linear SISO model.
      <br/>
      For example, it can be a copy of the transfer function extracted at the smallest bias.
      <br/>
      The radial correction factor is the ratio of the non-linear SISO model's output to the linear SISO model's output.
      <br/>
      When the input radius is small the correction factor is nearly one.
      <br/>
      When the input radius is large the correction factor is less than one, assuming the non-linearity stems from saturation.
    </p>
    <p num="38">
      To compute the rotational correction the K-model first reads tabular I and Q versus radius data and interpolates an I and Q depending on input radius.
      <br/>
      The model then rotates the input by arctan (Q/I) before the input reaches the linear MIMO filter 406.
      <br/>
      The K-model removes the DC rotation introduced by the linear MIMO filter 406 to avoid over-rotating the input.
      <br/>
      From an angular perspective the K-model is a cascade model, a static non-linearity followed by a linear filter.
      <br/>
      The non-linear phase correction enables the K-model to simulate phase-shifts that depend on input amplitude.
      <br/>
      The rest of this section explains each block in FIG. 4.
    </p>
    <p num="39">
      FIG. 4 also includes two rectangular-to-polar coordinate transformations units 401.
      <br/>
      One example of the operation performed by the rectangular-to-polar coordinate transformations units 401 is shown in equation (7).
      <br/>
      r=Sqrt �i2 +q2 �, and q=ArcTan�q/i�  Eq. (7)
    </p>
    <p num="40">
      FIG. 4 also includes a polar-to-rectangular coordinate transformations unit 402.
      <br/>
      One example of the operation performed by the polar-to-rectangular coordinate transformation unit 402 is shown in equation (8).
      <br/>
      i=r cos(q), and q=r sin(q)  Eq. (8)
    </p>
    <p num="41">
      FIG. 4 also includes a signal divider 403.
      <br/>
      The output is equal to y/x (with y and x being received as inputs).
      <br/>
      This block checks for x=0 and outputs a set value, e.g., 1 in that event.
    </p>
    <p num="42">FIG. 4 also includes a multiplier 404, its output equals the product of its inputs.</p>
    <p num="43">
      FIG. 4 includes the rotation block 405 which performs a rotation operation in the complex plane.
      <br/>
      FIG. 4a is an illustration of a technique for implementing the rotation according to one embodiment of the present invention.
      <br/>
      The data for the interpolation process is steady state values of iout and qout resulting from several values of iin with qin=0.
      <br/>
      The implementation does not necessarily have to involve interpolation.
      <br/>
      One could use a closed form expression for the phase shift if it exists.
      <br/>
      The point is that  DELTA  THETA  is a non-linear function of r. One could also interchange the order of the rotation block 405 and the linear MIMO filter 406 to correct the phase after the linear block instead of before it.
      <br/>
      The rotation implemented by the correction block 4055 corresponds to " THETA (.vertline.
      <br/>
      RHO .vertline.)" in equation (2) of Struble et al., Understanding Linearity in Wireless Communications Amplifiers, IEEE Journal of Solid-State Circuits, September, 1997, that was incorporated by reference above.
    </p>
    <p num="44">
      The linear MIMO filter 406 is a 2-input-2-output linear filter.
      <br/>
      FIG. 4b is an illustration of the linear MIMO filter according to one embodiment of the present invention.
    </p>
    <p num="45">
      FIG. 4c is an illustration of one embodiment of the non-linear SISO filter.
      <br/>
      As described above, the non-linear SISO filter 407 determines the value for x(r(t)).
    </p>
    <p num="46">
      The preferred embodiment uses the tanh function.
      <br/>
      However, other functions can also be used, e.g., other functions having an "S" shape.
      <br/>
      In an alternate embodiment a piece-wise linear function can be used, e.g., as shown in FIG. 4d.
    </p>
    <p num="47">
      The S-curves do not all have to be identical; one could attempt to decrease the number of curves by using curves that are different from each other.
      <br/>
      Also, if r0=0, symmetry can be exploited to remove the negatively indexed filters and instead, re-use the positively indexed filters.
    </p>
    <p num="48">The linear SISO 408 can be a copy of the h0 block illustrated in FIG. 4c.</p>
    <p num="49">
      The K-model was tested using two circuits.
      <br/>
      The first test circuit was a model that demonstrated the need to include memory in the model.
      <br/>
      The second test circuit was a larger transistorlevel model that demonstrated the need to include frequencydependent gain compression (pole-zero movement).
    </p>
    <p num="50">
      FIG. 5 is an illustration of the first circuit used to test the preferred embodiment of the present invention.
      <br/>
      The test circuit translates base-band inputs up to RF, e.g., 1 Ghz, passes them through a saturating pass-band active filter, then down-converts to base-band.
      <br/>
      The amplifier saturates at 10 volts when the input exceeds 1 volt.
      <br/>
      The band-width of the circuit is 70 Mhz and the carrier is 1 Ghz.
    </p>
    <p num="51">
      Recall, that "bias" refers to the amplitude of the unmodulated 1 Ghz carrier.
      <br/>
      The small-signal input, for which transfer functions are defined, is an infinitesimal modulation of the carrier amplitude.
      <br/>
      FIG. 6 is an illustration of the DC transfer curve, the relationship between base-band output radius and unmodulated input carrier amplitude resulting from the testing of the first circuit using the preferred embodiment of the present invention.
    </p>
    <p num="52">
      FIG. 7 is an illustration of the radial transfer functions (i.e. input to output radius) extracted at several input biases resulting from the testing of the first circuit using the present invention.
      <br/>
      FIG. 7 shows gain compression.
      <br/>
      FIG. 8 is an illustration of the transfer functions normalized for unity DC gain according to the results of the testing of the first circuit using the present invention.
      <br/>
      FIG. 8 shows pole-zero movement since the normalized transfer functions do not all coincide.
    </p>
    <p num="53">
      We compared K-model simulations of the first test circuit to simulations performed using SpectreRF that is commercially available from Cadence Design Systems, Inc., San Jose, Calif.
      <br/>
      We used the a DSP tool, SPW (Signal Processing Workstation) which is commercially available from Cadence Design Systems, Inc., to run the K-model.
      <br/>
      We compared I-Q (i.e. in-phase versus quadrature) trajectories since the systems engineer may visualize distortion in terms of a symbol constellation, which lies in the I-Q plane.
      <br/>
      FIGS. 9a and 9b are illustrations comparing I-Q output trajectories for small and large in-band signals using SpectreRF model and the K-model of the present invention.
      <br/>
      The small signal SpectreRF and K-model responses coincide.
      <br/>
      The large signal K-model response is about 8 percent smaller than the SpectreRF response; if we were to scale the K-model's response by 1.08 the outer edges of the trajectories would coincide.
      <br/>
      The DC transfer curve starts to saturate at an input voltage of 1 volt.
      <br/>
      The combined base-band input signals produced a peak input signal of 1.82 volts.
    </p>
    <p num="54">
      FIGS. 10a and 10b are illustrations of the trajectories for small and large signals at higher frequencies, (in-phase=70 Mhz and quadrature=150 Mhz) according to the present invention.
      <br/>
      Both input signals were 1 volt sinusoids, giving a combined peak base-band signal of 1.4 volts.
      <br/>
      The response is significantly better than a memoryless model.
      <br/>
      The aspect ratio of the overall response is much different than one because the response depends on frequency and the in-phase and quadrature inputs are of different frequencies.
      <br/>
      A memoryless model could not produce the correct aspect ratio because it would apply the same attenuation to both axes.
      <br/>
      A memoryless model would produce an aspect ratio of one.
    </p>
    <p num="55">
      A second test was also performed that compared K-model and SpectreRF simulations for a large transistor level model of an RF receiver.
      <br/>
      FIG. 11 is an illustration of an RF receiver used during a second test of the present invention.
    </p>
    <p num="56">
      FIG. 1 illustrates the radial transfer function at several input signal biases.
      <br/>
      Note the difference in gain compression at DC and 10 Mhz.
      <br/>
      The difference is due to amplitude-dependent poles and zeros.
      <br/>
      FIG. 12 is an illustration of the radial DC transfer curve using the second test circuit computed with SpectreRF and the K-model according to the present invention.
      <br/>
      The output is well into saturation when the unmodulated carrier exceeds 20 mv.
    </p>
    <p num="57">
      FIG. 13 is an illustration of a comparison of K-model and SpectreRF simulations for several input levels on the second test circuit according to the present invention.
      <br/>
      The input in-phase and quadrature signals were 5 Mhz and 10 Mhz respectively and of equal amplitude.
      <br/>
      The combined input signals gave peaks of 1.25 mv, 0.025 mv, and 30 mv.
      <br/>
      Based on the DC transfer curve the latter two input test signals were large.
      <br/>
      The error in the large signal response was on the order of 10 percent.
    </p>
    <p num="58">
      Trajectories from a cascade model did not significantly differ from those in FIG. 13. One might be tempted to use the cascade model.
      <br/>
      However, while it is important to simulate large signal swings it is also be important to simulate small perturbations about a large displacement.
      <br/>
      An I-Q trajectory may spiral into a constellation point instead of jumping right to it.
      <br/>
      The next test addresses the latter scenario.
    </p>
    <p num="59">
      FIG. 14 is an illustration comparing simulations using SpectreRF, a linear model, a cascade model, and the K-model of the present invention.
      <br/>
      For each simulation the input was a small constant amplitude sinusoid, 10 Mhz away from the carrier, added to a large unmodulated carrier.
      <br/>
      In the input complex plane the input signal traced out a small circle centered on the real axis and displaced from the origin.
      <br/>
      SpectreRF produced the lower oval.
      <br/>
      The uncorrected linear MIMO model within the K-model produced the largest trajectory in FIG. 14. Alone, the linear model is way off because it does not account for saturation.
      <br/>
      The complete K-model produced the upper oval.
      <br/>
      A cascade model produced the thin vertical trajectory.
      <br/>
      The cascade model in this example consisted of a memoryless non-linear multi-tanh structure followed by a normalized linear MIMO model.
      <br/>
      The memoryless multi-tanh structure used the same tanh curves used in the K-model but the associated slopes were just the DC values of the K-model's transfer functions.
      <br/>
      The memoryless multi-tanh structure operated only on radius.
      <br/>
      The resulting radius was combined with. the input phase to convert back to rectangular coordinates and drive the linear MIMO model 406.
      <br/>
      The linear MIMO model 406 was the K-model's linear MIMO model normalized for a radial gain of one.
    </p>
    <p num="60">
      In the radial direction the cascade model does not account for the poles and zeros that depend on radius.
      <br/>
      In general, cascade models cannot simulate pole-zero movement because all filtering effects come from a single linear MIMO model.
      <br/>
      The non-linear part of the cascade model can scale the linear filter's response depending on bias but it can not move the poles and zeros.
      <br/>
      In contrast, the K-model can move the poles and zeros for bias.
    </p>
    <p num="61">
      The K-model is an improvement over linear models, memoryless non-linear models, and cascaded combinations of linear filters and memoryless non-linearities.
      <br/>
      Simulations of two different test circuits show the modeling error is about 10 percent for input excursions well into the saturation region of the DC transfer curve.
    </p>
    <p num="62">
      The first test circuit composed mostly of behavioral blocks implemented in analog hardware description language (AHDL) code.
      <br/>
      The second test circuit was composed of device models and used very little AHDL.
      <br/>
      Aside from validating the K-model, the two test circuits demonstrate that the K-model can be used to extract a system-level model from any mix of behavioral and device models.
      <br/>
      Accordingly the K-model can be used during any phase of the receiver's design to see if the current design will work in the larger system.
    </p>
    <p num="63">
      As indicated above SPW was used to simulate the K-model.
      <br/>
      SPW read in transfer functions extracted using SpectreRF then applied an inverse fast fourier transform (IFFT) to compute impulse responses.
      <br/>
      To simulate a transfer function, SPW convolved the sampled input with the sampled impulse response.
      <br/>
      There are other ways to simulate the transfer functions.
      <br/>
      One could apply the FFT to chunks of input data, multiply the FFT by the transfer function, then apply an IFFT to return to the time domain.
      <br/>
      However, that approach does not work well in feedback loops because the output is delayed by the length of a data chunk.
      <br/>
      Another approach is to fit rational transfer functions to the measured transfer functions.
      <br/>
      The rational transfer functions can be decomposed into pole-residue forms which can then be simulated with recursive convolution one example of which is described in Lin and Kuh, Transient Simulation of Lossy Interconnects Based on the Recursive Convolution Formulation, 39 IEEE Trans.
      <br/>
      Circuits Syst. 11, pp 879-892 (1992) that is incorporated by reference herein in its entirety.
      <br/>
      Recursive convolution is very fast.
      <br/>
      The first step is to make sure the rational transfer function approach is as good as or better than the finite impulse response (FIR) filter approach.
    </p>
    <p num="64">
      Along with increased simulation speed the rational transfer function approach may enable the K-model to simulate very low frequency dynamics.
      <br/>
      The automatic gain control (AGC) loop for example introduces very low frequency dynamics.
      <br/>
      An FIR filter can not simulate transients lasting longer than the number of taps times the sample period.
      <br/>
      The rational transfer functions would be implemented as IIR filters, which can have transients of arbitrary duration.
    </p>
    <p num="65">While the invention has been particularly shown and described with reference to a preferred embodiment and several alternate embodiments, it will be understood by persons skilled in the relevant art that various changes in form and details can be made therein without departing from the spirit and scope of the invention.</p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A system for modeling output signals produced by mixed analog and digital circuitry in a digital signal design environment that provides an input signal, the input and output signals having an in-phase component and a quadrature component when represented in rectangular coordinates and the input and output signals having a radial component and an angular component when represented in polar coordinates, the system comprising:</claim-text>
      <claim-text>a non-linear static angular correction unit, disposed to receive the input signal, for rotating the input signal to generate a rotated signal; a first linear filter, disposed to receive said rotated signal, to linearly filter said rotated signal to generate a filtered rotated signal; a non-linear dynamic radial correction unit comprising:</claim-text>
      <claim-text>- a second linear filter, disposed to receive said radial component of the input signal, to linearly filter said radial component of the input signal and to generate a first radial correction component; - a non-linear filter, disposed to receive said radial component of the input signal, to capture frequency-dependent gain compression and to generate a second radial correction component; - a radial correction factor unit, disposed to receive said first and second radial correction components, to determine a radial correction factor based upon said first and second radial correction components;</claim-text>
      <claim-text>and a correction unit, for integrating said radial correction factor and said filtered rotated signal to model said output signal.</claim-text>
    </claim>
  </claims>
</questel-patent-document>