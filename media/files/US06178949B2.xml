<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06178949B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06178949</doc-number>
        <kind>B2</kind>
        <date>20010130</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6178949</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference is-representative="YES" family-id="23628273" extended-family-id="13607133">
      <document-id>
        <country>US</country>
        <doc-number>09411273</doc-number>
        <kind>A</kind>
        <date>19991004</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1999US-09411273</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>13900084</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>41127399</doc-number>
        <kind>A</kind>
        <date>19991004</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1999US-09411273</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010130</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>F02P   5/15        20060101AFI20060310RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>P</subclass>
        <main-group>5</main-group>
        <subgroup>15</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20060310</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>F02D  35/02        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>35</main-group>
        <subgroup>02</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="3">
        <text>F02D  41/00        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>41</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="4">
        <text>F02D  41/04        20060101ALI20060310RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>41</main-group>
        <subgroup>04</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20060310</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="5">
        <text>F02D  41/06        20060101ALI20060310RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>41</main-group>
        <subgroup>06</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20060310</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="6">
        <text>F02D  45/00        20060101ALI20060310RMJP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>45</main-group>
        <subgroup>00</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <generating-office>
          <country>JP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20060310</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>123435000</text>
        <class>123</class>
        <subclass>435000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>123406220</text>
        <class>123</class>
        <subclass>406220</subclass>
      </further-classification>
      <further-classification sequence="2">
        <text>123486000</text>
        <class>123</class>
        <subclass>486000</subclass>
      </further-classification>
    </classification-national>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-035/023</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>35</main-group>
        <subgroup>023</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130703</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-019/061</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>19</main-group>
        <subgroup>061</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130703</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-019/0636</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>19</main-group>
        <subgroup>0636</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130703</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="4">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-019/0649</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>19</main-group>
        <subgroup>0649</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130703</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="5">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-041/0025</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>41</main-group>
        <subgroup>0025</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130703</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="6">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-2200/0612</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>2200</main-group>
        <subgroup>0612</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130703</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="7">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>Y02T-010/36</classification-symbol>
        <section>Y</section>
        <class>02</class>
        <subclass>T</subclass>
        <main-group>10</main-group>
        <subgroup>36</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20150115</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>6</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>4</number-of-drawing-sheets>
      <number-of-figures>8</number-of-figures>
      <image-key data-format="questel">US6178949</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Engine control having fuel volatility compensation</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>TOMISAWA NAOKI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5682856</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5682856</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>MOOTE RICHARD K, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5868117</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5868117</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>GATELLIER BERTRAND</text>
          <document-id>
            <country>US</country>
            <doc-number>6062193</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6062193</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>AMENT FRANK, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>6079396</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6079396</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="5">
          <text>MATEKUNAS FREDERIC A</text>
          <document-id>
            <country>US</country>
            <doc-number>4621603</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4621603</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="6">
          <text>MATEKUNAS FREDERIC A</text>
          <document-id>
            <country>US</country>
            <doc-number>4624229</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4624229</doc-number>
          </document-id>
        </patcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>General Motors Corporation</orgname>
            <address>
              <address-1>Detroit, MI, US</address-1>
              <city>Detroit</city>
              <state>MI</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>GENERAL MOTORS</orgname>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Kirwan, John E.</name>
            <address>
              <address-1>Troy, MI, US</address-1>
              <city>Troy</city>
              <state>MI</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="2">
          <addressbook lang="en">
            <name>Matekunas, Frederic Anton</name>
            <address>
              <address-1>Troy, MI, US</address-1>
              <city>Troy</city>
              <state>MI</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="3">
          <addressbook lang="en">
            <name>Jorgensen, Scott Willis</name>
            <address>
              <address-1>Bloomfield Township, Oakland County, MI, US</address-1>
              <city>Bloomfield Township, Oakland County</city>
              <state>MI</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="4">
          <addressbook lang="en">
            <name>Chang, Chen-Fang</name>
            <address>
              <address-1>Troy, MI, US</address-1>
              <city>Troy</city>
              <state>MI</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <name>Grove, George A.</name>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Kwon, John</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>GRANTED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      An improved engine control in which the fuel volatility is detected based on a measure of the fired-to-motored cylinder pressure ratio, and used to trim fuel and spark timing controls during engine warm-up and transient fueling periods.
      <br/>
      In a first embodiment, a matrix of empirically determined pressure ratio values that occur with fuels of differing volatility is stored and compared to the measured pressure ratio to identify the closest stored pressure ratio, and the fuel volatility is determined based on the fuel volatility associated with the identified pressure ratio.
      <br/>
      In a second embodiment, the actual fuel vapor-to-air equivalence ratio is computed based on the measured pressure ratio, and the fuel volatility is determined based on the deviation between the actual ratio and the desired fuel vapor-to-air equivalence ratio.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>TECHNICAL FIELD</heading>
    <p num="1">The present invention relates in general to an engine fuel and spark control, and more specifically to a control that is compensated for variations in fuel volatility during cold starts and fueling transients.</p>
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="2">
      Current state-of-the-art engine controls rely almost exclusively on exhaust gas sensing to maintain the engine air-fuel ratio at a value that minimizes exhaust emissions.
      <br/>
      However, such sensors typically require heating for a significant period before the sensor is useful for control following a cold start.
      <br/>
      For this reason, engine spark timing and fueling during cranking and warm-up is generally performed based on an open-loop calibration.
      <br/>
      For a given amount of fuel delivered to the intake manifold, the air-fuel ratio delivered to the cylinder varies considerably for fuels of different volatility.
      <br/>
      The fuel in the cylinder comes in part from vaporized fuel from the current injection event and in part from fuel vaporized from the port walls wetted by previous injections.
      <br/>
      The rate at which both these components vaporize depends not only on temperature and pressure, but also on the fuel volatility, which may vary considerably from tank to tank.
    </p>
    <p num="3">
      The above-described dependence on fuel volatility is illustrated in FIG. 1A, where the solid and broken traces represent the fuel vapor-to-air equivalence ratio  PHI v as a function of time, as measured in the engine exhaust stream during a cold start test.
      <br/>
      The solid trace depicts the ratio  PHI v for a fuel having a relatively high volatility, while the broken trace depicts the ratio  PHI v for a fuel having a relatively low volatility.
      <br/>
      As seen in the graph, the ratio  PHI v is roughly 20% richer with the high volatility fuel than with the low volatility fuel.
      <br/>
      FIG. 1B shows the indicated mean effective pressure (IMEP) for the two fuels; again, the solid trace corresponding to the high volatility fuel, and the broken trace corresponding to the low volatility fuel.
      <br/>
      The IMEP parameter, a measure of the work produced, is significantly lower and more variable for the low volatility fuel than for the high volatility fuel.
      <br/>
      This is a result of the low volatility fuel yielding a leaner mixture, which for a given spark timing, burns later during the engine cycle than the richer mixture.
      <br/>
      For the condition depicted, these later burning cycles release heat further after top-dead-center for the piston, resulting in less useful work being produced with nominal spark advance settings.
    </p>
    <p num="4">
      The uncertainty in  PHI v delivered to the cylinder and the appropriate spark timing forces design engineers to enrich the cold calibration to insure that operating with low volatility fuel will not result in driveability problems.
      <br/>
      This enrichment to compensate for low volatility fuels causes  PHI v to be richer-than-optimum with high volatility fuel, resulting in higher hydrocarbon emissions than if the appropriate calibration for that fuel was used.
      <br/>
      Similar phenomena occur, although to a lesser degree, during fueling transients.
      <br/>
      Thus, it is apparent that differences in fuel volatility adversely affect both emissions and performance with conventional control strategies.
    </p>
    <p num="5">Accordingly, what is needed is a method for detecting fuel volatility in order to deliver fuel more accurately, for improved emissions and driveability.</p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="6">
      The present invention is directed to an improved engine control in which in-cylinder air-fuel ratio is detected based on a measure of the fired-to-motored cylinder pressure ratio.
      <br/>
      The detected air-fuel ratio is used to infer the fuel volatility and to appropriately trim fuel and spark timing during engine warm-up and transient fueling periods.
      <br/>
      In a first embodiment, a matrix of empirically determined pressure ratio values that occur with fuels of differing volatility are stored and compared to the measured pressure ratio determined from pressure sensor signal samples to identify the closest stored pressure ratio.
      <br/>
      The fuel volatility is determined based on the fuel volatility associated with the identified pressure ratio.
      <br/>
      In a second embodiment, the actual fuel vapor-to-air equivalence ratio is computed based on the measured pressure ratio, and the fuel volatility is determined based on the deviation between the actual ratio and the desired fuel vapor-to-air equivalence ratio.
    </p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="7">
      FIG. 1A is a graph depicting the fuel vapor-to-air equivalence ratio  PHI v as a function of time for low and high volatility fuels during a cold start.
      <br/>
      FIG. 1B is a graph depicting the indicated mean effective pressure (IMEP) as a function of time for low and high volatility fuels during a cold start.
      <br/>
      FIG. 2 is a diagram of a fuel volatility compensated engine control, including a microprocessor-based controller programmed according to this invention.
      <br/>
      FIG. 3 shows the pressure ratio parameter for the high and low volatility fuels as in FIGS. 1A and 1B.
      <br/>
      FIGS. 4-7 are flow diagrams representative of computer program instructions executed by the controller of FIG. 2 in carrying out the control of this invention.
      <br/>
      FIG. 4 is a main flow diagram;
      <br/>
      FIG. 5 is an interrupt service routine for detecting fuel volatility and compensating the engine control parameters; and
      <br/>
      FIGS. 6-7 detail alternate implementations of the fuel volatility detection step of the flow diagram of FIG. 4.
    </p>
    <heading>DESCRIPTION OF THE PREFERRED EMBODIMENT</heading>
    <p num="8">
      FIG. 2 depicts a motor vehicle internal combustion engine 10 and a microprocessor-based engine control module (ECM) 12. For purposes of illustration, the engine 10 is depicted as having four cylinders 14, an intake manifold 16 with throttle valve 18, and an exhaust manifold 20 with a three-way catalytic converter 22.
      <br/>
      An exhaust gas recirculation (EGR) valve 24 returns a portion of the exhaust gasses from the exhaust manifold 20 to the intake manifold 16.
      <br/>
      Each cylinder 14 is provided with a spark plug 26, an intake valve 28 coupled to the intake manifold 16, and an exhaust valve 30 coupled to the exhaust manifold 20.
      <br/>
      Fuel is delivered to the intake manifold 16 at each intake valve 28 by a respective fuel injector 32.
      <br/>
      Although not shown in FIG. 2, each cylinder 14 houses a piston which is mechanically coupled to a crankshaft, which in turn, provide motive power to the vehicle through a transmission and drivetrain.
    </p>
    <p num="9">
      The ECM 12 receives a number of input signals representing various engine and ambient parameters, and generates control signals F1-F4 for the fuel injectors 32, S1-S4 for the spark plugs 26, and EGR for the EGR valve 24, all based on the input signals.
      <br/>
      Conventionally, the inputs include crankshaft (or camshaft) position as provided by a variable reluctance sensor 34, exhaust gas air/fuel ratio as provided by oxygen sensor 36, and intake manifold absolute pressure (MAP) as provided by pressure sensor 38.
      <br/>
      Other typical inputs include the manifold absolute temperature (MAT), ambient (barometric) pressure (BARO), fuel rail pressure (FRP), and mass air flow (MAF).
      <br/>
      For the most part, the control algorithms for generating the fuel and spark control signals are conventional and well known.
      <br/>
      For example, fuel may be supplied based on MAF, or by a speed-density algorithm, with closed-loop correction based on the feedback of oxygen sensor 36, and spark timing may be controlled relative to crankshaft position based on engine speed and throttle position.
      <br/>
      Under steady state and slow transient conditions, the closed-loop feedback allows the ECM 12 to reliably control the engine 10 to minimize emissions while maintaining performance and driveability.
      <br/>
      However, during engine warm-up and significant fueling, transients, the sensor 36 is unable to provide adequate feedback information, and the fuel vapor-to-air equivalence ratio  PHI v deviates from the desired value (typically stoichiometric) due to variations in fuel volatility as discussed above in reference to FIG. 1A. Such variability can degrade both emission control and driveability, as also discussed above.
    </p>
    <p num="10">According to this invention, the ECM 12 detects variations in fuel volatility during engine warm-up and/or transient fueling conditions, and suitably adjusts the nominal control parameters to compensate for the detected variation.</p>
    <p num="11">
      In general, this invention recognizes that the fuel volatility may be conveniently detected as a function of the fired-to-motored cylinder pressure ratio; that is, the ratio of the pressure occurring with and without combustion.
      <br/>
      The motored pressure is the pressure that would exist through the cycle if combustion did not occur.
      <br/>
      Its value can be estimated from a few samples of pressure during compression, using polytropic relations.
      <br/>
      The ECM 12 determines the pressure ratio with one or more cylinder pressure sensors 40 by forming a ratio of the sensed pressure in a given combustion cycle before and after heat from the combustion can significantly influence pressure.
      <br/>
      The ratio of fired-to-motored pressure is 1.0 before heat release by the flame, increases as heat is released and after the heat release process is over remains constant through expansion.
      <br/>
      FIG. 3 shows two pressure-ratio curves for cycles with different air-fuel ratios as produced by the high and low volatility fuels as depicted in FIG. 1.
      <br/>
      The difference between the pressure ratio at any point in the cycle and 1.0 is directly related to the fraction of fuel burned at that point.
      <br/>
      This value (PR parameter) at some point during expansion (for this example 55 cam degrees after piston top dead center) is found to directly correlate with the IMEP for the cycle (see FIG. 1B for the IMEP curves).
      <br/>
      For a given spark timing, leaner cycles caused by lower fuel volatility burn more slowly.
      <br/>
      The work lost because the burning did not occur early enough is reasonably estimated by the PR parameter, and it acts as a measure of the lateness of the burn.
      <br/>
      The relationship among the lateness of the burn, the cylinder air-fuel ratio and the fuel volatility provides the basis for volatility detection with this invention.
      <br/>
      A single pressure sensor 40 may be used as depicted in FIG. 2, or alternately, the pressure ratios obtained from sensors responsive to the pressure in two or more cylinders 14 may be averaged.
    </p>
    <p num="12">
      FIGS. 4-7 depict flow diagrams representative of computer program instructions executed by ECM 12 in carrying out the control of this invention.
      <br/>
      FIG. 4 is a main flow diagram.
      <br/>
      It primarily embodies both conventional fuel and spark algorithms, as discussed above, as well as the volatility compensation of this invention.
      <br/>
      FIG. 5 is an interrupt service routine for detecting fuel volatility and compensating the engine control parameters; and FIGS. 6-7 detail alternate implementations of the fuel volatility determination.
    </p>
    <p num="13">
      Referring to FIG. 4, the initialization block 50 is executed at the initiation of each period of engine operation to initialize various parameters and status flags to predetermined initial conditions.
      <br/>
      In the control of this invention, for example, this may include retrieving an estimated fuel volatility parameter determined in a previous period of engine operation.
      <br/>
      Following initialization, the block 52 is executed to read the various inputs mentioned above in respect to FIG. 2.
      <br/>
      If the engine 10 is in a crank or warm-up mode, as determined at block 54, the blocks 56 and 58 are executed to determine various open-loop fuel and spark control calibration values by table look-up, based on the determined fuel volatility, and to schedule the fuel and spark control signals F1-F4, S1-S4 based on the determined calibration values.
      <br/>
      As indicated above, the assumed fuel volatility is initially set to a predetermined value, and in subsequent periods of engine operation is initialized based on the volatility determined in the previous period of engine operation.
      <br/>
      Although the fuel volatility changes each time fuel is added to the fuel tank, the retrieved volatility parameter provides a fairly close approximation of the current volatility in most instances.
    </p>
    <p num="14">
      Once the engine 10 is no longer in the crank or warm-up modes, again as determined at block 54, the block 60 is executed to schedule the fuel and spark controls using a conventional closed-loop control strategy, as discussed above.
      <br/>
      If a transient fueling condition is in effect, as determined at block 62, the block 64 is additionally executed to adjust the scheduled fuel and spark controls to satisfy emission and driveability concerns.
      <br/>
      The fuel transient adjustments are essentially open-loop corrections to the closed-loop values, based on an assumed fuel volatility.
      <br/>
      As with the crank and warm-up control, the assumed fuel volatility is initially set to a predetermined value, and in subsequent periods of engine operation is initialized based on the volatility estimated in the previous period of engine operation.
    </p>
    <p num="15">
      The above-described operations are repeatedly executed along with other control functions (as indicated by the block 66) as in a purely conventional control.
      <br/>
      Meanwhile, typically in response to an interrupt signal based on crankshaft position, the ECM samples the output of pressure sensor 40 to determine the PR parameter and suitably adjust the fuel and spark control calibrations.
      <br/>
      Alternately, of course, the motored-to-fired pressure ratio may be determined.
      <br/>
      FIG. 5 depicts such an interrupt service routine (ISR) in which the cylinder pressures are read and the PR parameter is computed at blocks 70 and 72.
      <br/>
      The blocks 74 and 76 are then executed to estimate the fuel volatility as a function of the pressure ratio PR, and to suitably adjust the crank/warm-up and transient fueling calibration values used to schedule fuel and spark controls in blocks 58 and 64 of FIG. 4.
      <br/>
      During crank and warm-up, the fuel and spark retard controls are adjusted based on the determined fuel volatility to provide more aggressive spark retard and leaner fueling with higher volatility fuels for reduced emissions, faster heating of the catalytic converter 22, and improved warm-up driveability.
      <br/>
      During transient fueling, the fuel and spark retard controls are adjusted based on the determined fuel volatility to reduce the rich/lean air-fuel ratio excursions, thereby reducing emissions and improving driveability.
    </p>
    <p num="16">
      FIGS. 6 and 7 depict alternate mechanizations of the block 74 of FIG. 5.
      <br/>
      In the mechanization of FIG. 6, the ECM 12 stores a matrix of empirically determined pressure ratio values that occur with fuels of differing volatility.
      <br/>
      In this case, the block 80 retrieves the pressure ratio matrix, the block 82 identifies a pressure ratio from the matrix that corresponds with the pressure ratio determined at block 72, and the block 84 sets the estimated fuel volatility VOL to the value associated with the identified pressure ratio of the matrix.
      <br/>
      In the mechanization of FIG. 7, the ECM 12 computes the fuel vapor-to-air equivalence ratio  PHI v (A/Fact), as indicated at block 90, and then determines the fuel volatility VOL as a function of the deviation between the computed ratio (A/Fact) and the desired fuel vapor-to-air equivalence ratio  PHI v (A/Fdes).
    </p>
    <p num="17">
      In summary, the control of this invention provides improved emission control and driveability, particularly during engine warm-up and transient fueling, by deducing the fuel volatility based on the measured pressure ratio PR, and then suitably adjusting the fuel and spark control parameters.
      <br/>
      Although described in reference to the illustrated embodiment, it will be appreciated that the present invention has much broader application and is not limited thereto.
      <br/>
      For example, the control may be used in connection with direct injection engines, engines having a different number of cylinders, multiple intake and/or exhaust valves per cylinder, multiple spark plugs per cylinder, and so on.
      <br/>
      Accordingly, controls incorporating these and other modifications may fall within the scope of this invention, which is defined by the appended claims.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A control method for a spark ignition internal combustion engine in which fuel delivery to an engine cylinder is determined based on an assumed fuel volatility, the control method comprising the steps of:</claim-text>
      <claim-text>measuring fired and motored pressures in said cylinder during a combustion cycle, and determining a pressure ratio based on such measured pressures; determining an actual volatility of the delivered fuel as a function of the determined pressure ratio;</claim-text>
      <claim-text>and adjusting the fuel delivery to said engine cylinder based on the determined actual volatility.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. The control method of claim 1, including the steps of: storing the actual fuel volatility determined in a first period of engine operation, and in a subsequent period of engine operation, retrieving the stored actual volatility and delivering fuel to the engine cylinder based on the retrieved volatility.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. The control method of claim 1, wherein the step of determining an actual volatility of the delivered fuel comprises the steps of: storing a matrix of empirically determined pressure ratios associated with various fuel volatilities; identifying a stored pressure ratio that most closely corresponds to the determined pressure ratio;</claim-text>
      <claim-text>and determining the actual volatility based on the fuel volatility associated with the identified stored pressure ratio.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. The control method of claim 1, wherein the fuel delivery is calibrated to achieve a desired fuel vapor-to-air equivalence ratio, and the step of determining an actual volatility of the delivered fuel comprises the steps of: determining an actual fuel vapor-to-air equivalence ratio based on the determined pressure ratio;</claim-text>
      <claim-text>and determining the actual volatility of the delivered fuel based on a deviation of the actual fuel vapor-to-air equivalence ratio from the desired fuel vapor-to-air equivalence ratio.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. A control method for a spark ignition internal combustion engine in which spark timing and fuel delivery to an engine cylinder during an engine warm-up period are determined based on an assumed fuel volatility, the control method comprising the steps of: measuring fired and motored pressures in said cylinder during a combustion cycle of said warm-up period, and determining a pressure ratio based on such measured pressures; determining an actual volatility of the delivered fuel as a function of the determined pressure ratio;</claim-text>
      <claim-text>and adjusting the spark timing and fuel delivery to said engine cylinder during said warm-up period based on the determined actual volatility.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. A control method for a spark ignition internal combustion engine in which spark timing and fuel delivery to an engine cylinder are determined based on a measure of an fuel vapor-to-air ratio in an exhaust stream of the engine, the control method comprising the steps of: identifying a period of transient fuel delivery; measuring fired and motored pressures in said cylinder during a combustion cycle of said identified period, and determining a pressure ratio based on such measured pressures; determining an actual volatility of the delivered fuel as a function of the determined pressure ratio;</claim-text>
      <claim-text>and adjusting the spark timing and fuel delivery to said engine cylinder during said identified period based on the determined actual volatility.</claim-text>
    </claim>
  </claims>
</questel-patent-document>