<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06181135B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06181135</doc-number>
        <kind>B2</kind>
        <date>20010130</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6181135</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference is-representative="YES" family-id="22770619" extended-family-id="42107429">
      <document-id>
        <country>US</country>
        <doc-number>09207456</doc-number>
        <kind>A</kind>
        <date>19981208</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1998US-09207456</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>43163652</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>20745698</doc-number>
        <kind>A</kind>
        <date>19981208</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1998US-09207456</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010130</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>G01R  33/56        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>01</class>
        <subclass>R</subclass>
        <main-group>33</main-group>
        <subgroup>56</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>324309000</text>
        <class>324</class>
        <subclass>309000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>324307000</text>
        <class>324</class>
        <subclass>307000</subclass>
      </further-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>G01R-033/56</text>
        <section>G</section>
        <class>01</class>
        <subclass>R</subclass>
        <main-group>33</main-group>
        <subgroup>56</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G01R-033/56</classification-symbol>
        <section>G</section>
        <class>01</class>
        <subclass>R</subclass>
        <main-group>33</main-group>
        <subgroup>56</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G01R-033/5608</classification-symbol>
        <section>G</section>
        <class>01</class>
        <subclass>R</subclass>
        <main-group>33</main-group>
        <subgroup>5608</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="ICO"/>
        <classification-symbol>S01R-033/56P</classification-symbol>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>11</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>4</number-of-drawing-sheets>
      <number-of-figures>4</number-of-figures>
      <image-key data-format="questel">US6181135</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">MRI system with fractional decimation of acquired data using linear phase shift</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>LI JIANHUA</text>
          <document-id>
            <country>US</country>
            <doc-number>5036281</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5036281</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>BERNSTEIN MATTHEW A, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5226418</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5226418</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>FOO THOMAS K</text>
          <document-id>
            <country>US</country>
            <doc-number>5347216</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5347216</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>KING KEVIN F, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>6046591</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6046591</doc-number>
          </document-id>
        </patcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>General Electric Company</orgname>
            <address>
              <address-1>Milwaukee, WI, US</address-1>
              <city>Milwaukee</city>
              <state>WI</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>GENERAL ELECTRIC</orgname>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Shen, Jie F.</name>
            <address>
              <address-1>New Berlin, WI, US</address-1>
              <city>New Berlin</city>
              <state>WI</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <orgname>Quarles &amp; Brady</orgname>
          </addressbook>
        </agent>
        <agent sequence="2" rep-type="agent">
          <addressbook lang="en">
            <name>Cabou, Christian G.</name>
          </addressbook>
        </agent>
        <agent sequence="3" rep-type="agent">
          <addressbook lang="en">
            <name>Price, Phyllis Y.</name>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Oda, Christine K.</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>LAPSED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      An MRI system acquires NMR signals at a fixed sample rate.
      <br/>
      The acquired NMR signals are decimated to produce an output NMR signal at a prescribed sample rate.
      <br/>
      The acquired NMR signal is fast Fourier transformed to the frequency domain, and additional signal samples are produced by phase shifting in the frequency domain.
      <br/>
      The frequency domain signal samples needed to produce the prescribed sample rate are then fast Fourier transformed back to the time domain to produce the output NMR signal.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="1">
      The field of the invention is nuclear magnetic resonance imaging methods and systems.
      <br/>
      More particularly, the invention relates to the sampling of acquired NMR signals at prescribed sample rates.
    </p>
    <p num="2">
      When a substance such as human tissue is subjected to a uniform magnetic field (polarizing field B0), the individual magnetic moments of the spins in the tissue attempt to align with this polarizing field, but precess about it in random order at their characteristic Larmor frequency.
      <br/>
      If the substance, or tissue, is subjected to a magnetic field (excitation field B1) which is in the x-y plane and which is near the Larmor frequency, the net aligned moment, Mz, may be rotated, or "tipped",into the x-y plane to produce a net transverse magnetic moment Mt.
      <br/>
      A signal is emitted by the excited spins after the excitation signal B1 is terminated, this signal may be received and processed to form an image.
    </p>
    <p num="3">
      When utilizing these signals to produce images, magnetic field gradients (Gx Gy and Gz) are employed.
      <br/>
      Typically, the region to be imaged is scanned by a sequence of measurement cycles in which these gradients vary according to the particular localization method being used.
      <br/>
      The resulting set of received NMR signals are digitized and processed to reconstruct the image using one of many well known reconstruction techniques.
    </p>
    <p num="4">
      The rate at which the received NMR signals are digitized is an important scan parameter.
      <br/>
      The signal-to-noise ratio of an NMR image can be improved if the effective bandwidth (which is the inverse of the sampling period per point) is reduced.
      <br/>
      This is usually accomplished by widening the read-out gradient pulse and reducing the amplitude of the read-out gradient to encode the positions into a narrower bandwidth and to retain the same spatial resolution.
      <br/>
      The anti-aliasing filters are modified to match the reduced bandwidth and the analog-to-digital conversion (A/D) sample rate is reduced to acquire the same number of samples over the longer read-out gradient pulse.
      <br/>
      The SNR improvement is proportional to the square root of the bandwidth reduction.
    </p>
    <p num="5">
      A higher SNR and corresponding lower A/D sample rate is not always desired, since the increase in SNR is accompanied by two disadvantages.
      <br/>
      First, the minimum echo delay (TE1min) for the first NMR echo signal is increased due to the widening of the read-out gradient pulse.
      <br/>
      For some rf spin echo acquisitions the delay is twice what might be expected, since the time between the 90 (degree)  RF excitation pulse and the 180 (degree)  RF pulse must also be increased to orient the NMR echo signal at the center of the widened read-out gradient pulse.
      <br/>
      The lengthening of TE1 is a disadvantage when T2 weighting of the NMR image is not desired.
      <br/>
      A second disadvantage which accompanies this increase in SNR is an increase in chemical shift artifacts.
      <br/>
      Since the bandwidth per image pixel is reduced, the frequency difference between lipid and water resonances becomes more significant.
      <br/>
      For example, at 1.5 Tesla main field strength, the approximately 220 Hertz difference in resonant frequency will appear approximately three times further apart in an image where each image pixel represents a difference in frequency of 42 Hertz rather than 125 Hertz.
      <br/>
      The result is an increased relative displacement between the lipid structures and the water structures.
      <br/>
      This displacement can be especially disturbing with images reconstructed from the first NMR echo signal since the second echo signal often has lower lipid signal components due to the shorter T2 decay time of lipids.
    </p>
    <p num="6">To allow maximum flexibility of the SNR, spatial resolution, and field of view of an image, a completely adjustable A/D sampling rate is desirable.</p>
    <p num="7">
      A number of methods have been used in prior MRI systems to enable the A/D sample rate to be precisely adjusted to enable the best image acquisition possible.
      <br/>
      One approach is to employ an analog-to-digital converter circuit ("ADC") in which the sample rate is adjustable and can be precisely controlled.
      <br/>
      Such ADCs are expensive.
    </p>
    <p num="8">
      Another approach is to employ an ADC which has a fixed sample rate far higher than that required to achieve the desired sample rates.
      <br/>
      In such designs the sample rate is reduced to the prescribed A/D sample rate by using decimation.
      <br/>
      The decimation ratio (d) is an integer value.
      <br/>
      Decimation effectively reduces the A/D sample rate to one-half (d=2) by selecting alternate digitized samples, to one-third (d=3) by selecting every third digitized sample, to one-fourth (d=4) by selecting every fourth digitized sample, etc.
      <br/>
      The difficulty with this method is that the effective A/D sample rate can only be changed in discrete steps.
      <br/>
      If the ADC sample rate is very high and the decimation ratio (d) necessary to achieve operable A/D sample rates is very high (e.g. d=10, 11, 12), these discrete steps are relatively small and a desired A/D sample rate can be achieved with reasonable accuracy.
      <br/>
      However, ADC devices that operate at such high sample rates are expensive.
    </p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="9">
      The present invention is a method for using a fixed sample rate ADC to acquire NMR image data and produce an image data set at a prescribed sample rate.
      <br/>
      More specifically, the method includes transforming the acquired time domain NMR image data samples to the frequency domain; producing additional frequency domain image data samples by shifting the phase of the transformed NMR image data samples, selecting a set of frequency domain image data samples; and transforming the selected set of frequency domain image data samples to the time domain to produce an image data set at the prescribed sample rate.
      <br/>
      The linear phase shift in the frequency domain is equivalent to interpolation between sample points in the time domain.
      <br/>
      Only the frequency domain image data samples needed to produce the prescribed time domain sample rate are selected and transformed back to the time domain.
    </p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="10">
      FIG. 1 is a block diagram of an MRI system which employs the present invention;
      <br/>
      FIG. 2 is an electrical block diagram of the transceiver which forms part of the MRI system of FIG. 1;
      <br/>
      FIG. 3 is a flow chart of a preferred method used by the MRI system of FIG. 1 to practice the present invention; and
      <br/>
      FIG. 4 is a pictorial representation of the relationship of the phase shifted frequency domain data and the time domain data points produced by the method of FIG. 3.
    </p>
    <heading>GENERAL DESCRIPTION OF THE INVENTION</heading>
    <p num="11">
      The present invention reduces the amount of memory and computation time needed to change the sample rate of an acquired NMR signal.
      <br/>
      The acquired signal is sampled at a fixed rate with a time interval  DELTA t between samples.
      <br/>
      The prescribed sample rate has intervals m DELTA t/n, where m/n is the fractional decimation ratio.
      <br/>
      The method may be divided into two parts.
      <br/>
      In the first part, the number of digitized NMR signal samples is extended to the next power of 2 by zero padding; the zero-padded sequence is then Fourier transformed using an FFT; and the resulting frequency domain signal is multiplied by a band-limiting window function.
      <br/>
      This part is no different from prior methods based on zero padding.
      <br/>
      During the second part of the method, the band-limited frequency-domain data is phase shifted to produce additional frequency domain data.
      <br/>
      This data is transformed back to the time domain using an inverse FFT.
      <br/>
      Only the data points which fall at multiples of m DELTA t/n are included in the inverse FFT, and when m is a power of 2, the inverse FFT of these points can be performed much faster than the inverse FFT that includes all time-domain points.
    </p>
    <p num="12">The first part of the method consists of the following three steps:</p>
    <p num="13">
      1.
      <br/>
      Extend the number of digitized samples to the next power of 2 by padding
      <br/>
      +S0, S1, S3, . . . SMO-1, O,O, . . . , Sm-1 =O}, (1)
    </p>
    <p num="14">where M is a power of 2.</p>
    <p num="15">
      2. Calculate the Fourier transform of the zero-padded data using a FFT +S0, S1, S2, S3, . . . , SM-1 },
      <br/>
      where  (Equation image '1' not included in text)
    </p>
    <p num="16">
      3.
      <br/>
      Multiply the Fourier transform by a windowing function +H0, H1, H2, H3, . . . , HM-1 }
      <br/>
      +S0 H0, S1,H1, S2 H2, S3 H3, . . . SM-1 HM-1 }  (3)
    </p>
    <p num="17">The second part of the method calculates the prescribed time domain signal samples.+X0, X1, X2, X3, . . . , XN-1 } by using an inverse FFT and a linear phase shift.</p>
    <p num="18">
      Let +V0, V1, V2, V3, . . . , VM-1 } be the inverse Fourier transform of +S0 H0, S1, H1, . . . SM-1 HM-1 }. We note that Vqm and Xqn coincide at qm DELTA t, where q=0, 1, . . . , (M/m)-1, and we therefore have Xqn =Vqm.
      <br/>
      The number of multiplications required to calculate all Vj 's using the inverse FFT is proportional to M log2 M. However, only those with index being multiples of m fall at the desired time point, and the rest are not needed.
      <br/>
      When only Vqm are needed, the inverse Fourier transform can be reduced from length M to length M/m.
      <br/>
      The proof is given below.  (Equation image '2' not included in text)
    </p>
    <p num="19">
      Let L=M/m.
      <br/>
      The last summation can be written as  (Equation image '3' not included in text)
    </p>
    <p num="20">The summation of M terms may be broken up into m summations of L terms each  (Equation image '4' not included in text)</p>
    <p num="21">Replacing the index k by pL+k in the p'th summation above and then using the unity relation e-i2 PI qk/L =1, the summations are reduced to  (Equation image '5' not included in text)</p>
    <p num="22">The inner summation does not require any multiplications and the outer summation can be evaluated using an inverse FFT of length L. The number of multiplications required is proportional to (M/m)log2 (M/m), which is much less than M log2 M.</p>
    <p num="23">
      To calculate the n-1 points between Xqn and X(q+1)n, the inverse FFT is repeated n-1 times and, before each inverse FFT, the frequency-domain data is phase-shifted by a linear phase equal to 2 PI l/(nM), where I is the iteration index and varies from 1 to n-1.
      <br/>
      The detailed procedures are given below.
    </p>
    <p num="24">
      4. Apply a linear phase shift to +S0 H0, S1 H1, S2 H2, S3 H3, . . . , Sm-1 Hm-1}
      <br/>
      +S0 H0, S1 H1 e-i ALPHA , S2 H2 e-i2 ALPHA , S3 H3 e-i3 ALPHA , . . . , Sm-1 Hm-1 e-(m-1) ALPHA  }
    </p>
    <p num="25">
      where  ALPHA =2 PI l/(nM).
      <br/>
      Note that for the first iteration  ALPHA =0 and the linear phase shift may be skipped because the existing frequency domain data is reproduced.
    </p>
    <p num="26">5. Divide the M data points into m groups of size L-M/m.</p>
    <p num="27">
      Group 1: +S0 H0, S1 H1 e-i ALPHA , S2 H2 e-i2 ALPHA , . . . , SL-1 HL-1 e-i(L-1) ALPHA  }
      <br/>
      Group 2: +SL HL e-L ALPHA , SL+1 HL+1 e-i(L+1) ALPHA , SL+2 HL+2 e-i(L+2) ALPHA , . . . , S2L-1 H2L-1 e-i(2L-1) ALPHA  }
      <br/>
      . . .
    </p>
    <p num="28">Group m: +S(m-1)L H(m-L) e-i(m-1)L ALPHA , S(m-1)L+1 H(m-1)L+1 e-i�(M-1)L+1� ALPHA , S(m-1)L+2 H(m-1)L+2 e-i�(M-1)L+2� ALPHA , . . . , SM-1 Hm-1 e-i(M-1) ALPHA  }</p>
    <p num="29">
      6.
      <br/>
      Add the corresponding data points in each group
      <br/>
      +U0, U1, U2, . . . , UL-1 }
      <br/>
      where  (Equation image '6' not included in text)
    </p>
    <p num="30">
      7.
      <br/>
      Perform the inverse FFT on +Uk }  (Equation image '7' not included in text)
    </p>
    <p num="31">The number of samples calculated is equal to nM/m, which is usually more than N. Only the first N samples are needed and the rest are in the extended time region created by the initial zero padding to make the sequence length a power of 2.</p>
    <heading>DESCRIPTION OF THE PREFERRED EMBODIMENT</heading>
    <p num="32">
      Referring first to FIG. 1, there is shown the major components of a preferred MRI system which incorporates the present invention.
      <br/>
      The operation of the system is controlled from an operator console 100 which includes a keyboard and control panel 102 and a display 104.
      <br/>
      The console 100 communicates through a link 116 with a separate computer system 107 that enables an operator to control the production and display of images on the screen 104.
      <br/>
      The computer system 107 includes a number of modules which communicate with each other through a backplane.
      <br/>
      These include an image processor module 106, a CPU module 108 and a memory module 113, known in the art as a frame buffer for storing image data arrays.
      <br/>
      The computer system 107 is linked to a disk storage 111 and a tape drive 112 for storage of image data and programs, and it communicates with a separate system control 122 through a high speed serial link 115.
    </p>
    <p num="33">
      The system control 122 includes a set of modules connected together by a backplane.
      <br/>
      These include a CPU module 119 and a pulse generator module 121 which connects to the operator console 100 through a serial link 125.
      <br/>
      It is through this link 125 that the system control 122 receives commands from the operator which indicate the scan sequence that is to be performed.
      <br/>
      The pulse generator module 121 operates the system components to carry out the desired scan sequence.
      <br/>
      It produces data which indicates the timing, strength and shape of the RF pulses which are to be produced, and the timing of and length of the data acquisition window.
      <br/>
      The pulse generator module 121 connects to a set of gradient amplifiers 127, to indicate the timing and shape of the gradient pulses to be produced during the scan.
      <br/>
      The pulse generator module 121 also receives patient data from a physiological acquisition controller 129 that receives signals from a number of different sensors connected to the patient, such as ECG signals from electrodes or respiratory signals from a bellow.
      <br/>
      And finally, the pulse generator module 121 connects to a scan room interface circuit 133 which receives signals from various sensors associated with the condition of the patient and the magnet system.
      <br/>
      It is also through the scan room interface circuit 133 that a patient positioning system 134 receives commands to move the patient to the desired position for the scan.
    </p>
    <p num="34">
      The gradient waveforms produced by the pulse generator module 121 are applied to a gradient amplifier system 127 comprised of Gx, Gy and Gz, amplifiers.
      <br/>
      Each gradient amplifier excites a corresponding gradient coil in an assembly generally designated 139 to produce the magnetic field gradients used for position encoding acquired signals.
      <br/>
      The gradient coil assembly 139 forms part of a magnet assembly 141 which includes a polarizing magnet 140 and a whole-body RF coil 152.
      <br/>
      A transceiver module 150 in the system control 122 produces pulses which are amplified by an RF amplifier 151 and coupled to the RF coil 152 by a transmit/receive switch 154.
      <br/>
      The resulting signals radiated by the excited nuclei in the patient may be sensed by the same RF coil 152 and coupled through the transmit/receive switch 154 to a preamplifier 153.
      <br/>
      The amplified NMR signals are demodulated, filtered, and digitized in the receiver section of the transceiver 150.
      <br/>
      The transmit/receive switch 154 is controlled by a signal from the pulse generator module 121 to electrically connect the RF amplifier 151 to the coil 152 during the transmit mode and to connect the preamplifier 153 during the receive mode.
      <br/>
      The transmit/receive switch 154 also enables a separate RF coil (for example, a head coil or surface coil) to be used in either the transmit or receive mode.
    </p>
    <p num="35">
      The NMR signals picked up by the RF coil 152 are digitized by the transceiver module 150 and transferred to a memory module 160 in the system control 122.
      <br/>
      When the scan is completed and an entire array of data has been acquired in the memory module 160, an array processor 161 operates to Fourier transform the data into an array of image data.
      <br/>
      This image data is conveyed through the serial link 115 to the computer system 107 where it is stored in the disk memory 111.
      <br/>
      In response to commands received from the operator console 100, this image data may be archived on the tape drive 112, or it may be further processed by the image processor 106 and conveyed to the operator console 100 and presented on the display 104.
    </p>
    <p num="36">
      Referring particularly to FIGS. 1 and 2, the transceiver 150 produces the RF excitation field B1 through power amplifier 151 at a coil 152A and receives the resulting signal induced in a coil 152B.
      <br/>
      As indicated above, the coils 152A and B may be separate as shown in FIG. 2, or they may be a single wholebody coil as shown in FIG. 1.
      <br/>
      The base, or carrier, frequency of the RF excitation field is produced under control of a frequency synthesizer 200 which receives a set of digital signals (CF) from the CPU module 119 and pulse generator module 121.
      <br/>
      These digital signals indicate the frequency and phase of the RF carrier signal produced at an output 201.
      <br/>
      The commanded RF carrier is applied to a modulator and up converter 202 where its amplitude is modulated in response to a signal R(t) also received from the pulse generator module 121.
      <br/>
      The signal R(t) defines the envelope of the RF excitation pulse to be produced and is produced in the module 121 by sequentially reading out a series of stored digital values.
      <br/>
      These stored digital values may, in turn, be changed from the operator console 100 to enable any desired RF pulse envelope to be produced.
    </p>
    <p num="37">
      The magnitude of the RF excitation pulse produced at output 205 is attenuated by an exciter attenuator circuit 206 which receives a digital command, TA, from the backplane 118.
      <br/>
      The attenuated RF excitation pulses are applied to the power amplifier 151 that drives the RF coil 152A.
      <br/>
      For a more detailed description of this portion of the transceiver 122, reference is made to U.S. Pat. No. 4,952,877 which is incorporated herein by reference.
    </p>
    <p num="38">
      Referring still to FIG. 1 and 2 the signal produced by the subject is picked up by the receiver coil 152B and applied through the preamplifier 153 to the input of a receiver attenuator 207.
      <br/>
      The receiver attenuator 207 further amplifies the signal by an amount determined by a digital attenuation signal (RA) received from the backplane 118.
    </p>
    <p num="39">
      The received signal is at or around the Larmor frequency, and this high frequency signal is down converted in a two step process by a down converter 208 which first mixes the NMR signal with the carrier signal on line 201 and then mixes the resulting difference signal with the 2.5 MHz reference signal on line 204.
      <br/>
      The down converted NMR signal is applied to the input of an analog-to-digital converter (ADC) 209 which samples and digitizes the analog signal and applies it to a digital detector and signal processor 210 which produces 16-bit in-phase (I) values and 16-bit quadrature (Q) values corresponding to the received signal.
      <br/>
      The resulting stream of digitized I and Q values of the received time domain NMR signal are output through backplane 118 to the memory module 160 where they are employed to reconstruct an image.
      <br/>
      In the preferred embodiment the ADC 209 operates at a fixed sample rate of 500 kHz so that complex pairs I and Q are sampled at a 250 kHz rate (i.e  DELTA t=4  MU sec.), yielding a maximum bandwidth of  +- 125 kHz.
    </p>
    <p num="40">
      The 2.5 MHz reference signal as well as the 250 kHz sampling signal and the 5, 10 and 60 MHz reference signals are produced by a reference frequency generator 203 from a common 20 MHz master clock signal.
      <br/>
      For a more detailed description of the receiver, reference is made to U.S. Pat. No. 4,992,736 which is incorporated herein by reference.
    </p>
    <p num="41">
      The present invention is implemented on the digitized I and Q samples of each acquired time domain NMR signal.
      <br/>
      A prescribed receive bandwidth is established prior to the scan, to provide the desired sampling interval m DELTA t/n, and the number (M0) of digitized samples is also prescribed.
      <br/>
      The acquired data is digitized at sampling intervals  DELTA t and it is then processed according to the present invention to produce a data set X0, X1, X2, . . . , XN-1 which is a representation of the acquired data digitized at the prescribed sampling interval.
      <br/>
      This data set is employed in the usual fashion to reconstruct an image at the completion of the scan as described above.
      <br/>
      The processing of the present invention is thus performed between the acquisition of each view of data and the use of that view in the image reconstruction process.
      <br/>
      This invention enables any arbitrary bandwidth to be prescribed (less than the fixed bandwidth of the receiver) with minimal impact on the image reconstruction time.
    </p>
    <p num="42">
      Referring particularly to FIG. 3, as each time domain NMR signal is acquired and digitized as described above, the signal samples are input as indicated by process block 200.
      <br/>
      The MO samples are zero padded at process 202 by adding zero values until the total number of samples is equal to M, a number equal to the next power of two.
      <br/>
      For example, if 192 samples are acquired, the time domain NMR signal is zero-padded to contain 256 samples.
      <br/>
      This is done to enable a fast Fourier transform (FFT) to be performed as indicated at process block 204 and described above in equation (2).
    </p>
    <p num="43">
      As indicated at process block 206, the next step is to multiply the transformed, frequency domain NMR signal (S) by a window function (H).
      <br/>
      The high frequency components of the windowed frequency domain signal (S*H) are discarded outside the desired receiver bandwidth.
    </p>
    <p num="44">
      A loop is entered next in which additional frequency domain NMR signal samples are produced and transformed back to the time domain.
      <br/>
      As indicated at process block 208, this is achieved by shifting the phase of each frequency domain signal sample (S*H) by an angle equal to the sample number times  ALPHA , where:
      <br/>
      ALPHA =2 PI l/(nM);
      <br/>
      m/n fractional decimation ratio and m is a power of 2; and
      <br/>
      I=an index ranging from zero to n-1.
    </p>
    <p num="45">
      The result is a data set of Mn phase shifted, frequency domain signal samples.
      <br/>
      These could all be transformed back to the time domain, however, it is one of the discoveries of the present invention that the data size can be greatly reduced and the processing can be substantially shortened by combining frequency-domain signal samples prior to transformation.
      <br/>
      As indicated at process block 210, this is accomplished by selecting every Lth sample in the data set and summing them together, where:
      <br/>
      L=M/m.
    </p>
    <p num="46">
      The Mn frequency-domain samples are thus reduced in number to L samples to form a frequency-domain data set:
      <br/>
      U=U0, U1, . . . UL-1.
    </p>
    <p num="47">
      The resulting smaller frequency domain data set U is then fast Fourier transformed back to the time domain as indicated at process block 212.
      <br/>
      As indicated at process block 214, the index I is then incremented and the process loops back to block 208 to produce another set of phase shifted frequency domain signal samples.
      <br/>
      This loop is performed n times to produce n sets of L time domain signal samples.
    </p>
    <p num="48">
      Referring particularly to FIG. 4, three successive sets of L time domain signal samples produced at process block 212 are indicated by data structures 220-222.
      <br/>
      The first set of time domain signal samples 220 produced with the index I set to zero produces time domain signal samples at original sample times as indicated by solid lines 224.
      <br/>
      The second set of time domain signal samples 221 produced with the index I set to 1 yields time domain signal samples at times indicated by dashed lines 226 which are interleaved with the samples for the first set 220.
      <br/>
      Similarly, the third set of time domain signal samples 222 produced with the index I set to 2 yields time domain signal samples at times indicated by dotted lines 228 which are interleaved with the samples from the first two data sets 220 and 221.
      <br/>
      The net result of all the time domain data sets produced by process block 212 for I=0 to I=n-1 is an output time domain NMR signal in which the samples are spaced at m DELTA t/n to provide the prescribed sample rate.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A method for decimating a time domain signal sampled at intervals  DELTA t at a decimation ratio of m/n, the steps comprising:</claim-text>
      <claim-text>a) Fourier transforming the time domain signal to produce a set of frequency domain signal samples b) producing additional frequency domain signal samples by phase shifting the set of frequency domain signal samples;</claim-text>
      <claim-text>and c) Fourier transforming frequency domain signal samples and additional frequency domain signal samples to produce an output time domain signal sampled at intervals m DELTA t/n.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. The method as recited in claim 1 in which the time domain signal is zero padded such that the number of samples therein is equal to a number which is a power of two; and the Fourier transformation in step a) is a fast Fourier transform.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. The method as recited in claim 2 which includes: d) multiplying the set of frequency domain signal samples by a window function that limits the bandwidth before performing step b).</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. The method as recited in claim 3 in which step b) is performed n-1 times.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. The method as recited in claim 4 in which selected ones of the frequency domain signal samples and additional frequency domain signal samples are selectively combined prior to performing step c) to reduce the number of samples being Fourier transformed.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. The method as recited in claim 5 in which the selection of frequency domain signal samples to be combined is determined in part by the value of m.</claim-text>
    </claim>
    <claim num="7">
      <claim-text>7. The method as recited in claim 3 in which step d) produces M frequency domain signal samples and step b) is performed n-1 times.</claim-text>
    </claim>
    <claim num="8">
      <claim-text>8. The method as recited in claim 7 in which the phase shift in step b) is proportional to  ALPHA =2 PI l/(nM), where l is an iteration index from 1 to n-1 which indicates the number of times step b) has been performed.</claim-text>
    </claim>
    <claim num="9">
      <claim-text>9. The method as recited in claim 7 in which every Lth frequency domain sample and every Lth additional frequency domain sample produced by performing step b) is summed to form L frequency domain samples for use in performing step c), where L=M/m.</claim-text>
    </claim>
    <claim num="10">
      <claim-text>10. The method as recited in claim 7 in which step c) is performed each time after step b) is performed.</claim-text>
    </claim>
    <claim num="11">
      <claim-text>11. The method as recited in claim 10 in which every Lth additional frequency domain sample produced in step b), is summed to form L frequency-domain samples for use in performing step c), where L=M/m.</claim-text>
    </claim>
  </claims>
</questel-patent-document>