<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06178945B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06178945</doc-number>
        <kind>B2</kind>
        <date>20010130</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6178945</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference family-id="26499435" extended-family-id="13735124">
      <document-id>
        <country>US</country>
        <doc-number>09542988</doc-number>
        <kind>A</kind>
        <date>20000404</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>2000US-09542988</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>69051370</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>54298800</doc-number>
        <kind>A</kind>
        <date>20000404</date>
        <priority-active-indicator>N</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>2000US-09542988</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="2">
        <country>JP</country>
        <doc-number>17965197</doc-number>
        <kind>A</kind>
        <date>19970704</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="2">
        <doc-number>1997JP-0179651</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="3">
        <country>JP</country>
        <doc-number>35153097</doc-number>
        <kind>A</kind>
        <date>19971219</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="3">
        <doc-number>1997JP-0351530</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="4">
        <country>US</country>
        <doc-number>11041398</doc-number>
        <kind>A</kind>
        <date>19980706</date>
        <priority-linkage-type>3</priority-linkage-type>
        <priority-active-indicator>N</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="4">
        <doc-number>1998US-09110413</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010130</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>F02D  37/02        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>37</main-group>
        <subgroup>02</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>F02D  41/08        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>41</main-group>
        <subgroup>08</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="3">
        <text>F02D  41/30        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>41</main-group>
        <subgroup>30</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="4">
        <text>F02D  41/34        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>41</main-group>
        <subgroup>34</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="5">
        <text>F02P   5/04        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>P</subclass>
        <main-group>5</main-group>
        <subgroup>04</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>123295000</text>
        <class>123</class>
        <subclass>295000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>123305000</text>
        <class>123</class>
        <subclass>305000</subclass>
      </further-classification>
    </classification-national>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-037/02</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>37</main-group>
        <subgroup>02</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-041/083</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>41</main-group>
        <subgroup>083</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-041/3029</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>41</main-group>
        <subgroup>3029</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="4">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-041/3064</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>41</main-group>
        <subgroup>3064</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="5">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-041/345</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>41</main-group>
        <subgroup>345</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="6">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-2250/18</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>2250</main-group>
        <subgroup>18</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="7">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02P-005/04</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>P</subclass>
        <main-group>5</main-group>
        <subgroup>04</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="8">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>Y02T-010/128</classification-symbol>
        <section>Y</section>
        <class>02</class>
        <subclass>T</subclass>
        <main-group>10</main-group>
        <subgroup>128</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130117</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="9">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>Y02T-010/44</classification-symbol>
        <section>Y</section>
        <class>02</class>
        <subclass>T</subclass>
        <main-group>10</main-group>
        <subgroup>44</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130122</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>8</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>24</number-of-drawing-sheets>
      <number-of-figures>27</number-of-figures>
      <image-key data-format="questel">US6178945</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Control system for internal combustion engine</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>JEHANNO GILLES</text>
          <document-id>
            <country>US</country>
            <doc-number>5359519</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5359519</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>TAKAHASHI JUN</text>
          <document-id>
            <country>US</country>
            <doc-number>5896840</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5896840</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>IIDA KAZUMASA, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5970947</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5970947</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>MACHIDA KENICHI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5996547</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5996547</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="5">
          <text>SUZUKI KEISUKE, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>6050238</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6050238</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="6">
          <text>YOSHINO TAKAHIRO</text>
          <document-id>
            <country>US</country>
            <doc-number>6058906</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6058906</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="7">
          <text>MATSUURA TAKASHI</text>
          <document-id>
            <country>US</country>
            <doc-number>5333583</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5333583</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="8">
          <text>TAKANO YOSHIYA, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5722362</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5722362</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="9">
          <text>SCHRICKER DAVID R, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5878366</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5878366</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="10">
          <text>MIZUNO HIROYUKI</text>
          <document-id>
            <country>US</country>
            <doc-number>5881693</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5881693</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="11">
          <text>FRIEDRICH ARNO, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5884602</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5884602</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="12">
          <text>KAMURA HITOSHI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5894827</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5894827</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="13">
          <text>IIDA KAZUMASA, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5960765</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5960765</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="14">
          <text>TOYOTA MOTOR CO LTD</text>
          <document-id>
            <country>EP</country>
            <doc-number>0451829</doc-number>
            <kind>A2</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>EP-451829</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="15">
          <text>MITSUBISHI MOTORS CORP</text>
          <document-id>
            <country>EP</country>
            <doc-number>0826880</doc-number>
            <kind>A2</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>EP-826880</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="16">
          <text>NISSAN MOTOR</text>
          <document-id>
            <country>EP</country>
            <doc-number>0887533</doc-number>
            <kind>A2</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>EP-887533</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="17">
          <text>MITSUBISHI MOTORS CORP, et al</text>
          <document-id>
            <country>WO</country>
            <doc-number>9636802</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>WO9636802</doc-number>
          </document-id>
        </patcit>
      </citation>
    </references-cited>
    <related-documents>
      <division>
        <relation>
          <parent-doc>
            <document-id>
              <country>US</country>
              <doc-number>11041398</doc-number>
              <kind>A</kind>
              <date>19980706</date>
            </document-id>
          </parent-doc>
        </relation>
        <relation>
          <parent-doc>
            <document-id>
              <country>US</country>
              <doc-number>6050238</doc-number>
              <kind>A</kind>
            </document-id>
          </parent-doc>
        </relation>
      </division>
    </related-documents>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Nissan Motor Co., Ltd.</orgname>
            <address>
              <address-1>Yokohama, JP</address-1>
              <city>Yokohama</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>NISSAN MOTOR</orgname>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Suzuki, Keisuke</name>
            <address>
              <address-1>Kanagawa, JP</address-1>
              <city>Kanagawa</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="2">
          <addressbook lang="en">
            <name>Takahashi, Nobutaka</name>
            <address>
              <address-1>Yokohama, JP</address-1>
              <city>Yokohama</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="3">
          <addressbook lang="en">
            <name>Obata, Takeaki</name>
            <address>
              <address-1>Kanagawa, JP</address-1>
              <city>Kanagawa</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <orgname>Foley &amp; Lardner</orgname>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Kwon, John</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>EXPIRED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      When an air conditioner is turned on during homogeneous operation, an equivalence ratio correction factor DELTAphi is increased sharply and suddenly in such a manner as to show a jump for thereby increasing an engine output torque, and thereafter is decreased gradually with increase of a cylinder intake air quantity, whereby to maintain the engine output torque constant.
      <br/>
      However, when switching to a homogeneous mode occurs in the middle of the above control, switching to proper torque correction is not carried out at the time of a homogeneous combustion mode, i.e., torque correction by the use of ignition timing but the torque correction by the equivalence ratio correction factor DELTAphi continuously.
      <br/>
      By this, in contrast to the case in which the torque correction is switched to one that is carried out by the use of ignition timing correction quantity, a sharp and sudden variation of engine output torque can be prevented.
      <br/>
      In the meantime, after completion of the torque correction by the above mentioned control, the torque correction at the time of the homogeneous combustion mode is carried out by ignition timing correction.
      <br/>
      Further, when the combustion mode is switched to stratified combustion during execution of torque correction by ignition timing correction at the time of the homogeneous combustion mode, the torque correction is switched to one that is carried out by the use of the equivalence ratio correction factor simultaneously with switching of the combustion mode.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
    <p num="1">This application claims the priority of JP 9-179651 filed Jul. 4, 1997, and JP 9-351530 filed Dec. 19, 1997.</p>
    <p num="2">
      This application is a divisional of application Ser.
      <br/>
      No. 09/110,413, filed Jul. 6, 1998, now U.S. Pat. No. 6,050,238.
    </p>
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="3">
      1.
      <br/>
      Field of the Invention
    </p>
    <p num="4">The present invention relates to a control system for an internal combustion engine capable of switching combustion modes which are different in injection timing, such as a homogeneous combustion mode and a stratified combustion mode, while performing quick-response torque correction by using different manipulated variables according to the combustion modes.</p>
    <p num="5">2. Description of the Related Art</p>
    <p num="6">
      For stabilization control of engine speed at idling, load compensation control, and torque control for meeting various requests during running, it has heretofore been practiced to perform torque correction by using manipulated variables which are higher in responsiveness than intake air quantity.
      <br/>
      Such torque correction is herein referred to as "quick-response torque correction".
    </p>
    <p num="7">
      On the other hand, in recent years direct-injection spark ignition internal combustion engines have attracted public attention.
      <br/>
      Typical one of such engines performs, in accordance with an engine operating condition, switching of two combustion modes, i.e., a homogeneous combustion mode in which fuel is injected during intake stroke and is dispersed within a combustion chamber to form a homogeneous mixture, and a stratified combustion mode in which fuel is injected during compression stroke to form a stratified mixture which is concentrated around a spark plug, as disclosed in Japanese patent provisional publication No. 59-37236.
    </p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="8">
      In such a direct-injection spark ignition internal combustion engine, the above described quick-response torque correction may be performed by using as a manipulated variable or variables at least ignition timing during homogenous operation and equivalence ratio during stratified operation.
      <br/>
      The calculation of the manipulated variable is performed by being synchronized with crank angle (Ref Job), and the calculation of judgement on the request for the combustion mode is performed by being synchronized with time (e.g., 10 ms).
      <br/>
      This is because in case of the former the idle speed is detected on the basis of a time interval between Ref signals so as to be reflected on the ignition timing immediately after the detection or the fuel injection quantity during stratified operation, and in case of the latter the calculation synchronous with crank angle causes a large calculation load but if the angular interval for the angle synchronization is expanded for making lower the calculation load the interval of the combustion mode switching judgement becomes so large as to disable rapid switching of the combustion modes.
    </p>
    <p num="9">For example, a combustion mode is requested on the basis of a combustion mode request flag (FSTRR) calculated at the interval of 10 ms, and by Ref Job a manipulated variable (ignition timing or equivalence ratio) for quick-response torque correction is requested on the basis of the combustion mode request flag (FSTRR) at that moment.</p>
    <p num="10">
      However, in such a request system for a manipulated variable for torque correction, in case of switching from a stratified combustion mode to a homogeneous combustion mode and in case the flag (FSTRR) is switched between the fuel injection timing and the Ref signal output timing during homogeneous operation of a certain cylinder (-3 cylinder in FIG. 26), the fuel injection timing during homogeneous operation of -3 cylinder has already been past so stratified operation must be performed at -3 cylinder and therefore switching to a homogeneous combustion mode starts from -4 cylinder.
      <br/>
      However, at the time when the Ref signal for -3 cylinder is produced, the flag (FSTRR) has already been switched to request a homogeneous combustion mode, so the quick-response manipulated variable has already been switched from equivalence ratio to ignition timing.
      <br/>
      As a result, the ignition timing is corrected though stratified operation is actually carried out, causing deterioration of combustion and in the worst case a possibility of misfire.
    </p>
    <p num="11">
      Further, in case of switching from a homogeneous combustion mode to a stratified combustion mode and in case the flag (FSTRR) is switched after fuel injection for homogeneous operation has been carried out at a certain cylinder (e.g., -1 cylinder in FIG. 27) and before the Ref signal for that cylinder rises, homogeneous operation is performed at -1 cylinder since fuel injection for homogeneous operation has already been finished.
      <br/>
      However, since the flag (FSTRR) has already been switched to request a stratified combustion mode at the time when the Ref signal for -1 cylinder is produced, the quick-response manipulated variable is switched from ignition timing to equivalence ratio.
      <br/>
      In this instance, correction by equivalence ratio is not performed since fuel injection has already been finished.
      <br/>
      As a result, quick-response torque correction is not reflected on combustion at -1 cylinder.
    </p>
    <p num="12">
      The quick-response torque control encounters another problem as follows.
      <br/>
      When a combustion mode is switched from a stratified combustion mode to a homogeneous combustion mode during execution of quick-response torque control by the use of equivalence ratio at the time of stratified operation, a portion of correction executed by equivalence ratio is converted to a correction value by the use of ignition timing so as to carry out correction by ignition timing.
      <br/>
      In this connection, it is impossible for the reason of the capacity of ROM to prepare equivalence ratio/ignition timing translation tables for a number of operating conditions.
      <br/>
      When, for the above reason, the tables are reduced in number considerably for the purpose of reducing the capacity of ROM or an arithmetic expression is used to carry out the conversion, the accuracy of torque control at the time of conversion of equivalence ratio/ignition timing is lowered.
    </p>
    <p num="13">
      For example, FIG. 25 shows an equivalence ratio correction factor/ignition timing correction quantity translation table which is prepared by the use of a torque correction factor/equivalence ratio correction factor translation table shown in FIG. 8 and a torque correction factor/ignition timing correction quantity translation table shown in FIG. 9.
      <br/>
      In the table of FIG. 25, an actual characteristic may diverge from the solid line curve as indicated by a dotted line curve.
    </p>
    <p num="14">For this reason, a variation of the torque correction factor attained by the use of equivalence ratio at the time of stratified operation and a variation of the torque correction factor attained by the use of ignition timing which is employed in place of equivalence ratio after switching to a homogeneous combustion mode, when regarded as torque value, are not always smoothly consecutive with each other, thus causing a possibility that a jump or sharp drop is caused in variation of torque when a manipulated variable is switched from equivalence ratio to ignition timing.</p>
    <p num="15">
      According to a first aspect of the present invention, there is provided an internal combustion engine, comprising: a first cylinder; a second cylinder; and a controller.
      <br/>
      The controller comprises a mode requesting section for requesting one of a first combustion mode and a second combustion mode for each of the cylinders, the second combustion mode being later in a fuel injection timing than the first combustion mode; a mode judging section for judging whether an actual combustion mode of each of the cylinders is the first combustion mode or the second combustion mode; a torque requesting section for generating a torque correction request signal for a torque correction according to operation of the engine; and a torque correction section for performing torque correction for each of the cylinders, in response to the torque correction request signal and to the combustion mode of each of the cylinders, by manipulating different manipulated variables in the respective first and second combustion modes.
    </p>
    <p num="16">By the first aspect of the present invention, after one of the combustion modes is requested, a cylinder would be transitionally maintained at the same combustion mode as that before the request, switching of the actual combustion mode starts from the cylinder which becomes capable of executing combustion according to the combustion mode after the request.</p>
    <p num="17">
      In this connection, when a request for switching of the combustion modes is produced under the condition where torque correction according to an operating condition of the engine is executed, a cylinder whose combustion just after the request is executed according to a combustion mode before the request is subjected to torque correction by using a manipulated variable according to the combustion mode before the request.
      <br/>
      Then, the cylinder is subjected to torque correction by using a manipulated variable according to the combustion mode after the request starts from a cylinder which executes combustion which is switched according to the combustion mode after the request.
    </p>
    <p num="18">Accordingly, it is possible to attain torque correction according to an actual combustion mode and therefore a suitable torque correction can be executed to maintain a good driving condition.</p>
    <p num="19">According to a second aspect of the present invention, there is provided a control system for an internal combustion engine, comprising: a mode selecting section for selecting one of a first combustion mode and a second combustion mode for each of cylinders of the engine, the second combustion mode being later in a fuel injection timing than the first combustion mode; a torque correction requesting section for generating a torque correction requesting signal for a torque correction according to operation of the engine; a variable selecting section for selecting a manipulated variable according to whether the combustion mode is charged from the first combustion mode to the second combustion mode or from the second combustion mode to the first combustion mode; a torque correction section for performing torque correction for each of the cylinders, in response to the torque correction request signal and to the manipulated variable selected by the variable selecting section.</p>
    <p num="20">By the second aspect of the present invention, the following effects are obtained.</p>
    <p num="21">
      If a different manipulated variable is used for manipulation of torque correction, there may possibly be caused a variation in a correction quantity for the same torque correction work.
      <br/>
      Accordingly, when the manipulated variable for torque correction is switched in response to switching of the combustion mode during execution of the torque correction, there may possibly be caused a jump or sharp drop in the variation of torque.
      <br/>
      Accordingly, in such a case, it is desirable to delay switching of the manipulated variable until the torque correction in progress is finished even when the combustion mode is switched.
      <br/>
      However, in case it is actually impossible to carry out, by using the manipulated variable for torque correction before switching of the combustion mode, torque correction after switching of the combustion mode from a point of view of combustion characteristics or the like, the manipulated variable must be switched in response to switching of the combustion mode.
    </p>
    <p num="22">
      As against the fact that the second combustion mode, e.g. the stratified combustion mode, has only a restricted number of manipulated variable for torque correction, the first combustion mode, e.g. the homogeneous combustion mode, can use, in addition to the most desirable manipulated variable for torque correction, the manipulated variables for torque correction in the second combustion mode.
      <br/>
      Accordingly, a jump or sharp drop in variation of torque can be avoided, in case it is requested switching to the first combustion mode during execution of torque correction at the time of the second combustion mode, by performing torque correction by using the manipulated variable for torque correction in the second combustion mode until the torque correction in progress is finished.
    </p>
    <p num="23">On the other hand, when it is requested switching to the second combustion mode during execution of torque correction in the first combustion mode, switching of the combustion mode can be attained without any obstacle such as deteriorated combustion properties by switching the manipulated variable to one that is for correction in the second combustion mode, at the same time with switching of the combustion mode.</p>
    <p num="24">The above structures of the present invention can solve the above noted problems inherent in the prior art devices.</p>
    <p num="25">It is accordingly an object of the present invention to provide a novel and improved control system for an internal combustion engine which is capable of switching manipulated variables for correction of torque in response to switching of actual combustion modes.</p>
    <p num="26">It is another object of the present invention to provide a novel and improved control system for an internal combustion engine which can prevent a jump or sharp drop in variation of torque even when request for switching of a combustion mode occurs during execution of torque correction.</p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="27">
      FIG. 1 is a block diagram of control system for an internal combustion engine according to the first embodiment of the present invention;
      <br/>
      FIG. 2 is a schematic view of an internal combustion engine in which the present invention is embodied;
      <br/>
      FIG. 3 is a flowchart of a routine for calculation of a fuel injection quantity for use in the control system of the first embodiment;
      <br/>
      FIG. 4 is a flowchart of a routine executed at the fuel injection timing during homogeneous operation at each cylinder, for use in the first embodiment;
      <br/>
      FIG. 5 is a flowchart of a routine executed at the time of output of a Ref signal at each cylinder, for use in the first embodiment;
      <br/>
      FIG. 6 is a flowchart of a routine executed at the fuel injection timing during stratified operation at each cylinder, for use in the first embodiment;
      <br/>
      FIG. 7 is a flowchart of an ignition timing control routine at each cylinder, for use in the first embodiment;
      <br/>
      FIG. 8 is a graph illustrating a torque correction factor/equivalence ratio correction factor translation table for use in the first embodiment;
      <br/>
      FIG. 9 is a graph illustrating a torque correction factor/ignition timing correction quantity translation table for use in the first embodiment;
      <br/>
      FIG. 10 is a time chart of a torque correction control at the time of switching of a combustion mode from stratified to homogeneous, effected by the first embodiment;
      <br/>
      FIG. 11 is a time chart of a torque correction control at the time of switching of a combustion mode from homogeneous to stratified, effected by the first embodiment;
      <br/>
      FIG. 12 is a flowchart of a control routine executed at the fuel injection timing during homogenous operation at each cylinder, for use in the control system according to the second embodiment of the present invention;
      <br/>
      FIG. 13 is a flowchart of a control routine executed at the time of output of a Ref signal at each cylinder, for use in the control system according to the third embodiment of the present invention;
      <br/>
      FIG. 14 is a flowchart of a control routine executed at the fuel injection timing during homogeneous operation at each cylinder, for use in the control system according to the fourth embodiment of the present invention;
      <br/>
      FIG. 15 is a flowchart of a control routine executed at the fuel injection timing during stratified operation at each cylinder, for use in the fourth embodiment;
      <br/>
      FIG. 16 is a flowchart of a control routine executed when it is requested to switch a combustion mode from stratified to homogeneous, for use in the fourth embodiment;
      <br/>
      FIG. 17 is a time chart for illustration of the definition of a first set crank angle and a second set crank angle, for use in the fourth embodiment;
      <br/>
      FIG. 18 is a flowchart of a control routine executed at the fuel injection timing during homogeneous operation at each cylinder, for use in the control system according to the fifth embodiment of the present invention;
      <br/>
      FIG. 19 is a block diagram of a control system for an internal combustion engine according to the sixth embodiment of the present invention;
      <br/>
      FIG. 20 is a flowchart of a torque correction routine for use in the control system of the sixth embodiment;
      <br/>
      FIG. 21 is a time chart of a torque correction control at the time of switching of a combustion mode from stratified to homogeneous, which is effected by the sixth embodiment;
      <br/>
      FIG. 22 is a time chart of a torque correction control at the time of switching of a combustion mode from homogeneous to stratified, which effected by the sixth embodiment;
      <br/>
      FIG. 23 is a flowchart of a torque correction routine for use in the control system according to the seventh embodiment of the present invention;
      <br/>
      FIG. 24 is a flowchart of a torque correction routine for use in the control system according to the eighth embodiment of the present invention;
      <br/>
      FIG. 25 is a graph illustrating an equivalence ratio correction factor/ignition timing translation table;
      <br/>
      FIG. 26 is a time chart of a torque correction control at the time of switching of a combustion mode from stratified to homogeneous, showing a problem to be solved by the invention; and
      <br/>
      FIG. 27 is a time chart of a torque correction control at the time of switching of a combustion mode from homogeneous to stratified, showing a problem to be solved by the invention.
    </p>
    <heading>DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
    <p num="28">
      FIG. 1 shows a control system according to the first embodiment of the present invention.
      <br/>
      As illustrated, in an internal combustion engine having in an internal combustion engine having combustion mode switching means for switching a combustion mode from one of a first combustion mode and a second combustion mode to the other, the second combustion mode being later in a fuel injection timing than the first combustion mode, and torque correction means for performing torque correction which is requested according to an operating condition of the engine, by using different manipulated variables in the respective first and second combustion modes, the control system comprises combustion mode request means for requesting one of the first and second combustion modes according to an operating condition of the engine, combustion mode judging means for judging an actual combustion mode of each cylinder on the basis of a combustion mode requested by the combustion mode request means and a timing at which a combustion mode is switched as requested, and manipulated variable determining means for determining a manipulated variable for torque correction according to a combustion mode which is judged by the combustion mode judging means.
    </p>
    <p num="29">FIG. 2 shows an internal combustion engine in which the control system of the present invention is embodied.</p>
    <p num="30">Referring to FIG. 2, air is supplied to a combustion chamber of each cylinder of an internal combustion engine 1 installed on a vehicle, from an air cleaner through an intake passage 3 and under control of an electronically control led throttle valve 4.</p>
    <p num="31">The electronically controlled throttle valve 4 is controlled by a step motor or the like which is operated in accordance with a signal from a control unit 20, to vary its opening.</p>
    <p num="32">An electromagnetic type injection valve (injector) 5 is provided for injecting fuel (gasoline) directly into the combustion chamber.</p>
    <p num="33">
      The fuel injection valve 5 opens and injects fuel the pressure of which is regulated to a predetermined value, when its solenoid is energized in response to an injection pulse signal generated by the control unit 20 during the intake stroke or compression stroke in timed relation to an operation of the engine.
      <br/>
      The injected fuel spreads over the inside of the combustion chamber to form a homogeneous mixture in case of injection during the intake stroke.
      <br/>
      In case of injection during the compression stroke, the injected fuel forms a stratified mixture concentrating around a spark plug 6.
      <br/>
      In accordance with an ignition signal from the control unit 20, the injected fuel is ignited to combust (perform homogeneous combustion or stratified combustion).
      <br/>
      In the meantime, the combustion modes can be classified to, when combined with an air/fuel control, a homogeneous/stoichometric combustion mode, homogeneous/lean combustion mode (air/fuel ratio from 20:1 to 30:1), and stratified/lean combustion mode (air/fuel ratio of about 40:1).
    </p>
    <p num="34">The exhaust gas from the engine 1 is discharged through an exhaust passage 7, and a catalyst 8 for exhaust gas purification is provided to the exhaust passage 7.</p>
    <p num="35">
      The control unit 20 has a microcomputer which consists of CPU, ROM, RAM, A/D converter, input/output interface, etc.
      <br/>
      Signals from various sensors are supplied to the control unit 20.
    </p>
    <p num="36">
      Provided as such sensors are crank angle sensors 21 and 22 for detecting a rotation of a crankshaft and camshaft.
      <br/>
      The crank angle sensors 21 and 22 generate reference pulse signals REF every crank angle of 720 (degree)  /n where n is the number of cylinders of the engine 1 and when the crankshaft and camshaft assume a predetermined crank angle position (a predetermined crank angle position before a compression upper dead position in each cylinder), while generating a unit pulse signal POS every crank angle of 1.about.2 (degree) , whereby engine speed Ne can be calculated by the use of a cycle of the reference pulse signal REF.
    </p>
    <p num="37">Further, there are provided an airflow meter 23 at the intake passage 3 upstream of the throttle valve 4 for detecting an intake air quantity Qa, an acceleration sensor 24 for detecting an accelerator opening (amount of depression of accelerator pedal), throttle sensor 25 for detecting an opening TVO of a throttle valve 4 (an idle switch which is turned ON when the throttle valve 4 is put into a fully closed position, is included), a coolant temperature sensor 26 for detecting a coolant temperature Tw of the engine 1, oxygen sensor 27 for generating a signal according to an exhaust air/fuel ratio (i.e., rich/lean state of the exhaust gas) at the exhaust passage 7, and a vehicle speed sensor 28 for detecting a vehicle speed VSP.</p>
    <p num="38">In this instance, the control unit 20 receives signals from the above described various sensors and performs a predetermined calculating process by means of the built-in microcomputer, whereby to control the throttle opening by the electronically controlled throttle valve 4, the fuel injection quantity and the fuel injection timing by the fuel injection valve 5, and the ignition timing by the spark plug 6.</p>
    <p num="39">Then, referring to FIGS. 3 to 7, various control routines for use in the control system of the first embodiment will be described.</p>
    <p num="40">
      FIG. 3 shows a fuel injection quantity calculating routine.
      <br/>
      This routine is executed at the interval of, for example, 10 ms.
    </p>
    <p num="41">
      At step S1, it is judged that which one of a homogeneous combustion mode and a stratified combustion mode is requested.
      <br/>
      In this connection, a combustion mode is requested by another routine constituting a combustion mode request means, on the basis of an engine operating condition and by making a reference to a combustion mode switching map.
    </p>
    <p num="42">
      When it is judged at step S1 that the requested combustion mode is stratified, the control proceeds to step S2 where a combustion mode request flag FSTRR is set to "1".
      <br/>
      When it is judged at step S1 that the requested combustion mode is homogeneous, the control proceeds to step S3 where the flag FSTRR is set to "0".
      <br/>
      Thereafter, the control proceeds from the respective steps to step S4.
    </p>
    <p num="43">
      At step S4, a torque correction factor PIPER which serves as a quick-response correction quantity is read.
      <br/>
      In this connection, the torque correction factor PIPER is a correction factor of a torque which is obtained according to a delayed cylinder intake air quantity dQa which is an actual cylinder intake air quantity and a target equivalence ratio t.o slashed., relative to a target torque which is obtained according to a target cylinder intake air quantity tQa and a target torque t.o slashed.. Accordingly, as the actual torque becomes closer to the target torque by an equivalence ratio correction and an ignition timing correction made in response to request of torque correction which will be described hereinlater, the torque correction factor PIPER becomes smaller.
    </p>
    <p num="44">At step S5, the equivalence ratio correction factor  DELTA .o slashed.0 is calculated by retrieval from the torque correction ratio/equivalence ratio correction factor translation table shown in FIG. 8.</p>
    <p num="45">At step S6, a reference equivalence ratio t.o slashed.0 is calculated by retrieval from a map table or the like on the basis of, for example, target torque and engine speed.</p>
    <p num="46">
      At step S7, the target equivalence ratio is calculated from the following expression.
      <br/>
      t.o slashed.=t.o slashed.0 *  DELTA .o slashed.
    </p>
    <p num="47">At step S8, a fuel injection quantity Ti is calculated on the basis of the above described target equivalence ratio.</p>
    <p num="48">FIG. 4 shows a routine executed at the fuel injection timing (during intake stroke) during homogeneous operation of each cylinder (No. n cylinder).</p>
    <p num="49">
      At step S11, it is judged that the value of the above described combustion mode request flag FSTRR is "0".
      <br/>
      When the flag FSTRR is "0", i.e., when a homogeneous combustion mode is requested, the control proceeds to step S12 where a combustion mode judging flag FHORS(n) indicative of a combustion mode to be actually carried out at the No. n cylinder this time is set to "1" (homogeneous operation), and then to step S13 where it is produced an injection pulse signal equivalent to the fuel injection quantity Ti calculated by the routine shown in FIG. 3, whereby to carry out homogeneous operation.
    </p>
    <p num="50">Further, when at step S11 the value of the flag FSTRR is "0", i.e., when a stratified combustion mode is requested, the control proceeds to step S14 where the above described combustion mode judging flag FHORS(n) is set to "0" (homogeneous combustion mode), and thereafter the routine is ended.</p>
    <p num="51">
      FIG. 5 shows a routine executed at the time of output of a Ref signal at each cylinder (No. n cylinder).
      <br/>
      In this connection, the Ref signal is produced at the time between the fuel injection timing during homogeneous operation and the fuel injection timing during stratified operation of the corresponding cylinder.
    </p>
    <p num="52">At step S21, a torque correction factor PIPER which serves as a quick-response torque correction quantity is calculated.</p>
    <p num="53">
      At step S22, the value of the above described combustion mode judging flag FHORS (n) is judged.
      <br/>
      When the value of the flag FHORS (n) is "1", i.e., when the combustion mode of the No. n cylinder at this time is judged as homogeneous, the control proceeds to step S23 where an ignition timing correction quantity  DELTA  Adv is calculated by retrieval from a torque correction factor/ignition timing correction quantity translation table and then proceeds to step S24 where the above described torque correction factor PIPER is reset to 100%.
      <br/>
      That is, the torque correction is carried out by ignition timing only and the equivalence ratio correction factor in FIG. 3 is set to 1 for thereby preventing torque correction by the equivalence ratio, and thereafter the routine is finished.
    </p>
    <p num="54">Further, at step S22, when the flag FHORS (n) is "0", i.e., when the combustion mode of the No. n cylinder at this time is judged as stratified, the control proceeds to step S25 where  DELTA  Adv is reset to "0" for carrying out the torque correction by the equivalence ratio only and inhibiting the correction by ignition timing, and thereafter the routine is ended.</p>
    <p num="55">FIG. 6 shows a routine executed at each fuel injection timing (during compression stroke) during stratified operation of each cylinder (No. n cylinder).</p>
    <p num="56">
      At step S31, the value of the above described combustion mode judging flag FHORS (n) is judged.
      <br/>
      When the value of the flag FHORS (n) is "1", i.e., when the combustion mode of the No. n cylinder at this time is judged as homogeneous, this routine is finished.
      <br/>
      When, however, the value of the flag FHORS (n) is "0", i.e., when the combustion mode of the No. n cylinder at this time is judged as stratified, the control proceeds to step S32 where it is produced a fuel injection pulse signal equated to the fuel injection quantity Ti calculated by the routine shown in FIG. 3, whereby to execute stratified operation.
    </p>
    <p num="57">
      FIG. 7 shows a routine of ignition timing control at each cylinder (No. n cylinder).
      <br/>
      This routine is executed at a predetermined crank angle prior to the ignition timing such as a time of Ref signal output.
    </p>
    <p num="58">At step S41, it is read a reference ignition timing (AdvO) which is based on an engine operating condition, for example, an engine load and engine speed and corrected by coolant temperature, etc.</p>
    <p num="59">At step S42, a final ignition timing Adv is calculated on the basis of the above described ignition timing correction quantity  DELTA Adv from the following expression.</p>
    <p num="60">Adv=Adv0+ DELTA Adv</p>
    <p num="61">At step S43, it is judged whether the ignition timing Adv calculated as above is reached, and when judged as being reached n ignition pulse is produced to carry out ignition.</p>
    <p num="62">
      By the above, it becomes possible, as shown in FIG. 10, that when the combustion mode is switched from stratified to homogeneous, the combustion mode judging flag FHORS for the cylinders (-1 cylinder and -3 cylinder) whose stratified operation fuel injection timing corresponding to the combustion just after switching of the combustion mode request flag FSTRR exists prior to switching of the combustion mode judging flag FHORS (n), is set to "0" at that fuel injection timing so fuel is injected at the fuel injection timing for stratified operation to carry out stratified combustion, while it becomes possible to execute quick-response torque correction by equivalence ratio which is a manipulated variable for the stratified combustion mode.
      <br/>
      Accordingly, it becomes possible to prevent deteriorated combustion and, in the worst case, a misfire which may result from erroneous torque correction by the use of ignition timing during stratified operation.
    </p>
    <p num="63">
      On the other hand, as shown in FIG. 11, when the combustion mode is switched from homogeneous to stratified, the combustion mode judging flag FHORS for the cylinders (-1 cylinder and -2 cylinder) whose homogeneous operation fuel injection timing corresponding to the combustion just after switching of the combustion mode request flag FSTRR exists prior to switching of the combustion mode judging flag FHORS (n), is set to "1" at that fuel injection timing so fuel is injected at the fuel injection timing during stratified operation to carry out stratified combustion, while it becomes possible to execute quick-response torque correction by ignition timing which is a manipulated variable for the homogeneous combustion mode.
      <br/>
      Accordingly, it becomes possible to prevent torque correction from being disabled due to the incapability of torque correction by the use of equivalence ratio after fuel injection for homogenous operation is finished, and it becomes possible to execute torque correction by the use of ignition timing corresponding to homogeneous operation.
    </p>
    <p num="64">Further, the cylinders (-3 and -4 in FIG. 10, and -3 and -4 in FIG. 11) whose homogeneous operation ignition timing corresponding to the combustion just after switching of the combustion mode request flag FSTRR comes after switching of the flag FSTRR start their operation according to the switched combustion mode from the time just after switching of the flag FSTRR, while it becomes possible to attain, on the basis of the value of the combustion mode judging flag FHORS (n), switching to quick-response torque correction by the use of equivalence ratio according to the switched combustion mode.</p>
    <p num="65">
      FIG. 12 shows a routine executed at the fuel injection timing during homogeneous operation, for use in a control system according to the second embodiment of the present invention.
      <br/>
      This embodiment differs from the first embodiment in that when the combustion mode request flag FSTRR is "0", i.e., when homogeneous operation is requested, a fuel injection pulse signal is produced and thereafter the combustion mode judging flag FHHORS (n) is set to "1".
      <br/>
      Other routines shown in FIGS. 3 and 5 to 7 are executed in this embodiment similarly to the first embodiment.
      <br/>
      This embodiment can operate similarly to the first embodiment and can produce substantially the same effect.
    </p>
    <p num="66">Then, the third embodiment will be described.</p>
    <p num="67">In this embodiment, the routines shown in FIGS. 3, 4 and 6 are executed similarly to the first embodiment (in place of routine in FIG. 4, routine in FIG. 12 may be used), a routine shown in FIG. 13 is executed at the time of output of Ref signal in place of the routine in FIG. 5.</p>
    <p num="68">
      At step S21, the torque correction factor PIPER is calculated for use as a quick-response torque correction quantity, and thereafter it is judged at step S26 whether a predetermined period of time has lapsed after switching of the combustion mode request flag FSTRR or not.
      <br/>
      In this connection, the above described predetermined period of time is a period of time having a possibility that the value of the flag FSTRR and the actual combustion mode do not correspond with each other at a transitional time when the request is switched, and the time of period can be obtained by the experiments conducted previously.
    </p>
    <p num="69">
      Then, before a predetermined period of time lapses after switching of the flag FSTRR, the control proceeds to step S22 where judgement on the value of the flag FHORS (n) is made.
      <br/>
      When it is judged that the flag FHORS (n) is "1" and the combustion mode of the No. n cylinder at this moment is judged as homogeneous, the control proceeds to step S23 where the ignition timing correction quantity  DELTA Adv is calculated.
      <br/>
      Thereafter, the control proceeds to step S24 where the above described torque correction factor PIPER is reset to 100% , and the routine is ended.
      <br/>
      When it is judged at step S22 that the value of the flag FHORS (n) is "0" and the combustion mode of the No. n cylinder at this moment is stratified, the control proceeds to step S25 where the ignition timing correction quantity  DELTA Adv is reset to "0" and then the routine is ended.
    </p>
    <p num="70">
      Further, when it is judged at step S26 that a predetermined period of time has lapsed after switching of the flag FSTRR, the control proceeds to step S27 where the value of the flag FSTRR is judged.
      <br/>
      When the value of the flag FSTRR is "0", the combustion mode of the No. n cylinder at this moment is judged as homogeneous, and the control proceeds to step S28 where the ignition timing correction quantity  DELTA Adv is calculated by retrieval from the torque correction factor/ignition timing correction quantity translation table shown in FIG. 9, or the like.
      <br/>
      Then, the control proceeds to step S29 where the above described torque correction factor PIPER is reset to 100%, and the routine is ended.
    </p>
    <p num="71">
      This embodiment is structured such that after lapse of the above described predetermined period of time the combustion mode is judged by the use of the combustion mode request flag FSTRR in place of the combustion mode judging flag FHORS (n), whereby the calculation load can be reduced.
      <br/>
      That is, in case the flag HORS (n) is used, it is required to carry out on soft ware such a process of selecting one value from the array of the combustion mode judging flag FHORS (n) by using a variable which is a cylinder number n. In case the flag FSTRR is used, such a selection process can be dispensed with, thus making it possible to reduce the calculation load.
    </p>
    <p num="72">Then, the fourth embodiment will be described.</p>
    <p num="73">In this embodiment, the routines in FIGS. 3 and 5 are executed similarly to the first embodiment, and other routines shown in FIGS. 14 to 16 are executed.</p>
    <p num="74">FIG. 14 shows a routine executed at the fuel injection timing during homogeneous operation of the No. n cylinder.</p>
    <p num="75">At step S51, judgement on the value of the combustion mode request flag FSTRR is made.</p>
    <p num="76">
      At step S51, when the value of the flag FSTRR is requested to be "1", i.e., when a stratified combustion mode is requested, this routine is ended.
      <br/>
      On the other hand, when the value of the flag FSTRR is requested to be "0", i.e., a homogeneous combustion mode is requested, the control proceeds to the step S52 where a fuel injection pulse signal (Ti) is produced.
    </p>
    <p num="77">
      At step S53, it is judged whether a predetermined crank angle  BETA  (second set crank angle) has been past after the fuel injection timing during the requested homogeneous operation or not.
      <br/>
      In this connection, the above described set crank angle  BETA  is set to a crank angle between the fuel injection timing during homogeneous operation of the No. n cylinder and the fuel injection timing during homogeneous operation of the No. (n+1) cylinder (e.g., 180 degrees in case of four-cylinder internal combustion engine).
    </p>
    <p num="78">
      When it is judged that the set crank angle  BETA  MU has not yet been past, the control proceeds to step S54 where the it is judged whether the combustion mode request flag FSTRR has been switched to "1" or not.
      <br/>
      In the event the flag FSTRR has been switched to "1" before the set crank angle  BETA  is past, the control proceeds to step S55 where the combustion mode judging flag FHORS (n+1) for the next No. (n+1) cylinder is switch to "0", i.e., a stratified combustion mode, whereas in the event the flag FSTRR is maintained at "0", the control proceeds to step S56 where the combustion mode judging flag FHORS for the next No. (n+1) cylinder is maintained at "1", and thereafter the control returns to step S153.
    </p>
    <p num="79">When it is judged at step S53 that the set crank angle has been past, this routine is ended.</p>
    <p num="80">
      That is, in the event fuel injection for homogeneous operation is carried out at No. n cylinder and homogeneous operation is performed at that cylinder, it is judged that also the combustion mode of the next No. (n+1) cylinder is judged as homogeneous unless the flag STRR is switched to "1" (i.e., homogenous combustion mode) before the set crank angle  BETA  is past after execution of fuel injection, i.e., until the fuel injection timing during homogeneous operation of the next No. (n+1) cylinder comes.
      <br/>
      Although there is a possibility that switching to the stratified combustion mode occurs after that, it will become incapable of carrying out homogeneous operation unless fuel injection is carried out at that moment, so fuel injection is carried out to perform homogenous operation.
      <br/>
      Further, in the event the flag FSTRR is switched to "1" (stratified combustion mode) before the set crank angle  BETA  is past, the combustion or operation of the No. (n+1) cylinder can be stratified as requested and thus it is judged that the combustion mode is stratified.
    </p>
    <p num="81">FIG. 15 shows a routine executed at the fuel injection timing during stratified operation of No. n cylinder.</p>
    <p num="82">
      At step S31, judgement on the value of the combustion mode judging flag FHORS (n) is made.
      <br/>
      When the value of the flag FHORS (n) is "1", the control proceeds to step S61, whereas when the value is "0", the control proceeds to step S32 where fuel injection for stratified operation of the No. n cylinder is carried out, and thereafter the control proceeds to step S61.
    </p>
    <p num="83">After the process similar to that shown in FIG. 6 is carried out, it is judged at step S61 whether the combustion mode request flag FSTRR is "1", i.e., the stratified combustion mode is requested.</p>
    <p num="84">When it is judged that the flag FSTRR is "1", the control proceeds to step S62 where it is judged whether fuel injection for stratified operation of the No. n cylinder has been executed out or not.</p>
    <p num="85">In the event it is judged at step S62 that fuel injection for stratified operation of the No. n cylinder has been executed, the control proceeds to step S63 where the combustion mode judging flag FHORS (n+1) is set to "0", and it is judged that the combustion mode of the next No. (n+1) cylinder is stratified.</p>
    <p num="86">This is because in the event the stratified combustion mode is requested at the fuel injection timing for stratified operation of the No. n cylinder and stratified operation is carried out, the fuel injection timing for homogeneous operation of the next No. (n+1) cylinder has already been past as shown in FIG. 17 and it is impossible to carry out homogeneous operation at the No. (n+1) cylinder even if the request of the combustion mode is switched to that for homogeneous after that, so the combustion mode of the No. (n+1) cylinder is judged as stratified.</p>
    <p num="87">FIG. 16 shows a routine executed when the combustion mode request flag FSTRR is switched from "1" (stratified combustion mode) to "0" (homogeneous combustion mode).</p>
    <p num="88">
      At step S71, it is judged whether a set crank angle a (first set crank angle) has been past after switching of the above described request or not.
      <br/>
      In this connection, the crank angle  ALPHA , as shown in FIG. 17, is set to a crank angle between the fuel injection timing for homogeneous operation of the No. (n+1) cylinder and the fuel injection timing for stratified operation of the No. n cylinder.
    </p>
    <p num="89">When it is the time before the set crank angle is past, the control proceeds to step S72 where it is judged whether fuel injection for stratified operation is executed at the No. n cylinder so that the No. n cylinder is in a condition of carrying out stratified operation or not.</p>
    <p num="90">When it is judged that fuel injection for stratified operation has been executed, the control proceeds to step S73 where the combustion mode judging flag FHORS 8n+1) is set to "0" and it is judged that the combustion mode of the next No. (n+1) cylinder as stratified, and thereafter the routine is ended.</p>
    <p num="91">
      When it is judged that fuel injection for stratified operation has not yet been executed, the control proceeds to step S74 where it is judged whether the combustion mode request flag FSTRR is switched to "1" (stratified operation).
      <br/>
      When it is judged that the combustion mode has been switched to stratified, this routine is ended, and when not switched the control returns to step S71.
    </p>
    <p num="92">In the event the above described set crank angle  ALPHA  is past without execution of fuel injection for stratified operation and without switching of the combustion mode request flag FSTRR, i.e., in the event stratified operation will be executed after the set crank angle  ALPHA  is past (since stratified operation will necessarily be executed, recognition of its execution is not necessary), the control proceeds to step S75 where the combustion mode judging flag FHORS (n+1) is set to "1" and judgement is made on the combustion mode on the next No. (n+1) cylinder, and thereafter the routine is ended.</p>
    <p num="93">
      That is, the case fuel injection for stratified operation of the No. n cylinder is carried out before the above described set crank angle is past is the case the request is switched to homogeneous operation after the fuel injection timing for homogeneous operation of the No. (n+1) cylinder, so the No. (n+1) cylinder cannot carry out homogeneous operation but stratified operation and thus the combustion mode of the No. (n+1) cylinder is judged as homogenous.
      <br/>
      Further, the case fuel injection for stratified operation of the No. n cylinder is carried out after passage of the set crank angle  ALPHA  is the case the request is switched to homogeneous before the fuel injection timing for homogeneous operation of the No. (n+1) cylinder, so the No. (n+1) cylinder can perform homogeneous operation and thus the combustion mode of the No. (n+1) cylinder is judged as homogeneous.
    </p>
    <p num="94">Then, the fifth embodiment will be described.</p>
    <p num="95">In this embodiment, the routines of FIGS. 3 and 5 to 7 are executed similarly to the first embodiment, and in addition the routine shown in FIG. 18 is executed.</p>
    <p num="96">FIG. 18 shows a routine of a fuel injection timing for homogeneous operation of the No. n cylinder.</p>
    <p num="97">The steps S51 to S56 are the same as those of the routine shown in FIG. 14, so repeated description thereto is omitted for brevity.</p>
    <p num="98">
      In case at step S51 the value of the combustion mode request flag FSTRR is requested to "1", i.e., stratified operation is requested, the control proceeds to step S81 where it is judged whether the above described set crank angle  BETA  (second set crank angle) has been past after the fuel injection timing for the corresponding homogeneous operation.
      <br/>
      In case the set crank angle  BETA  has not yet been past, the control proceeds to step S82 where it is judged whether the combustion mode request flag FSTRR has been switched to "0".
      <br/>
      In case the flag FSTRR is switched to "0" before the set crank angle  BETA  is past, the control proceeds to step S83 where the combustion mode judging flag FHORS (n+1) for the next No (n+1) cylinder is switched to "1", i.e., homogeneous.
      <br/>
      In case the flag FSTRR is maintained at "1", the control proceeds to step S84 where the combustion mode judging flag FHORS (n+1) for the No. (n+1) cylinder is maintained at "0", and thereafter the control returns to step S81 and when it is judged at step S81 that the set crank angle  BETA  has been past the control routine is ended.
    </p>
    <p num="99">
      That is, in case the combustion mode request is not switched to homogeneous before the set crank angle  BETA  is past after the condition where the stratified combustion mode is requested at the fuel injection timing for homogeneous operation of the No. n cylinder, i.e., from that condition till the fuel injection timing for homogeneous operation of the No. (n+1) cylinder, it is necessary to execute stratified operation since it is impossible, even if the combustion mode request is switched to homogeneous later, the fuel injection timing for homogeneous operation of the No. (n+1) cylinder has already been past, so the combustion mode of the No. (n+1) cylinder is judged as stratified.
      <br/>
      Further, in case the request is switched to the stratified combustion mode before the set crank angle  BETA  is past, switching of the request has been made before the fuel injection timing for homogeneous operation of the No. (n+1) cylinder, so homogeneous operation can be carried out as requested and thus the combustion mode of the No. (n+1) cylinder is judged as homogeneous.
    </p>
    <p num="100">While in the above described embodiments the combustion mode judging flag FHORS (n) is provided to each cylinder, the flags FHORS for the respective cylinder can be a single variable if the periods of time from setting of the flags for the respective cylinder tilI selection of manipulated variables for quick-response torque correction at the time of production of a Ref signal do not overlap each other.</p>
    <p num="101">
      FIG. 19 shows a control system according to the sixth embodiment of the present invention.
      <br/>
      As illustrated, the control system comprises combustion mode switching means for switching a combustion mode from one of a homogeneous combustion mode and a stratified combustion mode to the other according to an operating condition of the engine, torque correction request means for requesting torque correction according to an operating condition of the engine, torque correction means (for homogeneous combustion mode and stratified combustion mode) for making the torque correction by manipulating different manipulated variables in the respective homogeneous and stratified combustion modes, and manipulated variable switching timing setting means for setting, when the combustion mode switching means is requested to switch a combustion mode during execution of the torque correction, a manipulated variable switching timing at which the manipulated variables are switched, according to whether the combustion mode is switched by the combustion mode switching means from the homogeneous combustion mode to the stratified combustion mode or vice versa.
    </p>
    <p num="102">
      Referring to the flowchart of FIG. 20, the torque control (torque correction) routine for use in the control system according to the sixth embodiment of the present invention will be described.
      <br/>
      This routine is executed at an interval of a predetermined time, specifically every 10 ms (10 ms-JOB) during the time a quick-response torque correction is requested.
    </p>
    <p num="103">
      At step S101, judgement is made on whether a combustion mode is homogeneous or stratified.
      <br/>
      In this connection, the combustion mode is requested by another routine constituting a combustion mode switching means, on the basis of an engine operating condition and by making a reference to a combustion mode changing map.
    </p>
    <p num="104">
      When it is judged at step S101 that the combustion mode is stratified, the control proceeds to step S102 where a torque correction factor PIPER is read.
      <br/>
      In this connection, the torque correction factor PIPER is a correction factor of a torque which is obtained according to a delayed cylinder intake air quantity dQa which is an actual cylinder intake air quantity and a target equivalence ratio t.o slashed., relative to a target torque which is obtained according to a target cylinder intake air quantity tQa and a target torque t.o slashed.. Accordingly, as the actual torque becomes closer to the target torque by an equivalence ratio correction and an ignition timing correction made in response to request of torque correction which will be described hereinlater, the torque correction factor PIPER becomes smaller.
    </p>
    <p num="105">
      At step S103, it is judged whether the torque correction factor PIPER which is becoming smaller as described above, is smaller than a predetermined value  EPSILON .
      <br/>
      When it is judged that the torque correction factor PIPER is not smaller than the predetermined value, the control proceeds to step S104.
    </p>
    <p num="106">At step S104, the equivalence ratio correction factor  DELTA .o slashed.O is calculated by retrieval from the torque correction ratio/equivalence ratio correction factor translation table shown in FIG. 8.</p>
    <p num="107">
      At step S105, the above described equivalence ratio correction factor  DELTA .o slashed.O is stored for use as a predetermined variable.
      <br/>
      By this, a control for correcting the equivalence ratio by the use of the equivalence ratio correction factor  DELTA .o slashed.O is executed by another job, and torque correction according to the torque correction factor PIPER is carried out.
    </p>
    <p num="108">At step S106, a flag FADJINH which indicates that it is during correction of the equivalence ratio at the time of stratified operation, is set to "1".</p>
    <p num="109">When, as a result of making correction of the equivalence ratio as above, it is judged at step S103 that the torque correction factor PIPER is smaller than the predetermined value  EPSILON , it is determined that the equivalence ratio has converged sufficiently to a target value and correction has been completed, and the control proceeds to step S107 where the above described flag FADJINH is reset to "0".</p>
    <p num="110">On the other hand, when it is judged at step S101 that the combustion mode is homogeneous, the control proceeds to step S108 where judgement on the value of the flag FADJINH is made.</p>
    <p num="111">When the above described flag FADJINH is "0", that is, when the combustion mode is switched to homogeneous when torque correction during stratified operation is not executed, the control proceeds to step S109 where the torque correction factor PIPER is read.</p>
    <p num="112">At step S110, the ignition timing correction quantity  DELTA Adv0 is calculated by retrieval from the torque correction factor/ignition timing correction quantity translation table shown in FIG. 8, or the like.</p>
    <p num="113">
      At step S111, the above described ignition timing correction quantity  DELTA Adv0 is stored for use as a predetermined variable.
      <br/>
      By this, a control for correcting the ignition timing by the ignition timing correcting quantity  DELTA Adv0 is executed by another job, and correction according to the torque correction factor PIPER is carried out.
    </p>
    <p num="114">On the other hand, when it is judged at step S108 that the flag FADJINH is "1", i.e., when the combustion mode is switched to homogeneous during execution of the torque correction at the time of the above described homogeneous operation, the control returns to step S102 where the torque correction by the use of the equivalence ratio is executed continuously.</p>
    <p num="115">
      In the meantime, the routine may be structured such that after the flag FADJINH is reset to "0" at step S107, the control proceeds to step S110 (the same in the second embodiment in FIG. 7).
      <br/>
      That is, although the ignition timing correction should not be made during homogeneous operation in principal, such correction is carried out, after the torque correction factor PIPER becomes smaller than the predetermined value  EPSILON  and therefore becomes to be a sufficiently small value, for making fine adjustment of the ignition timing and thereby allowing it to go closer to zero.
    </p>
    <p num="116">FIG. 21 shows a state resulting when under the control of the first embodiment, switching to homogeneous charge operation takes place during execution of torque correction in response to request of torque correction at the time of stratified operation.</p>
    <p num="117">
      When an air conditioner switch is turned on during stratified operation, increase of torque is requested, and in response to this request the target intake air quantity is increased to increase the intake air quantity.
      <br/>
      However, it is after the equivalence ratio correction factor  DELTA .o slashed.O is increased gradually in time to delay in increase of the actual intake air quantity for thereby maintaining the torque constant that an air conditioner relay is turned on to start operation of the air conditioner.
      <br/>
      At this step of procedure, the intake air quantity has not yet reached the target value, so the equivalence ratio correction factor  DELTA .o slashed.O is increased sharply and suddenly in such a manner as to show a jump for thereby increasing torque responsively and is then reduced gradually in time to subsequent increase of the intake air quantity, whereby to maintain the torque constant.
    </p>
    <p num="118">
      When it is requested to switch the combustion mode during execution of torque correction by correction of the equivalence ratio during stratified operation, there is a possibility of causing a sudden and sharp variation of torque at the transition between the equivalence ratio correction and the ignition timing correction since during homogeneous operation the torque correction is properly made by the ignition timing correction.
      <br/>
      Thus, in the event the combustion mode is switched to homogeneous during correction of torque by the use of the equivalence ratio in stratified operation, torque correction by the use of the equivalence ratio is continued after that time, whereby occurrence of a sudden and sharp variation of torque at that transition can be avoided and a torque shock can be prevented.
      <br/>
      Further, as a reason why the correction by the equivalence ratio is continued, there can be adduced that when switching to the ignition timing correction is made at the time of homogeneous operation, the torque cannot be increased by ignition timing advance if the basic ignition timing for homogeneous operation is set adjacent to MBT (ignition timing at which maximum torque is produced) and therefore desired torque correction cannot be attained.
    </p>
    <p num="119">FIG. 22 shows a state resulting when under the control of the first embodiment, torque correction is requested at the time of homogeneous operation and switching to stratified operation takes place during execution of the torque correction.</p>
    <p num="120">
      When the air conditioner switch is turned on at the time of homogeneous operation, a control for increasing the intake air quantity starts and the ignition timing correction quantity  DELTA Adv is retarded, whereby to maintain the toque constant.
      <br/>
      After that, the air conditioner relay is turned on to start operation of the air conditioner, the deficiency of the intake air quantity with respect to the target value is compensated for by increasing the ignition timing correction quantity  DELTA Adv sharply and suddenly in a way as to show a jump, for thereby increasing the torque responsively, and the ignition timing correction quantity  DELTA Adv is reduced gradually in time to subsequent increase of the intake air quantity, whereby to maintain the torque constant.
    </p>
    <p num="121">
      When it is requested to switch the combustion mode during execution of torque correction by the ignition timing correction at the time of homogeneous operation, it is actually impossible to execute the torque correction by the ignition timing correction since, as mentioned above, the ignition timing correction range is small during stratified operation.
      <br/>
      Thus, simultaneously with switching of the combustion mode, the equivalence ratio correction factor  DELTA .o slashed. corresponding to the torque correction factor at that moment is calculated by retrieval from a map, or the like and thereafter the equivalence ratio correction factor is reduced gradually in time to increase of the intake air quantity.
    </p>
    <p num="122">Referring to FIG. 23, a torque control (torque correction) according to the seventh embodiment will be described.</p>
    <p num="123">
      The difference from the sixth embodiment shown in FIG. 20 resides in that, in contrast to the first embodiment constructed to complete at step S103 the torque correction by the equivalence ratio correction factor  DELTA .o slashed. when the equivalence ratio correction factor  DELTA .o slashed.
      <br/>
      PIPER becomes smaller than a predetermined value, the second embodiment is constructed to complete at step S121 the torque correction when the deviation .vertline.
      <br/>
      DELTA .o slashed.O-1 .vertline. of the equivalence ratio correction factor  DELTA .o slashed.O decreasing with decrease of the torque correction factor PIPER, from a reference value "1" in case of no equivalence ratio correction, becomes smaller than a predetermined  EPSILON .
      <br/>
      Except for the above, the second embodiment is substantially similar to the first embodiment.
    </p>
    <p num="124">
      Referring to FIG. 24, a torque control (torque correction) according to the eighth embodiment of the present invention will be described.
      <br/>
      In this embodiment, a predetermined time is set to be sufficiently longer as compared with the time from request of the quick response torque correction till finish of that correction, and the torque correction by the equivalence ratio correction factor  DELTA .o slashed.O is continued even when switching to homogeneous operation takes place during the predetermined time.
    </p>
    <p num="125">
      Specifically, when it is judged at step S101 that the combustion mode is homogeneous, the control proceeds to step S131 where it is judged whether it is the time just after request of torque correction or not.
      <br/>
      In case it is the time just after request of torque correction, the control proceeds to step S132 where the value of the counter N for measurement of time is reset to "0".
      <br/>
      Thereafter, at step S104 the torque correction factor PIPER is read, at step S133 the equivalence ratio correction factor  DELTA .o slashed.O is calculated, and at step S105 the equivalence ratio correction factor  DELTA .o slashed.O is stored for used as a predetermined variable, whereby to execute the torque correction by the equivalence ratio correction.
    </p>
    <p num="126">
      Then, it is judged at step S134 whether the value of the above described counter N becomes a predetermined value Nset or not.
      <br/>
      In case of no, it is determined that there is a possibility that the torque correction has not yet been finished, so at step S135 the flag FADJHN is set to "1" and thereafter at step S136 increment of the value of the counter N is carried out.
      <br/>
      Further, in case it is judged at step S134 that the value of the counter N becomes the predetermined value Nset, it is determined that a sufficient time has lapsed to allow the torque correction to be finished,and at step S137 and step S138 the flag FADJHN and the counter N are reset to "0" in sequence.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A control system for an internal combustion engine, comprising:</claim-text>
      <claim-text>a mode selecting section for selecting one of a first combustion mode and a second combustion mode for each of cylinders of the engine, the second combustion mode being later in a fuel injection timing than the first combustion mode; a torque correction requesting section for generating a torque correction request signal for a torque correction according to operation of the engine; a variable selecting section for selecting a manipulated variable according to whether the combustion mode is changed from the first combustion mode to the second combustion mode or from the second combustion mode to the first combustion mode;</claim-text>
      <claim-text>and a torque correction section for performing torque correction for each of the cylinders, in response to the torque correction request signal and to the manipulated variable selected by the variable selecting section.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. The engine as claimed in claim 1, wherein the variable selecting section switches manipulated variables in a predetermined period later than the time when the mode selecting section switches the combustion mode from the second combustion mode to the first combustion mode.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. The engine as claimed in claim 2, wherein the predetermined period is a period of time until a value of the torque correction requested by the torque correction requesting section becomes smaller than a predetermined value.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. The engine as claimed in claim 2, wherein the predetermined period is a period of time until a value of the manipulated variable for attaining transitional torque correction becomes smaller than a predetermined value.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. The engine as claimed in claim 1, wherein the variable selecting section switches the manipulated variables at the same time when the mode selecting section switches the combustion mode from the first combustion mode to the second combustion mode.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. The engine as claimed in claim 1, wherein the torque correction section completes the torque correction within a transitional and limited period of time.</claim-text>
    </claim>
    <claim num="7">
      <claim-text>7. The engine as claimed in claim 1, wherein the first combustion mode is homogeneous charge combustion, and the second combustion mode is stratified charge combustion.</claim-text>
    </claim>
    <claim num="8">
      <claim-text>8. The engine as claimed in claim 1, wherein the manipulated variable for torque correction in the first combustion mode comprises at least an ignition spark timing, and the manipulated variable for torque correction in said second combustion mode is comprises a rate of fuel and air.</claim-text>
    </claim>
  </claims>
</questel-patent-document>