<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06185307B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06185307</doc-number>
        <kind>B2</kind>
        <date>20010206</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6185307</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference is-representative="YES" family-id="25404476" extended-family-id="1494822">
      <document-id>
        <country>US</country>
        <doc-number>09006245</doc-number>
        <kind>A</kind>
        <date>19980113</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1998US-09006245</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>43124663</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>624598</doc-number>
        <kind>A</kind>
        <date>19980113</date>
        <priority-active-indicator>N</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1998US-09006245</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="2">
        <country>US</country>
        <doc-number>89541797</doc-number>
        <kind>A</kind>
        <date>19970716</date>
        <priority-linkage-type>3</priority-linkage-type>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="2">
        <doc-number>1997US-08895417</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010206</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>G06Q  20/02        20120101A I20150218RMEP</text>
        <ipc-version-indicator>
          <date>20120101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>02</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20150218</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>G06Q  20/04        20120101A I20150218RMEP</text>
        <ipc-version-indicator>
          <date>20120101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>04</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20150218</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="3">
        <text>G06Q  20/08        20120101A I20150218RMEP</text>
        <ipc-version-indicator>
          <date>20120101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>08</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20150218</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="4">
        <text>G06Q  20/20        20120101A I20150218RMEP</text>
        <ipc-version-indicator>
          <date>20120101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>20</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20150218</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="5">
        <text>G06Q  20/28        20120101A I20150218RMEP</text>
        <ipc-version-indicator>
          <date>20120101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>28</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20150218</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="6">
        <text>G06Q  20/34        20120101A I20150218RMEP</text>
        <ipc-version-indicator>
          <date>20120101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>34</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20150218</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="7">
        <text>G06Q  20/36        20120101A I20150218RMEP</text>
        <ipc-version-indicator>
          <date>20120101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>36</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20150218</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="8">
        <text>G06Q  20/38        20120101A I20150218RMEP</text>
        <ipc-version-indicator>
          <date>20120101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>38</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20150218</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="9">
        <text>G06Q  20/40        20120101A I20150218RMEP</text>
        <ipc-version-indicator>
          <date>20120101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>40</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20150218</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="10">
        <text>G07F   7/08        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>07</class>
        <subclass>F</subclass>
        <main-group>7</main-group>
        <subgroup>08</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="11">
        <text>G07F   7/10        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>07</class>
        <subclass>F</subclass>
        <main-group>7</main-group>
        <subgroup>10</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="12">
        <text>G07F  13/02        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>07</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>02</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>380270000</text>
        <class>380</class>
        <subclass>270000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>380044000</text>
        <class>380</class>
        <subclass>044000</subclass>
      </further-classification>
      <further-classification sequence="2">
        <text>380045000</text>
        <class>380</class>
        <subclass>045000</subclass>
      </further-classification>
      <further-classification sequence="3">
        <text>380047000</text>
        <class>380</class>
        <subclass>047000</subclass>
      </further-classification>
      <further-classification sequence="4">
        <text>705064000</text>
        <class>705</class>
        <subclass>064000</subclass>
      </further-classification>
      <further-classification sequence="5">
        <text>705065000</text>
        <class>705</class>
        <subclass>065000</subclass>
      </further-classification>
      <further-classification sequence="6">
        <text>705071000</text>
        <class>705</class>
        <subclass>071000</subclass>
      </further-classification>
      <further-classification sequence="7">
        <text>705077000</text>
        <class>705</class>
        <subclass>077000</subclass>
      </further-classification>
      <further-classification sequence="8">
        <text>705078000</text>
        <class>705</class>
        <subclass>078000</subclass>
      </further-classification>
      <further-classification sequence="9">
        <text>705079000</text>
        <class>705</class>
        <subclass>079000</subclass>
      </further-classification>
      <further-classification sequence="10">
        <text>713172000</text>
        <class>713</class>
        <subclass>172000</subclass>
      </further-classification>
      <further-classification sequence="11">
        <text>713185000</text>
        <class>713</class>
        <subclass>185000</subclass>
      </further-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>G07F-007/10D</text>
        <section>G</section>
        <class>07</class>
        <subclass>F</subclass>
        <main-group>007</main-group>
        <subgroup>10D</subgroup>
      </classification-ecla>
      <classification-ecla sequence="2">
        <text>G06Q-020/027</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>027</subgroup>
      </classification-ecla>
      <classification-ecla sequence="3">
        <text>G06Q-020/04</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>04</subgroup>
      </classification-ecla>
      <classification-ecla sequence="4">
        <text>G06Q-020/085</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>085</subgroup>
      </classification-ecla>
      <classification-ecla sequence="5">
        <text>G06Q-020/0855</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>0855</subgroup>
      </classification-ecla>
      <classification-ecla sequence="6">
        <text>G06Q-020/20</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>20</subgroup>
      </classification-ecla>
      <classification-ecla sequence="7">
        <text>G06Q-020/202</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>202</subgroup>
      </classification-ecla>
      <classification-ecla sequence="8">
        <text>G06Q-020/28</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>28</subgroup>
      </classification-ecla>
      <classification-ecla sequence="9">
        <text>G06Q-020/341</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>341</subgroup>
      </classification-ecla>
      <classification-ecla sequence="10">
        <text>G06Q-020/3576</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>3576</subgroup>
      </classification-ecla>
      <classification-ecla sequence="11">
        <text>G06Q-020/363</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>363</subgroup>
      </classification-ecla>
      <classification-ecla sequence="12">
        <text>G06Q-020/367</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>367</subgroup>
      </classification-ecla>
      <classification-ecla sequence="13">
        <text>G06Q-020/3674</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>3674</subgroup>
      </classification-ecla>
      <classification-ecla sequence="14">
        <text>G06Q-020/382</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>382</subgroup>
      </classification-ecla>
      <classification-ecla sequence="15">
        <text>G06Q-020/3823</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>3823</subgroup>
      </classification-ecla>
      <classification-ecla sequence="16">
        <text>G06Q-020/3829</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>3829</subgroup>
      </classification-ecla>
      <classification-ecla sequence="17">
        <text>G06Q-020/4093</text>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>4093</subgroup>
      </classification-ecla>
      <classification-ecla sequence="18">
        <text>G07F-007/08C</text>
        <section>G</section>
        <class>07</class>
        <subclass>F</subclass>
        <main-group>007</main-group>
        <subgroup>08C</subgroup>
      </classification-ecla>
      <classification-ecla sequence="19">
        <text>G07F-013/02B</text>
        <section>G</section>
        <class>07</class>
        <subclass>F</subclass>
        <main-group>013</main-group>
        <subgroup>02B</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G07F-007/1008</classification-symbol>
        <section>G</section>
        <class>07</class>
        <subclass>F</subclass>
        <main-group>7</main-group>
        <subgroup>1008</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/027</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>027</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20121105</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/04</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>04</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="4">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/085</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>085</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20121105</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="5">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/0855</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>0855</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20121105</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="6">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/20</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>20</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="7">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/202</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>202</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20121105</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="8">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/28</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>28</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="9">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/341</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>341</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="10">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/3576</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>3576</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="11">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/363</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>363</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="12">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/367</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>367</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20121105</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="13">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/3674</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>3674</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20121105</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="14">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/382</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>382</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20121105</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="15">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/3823</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>3823</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="16">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/3829</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>3829</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20121105</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="17">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06Q-020/4093</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>Q</subclass>
        <main-group>20</main-group>
        <subgroup>4093</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="18">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G07F-007/0866</classification-symbol>
        <section>G</section>
        <class>07</class>
        <subclass>F</subclass>
        <main-group>7</main-group>
        <subgroup>0866</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="19">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G07F-013/025</classification-symbol>
        <section>G</section>
        <class>07</class>
        <subclass>F</subclass>
        <main-group>13</main-group>
        <subgroup>025</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>19</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>25</number-of-drawing-sheets>
      <number-of-figures>25</number-of-figures>
      <image-key data-format="questel">US6185307</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Cryptography security for remote dispenser transactions</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>HORNE DONALD R</text>
          <document-id>
            <country>US</country>
            <doc-number>4887296</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4887296</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>GARGIULO JOSEPH L, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4935961</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4935961</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>SHAW WILLIAM Y</text>
          <document-id>
            <country>US</country>
            <doc-number>5425103</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5425103</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="4">
          <text>GINSBURGH IRWIN, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>3536109</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US3536109</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="5">
          <text>GINSBURGH IRWIN, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>3642036</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US3642036</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="6">
          <text>CHAMBERS ROBERT R, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>3650303</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US3650303</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="7">
          <text>CRANDALL STANLEY C, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>3662924</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US3662924</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="8">
          <text>WOSTL W, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>3786421</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US3786421</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="9">
          <text>WOSTL W</text>
          <document-id>
            <country>US</country>
            <doc-number>3814148</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US3814148</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="10">
          <text>VAN NESS BRADFORD O</text>
          <document-id>
            <country>US</country>
            <doc-number>4263945</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4263945</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="11">
          <text>STEPHENS WALTER R, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4313168</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4313168</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="12">
          <text>STORY JAMES R, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4345146</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4345146</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="13">
          <text>CHESAREK DONALD J</text>
          <document-id>
            <country>US</country>
            <doc-number>4386266</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4386266</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="14">
          <text>WALKEY LAURENCE J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4469149</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4469149</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="15">
          <text>FRANKS JAMES A, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4490798</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4490798</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="16">
          <text>LEMELSON JEROME H</text>
          <document-id>
            <country>US</country>
            <doc-number>4532511</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4532511</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="17">
          <text>ZEIDLER HOWARD M</text>
          <document-id>
            <country>US</country>
            <doc-number>4578530</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4578530</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="18">
          <text>WALTON CHARLES A</text>
          <document-id>
            <country>US</country>
            <doc-number>4600829</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4600829</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="19">
          <text>BARTLETT DAVID</text>
          <document-id>
            <country>US</country>
            <doc-number>4714925</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4714925</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="20">
          <text>HANE BENGT</text>
          <document-id>
            <country>US</country>
            <doc-number>4728955</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4728955</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="21">
          <text>BYDLON JEAN</text>
          <document-id>
            <country>US</country>
            <doc-number>4760533</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4760533</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="22">
          <text>FOCKENS TALLIENCO W H</text>
          <document-id>
            <country>US</country>
            <doc-number>4846233</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4846233</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="23">
          <text>HOLLERBACK JAMES A</text>
          <document-id>
            <country>US</country>
            <doc-number>4881581</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4881581</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="24">
          <text>WOODCOCK WILLIAM F, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4887578</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4887578</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="25">
          <text>DILULLO JOSEPH V, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4897642</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4897642</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="26">
          <text>LAMONT IAIN A J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4934419</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4934419</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="27">
          <text>KAEHLER DAVID L</text>
          <document-id>
            <country>US</country>
            <doc-number>4967366</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4967366</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="28">
          <text>DILULLO JOSEPH V, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5025253</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5025253</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="29">
          <text>STEWART STEDMAN J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5058044</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5058044</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="30">
          <text>FOCKENS TALLIENCO W H</text>
          <document-id>
            <country>US</country>
            <doc-number>5070328</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5070328</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="31">
          <text>RANDELMAN ROBERT E, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5072380</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5072380</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="32">
          <text>HASSETT JOHN J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5086389</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5086389</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="33">
          <text>SIMPSON W DWAIN, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5131441</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5131441</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="34">
          <text>HALL GERALD L</text>
          <document-id>
            <country>US</country>
            <doc-number>5156198</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5156198</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="35">
          <text>SIMPSON W DWAIN, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5184309</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5184309</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="36">
          <text>IIJIMA YASUO</text>
          <document-id>
            <country>US</country>
            <doc-number>5202922</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5202922</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="37">
          <text>IEKI TOSHIHARU, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5204512</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5204512</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="38">
          <text>RYAN MICHAEL C</text>
          <document-id>
            <country>US</country>
            <doc-number>5204819</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5204819</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="39">
          <text>SIMPSON W DWAIN, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5217051</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5217051</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="40">
          <text>CORFITSEN STEN</text>
          <document-id>
            <country>US</country>
            <doc-number>5238034</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5238034</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="41">
          <text>PARKS RICHARD G, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5249612</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5249612</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="42">
          <text>SIMPSON DWAIN W, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5267592</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5267592</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="43">
          <text>SMITH HARRY F</text>
          <document-id>
            <country>US</country>
            <doc-number>5327066</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5327066</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="44">
          <text>SIMPSON W DWAIN, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5327945</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5327945</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="45">
          <text>TIBBALS III HARRY F</text>
          <document-id>
            <country>US</country>
            <doc-number>5343906</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5343906</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="46">
          <text>RYAN MICHAEL C</text>
          <document-id>
            <country>US</country>
            <doc-number>5359522</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5359522</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="47">
          <text>SIMPSON W DWAIN, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5363889</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5363889</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="48">
          <text>SIMPSON W DWAIN, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5365984</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5365984</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="49">
          <text>DWARS SICCO, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5383500</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5383500</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="50">
          <text>GUNNARSSON STAFFAN</text>
          <document-id>
            <country>US</country>
            <doc-number>5392049</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5392049</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="51">
          <text>CORFITSEN STEN</text>
          <document-id>
            <country>US</country>
            <doc-number>5393195</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5393195</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="52">
          <text>GUNNARSSON STAFFAN</text>
          <document-id>
            <country>US</country>
            <doc-number>5414427</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5414427</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="53">
          <text>ROGGE STANLEY A, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5500890</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5500890</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="54">
          <text>TANNENBAUM DAVID H</text>
          <document-id>
            <country>US</country>
            <doc-number>5521363</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5521363</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="55">
          <text>TAYLOR DOUGLAS C</text>
          <document-id>
            <country>US</country>
            <doc-number>5578808</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5578808</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="56">
          <text>NGUYEN MINHTAM C</text>
          <document-id>
            <country>US</country>
            <doc-number>5638448</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5638448</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="57">
          <text>YAHAGI MASAHIKO</text>
          <document-id>
            <country>US</country>
            <doc-number>5642401</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5642401</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="58">
          <text>RASPOTNIK WILLIAM B</text>
          <document-id>
            <country>US</country>
            <doc-number>5832090</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5832090</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="59">
          <text>AKIYAMA RYOTA, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5832210</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5832210</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="60">
          <text>OKI ELECTRIC IND CO LTD</text>
          <document-id>
            <country>EP</country>
            <doc-number>0134109</doc-number>
            <kind>A2</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>EP-134109</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="61">
          <text>PALOMAR TECHN CORP</text>
          <document-id>
            <country>EP</country>
            <doc-number>0758777</doc-number>
            <kind>A2</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>EP-758777</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="62">
          <document-id>
            <country>IL</country>
            <doc-number>1027682</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>IL1027682</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="63">
          <text>TATSUNO CO LTD</text>
          <document-id>
            <country>JP</country>
            <doc-number>H06227597</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP06227597</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="64">
          <text>CORFITSEN STEN</text>
          <document-id>
            <country>WO</country>
            <doc-number>9406031</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>WO9406031</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="65">
          <text>CORFITSEN STEN</text>
          <document-id>
            <country>WO</country>
            <doc-number>9405592</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>WO9405592</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="66">
          <text>RAPAC NETWORK INT INC, et al</text>
          <document-id>
            <country>WO</country>
            <doc-number>9514612</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>WO9514612</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="67">
          <text>GUNNARSSON STAFFAN</text>
          <document-id>
            <country>WO</country>
            <doc-number>9532919</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>WO9532919</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="68">
          <text>TASK TECHNOLOGY USA INC</text>
          <document-id>
            <country>WO</country>
            <doc-number>9628791</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>WO9628791</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="69">
          <text>NAT WESTMINSTER BANK PLC, et al</text>
          <document-id>
            <country>WO</country>
            <doc-number>9636947</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>WO9636947</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="70">
          <text>DRESSER IND, et al</text>
          <document-id>
            <country>WO</country>
            <doc-number>9724689</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>WO9724689</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="71">
          <document-id>
            <country>ZA</country>
            <doc-number>944327</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>ZA-944327</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="1">
          <text>PCT International Search Report.</text>
        </nplcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="2">
          <text>Sae Meeting Notice; Orvr Interaction with Balance Phase II Vapor Recovery Systems, May 19, 1997.</text>
        </nplcit>
      </citation>
      <citation srep-phase="applicant">
        <nplcit num="3">
          <text>Sae Orvr Task Force Agenda; Open Discussion Topics for Sae Orvr Task Force, May 29, 1997.</text>
        </nplcit>
      </citation>
    </references-cited>
    <related-documents>
      <division>
        <relation>
          <parent-doc>
            <document-id>
              <country>US</country>
              <doc-number>89541797</doc-number>
              <kind>A</kind>
              <date>19970716</date>
            </document-id>
          </parent-doc>
        </relation>
      </division>
    </related-documents>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Gilbarco Inc.</orgname>
            <address>
              <address-1>Greensboro, NC, US</address-1>
              <city>Greensboro</city>
              <state>NC</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>GILBARCO</orgname>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Johnson, Jr., William S.</name>
            <address>
              <address-1>Jamestown, NC, US</address-1>
              <city>Jamestown</city>
              <state>NC</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <orgname>Coats &amp; Bennett, PLLC</orgname>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Swann, Tod R.</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>EXPIRED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      The invention relates to providing secure transactions with a tag and POS device associated with a host network authorization system.
      <br/>
      In doing so, the tag is adapted to bi-directionally communicate with a POS device, preferably a fuel dispenser, which further communicates with a host network to provide authorization of the tag and carry out any desired purchases or transactions.
      <br/>
      To avoid transmitting data from which valuable account or financial information could be derived, between the tag and POS device or the POS device and the host network system, the invention may maintain all or a majority of account and financial information requiring absolute security only at the host network.
      <br/>
      Neither the tag nor the POS device has or has access to certain critical financial or account information.
      <br/>
      The tag also is adapted to communicate with other local sources and the POS device directly.
      <br/>
      Additional and alternate security is available for these communications.
      <br/>
      Furthermore, the local sources may need a password to access certain data stored in the tag's memory.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <p num="1">
      This is a divisional application claiming the benefit of application Ser.
      <br/>
      No. 08/895,417 filed Jul. 16, 1997 entitled CRYPTOGRAPHY SECURITY FOR REMOTE DISPENSER which is incorporated herein by reference.
    </p>
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="2">The present invention relates generally to providing secure transactions between a local transaction device and a remote communication device and, more particularly, to a transponder fuel dispensing system for providing secure authorizations and transactions using the transponder in a fuel delivery, retail sales and service environment.</p>
    <p num="3">
      In recent years, traditional gasoline pumps at service stations have evolved into elaborate point-of-sale (POS) devices having sophisticated control electronics and user interfaces with large displays and touch pads (or screens).
      <br/>
      These dispensers include various types of payment means, such as card readers, to expedite and further enhance fueling transactions.
      <br/>
      A customer is not limited to the purchase of fuel at the dispenser.
      <br/>
      More recent dispensers allow the customer to purchase services, such as car washes, and goods such as fast food or convenience store products at the dispenser.
      <br/>
      Once purchased, the customer need only pick up the goods and services at the station store.
    </p>
    <p num="4">
      Given the ever increasing demand to increase transaction efficiency by both fuel suppliers and customers, transaction systems associated with the service stations are further evolving to provide fully automated authorization and purchasing.
      <br/>
      It would be advantageous if customers no longer needed to use a credit/debit card or smartcard to purchase fuel or other products or services.
      <br/>
      This can be accomplished if the customer, vehicle or both are equipped with a remote intelligent communications device, or transponder (hereinafter referred to as a tag for simplicity), capable of remotely communicating with fuel dispensers and other devices as desired.
      <br/>
      These tags and dispensers operate in conjunction to provide a cashless and cardless transaction system where transactions are automatically charged or debited without requiring any action by the customer.
    </p>
    <p num="5">
      Numerous patents have issued and foreign applications published relating to technology associated with communicating information between a tag or like transponder and the fuel dispenser.
      <br/>
      These patents disclose communicating between the tag and fuel dispenser with fiber optics, electromagnetic radiation, such as radio frequency transmissions, infrared, direct electrical connections and various others means or combination of these means.
      <br/>
      Various types of information is communicated between the tag and the dispenser including vehicle identification, customer identification, account information, fuel requirements, diagnostics, advertising, and various other types of solicited and unsolicited messages.
      <br/>
      Certain specific applications equip the tag and dispenser with cryptography electronics to encrypt and decrypt data transferred between the tag and dispenser.
    </p>
    <p num="6">
      Tag transponder technology is used in many areas of technology relating to vehicles.
      <br/>
      Such technology is used in tracking vehicles, navigational aids, toll collection, diagnostics, vehicle security and theft deterrence, keyless entry, refueling, collision avoidance, vehicle identification, surveillance and traffic control as well as transmitting and receiving financial data.
    </p>
    <p num="7">
      Using tag technology in association with the fuel dispensing environment is currently in its embryonic stage.
      <br/>
      Although further advances occur at a continually increasing rate, a concern of utmost importance has not been addressed.
      <br/>
      Given the ingenuity and resourcefulness of information thieves, financial and account information is susceptible to theft if transmitted from the tag to the dispenser and onto a host network system, which generally provides authorization and account adjustment functions for the transaction.
      <br/>
      Even with today's most sophisticated coding and encryption techniques, information thieves, given enough time and opportunity, are able to decrypt the encrypted data and obtain various financial and account information.
    </p>
    <p num="8">
      Further dangers arise when each fuel dispenser either includes, or relays this account information to the host network.
      <br/>
      Theft and fraud opportunities arise from not only the information thieves stealing information from the airwaves in the local transaction environment, but from those having access to confidential information stored in the tag, dispenser and fuel station store.
      <br/>
      A stolen tag provides a thief an indefinite amount of time to figure out the internal workings and information within the tag.
    </p>
    <p num="9">
      Additionally, since most of these tags will necessarily and ultimately communicate with a central network host through the fuel dispenser POS, access to various different accounts and different financial information is available for purchasing any number of products using a number of accounts.
      <br/>
      In addition to providing high levels of security for tag authorization, account access, and data transfer, less sophisticated security techniques providing lower levels of security are needed to facilitate certain tag functions that either do not require a high degree of security or require the tag to access and communicate with a fuel dispenser or other source, such as a restaurant or other goods or services provider that does not have high level security capability.
      <br/>
      For example, service stations or restaurants may want to access various types of non-confidential information on the tag to determine identification or other information relating to their particular business.
      <br/>
      Based on this information, the businesses may want to provide loyalty points for a tag holder relating to the number of visits or amount of goods or services purchased.
      <br/>
      Although providing loyalty points does not require the intense security necessary to secure financial account information, these local businesses still need to ensure to a sufficient degree that unscrupulous customers cannot adjust their loyalty points at will.
    </p>
    <p num="10">
      Another reason for providing different levels or types of security for different transactions is to reduce the number of times information thieves have access to a given security technique.
      <br/>
      Security is enhanced if the manner of encryption or the key used for encryption varies periodically and if the key used for encryption and decryption is never transmitted.
      <br/>
      Thus, there is a need for a secure transaction system capable of providing virtually impenetrable transactions between a tag and a fuel dispenser associated with a host authorization network.
      <br/>
      There is also a need for this system and tag to enable other sources to access the tag at lower levels of security without jeopardizing account or financial information in addition to providing general access to non-confidential information.
      <br/>
      The system should avoid transmitting cryptography keys and should periodically change keys during transactions to minimize any chance a thief may have in deciphering the key.
    </p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="11">
      Applicants fulfill this need by providing secure transactions with a tag and POS device associated with a host network authorization system.
      <br/>
      In doing so, the tag is adapted to bi-directionally communicate with a POS device, preferably a fuel dispenser, which further communicates with a host network to provide authorization of the tag and carry out any desired purchases or transactions.
      <br/>
      To avoid transmitting data from which valuable account or financial information could be derived between the tag and POS device or the POS device and the host network system, the invention may maintain all or a majority of account and financial information requiring absolute security only at the host network.
      <br/>
      In tie preferred embodiment, neither the tag nor the POS device has or has access to critical financial or account information.
      <br/>
      But, the security system will also provide high levels of security for applications requiring transmission of such information.
    </p>
    <p num="12">
      In order to avoid placing this information at risk during transactions, the invention provides a unique identifier for each transponder wherein the host network maintains account and financial information associated with the tag having the unique identifier.
      <br/>
      The tag identifier is transmitted to the host system through the POS device, and the host network checks to see that the tag, and not a counterfeit, has sent the identifier.
      <br/>
      Once the host system determines that an authorized tag sent the identifier, the host authorizes the POS device to further interact with the tag and allow all or certain subsequent transactions.
    </p>
    <p num="13">
      Preferably, the tag is authenticated using identical cryptography techniques known only by the tag and host, but not by the POS device.
      <br/>
      Initially, the communication electronics of POS device, acting as an interrogator, will continuously scan for a tag within the field.
      <br/>
      Once a tag comes within the field in response to the interrogator, the interrogator will recover the tag's identifier, hereinafter referred to as the ID number, from the tag.
      <br/>
      The POS device will generate authentication check data, preferably a random number, and send it to the tag for encryption.
      <br/>
      The tag then encrypts the random number with an encryption technique using a main cryptography key and transmits the encrypted random number back to the POS device.
      <br/>
      The interrogator passes the ID number, the encrypted random number and the original random number to the host through the associated POS device.
      <br/>
      The host determines or calculates the main cryptography key used in the tag from the tag ID number.
      <br/>
      The host encrypts the random number sent from the POS device and compares it with the encrypted random number sent from the tag through the POS device.
      <br/>
      The host then compares the encrypted random numbers encrypted by the host and the tag.
      <br/>
      If these numbers match, the host signals the POS device that the tag is valid.
    </p>
    <p num="14">
      To further enhance security, the main cryptography key stored in the tag and determined or calculated by the host is only used for authentication of the tag.
      <br/>
      Data transfers or transactions between the tag and host through the POS device requiring security are encrypted and decrypted as necessary by the tag and host using a session key, which is diff rent then the main cryptography key.
      <br/>
      Preferably, a new session key is generated for each transaction and is a function of a random number, independently generated in the tag and host, as well as the main encryption key.
      <br/>
      The tag random number is preferably generated upon receipt of the random number generated at the POS device.
      <br/>
      The tag random number is transmitted to the host through the POS device so that both the tag and host can independently generate the session key capable of encrypting and decrypting data at either the host or the tag.
      <br/>
      The method used to generate the session key from the tag random number must be the same in both the host and tag.
      <br/>
      Similarly, the electronics in the tag and host are used to encrypt the random number generated at the POS device.
    </p>
    <p num="15">
      Each tag includes memory for storing various types of data, including information and commands.
      <br/>
      Preferably the memory and associated electronics allow data to be stored in the memory, read from the memory and transmitted to the POS device and altered according to commands sent from remote sources, including, but not limited to the POS device.
    </p>
    <p num="16">
      For example, the tag may include portions of memory which are accessible and modifiable by numerous fuel dispensers, restaurant interrogators and the like.
      <br/>
      Various portions of memory may have different security levels with corresponding passwords.
      <br/>
      Preferably, the memory is partitioned into four or more groups wherein the associated electronics may store data in the group, read data from the group, add to the data in the group and subtract from the data in the group.
      <br/>
      Depending on the group, the available functions are controlled by the group and its security level.
      <br/>
      For example, a first group (group I) may require all functions to be secure; thereby, requiring that only the host, acting through the POS device, has access to the group I partition and that only the host can carry out the store, read, add or subtract functions.
      <br/>
      A second group (group II) may require the store, add and subtract functions be authorized by the host and allow sources other than the host to read the data stored in group II.
      <br/>
      This is useful with tags used as smartcards having a cash reserve or prepaid tags having a set amount of credit.
      <br/>
      Group II may be arranged so that sources other then the host can check availability of funds, but cannot modify those funds without authorization.
      <br/>
      A third group (group III) may be configured so that the store and add functions are secure while the read and subtract functions are accessible by other sources at a lower security level.
      <br/>
      This lower security may be provided the cryptography and/or passwords.
      <br/>
      Group III data arrangements are useful where sources other than the host recognize customer loyalty and are allowed to provide the customer benefits based on a number of loyalty points accumulated on the tag.
      <br/>
      The source may subtract a loyalty point for a benefit provided, as well as ensure the benefit should be provided by checking the loyalty points stored on the tag.
      <br/>
      However, it is undesirable to allow the local source to add loyalty points without authorization.
      <br/>
      A fourth group (group IV) may be arranged such that customer information is accessible by sources other than the host, but cannot be changed without authorization from the host Group IV is useful in situations where local sources need to determine information, such as identification, about the tag and tag holder.
    </p>
    <p num="17">These and other aspects of the present invention will become apparent to those skilled in the art after reading the following description of the preferred embodiments in conjunction with the drawings.</p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="18">
      FIG. 1 is a schematic of a tag constructed and implemented according to a preferred embodiment of the present invention interacting with a POS device and host network.
      <br/>
      FIG. 2A is a schematic representation of the tag 100 constructed according to the preferred embodiment
      <br/>
      FIG. 2B is a schematic of a POS device and host network constructed according to the preferred embodiment.
      <br/>
      FIG. 2C is a schematic representation of the tag 100 having integrated electronics constructed according to the preferred embodiment.
      <br/>
      FIG. 3A shows a preferred format for a tag ID.
      <br/>
      FIG. 3B shows sample tag ID values for bytes 5 and 6 for the tag ID format shown in FIG. 3A.
      <br/>
      FIG. 4A depicts a preferred process for generating a tag's main DES key.
      <br/>
      FIG. 4B depicts a preferred process for loading a tag with the tag ID and the main DES key generated in FIG. 4A.
      <br/>
      FIG. 5 depicts a preferred tag authentication process.
      <br/>
      FIG. 6 shows a preferred format for programming a group mode register.
      <br/>
      FIG. 7 a sample group mode register setting.
      <br/>
      FIG. 8 is a list of certain tag commands and a preferred command code.
      <br/>
      FIG. 9A depicts a preferred process for securely writing, adding or subtracting data to a tag from the host, omitting the POS device depicts for the sake of simplicity.
      <br/>
      FIG. 9B depicts a preferred process for securely reading data from the tag with the host, omitting the POS device for the sake of simplicity.
      <br/>
      FIG. 10 is table showing select memory group configurations adapted to provide select group functions.
      <br/>
      FIG. 11 shows the memory block arrangement for the group configuration outlined in FIG. 10.
      <br/>
      FIG. 12 outlines a tag's user memory organization and defines passwords associated therewith.
      <br/>
      FIG. 13A and 13B outline customer information data fields for partition number 0 as defined in FIG. 12.
      <br/>
      FIG. 14 outlines the local and host authentication codes for partition number 1 as defined in FIG. 12.
      <br/>
      FIG. 15 outlines the scratch pad area for partition number 2 as defined in FIG. 12.
      <br/>
      FIG. 16 depicts the preferred process for generating a Super User password for partition number 0 as defined in FIG. 12.
      <br/>
      FIG. 17 depicts the preferred process for generating an Administrator password for partition number 1 as defined in FIG. 12.
      <br/>
      FIG. 18 depicts the preferred process for generating the host authentication code.
      <br/>
      FIG. 19 depicts the preferred process for generating the local authentication code.
    </p>
    <heading>DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
    <p num="19">
      In the following description, like reference characters designate like or corresponding parts throughout the several figures.
      <br/>
      Referring now to the drawings in general, and FIG. 1 in particular, please understand that the illustrations are for the purpose of describing preferred embodiments of the invention and are not intended to limit the invention thereto.
      <br/>
      As best seen in FIG. 1, a secure transaction system generally designated 10, is shown constructed according to a preferred embodiment of the present invention.
      <br/>
      The secure transaction system 10 includes or is associated with three major subsystems: a remote communication unit 100 (hereinafter a tag); a POS device 200 and a host network 300.
      <br/>
      In general, remote communication units 100 are adapted to communicate with and through the POS device 200 in order to obtain authorization and communicate information to and from the host network 300.
      <br/>
      The tag 100 may also communicate with the POS device 200 or other local sources 32 directly.
    </p>
    <p num="20">
      Various means of security are employed depending on the information being communicated and the source and destination of the information.
      <br/>
      Importantly, the tag 100 and host network 300 are adapted to encrypt and decrypt certain communications there-between, while the POS device 200 primarily only relays the encrypted information sent between the tag 100 and host network 300.
      <br/>
      Preferably to enhance security, the POS device 200 is unable to decrypt such information.
    </p>
    <p num="21">
      The tag unit 100 is preferably integrated into a small carrying medium, such as a module in a vehicle 12, a transaction card 14 or a key fob 16.
      <br/>
      Regardless of the medium carrying the tag 100, the unit is designed to provide remote bi-directional communications with the POS device 200.
      <br/>
      Preferably, the POS device 200 is placed in a fuel dispensing environment 20, and in particular, at each fueling position 24 of the fuel dispenser 22.
      <br/>
      The dispensers are operatively associated with a central station store 26 by a conventional wire system, which may house a convenience store as well as one or more restaurants.
      <br/>
      Many fuel dispensing environments 20 will provide services, such as car washes, in addition to goods.
      <br/>
      Generally the store 26 will include a central site controller 28 to provide central control functions for each dispenser 22.
      <br/>
      Each dispenser, and its respective POS electronics, generally communicates either directly, or indirectly through the central site controller 28, to the host network 300 via a telephone network 30.
      <br/>
      The host network 300 provides authorizations and other data for the various transactions attempted at each POS device 200.
    </p>
    <p num="22">
      In addition to communicating with the POS devices 200, the transponders 100 are also adapted to communicate with various other local sources 32 for various informational and transaction-type functions.
      <br/>
      These local sources 32 may include any number of goods or service providers, such as local restaurants.
    </p>
    <p num="23">
      The present invention provides virtually impenetrable security with respect to informational and financial communications between the transponder 100 and the host network 300 through the POS device 200.
      <br/>
      High levels of security are also provided as desired for communications solely directed to the POS device 200 and the local sources 32 from the tag 100.
      <br/>
      Such direct communications from the tag 100 to the POS device 200 are those communications not intended to require interaction with the host network 300.
    </p>
    <p num="24">
      Turning now to FIG. 2A, the preferred embodiment of the tag 100 is shown.
      <br/>
      Communications electronics 102, adapted to provide remote communications with various remote sources, includes a transmitter 106 and receiver 108 having associated antennas 110, 112.
      <br/>
      The transmitter 106 and receiver 108 operate to transmit and receive data to and from the remote communications unit 100.
      <br/>
      The communications electronics 102 also include a battery power supply 114, a communication controller 116 associated with a memory 120 having the software 122 necessary to operate the communications electronics 102 and communicate with the cryptography electronics 104.
      <br/>
      Serial communications between the communication electronics and the cryptography electronics 102, 104 is provided via the input/output (I/O) ports 124, 138 associated with the respective electronics.
      <br/>
      The communication electronics 102 provide a clock 128 signal to the I/O port 138 of the cryptography electronics 104.
      <br/>
      The cryptography electronics 104 include a controller 130, memory 132 and software 134 necessary to encrypt and decrypt data, as well as provide any additional operations.
      <br/>
      The memory 120, 132 may include random access memory, read only memory or a combination of both.
      <br/>
      Notably, the communication controller 116 and the cryptography controller 130 may be integrated into one controller.
      <br/>
      Similarly the software and memory of the communication and cryptography modules could be merged.
    </p>
    <p num="25">
      As shown in FIG. 2C, the communication and cryptography electronics, as well as any associated controllers may be integrated into a single controller system and/or integrated circuit.
      <br/>
      In such cases, a single controller 115 is associated with memory 117 having software 119 as necessary for operation.
      <br/>
      In such an integrated system, the controller 115 will carryout any cryptography functions as well as any other necessary functions.
    </p>
    <p num="26">
      The communication electronics 102 are preferably the Micron MicroStarnp (tm)  produced by Micron Communications, Inc., 8000 South Federal Way, Boise, Id. 83707-0006.
      <br/>
      A detailed description of the MicroStamp engine (tm)  is provided in the Preliminary Data Sheet and the MicroStamp Standard Programmers Reference Manual provided by Micron Communications, Inc.
      <br/>
      These references and the information provided by Micron Communications on their website at HTTP://WWW.MCC.MICRON.COM are incorporated herein by reference.
      <br/>
      The Micron MicroStamp engine (tm)  is an integrated system implementing a communications platform referred to as the MicroStamp (tm)  standard on a single CMOS chip.
    </p>
    <p num="27">
      The communications controller 116 specifically provides a spread spectrum processor associated with an eight-bit microcontroller.
      <br/>
      The memory 120 includes 256 bytes of RAM.
      <br/>
      The receiver 108 operates in conjunction with the spread spectrum processor and is capable of receiving direct sequence spread spectrum signals having a center frequency of 2.44175 GHz. The transmitter 106 is preferably a DPSK modulated back-scatter transmitter traitting differential phase shift key (DPSK) modulated back-scatter at 2.44175 GHz with a 596 KHz sub-carrier.
    </p>
    <p num="28">
      In order to save power and extend battery life, the communication electronics 102 operate at a low-current, sleep mode until an internal programmable timer causes it to wake up.
      <br/>
      The communication electronics 102 determine whether there is a properly modulated signal present and, if not, immediately returns to the sleep mode.
      <br/>
      The modulated signal of which the communication electronics 102 look for once it awakens is provided by the POS device 200 or one of the local sources 32.
      <br/>
      If a properly modulated signal is present, the communication electronics 102 process the received command and send an appropriate reply.
      <br/>
      The communication electronics 102 then return to the sleep mode.
      <br/>
      The communications electronics 102 cause the cryptography electronics 104 to awaken as necessary to encrypt or decrypt data received by or transmitted from the tag 100.
    </p>
    <p num="29">
      Referring now to FIG. 2B, a schematic representation of the POS device 200 and host network 300 is shown.
      <br/>
      The POS device 200 preferably includes a controller 202 forming communication electronics 204 and cryptography electronics 206.
      <br/>
      The controller 202 is associated with a memory 210 and an antenna 208 for providing remote communications.
      <br/>
      The controller 202 interfaces with the telephone network 30 to provide bi-directional communications with the host network 300.
      <br/>
      Those skilled in the art will appreciate that any suitable form of communications between the POS device 200 and host network 300 are considered within the scope of this disclosure and the claims that follow.
      <br/>
      The POS device 200 preferably includes a display 212 and an input device 214, such as a touch pad or touch screen associated with the display 212.
      <br/>
      In the preferred embodiment, the POS device 200 is a fuel dispenser having at least two fueling positions and a card reader 216 for receiving payment through any variety of credit, debit or smartcards.
      <br/>
      The POS device 200 may also include a cash acceptor for receiving payment.
      <br/>
      The card and cash acceptors are present to service those customers who do not have tags 100.
      <br/>
      Customers having tags 100 have a lessened need for these devices in the POS device 200.
      <br/>
      A suitable POS is The Advantage fuel dispenser sold by Gilbarco, Inc., upgraded with the Micron MicroStamp Interrogator from Micron Electronics or having compatible integrated communication electronics.
    </p>
    <p num="30">
      The host network 300 also includes a control system 302 forming communication electronics 304 and cryptography electronics 306.
      <br/>
      The host network 300 also includes memory 310 associated with the electronics 304, 306.
      <br/>
      The host network 300 may include additional communications ports 312 for communicating with other POS devices.
    </p>
    <heading>TAG OVERVIEW</heading>
    <p num="31">
      Preferably, the tag cryptography electronics 104 implement the encryption standard called DES (or Data Encryption Standard) as defined by Federal Information Processing Standard Publication Number 46.
      <br/>
      Various commands are available in the tag cryptography electronics 104 using the DES algorithm as a basis for security.
      <br/>
      Although other cryptography methods are available and will work with the current invention, applicant believes DES provides the highest degree of security when used according to the invention described herein.
    </p>
    <p num="32">
      The tag cryptography electronics 104 are used for two main functions in the tag 100.
      <br/>
      First, it provides a secure authentication procedure when implemented with the network host 300.
      <br/>
      Thus, if the tag 100 passes this authentication procedure, then to a high level of confidence, the host 300 is assured that a real tag 100 was authenticated.
      <br/>
      Second, the tag cryptography electronics 104 allow the host 300 to securely write data to the tag 100, read data from the tag 100 or modify data in the tag 100.
    </p>
    <p num="33">
      Attention is directed again to FIG. 2A. Preferably, when DES authentication and write functions are included in the tag, all of the DES functionality, including storage of DES keys, resides in the tag cryptography electronics 104 and not in the tag communication electronics 102.
      <br/>
      In other words, the tag communication electronics 102 act as the transmission medium for the tag cryptography electronics 104.
      <br/>
      Communications from the communication controller 116 to the tag cryptography electronics 104 takes place via the tag communication electronics 102 using the WriteDigitalPort and ReadDigitalPort commands, which are standard MicroStamp commands.
    </p>
    <p num="34">
      All data, including commands sent to the tag cryptography electronics 104, are sent as data within the WriteDigitalPort command.
      <br/>
      The data to be sent to the tag cryptography electronics 104 is stored in a buffer in the tag communication electronics 102 until it is serially transmitted to the tag cryptography electronics 104.
      <br/>
      The data packet sent to the tag cryptography electronics 104 using the WriteDigitalPort command is only limited by the size of the buffer in the tag communication electronics 102 and is preferably 64 bytes.
    </p>
    <p num="35">
      Likewise, when the tag cryptography electronics 104 have data for the tag communication electronics 102, data is transmitted to the tag communication electronics 102 where it is stored in a buffer in the tag communication electronics 102.
      <br/>
      The size of the data packet from tag cryptography electronics 104 are limited in the same manner set forth above with regard to the data packet sent to the tag cryptography electronics 104.
      <br/>
      This data is read from the MicroStamp module using the ReadDigitalPort command.
    </p>
    <heading>HOST TAG GENERATION</heading>
    <p num="36">
      When initially configuring tag 100, the host network 300 generates a tag identification number (ID) and a main tag key, which is preferably a DES key, and directly injects these numbers into the tag 100 along with any other pertinent information.
      <br/>
      Generally, the POS device 200 is not used during configuration.
      <br/>
      Preferably, a different main tag key is injected into every tag 100, and a secure algorithm is used to generate the main tag keys from a master key known only by the host 300.
      <br/>
      Maximum security is obtained when it is impossible for an infiltrator or cracker to calculate the host master key from the main tag key and tag ID.
    </p>
    <p num="37">
      The preferred format for a 10 byte tag ID is shown in FIGS. 3A and 3B. The first four bytes, bytes 1-4, are reserved for market segment definitions.
      <br/>
      Preferably, each market segment includes a classification as defined by the Standard Industrial Classification Manual.
      <br/>
      For example, the classification (generally known as the SIC code) for the service station industry is "5541".
      <br/>
      This classification is preferably stored as four byte ASCII value (hex 35353431).
      <br/>
      In this example, the code would appear in the first four bytes of all tags of companies in the service station industry.
      <br/>
      Bytes 5 and 6 identify the issuing company and the last four bytes are represent the specific tag's generation number used to uniquely identify the particular tag for that company.
      <br/>
      With bytes 7-10 available to define a tag number for a particular company, over four billion tags may issue without repetition for each issuing company.
      <br/>
      Special codes may be stored in any of the tag ID fields, such as the issuing company field, to provide for local or network testing.
      <br/>
      If the tag ID is formatted as depicted and the fifth and sixth data fields are coded 00 (hex 3030), then the tag is a local test tag, and therefore, the tag ID is not passed on to the host 300.
      <br/>
      If the fifth and sixth data fields are coded 01 (hex 3031), then the tag is a network test tag and the tag ID is passed on to the host 300.
      <br/>
      Such testing is typically used to test communication ability and assure proper operation of the POS device 200 and/or host 300.
    </p>
    <heading>PREFERRED DES KEY GENERATION PROCEDURE</heading>
    <p num="38">
      The preferred procedure for generating each main tag key for the various tags 100 employs triple encryption with three secret master keys.
      <br/>
      The main tag keys are generated by the host 300.
      <br/>
      Referring now to FIG. 4A, the last 8 bytes of the tag ID number are preferably used to generate the main tag key.
      <br/>
      For example, if Shell Oil Company is the issuing company, the 8 byte number (rendered here in hexadecimal) would be of the form 34315348 xx xx xx xx, where the x's represent the individual tag's sequence number.
      <br/>
      Initially, an exclusive-OR (XOR) is taken of the 8 byte number derived from the tag ID and a constant, chosen randomly, whose value is securely held by the host network 300.
      <br/>
      The result is XORed with the first master key (Mkey -1), encrypted with the first master key, and XORed with the first master key.
      <br/>
      This result is XORed with the second master key (Mkey -2), decrypted with the second master key, and XORed with the second master key.
      <br/>
      This result is XORed with the third master key (Mkey -3), encrypted with the third master key, and XORed with the third master key.
      <br/>
      The final result is the main tag key, which is loaded into the tag 100.
    </p>
    <p num="39">
      All four components of the key generation procedure, the constant, first master key (Mkey -1), second master key (Mkey -2), and third master key (Mkey -3) are held in strict confidence at the host 300.
      <br/>
      These components are not cryptographically or mathematically related to each other.
      <br/>
      Furthermore, the host 300 should ensure that none of these components are cryptographically decipherable by unauthorized persons.
      <br/>
      Although this is the preferred embodiment, various combinations of logic functions and cryptography are possible to ensure a difficult to crack key generation process.
      <br/>
      As with any of the key and code generation techniques disclosed herein, portions of the tag ID may be operated on by a function to achieve a desired result The function may range from f(x)=x to any convoluted function chosen for the generation process.
    </p>
    <p num="40">
      The preferred process for loading the tag 100 with its respective tag ID and main DES key is shown in FIG. 4B. As discussed above, a 10 byte tag ID number comprising the standard industry code, company code and individual sequence number is directly loaded by the host 300 into the tag 100 during generation of the tag.
      <br/>
      Typically, a 4 byte sequence counter generates the tag sequence number forming bytes 7-10 of the tag ID.
      <br/>
      Concurrently with loading the tag ID number, the main DES tag key is generated using the master keys and loaded into the tag 100.
      <br/>
      Additionally, other information is loaded into the tag 100 during loading as desired.
      <br/>
      Once the tag is generated, it is distributed to customers for use with the POS device 200 and local sources 32.
    </p>
    <heading>HOST AUTHENTICATION OF TAG</heading>
    <p num="41">
      Typically, tags 100 are authenticated at the host 300 using a DES encrypted value produced by the tag 100.
      <br/>
      The main tag key for this DES calculation is stored in the tag cryptography electronics 104 when the tag 100 is initialized.
      <br/>
      As noted, the tag 100 is initialized directly at host 300 without transmitting the main tag key to or through any other system.
    </p>
    <p num="42">
      A preferred tag authorization process is shown figure 5.
      <br/>
      In step 1, the POS communication electronics 204 of the POS device 200 generate and send a random number (CRN) to the tag 100 and to the host 300.
      <br/>
      The tag 100 encrypts the random number and returns the encrypted random number (TRN) to the POS device 200 along with a tag identification number (ID) in step 2.
      <br/>
      The POS communication electronics relays the tag ID, the encrypted random number received from the tag 100 and the random number to the host 300 without modification in step 3.
      <br/>
      In the preferred embodiment, the tag ID number is 10 bytes, the random number is 8 bytes and the encrypted random number is 8 bytes.
      <br/>
      Upon receipt of the tag ID from the POS device 200, the host 300 calculates (or looks up) the main tag key for the tag 100 using the tag ID and the secret master keys in the same manner as the main tag key was initially created from the tag ID.
      <br/>
      In other words, the host 300 recalculates the main tag key for each operation.
      <br/>
      The host cryptography electronics 206 encrypt the random number using the recalculated main tag key and compares the result to the encrypted random number received from the tag 100.
      <br/>
      If they match, the tag 100 is a valid tag, and most likely not a counterfeit Upon authorization, the host 300 can use the ID number to look up transaction billing data or other information associated with the tag 100 or its owner and authorize the POS device 200 to carry the desired transactions in step 4.
    </p>
    <p num="43">
      In a fueling environment, the POS device 200 is, or is incorporated within, a fuel dispenser 24.
      <br/>
      Typically the card reader 216 in the dispenser (CRIND) will operate in conjunction with the POS communication electronics 204 to provide an interrogator.
      <br/>
      In order for the host 300 to authenticate a tag 100, the POS communication electronics 204 will continuously scan for a tag 100 within a particular communications field or range.
      <br/>
      The tag 100 will respond once inside the field by sending a command to POS device 200.
      <br/>
      This interrogation and response sequence is conventional in the Micron MicroStamp System.
    </p>
    <p num="44">
      Once the tag 100 responds, the POS device 200 will recover the tag ID from the tag 100.
      <br/>
      The POS device 200 generates the random number (CRN) and sends it to the tag 100 with an appropriate command.
      <br/>
      The tag 100 then encrypts the random number (CRN) using DES with the main tag key and transmits the encrypted random number (ECRN) back to the POS device 200.
      <br/>
      The POS device 200 subsequently transmits the tag ID, the random number (CRN), and the encrypted random number (ECRN) to the host 300.
    </p>
    <p num="45">
      The host 300 calculates the main tag key from the ID number in the same manner in which the host 300 originally generated the main tag key (see FIG. 4).
      <br/>
      The random number (CRN) originally generated by the POS device 200 is encrypted by the host 300 to provide a host network encrypted random number (NERN).
      <br/>
      The host 300 then compares the encrypted random number (ECRN) encrypted at the tag 100 to the host network encrypted random number NERN).
      <br/>
      If the ECRN and NERN match, then the host signals the POS device 200 or site controller 28 that the tag 100 is valid and authorized.
      <br/>
      Alternatively, the host 300 may decrypt the encrypted random number (ECRN) and compare the result to the random number (CRN).
    </p>
    <heading>DES MODULE REGISTERS</heading>
    <p num="46">
      The tag cryptography electronics 104 and memory 132 of the tag 100 includes several designated registers for storing various types of values and information.
      <br/>
      Certain of these registers used in the preferred embodiment are listed and described as follows:
    </p>
    <p num="47">
      UNSIGNED CHAR DES Key Counter;
      <br/>
      UNSIGNED CHAR Current Sequence Number;
      <br/>
      UNSIGNED CHAR DES Password;
      <br/>
      UNSIGNED CHAR DES Key;
      <br/>
      UNSIGNED SHORT DES Module user Memory Size;
      <br/>
      UNSIGNED CHAR DES Module Version Number;
      <br/>
      UNSIGNED SHORT BEGIN BLOCK GROUP 0;
      <br/>
      UNSIGNED SHORT END BLOCK GROUP 0;
      <br/>
      UNSIGNED CHAR GROUP MODE 0;
      <br/>
      UNSIGNED SHORT BEGIN BLOCK GROUP 1;
      <br/>
      UNSIGNED SHORT END BLOCK GROUP 1;
      <br/>
      UNSIGNED CHAR GROUP MODE 1;
      <br/>
      UNSIGNED SHORT BEGIN BLOCK GROUP 2;
      <br/>
      UNSIGNED SHORT END BLOCK GROUP 2;
      <br/>
      UNSIGNED CHAR GROUP MODE 2;
      <br/>
      UNSIGNED SHORT BEGIN BLOCK GROUP 3;
      <br/>
      UNSIGNED SHORT END BLOCK GROUP 3; and
    </p>
    <p num="48">UNSIGNED CHAR GROUP MODE 3.</p>
    <p num="49">
      DES Key Counter The DES key counter is one byte in size and is incremented only when a new main tag key (a DES key) is written to the tag cryptography electronics 104.
      <br/>
      The DES key counter is initially zero when the tag cryptography electronics 104 is first powered up.
      <br/>
      This register allows an authorized tag programmer (i.e. host 300) to calculate a current DES password and main tag key and to change the main tag key if necessary.
      <br/>
      The DES password and its function is described in greater detail below.
    </p>
    <p num="50">Current Sequence Number</p>
    <p num="51">
      The current sequence number is used when transferring data between the tag 100 and a local interrogator of the POS device 200.
      <br/>
      The current sequence number allows the interrogator to ensure that an event has occurred in the presence of noise or other disturbing factors and prevents a command or operation from being accidentally replicated.
      <br/>
      The current sequence number preferably corresponds to a tally of transactions or operations the tag has conducted.
      <br/>
      The host typically sends a sequence number to the tag with each command.
      <br/>
      If the sequence number sent by the host does not correspond to that stored in this register, the command is ignored.
      <br/>
      Typically, the host will include a new sequence number, one plus the current sequence number, to signify a new command affecting store data is being sent.
      <br/>
      Read commands preferably include the current sequence number.
      <br/>
      The register in the tag is updated accordingly.
      <br/>
      The sequence number adds further security by ensuring the host 300 is transmitting proper data and/or commands to the tag, that no unauthorized communications have occurred and that each previous communication between the host and tag was properly received and acted on.
    </p>
    <p num="52">DES Password</p>
    <p num="53">
      The password prevents unauthorized replacement of the main tag key in the DES Module.
      <br/>
      The password is used to gain access to the key, while the key is what is used by the cryptography electronics to encrypt information.
      <br/>
      If an attacker could replace the main tag key, various registers and memory locations could be altered to allow the attacker to enjoy secondary services such as loyalty points and other benefits from sources other than the host without having earned them.
      <br/>
      A loyalty plan may be a program where customers collect bonus points based on purchases and transactions.
      <br/>
      The bonus points may be stored on the tag and redeemed as desired for benefits or privileges at the fuel station store or any other local source 32.
      <br/>
      Notably, even if an attacker could replace the main tag key, an authentication check with the host 300 would fail since the host 300 would generate the original main tag key or one authorized and updated by the host 300.
      <br/>
      For authorization and other secure transactions, the host 300 and tag 100 must have or be able to generate identical keys.
      <br/>
      Since some loyalty plans require a non-secure read function, the DES password may be useful to access read-only information stored on the tag 100.
    </p>
    <p num="54">
      Preferably, the DES password register can only be directly written once.
      <br/>
      After that, the tag cryptography electronics 104 refuse further attempts to write to the DES password register.
      <br/>
      The DES password is modified by the tag 100 when a main tag key is initially written to the tag 100.
      <br/>
      The tag 100 preferably uses the new main tag key to encrypt the previous DES password and write the encrypted result into the DES password register to form a new password.
    </p>
    <p num="55">Main Tag Key</p>
    <p num="56">
      As noted, the main tag key is preferably an 8 byte standard DES cryptography key that is used by the tag 100 for both encryption and decryption.
      <br/>
      The main tag key is loaded in the tag 100 with a set DES key command as discussed in the "DES commands section" below.
    </p>
    <p num="57">User Memory Size</p>
    <p num="58">
      The memory size register stores a value representative of the amount of memory available in the tag cryptography electronics 104.
      <br/>
      The memory size is preferably reported in blocks, with each block having 8 bytes of data.
    </p>
    <p num="59">DES Version Number</p>
    <p num="60">The version number register is a read only register and stores the cryptography electronics 104 software and/or hardware version.</p>
    <p num="61">Begin and End Block Registers</p>
    <p num="62">
      The begin and end block registers are generally set by the tag programmer to reflect desired groupings of the user memory in the memory 120 of the tag cryptography electronics 104.
      <br/>
      These registers preferably reflect the begin and end blocks of the groups starting from memory location zero.
      <br/>
      A group is unused or does not exist if the begin and end block registers for that group are both set to zero.
      <br/>
      Preferably, there are four groups and one set of Begin and End registers for each group.
    </p>
    <p num="63">Group Mode Register</p>
    <p num="64">
      The group mode register defines the acceptable commands for a particular group.
      <br/>
      There is a group mode register for each of the groups.
      <br/>
      Preferably, there are 8 total commands selectable by this register.
      <br/>
      These commands and their respective bit positions are listed in FIG. 6.
      <br/>
      The group mode register is an 8 bit register.
      <br/>
      Each bit position in the register refers to one specific command.
      <br/>
      A logical `1` in a given bit position indicates that the respective command is selected for the respective group.
      <br/>
      For example, the group mode register depicted in FIG. 7 is programmed to 0F hexadecimal (HEX).
      <br/>
      This means that the group will accept all four of the secure commands (read, subtract, add, and write) but none of the unsecure commands.
    </p>
    <heading>DES TAG COMMANDS</heading>
    <p num="65">
      The tag 100 may receive and respond to various cryptography related commands, such as those shown in FIG. 8.
      <br/>
      The DES commands in bold preferably require cryptography, either encryption or decryption, to encode or decode data
    </p>
    <p num="66">
      As depicted in FIG. 9A, when the tag 100 is presented with a random number (CRN) from the POS device 200 during an authentication cycle, the tag 100 also generates a tag random number (TRN) that is sent to the host 300 through the POS device 200.
      <br/>
      This tag random number (TRN) is used in the tag 100 to generate a session key (SK) from the main tag key of the tag 100.
      <br/>
      The host 300 uses its knowledge of the tag's original main tag key to generate the same session key (SK) using the tag random number (TRN).
      <br/>
      The session key (SK) is used to encrypt or decrypt actual data and authenticator data transferred between the tag 100 and the host 300.
      <br/>
      Actual data represents the actual information or commands to be transferred.
      <br/>
      Authenticator data is the result of a security or checking process performed on the actual data to allow the receiving device, whether the host 300 or tag 100, to assure accuracy of data transmission.
      <br/>
      The process is described in detail below.
    </p>
    <p num="67">
      The session key (SK) is preferably used a maximum of four times before it is destroyed in the tag 100.
      <br/>
      After that, a new tag random number (TRN) is generated by performing another tag authentication cycle using a new random number (CRN) generated by the POS device 200.
      <br/>
      Requesting a tag authentication cycle produces a new tag random number (TRN) regardless of how many times it has been used.
      <br/>
      Note that the tag authentication cycle or process uses the encrypt random number command, the third command listed in FIG. 8, to encrypt the random number (CRN) received from the POS device 200.
    </p>
    <p num="68">
      For secure commands transferring data from the host 300 to the tag 100.
      <br/>
      Through the POS device 200, data is encrypted at the host with the session key (SK) generated during the tag authentication process and decrypted at the tag 100 using an identically calculated session key (SK).
      <br/>
      As noted, the session key (SK) is generated at the host 300 by encrypting the tag random number (TRN) with the main tag key.
      <br/>
      Session key (SK) generation may include other logic functions in addition to encryption.
      <br/>
      In this context, encryption is meant to include any additional functions used to arrive at the session key (SK) or like value.
      <br/>
      Data to be authenticated is generally 8 bytes long and is assumed to be numeric but generally no checks are performed to ensure that it is.
    </p>
    <p num="69">
      The authenticator data is preferably formed by concatenating a 4 byte, 32 bit cyclic redundancy check (a super checksum process referred to as CRC) on the original data, with 4 bytes of random numbers generated by the host 300.
      <br/>
      The CRC occupies the least significant 4 bytes of the 8 byte authenticator data.
      <br/>
      The authenticator data should also be encrypted by the host 300 using the tag's session key (SK).
      <br/>
      When the tag 100 decrypts the authenticator data and checks the accuracy of the transfer, the 4 bytes of random numbers generated by the host are discarded and only the CRC bytes are used in checking the data.
    </p>
    <p num="70">
      For secure commands transferring data from the tag 100 to the host 300. through the POS device 200, as shown in FIG. 9B, data is encrypted with the session key (SK) generated during the tag authentication process.
      <br/>
      Again, the session key (SK) is generated by encrypting the tag random number (TRN) with the main tag key.
      <br/>
      The data to be authenticated is generally 8 bytes long and assumed to be numeric.
      <br/>
      As above, authenticator data is used to check the accuracy of the data transfer.
      <br/>
      The authenticator data is formed by concatenating a 4 byte, 32 bit CRC on the data, with 4 bytes of random numbers generated by the tag 100.
      <br/>
      The CRC occupies the least significant 4 bytes of the 8 byte authenticator data The authenticator data is encrypted by the tag 100 using the tag's session key (SK).
      <br/>
      When the host 300 decrypts the authenticator data, the 4 bytes of random numbers generated by the tag 100 are discarded and only the CRC bytes are used in checking the data.
      <br/>
      Additional error checking and detection for either tag-to-host or host-to-tag communications is provided by using a longitudinal redundancy check (LRC).
      <br/>
      An LRC appended to each communications block is formed by performing a byte-wise binary addition of every preceding byte of data in the communications block.
      <br/>
      Carries from the additions are discarded.
    </p>
    <p num="71">Set DES Password</p>
    <p num="72">
      The set DES password command allows a tag programmer to load the DES or other password in the tag 100.
      <br/>
      The tag 100 will not accept a main tag key if the password is zero.
      <br/>
      The password is set to zero at initialization.
      <br/>
      The password can only be set once.
      <br/>
      After it is set, new passwords are generated by the tag.
      <br/>
      The following command protocol sequence is recommended from a tag programmer associated with the host 300 to initially set the DES password:
    </p>
    <p num="73">
      --
      <br/>
      --      UNSIGNED CHAR Set_DES_Password = E1 (command to set password);
      <br/>
      --      UNSIGNED CHAR DES_Password8 (actual 8 byte password); and
      <br/>
      --      UNSIGNED CHAR LRC                     (checksum).
    </p>
    <p num="74">
      Possible replies from the tag 100 are:
      <br/>
      UNSIGNED CHAR Command_Accepted=ACK; and
      <br/>
      UNSIGNED CHAR Command_Not_Accepted=NAK.
    </p>
    <p num="75">Set DES Key</p>
    <p num="76">
      The set DES key command allows the tag programmer to directly set the main tag key for use in all subsequent secure communications with the tag 100.
      <br/>
      Preferably, the DES password is sent as part of this command sequence.
      <br/>
      The command protocol sequence follows:
    </p>
    <p num="77">
      --
      <br/>
      --      UNSIGNED CHAR Set_DES_Key = E2 (command to set main tag key);
      <br/>
      --      UNSIGNED CHAR DES_Password8 (send actual password);
      <br/>
      --      UNSIGNED CHAR DES_Key8 (send main tag key); and
      <br/>
      --      UNSIGNED CHAR LRC                  (checksum).
    </p>
    <p num="78">
      Possible replies from the tag 100 are:
      <br/>
      UNSIGNED CHAR Command_Accepted=ACK; and
      <br/>
      UNSIGNED CHAR Command_Not_Accepted=NAK.
    </p>
    <p num="79">
      When the tag cryptography electronics 104 of the tag 100 accept a main tag key, the main tag key is used to encrypt the current DES password.
      <br/>
      The result of that encryption is then stored as the new DES password.
      <br/>
      In addition, each time a DES key is accepted, the DES key counter is incremented by one.
      <br/>
      The DES key counter is zeroed at initial power on for the tag, and cannot be directly written or modified except by writing a new DES key to the tag cryptography electronics 104.
    </p>
    <p num="80">Set Group Registers</p>
    <p num="81">
      The set group registers command allows the tag programmer to set up group information for the user memory in the DES Module.
      <br/>
      The DES password is given as part of this command.
      <br/>
      This command may be configured to work even if the DES password is zero (i.e. before the DES password is loaded into the tag cryptography electronics 104).
      <br/>
      Note that the block numbers defined in this command are absolute, start from block zero (0) and do not relate to the group number.
      <br/>
      The begin and end block numbers may overlap.
    </p>
    <p num="82">
      --
      <br/>
      -- UNSIGNED CHAR Set_DES_Key = E3        (set main tag key);
      <br/>
      -- UNSIGNED CHAR DES_Password8      (send password);
      <br/>
      -- UNSIGNED SHORT BEGIN_BLOCK_GROUP_0           (start first block);
      <br/>
      -- UNSIGNED SHORT END_BLOCK_GROUP_0             (end first block);
      <br/>
      -- UNSIGNED CHAR GROUP_MODE_0                   (define group mode);
      <br/>
      -- UNSIGNED SHORT BEGIN_BLOCK_GROUP_1           (start second block);
      <br/>
      -- UNSIGNED SHORT END_BLOCK_GROUP_1             (end second block);
      <br/>
      -- UNSIGNED CHAR GROUP_MODE_1                   (define group mode);
      <br/>
      -- UNSIGNED SHORT BEGIN_BLOCK_GROUP_2           (start third block);
      <br/>
      -- UNSIGNED SHORT END_BLOCK_GROUP_2             (end third block);
      <br/>
      -- UNSIGNED CHAR GROUP_MODE_2                   (define group mode);
      <br/>
      -- UNSIGNED SHORT BEGIN_BLOCK_GROUP_3           (start fourth block);
      <br/>
      -- UNSIGNED SHORT END_BLOCK_GROUP_3             (end fourth block);
      <br/>
      -- UNSIGNED CHAR GROUP_MODE_3                   (define group mode); and
      <br/>
      -- UNSIGNED CHAR LRC                            (checksum).
    </p>
    <p num="83">
      The possible replies from the tag 100 are:
      <br/>
      UNSIGNED CHAR Command_Accepted=ACK; and
      <br/>
      UNSIGNED CHAR Command_Not_Accepted=NAK.
    </p>
    <p num="84">Encrypt Random Number</p>
    <p num="85">
      The encrypt random number command requests the tag 100 to encrypt the Pos device random number (CRN) sent to the tag 100 with the tag's main tag key.
      <br/>
      Preferably, the tag 100 replies by sending the encrypted random number (ECRN) and the tag random number (TRN) generated by the tag 100.
      <br/>
      Generation of the tag random number (TRN) by the tag 100 is preferably triggered upon receipt of the encrypt random number command from the POS device 200.
      <br/>
      For maximum security, the tag random number (TRN) is not mathematically related to the POS device 200 random number (CRN).
      <br/>
      Again, the tag random number (TRN) is used to generate a session key (SK) in the tag 100 and at the host to encrypt and decrypt data.
    </p>
    <p num="86">A typical command protocol sequence for encrypting the POS random number (CRN) follows:</p>
    <p num="87">
      --
      <br/>
      -- UNSIGNED CHAR Encrypt_Random_Number = E4 (command to encrypt CRN);
      <br/>
      -- UNSIGNED CHAR Tag_Random_Number8 (generate TRN); and
      <br/>
      -- UNSIGNED CHAR LRC                         (checksum).
    </p>
    <p num="88">The possible replies from the tag 100 are:</p>
    <p num="89">
      --
      <br/>
      -- UNSIGNED CHAR Command_Not_Accepted = NAK; or
      <br/>
      -- UNSIGNED CHAR Command_Accepted = ACK;
      <br/>
      -- UNSIGNED CHAR Currrent_Sequence_Number       (increment sequence number);
      <br/>
      -- UNSIGNED CHAR Encrypted_Random_Number8 (send encrypted CRN ECRN);
      <br/>
      -- UNSIGNED CHAR Tag_Random_Number8 (send TRN); and
      <br/>
      -- UNSIGNED CHAR LRC                            (checksum).
    </p>
    <p num="90">Secure Write Data</p>
    <p num="91">
      The secure write data command causes the tag cryptography electronics 104 to store data that is part of this command.
      <br/>
      The block number in this command is relative to a group and starts from block 0.
    </p>
    <p num="92">The following protocol command sequence securely writes data to a tag 100 according to FIG. 9:</p>
    <p num="93">
      --
      <br/>
      -- UNSIGNED CHAR Secure_Write_Data = E5 (command to write data to tag);
      <br/>
      -- UNSIGNED CHAR Sequence_Number       (increment sequence number);
      <br/>
      -- UNSIGNED CHAR Group_Number          (select group to be written);
      <br/>
      -- UNSIGNED SHORT Block_Number         (select block to be written in group);
      <br/>
      -- UNSIGNED CHAR Data8     (send 8 bytes of encrypted data);
      <br/>
      -- UNSIGNED CHAR Authenticator_Block8 (send 8 bytes of encrypted
      <br/>
      --                                     authenticator data); and
      <br/>
      -- UNSIGNED CHAR LRC                   (checksum).
    </p>
    <p num="94">
      The possible replies from the tag 100 are:
      <br/>
      UNSIGNED CHAR Command_Accepted=ACK; and
      <br/>
      UNSIGNED CHAR Command_Not_Accepted=NAK.
    </p>
    <p num="95">Secure Add Data</p>
    <p num="96">
      The secure add data command causes the tag cryptography electronics 104 to add data that is part of this command to the data that is already stored in the tag cryptography electronics 104.
      <br/>
      The sequence number sent from the host 300 is one higher than the sequence number stored in the tag cryptography electronics 104.
      <br/>
      The Add function adds the data in the block to the data in the command and stores the result in the block.
      <br/>
      The addition is performed in binary coded decimal with carries across bytes.
      <br/>
      The carry from the most significant byte (MSB) is dropped.
      <br/>
      If the addition would result in a carry out of the last byte, then the addition is not performed.
      <br/>
      Note that the block number in this command is relative to a group and starts from block 0.
    </p>
    <p num="97">A sample protocol command sequence follows:</p>
    <p num="98">
      --
      <br/>
      -- UNSIGNED CHAR Secure_Add_Data = E6 (send command);
      <br/>
      -- UNSIGNED SHORT New_Sequence_number  (send new sequence number);
      <br/>
      -- UNSIGNED CHAR Group_Number          (select group);
      <br/>
      -- UNSIGNED SHORT Block_Number         (select block);
      <br/>
      -- UNSIGNED CHAR Data8     (send 8 byte encrypted data);
      <br/>
      -- UNSIGNED CHAR Authenticator_Block8 (send 8 byte encrypted authenticator
      <br/>
      --                                     data; and
      <br/>
      -- UNSIGNED CHAR LRC                   (checksum).
    </p>
    <p num="99">
      The possible replies from the tag 100 are:
      <br/>
      UNSIGNED CHAR Command_Accepted=ACK; and
      <br/>
      UNSIGNED CHAR Command_Not_Accepted=NAK.
    </p>
    <p num="100">Secure Subtract Data</p>
    <p num="101">
      The secure subtract data command causes the tag cryptography electronics 104 to perform a subtraction from the secure data storage area in the tag cryptography electronics 104.
      <br/>
      Preferably, the sequence number is one higher than the sequence number stored in the tag cryptography electronics 104.
      <br/>
      The subtract function subtracts the number in the command from the number in the block and stores the result in the block.
      <br/>
      The subtraction is in binary format with borrows across bytes.
      <br/>
      If the subtraction results in a borrow from the last byte, then the subtraction is performed.
      <br/>
      Note that the block number in this command is relative to a group and starts from block 0.
    </p>
    <p num="102">A command protocol sequence follows:</p>
    <p num="103">
      --
      <br/>
      -- UNSIGNED CHAR Subtract_Data = E7 (send command);
      <br/>
      -- UNSIGNED SHORT New_Sequence_Number    (send new sequence number);
      <br/>
      -- UNSIGNED CHAR Group_Number            (select group);
      <br/>
      -- UNSIGNED SHORT Block_Number           (select block);
      <br/>
      -- UNSIGNED CHAR Data8       (send encrypted data);
      <br/>
      -- UNSIGNED CHAR Authenticator_Block8 (send encrypted authenticator); and
      <br/>
      -- UNSIGNED CHAR LRC.
    </p>
    <p num="104">
      The possible replies from the tag 100 are:
      <br/>
      UNSIGNED CHAR Command_Accepted=ACK; and
      <br/>
      UNSIGNED CHAR Command_Not_Accepted=NAK.
    </p>
    <p num="105">Secure Read Data</p>
    <p num="106">
      This commands returns data stored in a secure read memory area of the tag cryptography electronics 104 to the POS device 200.
      <br/>
      Generally, the data size is assumed to be one block or 8 bytes.
      <br/>
      Note that the block number in this command is relative to a group and starts from block 0.
    </p>
    <p num="107">A command protocol sequence follows:</p>
    <p num="108">
      --
      <br/>
      --      UNSIGNED CHAR Read_Data = E8 (send command);
      <br/>
      --      UNSIGNED CHAR Group_Number       (select group);
      <br/>
      --      UNSIGNED SHORT Block_Number      (select block); and
      <br/>
      --      UNSIONED CHAR LRC                (checksum).
    </p>
    <p num="109">The possible replies from the tag 100 are:</p>
    <p num="110">
      --
      <br/>
      -- UNSIGNED CHAR Command_Not_Accepted = NAK; or
      <br/>
      -- UNSIGNED CHAR Command_Accepted = ACK;
      <br/>
      -- UNSIGNED CHAR Current_Sequence_Number        (send current sequence
      <br/>
      --  number);
      <br/>
      -- UNSIGNED CHAR DES_Key_Counter                (send DES key counter value);
      <br/>
      -- UNSIGNED CHAR Data8/*encrypted*/ (send encrypted data);
      <br/>
      -- UNSIGNED CHAR Authenticator_Block8 (send encrypted authentic or data);
      <br/>
      -- /*encrypted*/                                and
      <br/>
      -- UNSIGNED CHAR LRC                            (checksum).
    </p>
    <p num="111">Unsecure Write Data</p>
    <p num="112">
      The unsecure write data command causes the tag cryptography electronics 104 to store data that is part of this command.
      <br/>
      Note that the block number in this command is relative to a group and starts from block 0.
    </p>
    <p num="113">A command protocol sequence follows;</p>
    <p num="114">
      --
      <br/>
      -- UNSIGNED CHAR Secure_Write_Data = E9 (send command);
      <br/>
      -- UNSIGNED CHAR Sequence_Number       (send sequence number);
      <br/>
      -- UNSIGNED CHAR Group_Number          (select group);
      <br/>
      -- UNSIGNED SHORT Block_Number         (select block);
      <br/>
      -- UNSIGNED CHAR Data8     (send data); and
      <br/>
      -- UNSIGNED CHAR LRC                   (checksum).
    </p>
    <p num="115">
      The possible replies from the tag 100 are:
      <br/>
      UNSIGNED CHAR Command_Accepted=ACK; and
      <br/>
      UNSIGNED CHAR Command_Not_Accepted=NAK.
    </p>
    <p num="116">Unsecure Add Data</p>
    <p num="117">
      The unsecure add data command causes the tag cryptography electronics 104 to add data that is part of this command to the data that is already in storage in the tag cryptography electronics 104.
      <br/>
      The sequence number is one higher than the sequence number stored in the tag cryptography electronics 104.
      <br/>
      The Add function adds the data in the block to the data in the command and stores the result in the block.
      <br/>
      The addition is in binary coded decimal format with carries across bytes.
      <br/>
      Any carries from the MSBs is lost.
      <br/>
      If the addition would result in a carry out of the last byte, then the addition will not be performed.
      <br/>
      Note that the block number in this command is relative to a group and starts from block 0.
    </p>
    <p num="118">The command protocol sequence would be:</p>
    <p num="119">
      --
      <br/>
      -- UNSIGNED CHAR Secure_Add_Data = EA (send command);
      <br/>
      -- UNSIGNED SHORT New_Sequence_number    (send new sequence
      <br/>
      -- number);
      <br/>
      -- UNSIGNED CHAR Group_Number            (select group);
      <br/>
      -- UNSIGNED SHORT Block_Number           (select block);
      <br/>
      -- UNSIGNED CHAR Data8       (send data); and
      <br/>
      -- UNSIGNED CHAR LRC                     (checksum).
    </p>
    <p num="120">
      The possible replies from the tag 100 are:
      <br/>
      UNSIGNED CHAR Command_Accepted=ACK; and
      <br/>
      UNSIGNED CHAR Command_Not_Accepted=NAK.
    </p>
    <p num="121">Unsecure Subtract Data</p>
    <p num="122">
      The unsecure subtract data command causes the tag cryptography electronics 104 to perform a subtraction from the data stored in the tag cryptography electronics 104.
      <br/>
      The sequence number is one higher than the sequence number stored in the tag cryptography electronics 104.
      <br/>
      The data is not secured, and there are no security checks or encryption on this command.
      <br/>
      The Subtract function subtracts the number in the command from the number in the block and stores the result in the block.
      <br/>
      The subtraction is in binary coded decimal format with borrows across bytes.
      <br/>
      If the subtract would result in a borrow from the last byte, then the subtraction is performed.
      <br/>
      Note that the block number in this command is relative to a group and starts from block 0.
    </p>
    <p num="123">A command protocol sequence follows:</p>
    <p num="124">
      --
      <br/>
      -- UNSIGNED CHAR Subtract_Data = EB (send command);
      <br/>
      -- UNSIGNED SHORT New_Sequence_Number    (send new sequence
      <br/>
      -- number);
      <br/>
      -- UNSIGNED CHAR Group_Number            (select group);
      <br/>
      -- UNSIGNED SHORT Block_Number           (select block);
      <br/>
      -- UNSIGNED CHAR Data8       (send data); and
      <br/>
      -- UNSIGNED CHAR LRC                     (checksum).
    </p>
    <p num="125">
      The possible replies from the tag 100 are:
      <br/>
      UNSIGNED CHAR Command_Accepted=ACK; or
      <br/>
      UNSIGNED CHAR Command_Not_Accepted=NAK.
    </p>
    <p num="126">Unsecure Read Data</p>
    <p num="127">
      The unsecure read data command returns data stored in the tag cryptography electronics 104 to the POS device 200.
      <br/>
      The data size is assumed to be one block or 8 bytes.
      <br/>
      Note that the block number in this command is relative to a group and starts from block 0.
    </p>
    <p num="128">A command protocol sequence follows:</p>
    <p num="129">
      --
      <br/>
      --      UNSIGNED CHAR Read_Data = EC (send command);
      <br/>
      --      UNSIGNED SHORT Block_Number      (select block); and
      <br/>
      --      UNSIGNED CHAR LRC                (checksum).
    </p>
    <p num="130">The possible replies from the tag 100 are:</p>
    <p num="131">
      --
      <br/>
      -- UNSIGNED CHAR Command_Not_Accepted = NAK; or
      <br/>
      -- UNSIGNED CHAR Command_Accepted = ACK;
      <br/>
      -- UNSIGNED CHAR Current_Sequence_Number        (send current sequence
      <br/>
      --  number);
      <br/>
      -- UNSIGNED CHAR DES_Key_Counter                (send DES key counter);
      <br/>
      -- UNSIGNED CHAR Data8              (send data); and
      <br/>
      -- UNSIGNED CHAR LRC                            (checksum).
    </p>
    <p num="132">Read DES Module Status</p>
    <p num="133">The read DES module status command reads the tag status registers and also returns the tag cryptography electronics 104 version number.</p>
    <heading>CRYPTOGRAPHY MEMORY ORGANIZATION</heading>
    <p num="134">
      The tag user memory 120 is preferably configured to include numeric counters or registers.
      <br/>
      Each counter or register is called a block.
      <br/>
      Generally, each block is 8 bytes long.
      <br/>
      There are x blocks of memory in the tag depending on the CPU selected.
      <br/>
      Data is stored in the blocks in Big Endian mode, that is, the lowest address is the most significant byte of data As noted, the tag user memory 120 is divided into four different areas called groups.
      <br/>
      The commands available for each group depend on the content of the Group Mode register for that group.
      <br/>
      It is permissible for the group begin block and end block numbers to overlap.
      <br/>
      In these instances, groups can share blocks and the data stored therein.
    </p>
    <p num="135">
      Add and subtract operations are performed in binary coded decimal (BCD).
      <br/>
      Typically, each 8 byte block is capable of storing a maximum of 16 decimal numbers.
      <br/>
      If there are x number of bytes in the user memory 120, then there are x/8 blocks of data.
      <br/>
      Blocks are numbered from 0 to (x/8)-1. A detailed example is given below on block divisions and possible uses of the groups.
    </p>
    <p num="136">
      In the following example, there is 1024 bytes of user memory in the cryptography electronics 104 assuming there are 128 memory blocks.
      <br/>
      The group registers would be setup as follows:
    </p>
    <p num="137">
      --
      <br/>
      -- UNSIGNED SHORT BEGIN_BLOCK_GROUP_0 =    0x0000;
      <br/>
      -- UNSIGNED SHORT END_BLOCK_GROUP_0 =      0x001f;
      <br/>
      -- UNSIGNED CHAR GROUP_MODE_0 =            0x0f
      <br/>
      -- UNSIGNED SHORT BEGIN_BLOCK_GROUP_1 =    0x0020;
      <br/>
      -- UNSIGNED SHORT END_BLOCK_GROUP_1 =      0x003f;
      <br/>
      -- UNSIGNED CHAR GROUP_MODE_1 =            0x87
      <br/>
      -- UNSIGNED SHORT BEGIN_BLOCK_GROUP_2 =    0x0040;
      <br/>
      -- UNSIGNED SHORT END_BLOCK_GROUP_2 =      0x005f
      <br/>
      -- UNSIGNED CHAR GROUP_MODE_2 =            0xc3
      <br/>
      -- UNSIGNED SHORT BEGIN_BLOCK_GROUP_3 =    0x0060;
      <br/>
      -- UNSIGNED SHORT END_BLOCK_GROUP_3 =      0x007f;
      <br/>
      -- UNSIGNED CHAR GROUP_MODE_3 =            0x81
    </p>
    <p num="138">
      With reference to FIGS. 10 and 11 and the example setup, the first group of blocks is composed of the first 32 blocks in the user memory, numbered from 0 to 31.
      <br/>
      An attempt to perform an unsecure read or subtract function to these blocks will not be accepted.
      <br/>
      The data is preferably stored as clear text data.
      <br/>
      A different session key (SK) is used to manipulate the data at each session rather than expose the same key to constant scrutiny.
    </p>
    <p num="139">
      The second group of blocks is composed of 32 blocks numbered from 32 to 63.
      <br/>
      This group of blocks accepts an unsecure read function.
      <br/>
      An attempt to perform an unsecure add or subtract operation to one of these blocks will not be accepted.
      <br/>
      This group of blocks is preferably used as a cash storage device and other applications analogous to prepaid cards or smartcards.
    </p>
    <p num="140">
      The third group of blocks is composed of 32 blocks numbered from 64 to 95.
      <br/>
      This group of blocks may accept both an unsecure read function and an unsecure subtract function.
      <br/>
      Note that secure write and add functions are required.
      <br/>
      This group of blocks is preferably a data storage location for loyalty points.
      <br/>
      A local source 32 (or even the POS device 200 or local station) providing benefits in exchange for the loyalty points can read and subtract from data stored in this group, but is not able to write or add to the data stored in this group.
    </p>
    <p num="141">
      The last group of blocks is composed of 32 blocks numbered from 96 to 127 and will accept an unsecure read function.
      <br/>
      An attempt to perform an add or subtract function, either secure or unsecure, will not be accepted.
      <br/>
      The write operation must be secure.
      <br/>
      A block configured in this manner is useful for storing customer information on the tag 100 which is readily accessible by sources other than the host 300.
      <br/>
      The write operation is secure to prevent unauthorized sources, typically those other than the host 300, from altering customer information.
      <br/>
      FIGS. 10 and 11 include preferable commands and the recommended usage for each group in this example.
    </p>
    <heading>USER MEMORY ORGANIZATION</heading>
    <p num="142">
      In an active tag 100, that is one having an internal source of power, user memory 120 is preferably 256 bytes long.
      <br/>
      The memory 120 is preferably divided into three different partitions as allowed by the three different sets of partition descriptor registers.
      <br/>
      Each partition requires a different password for various types of access by various sources.
      <br/>
      FIG. 12 illustrates possible partitions for the tag 100 and outlines the recommended requirements for the respective passwords for the different partitions.
      <br/>
      Similar setup is available for passive tag and is limited only to the communication technology's ability to operate the tags control and memory structure.
    </p>
    <p num="143">
      The various partitions and the associated passwords provide varying types of access for different sources adapted to read, write or modify data in the tag 100.
      <br/>
      Preferably, there are three passwords, SuperUser, Administrator and User.
      <br/>
      The SuperUser password is known only by the host 300.
      <br/>
      Each tag 100 will have a different SuperUser password, which is calculated from the tag ID.
      <br/>
      The first partition, partition 0, associated with the SuperUser password may include customer definition data fields as shown in FIGS. 13A and 13B.
      <br/>
      Partition 0 can be read by local sources without the SuperUser password.
      <br/>
      However, only the host 300, using the SuperUser password, may write data to this partition or otherwise modify data therein.
    </p>
    <p num="144">
      The host network 300 may also generate a host authentication code from the tag ID.
      <br/>
      The SuperUser password and host authentication code will be different for each tag 100 and may be used during authorization or secure data transfer between the tag 100 and the host 300 when DES encryption or the primary cryptography technique is unavailable or unnecessary.
      <br/>
      The authentication code simply provides another security feature for data transfer between the tag 100 and host 300.
    </p>
    <p num="145">
      The second partition, partition number 1, allows the host 300, POS device 200 or other local sources to access and modify data in the tag 100.
      <br/>
      The second partition preferably includes local and host authentication codes.
      <br/>
      The POS device 200 can calculate the administrator password from the tag ID.
      <br/>
      The local authentication code is used for authorization for the various local sources, including the POS device 200, whereas the host authentication code is sent to the host for authentication.
      <br/>
      For example, the POS device 200 can calculate the administrator password for partition number 1 from the tag ID and then read the local and host authentication code.
      <br/>
      If local transactions are desired, the POS device 200 checks the local authentication code and authorizes a local transaction accordingly.
      <br/>
      If a host related transaction is necessary, the host authentication code is passed on to the host for authentication.
    </p>
    <p num="146">
      Preferably, an administrative DES key is used to generate the administrator password for the second partition (partition number 1).
      <br/>
      Yet another DES key is used to generate the local authentication code.
      <br/>
      Thus, the administrator password and the local authentication code is generated with additional DES keys and the tag ID.
      <br/>
      The administrator Partition password and the local authentication code should be unique for each tag.
      <br/>
      FIG. 14 provides a typical layout for the second partition, (partition number 1).
    </p>
    <p num="147">
      The third partition, partition number 2, provides a scratch pad for any of the various sources communicating with the tag 100.
      <br/>
      The scratch pad provides complete read and write access for any of the local sources.
      <br/>
      The scratch pad can be used for virtually any type of application where security is not of utmost importance.
      <br/>
      Notably, this portion of memory allows virtually any source to communicate with the tag, especially those without cryptography capabilities.
      <br/>
      The scratch pad feature expands tag compatibility with virtually any type of source having remote intelligent communication capability.
      <br/>
      Preferably, the scratch pad area allows a local system to save information to be read a short time later at the same location or station.
      <br/>
      Typically, the scratch pad is 32 bytes long, and its organization of data fields, if any, is determined by the local system.
      <br/>
      A User password may be used to limit access to those having a password and provide modest security.
      <br/>
      The User password for the user partition is preferably the same in all tags.
      <br/>
      Typically, the POS device operator or tag issuer will supply the password.
      <br/>
      FIG. 15 shows a typical layout of the third partition, (partition number 2).
    </p>
    <heading>PREFERRED PASSWORD AND AUTHENTICATION CODE GENERATION</heading>
    <p num="148">
      The SuperUser password for the SuperUser partition number 0 is generated by the host 300 and is preferably unknown to the local sources, including the POS device 200.
      <br/>
      The SuperUser password is different for each tag and is based on the tag ID.
      <br/>
      A preferred method of generating this password is shown in FIG. 16.
    </p>
    <p num="149">
      In order to generate the SuperUser password the least significant 8 bytes of the tag ID are XORed with an 8 byte constant chosen by the host 300.
      <br/>
      The result is then XORed with a unique host password generation key, DES encrypted with the host password generation key and XORed again with the host password generation key.
      <br/>
      The result of this is an 8 byte value.
      <br/>
      This 8 byte value is then split into two parts consisting of the least significant 4 bytes (lower half) and the most significant 4 bytes (upper half).
      <br/>
      These two halves are XORed together and then ANDed with the 4 byte hexadecimal constant 7F FF FF FF.
      <br/>
      This has the effect of making the most significant bit of the 32 bit value equal to a logical zero.
      <br/>
      The result of this operation is the tag's SuperUser Password that is injected and stored in to tag 100 during initialization.
    </p>
    <p num="150">
      The administrator password is generated by the host 300 at the time the tag is initialized.
      <br/>
      Each tag gets a different administrator password, which is calculated from the tag ID.
      <br/>
      The generation process uses a unique administrator DES key, preferably supplied by the POS device or dispenser provider.
      <br/>
      The administrator password generation process is shown in FIG. 17. The administrator password is preferably generated by the POS device 200 to allow read access to the local and host authentication codes stored in partition number 1.
    </p>
    <p num="151">
      In order to generate the administrator password the least significant 8 bytes of the tag ID are first XORed with the POS provider password generation key, then DES encrypted with the POS provider password generation key, and then XORed again with the POS provider password generation key.
      <br/>
      The result of this is an 8 byte value.
      <br/>
      The 8 byte value is then split into two parts consisting of the least significant 4 bytes (lower half) and the most significant 4 bytes (upper half).
      <br/>
      These two halves are XORed together and then ORed with the 4 byte hexadecimal constant 80 00 00 00.
      <br/>
      This has the effect of making the most significant bit of the 32 bit value equal to a logical one.
      <br/>
      The result of this operation is the tag administrator password that is injected and stored in the tag.
    </p>
    <p num="152">
      The host authentication code is read by the POS device 200 from partition 1, the administrator partition.
      <br/>
      The code is transmitted to the host 300 to authenticate the tag.
      <br/>
      Each tag has a different authentication code, which is generated from the tag ID.
      <br/>
      A preferred method of generating this code is shown in FIG. 8.
    </p>
    <p num="153">
      In order to generate the host authentication code the least significant 8 bytes of the tag ID are XORed with an 8 byte constant chosen by the host.
      <br/>
      The result is then XORed with a unique host authentication code generations DES encrypted with the host authentication code generation key, and XORed again with the host authentication code generation key.
      <br/>
      The result of this is an 8 byte value.
      <br/>
      This 8 byte value is stored in the administrator partition of the tag 100 as the host authentication code.
    </p>
    <p num="154">
      The local authentication code is also generated by the host 300 at the time the tag is initialized.
      <br/>
      Each tag 100 gets a different local authentication code that is calculated from the tag ID.
      <br/>
      Preferably, the generation process uses a DES key supplied by POS device provider for this purpose.
      <br/>
      The local authentication code Generation Process is shown in FIG. 19. The local authentication code can be generated by the POS device to allow the local system to authenticate the tag.
    </p>
    <p num="155">
      In order to generate the local authentication code the least significant 8 bytes of the tag ID are first XORed with the local authentication code generator DES key, then DES encrypted with the local authentication code generator DES key, and then XORed again with the local authentication code generator key.
      <br/>
      The result is an 8 byte value that is the local authentication code.
      <br/>
      The local authentication code is stored in the tag's administrator partition.
    </p>
    <p num="156">
      Notably, the convoluted processes disclosed herein to determine and calculate the various cryptography keys, codes, and numbers, such as the ID number, are for example only.
      <br/>
      The combination of cryptography and logical operations may be reduced, amplified or modified to provide the desired results.
    </p>
    <p num="157">
      Certain modifications and improvements will occur to those skilled in the art upon a reading of the foregoing description.
      <br/>
      It should be understood that all such modifications and improvements have been deleted herein for the sake of conciseness and readability but are properly within the scope of the following claims.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A cryptography key generator for generating keys used in remote communications devices comprising:</claim-text>
      <claim-text>a remote communication device identification number generator adapted to generate unique identification numbers for a plurality of remote communication devices a memory having at least one master encryption key stored therein; cryptography electronics associated with a host processing system adapted to encrypt a function of an identification number using said at least one master encryption key to provide a main remote communication device key;</claim-text>
      <claim-text>and communication electronics associated with said cryptography electronics adapted to transmit said remote communication device identification number and said remote communication device key to a corresponding remote communication device; wherein said identification number generator includes an incremental sequence counter, said incremental sequence counter adapted to provide a tag sequence number used to form at least part of said identification number.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. The cryptography key generator of claim 1 wherein said identification number generator forms said identification number by including an industry code signifying a type of industry from which the corresponding remote communication device is issued as part of said identification number.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. The cryptography key generator of claim 1 wherein said identification number generator forms said identification number by including an issuing company code signifying a company from which the corresponding remote communication device is issued as part of said identification number.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. The cryptography key generator of claim 1 wherein said cryptography electronics is adapted to encrypt a function of at least part of said identification number with said at least one master encryption key to form a value used to arrive at said main remote communication device key.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. The cryptography key generator of claim 4 wherein said function is f(x)=x.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. The cryptography key generator of claim 4 wherein said function of at least part of said identification number is a result of taking an exclusive-OR of at least part of said identification number and a constant.</claim-text>
    </claim>
    <claim num="7">
      <claim-text>7. The cryptography key generator of claim 1 wherein said cryptography electronics creates said remote communication device key by: a. taking an exclusive-OR of at least part of said identification number and a constant stored in said memory to provide a first result; b. taking an exclusive-OR of said first result and a first master key to provide a second result; c. encrypting said second result with said first master key to provide a third result; d. taking an exclusive-OR of said third result and said first master key to provide a fourth result; e. taking an exclusive-OR of said fourth result and a second master key to provide a fifth result; f. decrypting said fifth result with said second master key to provide a sixth result; g. taking an exclusive-OR of said sixth result and said second master key to provide a seventh result; h. taking an exclusive-OR of said seventh result and a third master key to provide an eighth result; i. encrypting said eighth result with said third master key to provide a ninth result;</claim-text>
      <claim-text>and j. taking an exclusive-OR of said ninth result and said third master key to provide said remote communication device key.</claim-text>
    </claim>
    <claim num="8">
      <claim-text>8. The cryptography key generator of claim 1 wherein said cryptography electronics encrypts and decrypts according to The Data Encryption Standard (DES) and the master encryption key is a DES key.</claim-text>
    </claim>
    <claim num="9">
      <claim-text>9. A cryptograph key generator for generating keys used in remote communication devices comprising: a remote communication device identification number generator adapted to generate unique identification numbers for a plurality of remote communication devices, a memory having at least one master encryption key stored therein; cryptography electronics associated with a host processing system adapted to encrypt a function of an identification number using said at least one master encryption key to provide a main remote communication device key;</claim-text>
      <claim-text>and communication electronics associated with said cryptography electronics adapted to transmit said remote communication device identification number and said remote communication device key to a corresponding remote communication device, wherein said identification number generator includes an incremental sequence counter, said incremental sequence counter adapted to provide a tag sequence number used to form at least part of said identification number, and said identification number generator forms said identification number by combining said tag sequence number, said issuing company code signifying a company from which the corresponding remote communication device is issued and an industry code signifying a type of industry the issuing company is associated.</claim-text>
    </claim>
    <claim num="10">
      <claim-text>10. A cryptography key generator for generating keys used in remote communications devices comprising: a remote communication device identification number generator adapted to generate unique identification numbers for a plurality of remote communication devices; a memory having at least one master encryption key stored therein; cryptography electronics associated with a host processing system adapted to encrypt a function of an identification number using said at least one master encryption key to provide a main remote communication device key;</claim-text>
      <claim-text>and communication electronics associated with said cryptography electronics adapted to transmit said remote communication device identification number and said remote communication device key to a corresponding remote communication device; wherein said cryptography electronics are adapted to encrypt a function of at least part of said identification number with a first master key to provide a first result and decrypt a function of said first result with another master key to provide another result used to arrive at said main remote communication device key.</claim-text>
    </claim>
    <claim num="11">
      <claim-text>11. A cryptography key generator for generating keys used in remote communications devices comprising: a remote communication device identification number generator adapted to generate unique identification numbers for a plurality of remote communication devices; a memory having at least one master encryption key stored therein; cryptography electronics associated with a host processing system adapted to encrypt a function of an identification number using said at least one master encryption key to provide a main remote communication device key;</claim-text>
      <claim-text>and communication electronics associated with said cryptography electronics adapted to transmit said remote communication device identification number and said remote communication device key to a corresponding remote communication device; wherein said cryptography electronics are adapted to encrypt a function of at least part of said identification number with a first master key to provide a first result and encrypt a function of said first result with another master key to provide another result used to arrive at said main remote communication device key.</claim-text>
    </claim>
    <claim num="12">
      <claim-text>12. A cryptography key generator for generating keys used in remote communications devices comprising: a remote communication device identification number generator adapted to generate unique identification numbers for a plurality of remote communication devices; a memory having at least one master encryption key stored therein; cryptography electronics associated with a host processing system adapted to encrypt a function of an identification number using said at least one master encryption key to provide a main remote communication device key;</claim-text>
      <claim-text>and communication electronics associated with said cryptography electronics adapted to transmit said remote communication device identification number and said remote communication device key to a corresponding remote communication device; wherein said cryptography electronics are adapted to encrypt a function of at least part of said identification number with a first master key to provide a first result;</claim-text>
      <claim-text>decrypt a function of said first result with a second master key to provide a second result and encrypt a function of said second result used to arrive at said main remote communication device key.</claim-text>
    </claim>
    <claim num="13">
      <claim-text>13. A cryptography key generator for generating keys used in remote communication devices comprising: a remote communication device identification number generator adapted to generate unique identification numbers for a plurality of remote communication devices, a memory having at least one master encryption key stored therein; cryptography electronics associated with a host processing system adapted to encrypt a function of an identification number using said at least one master encryption key to provide a main remote communication device key;</claim-text>
      <claim-text>and communication electronics associated with said cryptography electronics adapted to transmit said remote communication device identification number and said remote communication device key to a corresponding remote communication device, wherein said identification number generator includes an incremental sequence counter, said incremental sequence counter adapted to provide a tag sequence number used to form at least part of said identification number, and said identification number includes a standard industry code, issuing company identifier and a tag sequence number.</claim-text>
    </claim>
    <claim num="14">
      <claim-text>14. The cryptography key generator of claim 13 wherein said identification number is ten bytes having four bytes allocated for said standard industry code, two bytes allocated for said company identifier and four bytes for said tag sequence number.</claim-text>
    </claim>
    <claim num="15">
      <claim-text>15. The cryptography key generator of claim 13 wherein said at least part of said identification number includes said tag sequence number.</claim-text>
    </claim>
    <claim num="16">
      <claim-text>16. The cryptography key generator of claim 13 wherein said at least part of said identification number includes said tag sequence number and said issuing company identifier.</claim-text>
    </claim>
    <claim num="17">
      <claim-text>17. The cryptography key generator of claim 13 wherein said at least part of said identification number includes said tag sequence number, said issuing company identifier and part of said standard industry code.</claim-text>
    </claim>
    <claim num="18">
      <claim-text>18. A method of generating a cryptography key for a plurality of remote communication devices comprising: a. generating a unique identification number for a remote communication device; b. taking an exclusive-OR of at least part of the identification number and a constant to provide a first result; c. taking an exclusive-OR of the first result and a first master key to provide a second result; d. encrypting the second result with the first master key to provide a third result; e. taking an exclusive-OR of the third result and the first master key to provide a fourth result; f. taking an exclusive-OR of the fourth result and a second master key to provide a fifth result; g. decrypting the fifth result with the second master key to provide a sixth result; h. taking an exclusive-OR of the sixth result and the second master key to provide a seventh result; i. taking an exclusive-OR of the seventh result and a third master key to provide an eighth result; j. encrypting the eighth result with the third master key to provide a ninth result;</claim-text>
      <claim-text>and k. taking an exclusive-OR of the ninth result and the third master key to provide the remote communication device key.</claim-text>
    </claim>
    <claim num="19">
      <claim-text>19. The method of claim 18 wherein step a. includes: generating a sequence number, and forming said identification number by combining the sequence number, an issuing company code and a standard industry code.</claim-text>
    </claim>
  </claims>
</questel-patent-document>