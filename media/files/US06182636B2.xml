<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06182636B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06182636</doc-number>
        <kind>B2</kind>
        <date>20010206</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6182636</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference is-representative="YES" family-id="23665999" extended-family-id="13182647">
      <document-id>
        <country>US</country>
        <doc-number>09420324</doc-number>
        <kind>A</kind>
        <date>19991018</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1999US-09420324</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>13459072</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>42032499</doc-number>
        <kind>A</kind>
        <date>19991018</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1999US-09420324</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010206</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>F02D  13/02        20060101A I20070721RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>13</main-group>
        <subgroup>02</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20070721</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>F02D  31/00        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>31</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="3">
        <text>F02D  41/00        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>41</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>123399000</text>
        <class>123</class>
        <subclass>399000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>123090150</text>
        <class>123</class>
        <subclass>090150</subclass>
      </further-classification>
      <further-classification sequence="2">
        <text>123090170</text>
        <class>123</class>
        <subclass>090170</subclass>
      </further-classification>
      <further-classification sequence="3">
        <text>123478000</text>
        <class>123</class>
        <subclass>478000</subclass>
      </further-classification>
      <further-classification sequence="4">
        <text>123568210</text>
        <class>123</class>
        <subclass>568210</subclass>
      </further-classification>
    </classification-national>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-031/002</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>31</main-group>
        <subgroup>002</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-013/0207</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>13</main-group>
        <subgroup>0207</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-013/0215</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>13</main-group>
        <subgroup>0215</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="4">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-041/0002</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>41</main-group>
        <subgroup>0002</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="5">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-2041/001</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>2041</main-group>
        <subgroup>001</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="6">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-2041/002</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>2041</main-group>
        <subgroup>002</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="7">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-2041/1409</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>2041</main-group>
        <subgroup>1409</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="8">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-2041/389</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>2041</main-group>
        <subgroup>389</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="9">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>F02D-2250/18</classification-symbol>
        <section>F</section>
        <class>02</class>
        <subclass>D</subclass>
        <main-group>2250</main-group>
        <subgroup>18</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="10">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>Y02T-010/18</classification-symbol>
        <section>Y</section>
        <class>02</class>
        <subclass>T</subclass>
        <main-group>10</main-group>
        <subgroup>18</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130125</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="11">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>Y02T-010/42</classification-symbol>
        <section>Y</section>
        <class>02</class>
        <subclass>T</subclass>
        <main-group>10</main-group>
        <subgroup>42</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130128</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>20</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>10</number-of-drawing-sheets>
      <number-of-figures>34</number-of-figures>
      <image-key data-format="questel">US6182636</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Lean burn engine speed control</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>IIDA KAZUMASA, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5628290</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5628290</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>DAMSON ECKART, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5746176</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5746176</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>IIDA KAZUMASA, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>6009851</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6009851</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>YOSHINO TAKAHIRO</text>
          <document-id>
            <country>US</country>
            <doc-number>6024069</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6024069</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="5">
          <text>YOSHINO TAKAHIRO</text>
          <document-id>
            <country>US</country>
            <doc-number>6058906</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US6058906</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="6">
          <text>DENZ HELMUT, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4856465</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4856465</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="7">
          <text>UEDA KATSUNORI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5019989</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5019989</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="8">
          <text>ITO YASUSHI</text>
          <document-id>
            <country>US</country>
            <doc-number>5170759</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5170759</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="9">
          <text>CULLEN MICHAEL J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5414994</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5414994</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="10">
          <text>CLINTON ERIC L, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5548995</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5548995</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="11">
          <text>FUJIEDA MAMORU, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5666916</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5666916</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="12">
          <text>BAUER BERNHARD, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5676112</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5676112</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="13">
          <text>ZHANG HONG</text>
          <document-id>
            <country>US</country>
            <doc-number>5692471</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5692471</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="14">
          <text>ASIK JOSEPH R, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5758493</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5758493</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="15">
          <text>LEHNER VERA, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5765527</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5765527</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="16">
          <text>YOSHIOKA MAMORU</text>
          <document-id>
            <country>US</country>
            <doc-number>5857437</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5857437</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="17">
          <text>COOK JEFFREY ARTHUR, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5950603</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5950603</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="18">
          <text>BOSCH GMBH ROBERT</text>
          <document-id>
            <country>DE</country>
            <doc-number>4321413</doc-number>
            <kind>A1</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>DE4321413</doc-number>
          </document-id>
        </patcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Ford Global Technologies, Inc.</orgname>
            <address>
              <address-1>Dearborn, MI, US</address-1>
              <city>Dearborn</city>
              <state>MI</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>FORD GLOBAL TECHNOLOGIES</orgname>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Russell, John David</name>
            <address>
              <address-1>Farmington Hills, MI, US</address-1>
              <city>Farmington Hills</city>
              <state>MI</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="2">
          <addressbook lang="en">
            <name>Kotwicki, Allan Joseph</name>
            <address>
              <address-1>Williamsburg, MI, US</address-1>
              <city>Williamsburg</city>
              <state>MI</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <name>Russell, John D.</name>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Argenbright, Tony M.</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>GRANTED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      A method for controlling an engine having both an electronically controlled inlet device, such as an electronic throttle unit, and an electronically controlled outlet device, such as a variable cam timing system is disclosed.
      <br/>
      The method of the present invention achieves cylinder air charge control that is faster than possible by using an inlet device alone.
      <br/>
      In other words, the method of the present invention controls cylinder air charge faster than manifold dynamics by coordination of the inlet and outlet device.
      <br/>
      This improved control is used to improve various engine control functions.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>FIELD OF THE INVENTION</heading>
    <p num="1">The field of the invention relates to engine speed control in lean burn internal combustion engines.</p>
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="2">
      In direct injection spark ignition engines, fuel is injected directly into an engine cylinder.
      <br/>
      Since the fuel is injected directly into the cylinder, it is possible to rapidly adjust engine torque.
      <br/>
      Such ability is advantageous for performing engine speed control, especially during idle operation.
      <br/>
      For example, sudden loading from ancillary devices such as the power steering pump, can be quickly compensated by adjusting fuel injection amount into the cylinder.
    </p>
    <p num="3">
      In direct injection spark ignition engines, ignition timing is generally tightly coupled to fuel injection timing.
      <br/>
      Therefore, prior approaches using ignition timing to control engine speed are not applicable.
      <br/>
      Also, when operating in a lean air/fuel mode, where the throttle is generally mostly open to reduce engine pumping work, the range of air/fuel ratios is limited by emission constraints or engine operability limits.
      <br/>
      For example, during stratified operation at idle conditions, there is a minimum air/fuel ratio limit due to emission constraints.
      <br/>
      Similarly, there is a maximum air/fuel ratio limit due to combustion stability limits.
      <br/>
      Since the engine is unthrottled, giving a relatively fixed airflow, idle speed control using only fuel injection amount has a disadvantage in that the range of control authority is limited.
    </p>
    <p num="4">
      Given limits of air/fuel operation, the throttle may be adjusted thereby moving the air/fuel ratio limits, giving more control authority to the fuel injection amount.
      <br/>
      However, this method suffers from the disadvantage that adjustments in the throttle cannot quickly change the cylinder air charge amount.
      <br/>
      Controlling flow entering the manifold cannot rapidly control cylinder charge due to manifold volume.
      <br/>
      For example, if the throttle is instantly closed, cylinder air charge does not instantly decrease to zero.
      <br/>
      The engine must pump down the air stored in the manifold, which takes a certain number of revolutions.
      <br/>
      Therefore, the cylinder air charge gradually decreases toward zero.
      <br/>
      Thus, by adjusting airflow entering the manifold to prevent air/fuel operation in undesirable air/fuel ranges, air/fuel operation will occur in the undesired ranges during a transient period.
    </p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="5">An object of the present invention is to control engine speed to a desired engine speed while maintaining engine air/fuel ratio within desired limits.</p>
    <p num="6">The above object is achieved and disadvantages of prior approaches overcome by a method for controlling an engine having at least one cylinder, the engine also having an intake manifold and an outlet control device for controlling flow from the intake manifold into the cylinder and an inlet control device for controlling flow into the intake manifold, comprising: generating a fuel injection amount; and preventing an engine air/fuel ratio from entering a predetermined air/fuel ratio range by changing both the inlet control device and the outlet control device based on said fuel injection amount.</p>
    <p num="7">
      By changing both the outlet control device and the inlet control device, it is possible to rapidly change engine air charge so that the engine air/fuel ratio does not enter restricted regions.
      <br/>
      In other words, despite response delays from the manifold volume, it is possible to change engine air charge fast enough to compensate for rapid changes in fuel injection amount.
      <br/>
      Thus, even during transient conditions, engine operating is optimized by rapidly controlling engine air/fuel ratio.
    </p>
    <p num="8">An advantage of the above aspect of the invention is that greater range of authority can be given to fuel injection control.</p>
    <p num="9">Another advantage of the above aspect of the invention is improved idle speed control.</p>
    <p num="10">Yet another advantage of the above aspect of the invention is improved emissions.</p>
    <p num="11">In another aspect of the present invention, the above object is achieved and disadvantages of prior approaches overcome by a method for controlling an engine having at least one cylinder, the engine also having an intake manifold and an outlet control device for controlling flow from the intake manifold into the cylinder and an inlet control device for controlling flow into the intake manifold, comprising: generating a fuel injection amount; determining a restricted air amount range based on said fuel injection amount and a restricted air/fuel ratio range; and adjusting both the inlet control device and the outlet control device based on said restricted air amount range.</p>
    <p num="12">An advantage of the above aspect of the invention is that by determining the restricted air range based on the fuel injection amount, it is possible to prevent operating is restricted air/fuel ranges despite variation in operating engine load.</p>
    <p num="13">Other objects, features and advantages of the present invention will be readily appreciated by the reader of this specification.</p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="14">
      The object and advantages of the invention claimed herein will be more readily understood by reading an example of an embodiment in which the invention is used to advantage with reference to the following drawings wherein:
      <br/>
      FIGS. 1A and 1B are a block diagrams of an embodiment in which the invention is used to advantage;
      <br/>
      FIG. 2A is a block diagram of an embodiment in which the invention is used to advantage;
      <br/>
      FIGS. 2B-20 are graphs describing operation of the embodiment in FIG. 2A;
      <br/>
      FIGS. 3-5,8-10 are high level flowcharts which perform a portion of operation of the embodiment shown in FIGS. 1A, 1B, and 2A;
      <br/>
      FIG. 6 is a graph showing how various factors are related to engine operation according to the present invention;
      <br/>
      FIG. 7 is a graph depicting results using the present invention;
      <br/>
      FIGS. 11A-11F are graphs describing operation of an embodiment of the present invention; and
      <br/>
      FIGS. 12, 13 and 14 are a block diagrams of an embodiment in which the invention is used to advantage.
    </p>
    <p num="15">DESCRIPTION OF PREFERRED EMBODIMENT(S)</p>
    <p num="16">
      Direct injection spark ignited internal combustion engine 10, comprising a plurality of combustion chambers, is controlled by electronic engine controller 12.
      <br/>
      Combustion chamber 30 of engine 10 is shown in FIG. 1A including combustion chamber walls 32 with piston 36 positioned therein and connected to crankshaft 40.
      <br/>
      In this particular example piston 30 includes a recess or bowl (not shown) to help in forming stratified charges of air and fuel.
      <br/>
      Combustion chamber, or cylinder, 30 is shown communicating with intake manifold 44 and exhaust manifold 48 via respective intake valves 52a and 52b (not shown), and exhaust valves 54a and 54b (not shown).
      <br/>
      Fuel injector 66A is shown directly coupled to combustion chamber 30 for delivering liquid fuel directly therein in proportion to the pulse width of signal fpw received from controller 12 via conventional electronic driver 68.
      <br/>
      Fuel is delivered to fuel injector 66A by a conventional high pressure fuel system (not shown) including a fuel tank, fuel pumps, and a fuel rail.
    </p>
    <p num="17">
      Intake manifold 44 is shown communicating with throttle body 58 via throttle plate 62.
      <br/>
      In this particular example, throttle plate 62 is coupled to electric motor 94 so that the position of throttle plate 62 is controlled by controller 12 via electric motor 94.
      <br/>
      This configuration is commonly referred to as electronic throttle control (ETC) which is also utilized during idle speed control.
      <br/>
      In an alternative embodiment (not shown), which is well known to those skilled in the art, a bypass air passageway is arranged in parallel with throttle plate 62 to control inducted airflow during idle speed control via a throttle control valve positioned within the air passageway.
    </p>
    <p num="18">
      Exhaust gas oxygen sensor 76 is shown coupled to exhaust manifold 48 upstream of catalytic converter 70.
      <br/>
      In this particular example, sensor 76 provides signal EGO to controller 12 which converts signal EGO into two-state signal EGOS.
      <br/>
      A high voltage state of signal EGOS indicates exhaust gases are rich of stoichiometry and a low voltage state of signal EGOS indicates exhaust gases are lean of stoichiometry.
      <br/>
      Signal EGOS is used to advantage during feedback air/fuel control in a conventional manner to maintain average air/fuel at stoichiometry during the stoichiometric homogeneous mode of operation.
    </p>
    <p num="19">Conventional distributorless ignition system 88 provides ignition spark to combustion chamber 30 via spark plug 92 in response to spark advance signal SA from controller 12.</p>
    <p num="20">
      Controller 12 causes combustion chamber 30 to operate in either a homogeneous air/fuel mode or a stratified air/fuel mode by controlling injection timing.
      <br/>
      In the stratified mode, controller 12 activates fuel injector 66A during the engine compression stroke se that fuel is sprayed directly into the bowl of piston 36.
      <br/>
      Stratified air/fuel layers are thereby formed.
      <br/>
      The strata closest to the spark plug contains a stoichiometric mixture or a mixture slightly rich of stoichiometry, and subsequent strata contain progressively leaner mixtures.
      <br/>
      During the homogeneous mode, controller 12 activates fuel injector 66A during the intake stroke so that a substantially homogeneous air/fuel mixture is formed when ignition power is supplied to spark plug 92 by ignition system 88.
      <br/>
      Controller 12 controls the amount of fuel delivered by fuel injector 66A so that the homogeneous air/fuel mixture in chamber 30 can be selected to be at stoichiometry, a value rich of stoichiometry, or a value lean of stoichiometry.
      <br/>
      The stratified air/fuel mixture will always be at a value lean of stoichiometry, the exact air/fuel being a function of the amount of fuel delivered to combustion chamber 30.
      <br/>
      An additional split mode of operation wherein additional fuel is injected during the exhaust stroke while operating in the stratified mode is also possible.
    </p>
    <p num="21">
      Nitrogen oxide (NOx) absorbent or trap 72 is shown positioned downstream of catalytic converter 70.
      <br/>
      NOx trap 72 absorbs NOx when engine 10 is operating lean of stoichiometry.
      <br/>
      The absorbed NOx is subsequently reacted with HC and catalyzed during a NOx purge cycle when controller 12 causes engine 10 to operate in either a rich homogeneous mode or a stoichiometric homogeneous mode.
    </p>
    <p num="22">
      Controller 12 is shown in FIG. 1A as a conventional microcomputer including: microprocessor unit 102, input/output ports 104, an electronic storage medium for executable programs and calibration values shown as read only memory chip 106 in this particular example, random access memory 108, keep alive memory 110, and a conventional data bus.
      <br/>
      Controller 12 is shown receiving various signals from sensors coupled to engine 10, in addition to those signals previously discussed, including: measurement of inducted mass air flow (MAP) from mass air flow sensor 100 coupled to throttle body 58; engine coolant temperature (ECT) from temperature sensor 112 coupled to cooling sleeve 114; a profile ignition pickup signal (PIP) from Hall effect sensor 118 coupled to crankshaft 40; and throttle position TP from throttle position sensor 120; and absolute Manifold Pressure Signal MAP from sensor 122.
      <br/>
      Engine speed signal RPM is generated by controller 12 from signal PIP in a conventional manner and manifold pressure signal MAP provides an indication of engine load.
      <br/>
      In a preferred aspect of the present invention, sensor 118, which is also used as an engine speed sensor, produces a predetermined number of equally spaced pulses every revolution of the crankshaft.
    </p>
    <p num="23">
      In this particular example, temperature Tcat of catalytic converter 70 and temperature Ttrp of NOx trap 72 are inferred from engine operation as disclosed in U.S. Pat. No. 5,414,994 the specification of which is incorporated herein by reference.
      <br/>
      In an alternate embodiment, temperature Tcat is provided by temperature sensor 124 and temperature Ttrp is provided by temperature sensor 126.
    </p>
    <p num="24">
      Continuing with FIG. 1A, camshaft 130 of engine 10 is shown communicating with rocker arms 132 and 134 for actuating intake valves 52a, 52b and exhaust valve 54a. 54b. Camshaft 130 is directly coupled to housing 136.
      <br/>
      Housing 136 forms a toothed wheel having a plurality of teeth 138.
      <br/>
      Housing 136 is hydraulically coupled to an inner shaft (not shown), which is in turn directly linked to camshaft 130 via a timing chain (not shown).
      <br/>
      Therefore, housing 136 and camshaft 130 rotate at a speed substantially equivalent to the inner camshaft.
      <br/>
      The inner camshaft rotates at a constant speed ratio to crankshaft 40.
      <br/>
      However, by manipulation of the hydraulic coupling as will be described later herein, the relative position of camshaft 130 to crankshaft 40 can be varied by hydraulic pressures in advance chamber 142 and retard chamber 144.
      <br/>
      By allowing high pressure hydraulic fluid to enter advance chamber 142, the relative relationship between camshaft 130 and crankshaft 40 is advanced.
      <br/>
      Thus, intake valves 52a,52b and exhaust valves 54a,54b open and close at a time earlier than normal relative to crankshaft 40.
      <br/>
      Similarly, by allowing high pressure hydraulic fluid to enter retard chamber 144, the relative relationship between camshaft 130 and crankshaft 40 is retarded.
      <br/>
      Thus, intake valves 52a,52b and exhaust valves 54a,54b open and close at a time later than normal relative to crankshaft 40.
    </p>
    <p num="25">
      Teeth 138, being coupled to housing 136 and camshaft 130, allow for measurement of relative cam position via cam timing sensor 150 providing signal VCT to controller 12.
      <br/>
      Teeth 1, 2, 3, and 4 are preferably used for measurement of cam timing and are equally spaced (for example, in a V-8 dual bank engine, spaced 90 degrees apart from one another), while tooth 5 is preferably used for cylinder identification, as described later herein.
      <br/>
      In addition, Controller 12 sends control signals (LACT,RACT) to conventional solenoid valves (not shown) to control the flow of hydraulic fluid either into advance chamber 142, retard chamber 144, or neither.
    </p>
    <p num="26">
      Relative cam timing is measured using the method described in U.S. Pat. No. 5,548,995, which is incorporated herein by reference.
      <br/>
      In general terms, the time, or rotation angle between the rising edge of the PIP signal and receiving a signal from one of the plurality of teeth 138 on housing 136 gives a measure of the relative cam timing.
      <br/>
      For the particular example of a V-8 engine, with two cylinder banks and a five toothed wheel, a measure of cam timing for a particular bank is received four times per revolution, with the extra signal used for cylinder identification.
    </p>
    <p num="27">Referring now to FIG. 1B, a port fuel injection configuration is shown where fuel injector 66B is coupled to intake manifold 44, rather than directly cylinder 30.</p>
    <p num="28">
      Referring now to FIG. 2A, a more general diagram shows manifold 44a, with inlet flow, m_in, and outlet flow, m_out.
      <br/>
      Inlet flow, m_in, is governed by inlet control device 170.
      <br/>
      Outlet flow, m_out, is governed by outlet flow device 171.
      <br/>
      In a preferred embodiment, manifold 44a is an intake manifold of an engine, inlet control device 170 is a throttle, and outlet control device 171 is a variable cam timing mechanism.
      <br/>
      However, as one skilled in the art would recognize, there are many alternative embodiments of the present invention.
      <br/>
      For example, outlet control device could be a swirl control valve, a variable valve timing mechanism, a variable valve lift mechanism, or an electronically controlled intake valve used in camless engine technology.
    </p>
    <p num="29">
      Continuing with FIG. 2A, there are other variables that affect flow entering and exiting manifold 44a.
      <br/>
      For example, pressures p1 and p2, along with inlet control device 170, determine flow m_in.
      <br/>
      Similarly, pressures p2 and p3, along with outlet device 171 determine flow m_out.
      <br/>
      Therefore, flow storage in manifold 44a, which dictates how fast pressure p2 can change, affects flow m_out.
      <br/>
      In an example where manifold 44a is an intake manifold of an engine operating at stoichiometry, flow m_out represents flow entering a cylinder and is directly proportional to engine torque.
    </p>
    <p num="30">
      FIGS. 2B-2K illustrate the effect of such interrelationships on system performance.
      <br/>
      In FIG. 2B, inlet control device 170 is rapidly changed at time t1.
      <br/>
      The resulting change in outlet flow (m_out) is shown in FIG. 2C. The resulting change in inlet flow (m_in) is shown in FIG. 2D. This example has outlet control device 171 fixed, and therefore represents conventional engine operation and prior art operation where throttle position is used to control outlet flow (m_out).
      <br/>
      In this example, a rapid change in inlet control device 170 does not produce an equally rapid change in exit flow m_out.
    </p>
    <p num="31">
      According to the present invention, in FIG. 2E, outlet control device 171 is rapidly changed at time t2.
      <br/>
      The resulting change in outlet flow (m_out) is shown in FIG. 2F. The resulting change in inlet flow (m_in) is shown in FIG. 2G. This example has inlet control device 170 fixed, and therefore represents adjustment of outlet device 170 only to control outlet flow (m_out).
      <br/>
      In this example, a rapid change in outlet control device 170 does produce an equally rapid change in exit flow m_out.
      <br/>
      However, the rapid change is not completely sustained.
    </p>
    <p num="32">
      According to the present invention, in FIG. 2H, inlet control device 170 is rapidly changed at time t3.
      <br/>
      Similarly, in FIG. 2I, outlet control device 171 is rapidly changed at time t3.
      <br/>
      The resulting change in outlet flow (m_out) is shown in FIG. 2J. The resulting change in inlet flow (m_in) is shown in FIG. 2K. This example varies both inlet control device 170 and outlet control device 170 concurrently.
      <br/>
      In this example, a rapid change in both inlet control device and 170 outlet control device 171 does produce an equally rapid change in exit flow m_out, where the rapid change is sustained.
    </p>
    <p num="33">
      According to the present invention, in FIG. 2L, inlet control device 170 is rapidly changed at time t4.
      <br/>
      Similarly, in FIG. 2M, outlet control device 171 is rapidly changed at time t4 to a greater extent than in FIG. 2I. The resulting change in outlet flow (m_out) is shown in FIG. 2N. The resulting change in inlet flow (m_in) is shown in FIG. 20. This example varies both inlet control device 170 and outlet control device 170 concurrently.
      <br/>
      In this example, a rapid change in both inlet control device and 170 outlet control device 171 does produce an equally rapid change in exit flow m_out, where the rapid change is sustained and actually produces a certain amount of peak, or overshoot.
      <br/>
      This represents how the present invention can be used to not only rapidly produce an increase in outlet flow, but to also add an overshoot.
      <br/>
      Thus, a control system according to the present invention can therefore generate a airflow lead control.
      <br/>
      Such lead control is advantageous for engine idle speed control to counteract engine inertia, or for vehicle launch conditions, to give improved drive feel.
    </p>
    <p num="34">
      According to the present invention, by using an outlet control device it is possible to rapidly control flow exiting a manifold.
      <br/>
      Further, by controlling both an inlet and outlet control device it is possible to more accurately rapidly control flow exiting a manifold in various shapes.
    </p>
    <p num="35">
      In cases where engine 10 operates at a stoichiometric air/fuel ratio, then engine torque directly proportional to cylinder charge, which is in turn proportional to exit flow m_out and engine speed.
      <br/>
      Thus, according to the present invention, by controlling engine airflow to a desired value.
    </p>
    <p num="36">Engine Idle Speed Control</p>
    <p num="37">
      Referring now to FIG. 3, a routine is described for controlling engine speed using both throttle position and cam timing.
      <br/>
      In step 310, an engine speed error (Nerr) is calculated based on a difference between the desired engine speed (Ndes) and an actual engine speed (Nact).
      <br/>
      Then, in step 320, the desired change in cylinder charge is calculated from speed error using controller K1, where controller K1 is represented in the Laplace domain as K1(s) as is known to those skilled in the art.
      <br/>
      The desired in cylinder charge ( DELTA mcyl) is preferably calculated using a proportional controller.
      <br/>
      Therefore, in the preferred embodiment, controller K1 represents a proportional controller.
      <br/>
      However, as those skilled in the art will recognize, various other control schemes can be used in place of proportional controller K1.
      <br/>
      For example, proportional integral derivative controllers, or sliding mode controllers, or any other controllers known to those skilled in the art, can be used.
      <br/>
      Next, in step 330, an intermediate throttle position (Tpint) is calculated from speed error and controller K3.
      <br/>
      As described above, various controllers can be used for controller K3.
      <br/>
      In a preferred embodiment, controller K3 is an integral controller.
      <br/>
      Next, in step 340, a nominal cam timing error (VCTerr) is calculated based on a difference between a desired nominal cam timing (VCTdesnom) and an actual cam timing (VCTact).
      <br/>
      Desired nominal cam timing (VCTdesnom) can be determined based on operating conditions, for example, based on idle mode, or drive mode.
      <br/>
      Also, desired nominal cam timing (VCTdesnom) can be set as a function of desired engine torque, or any other steady state scheduling method known to those skilled in the art.
      <br/>
      Next, in step 350, an intermediate timing (VCTint) is calculated from nominal cam timing error and controller K2.
      <br/>
      Controller K2 can be any controller known to those skilled in the art.
      <br/>
      In the preferred embodiment, controller K2 is a proportional integral controller.
    </p>
    <p num="38">
      Referring now to FIG. 4, a routine is described for calculating adjustments to cam timing and throttle position to rapidly change cylinder charge.
      <br/>
      First, in step 410, manifold pressure (Pm) is estimated or measured using sensor 122.
      <br/>
      In the preferred embodiment, manifold pressure (Pm) is estimated using methods known to those skilled in the art.
      <br/>
      For example, manifold pressure can be estimated using signal MAF from mass airflow sensor 100, engine speed, and other signals known to those skilled in the art to effect manifold pressure.
      <br/>
      Next, in step 412, the desired change in cylinder charge ( DELTA ncyl) is read from FIG. 3.
      <br/>
      Next, in step 414, a change in cam timing ( DELTA VCT) is determined to give the desired change in cylinder charge at manifold pressure (Pm) read in step 410.
      <br/>
      Step 414 is performed using maps relating to cam timing, cylinder charge, and manifold pressure.
      <br/>
      The maps can be determined theoretically using engine models or measured using engine test data.
      <br/>
      Next, in step 416, a change in throttle position ( DELTA TP) is determined to give the desired change in cylinder charge ( DELTA ncyl) at manifold pressure (Pm) determined in step 410.
      <br/>
      Step 416 is similarly performed using characteristic maps relating parameters, throttle position, cylinder charge, and manifold pressure.
      <br/>
      The maps can be determined either using engine models or engine test data.
    </p>
    <p num="39">
      Regarding FIG. 5, the routine is described for calculating the desired cam timing and desired throttle position.
      <br/>
      First, in step 510, a desired cylinder, desired cam timing (VCTdes) is determined based on the desired change in cam timing and intermediate cam timing.
      <br/>
      Next, in step 512, the desired throttle position (TPdes) is determined based on intermediate throttle position and desired change in throttle position.
    </p>
    <p num="40">
      However, when a cam timing position is desired that is greater than a maximum possible cam timing, or when a minimum cam timing is less than a minimum possible cam timing, desired cam timing (VCTdes) is clipped to the maximum or minimum value.
      <br/>
      In other words adjustment of cam timing may not be able to provide the desired increase, or decrease in cylinder air charge.
      <br/>
      In this case, cam timing is clipped to the achievable limit value and throttle position is relied upon to provide control.
    </p>
    <p num="41">Steady State Constraints</p>
    <p num="42">
      As described above herein with particular reference to FIGS. 3-5, a control method for controlling engine airflow, or engine torque, and thereby engine speed was described.
      <br/>
      In addition, the method included a method for rapidly controlling cylinder charge using both an inlet and outlet control device, while also relatively slowly controlling the outlet control device to a nominal position.
      <br/>
      Both of these process are now further illustrated using both FIGS. 6 and 7.
    </p>
    <p num="43">
      Referring now to FIG. 6, a graph is shown with throttle position (TP) on the vertical axis and cam timing (VCT) on the horizontal axis.
      <br/>
      Dash dotted lines are shown for constant values of engine torque (Te), assuming stoichiometric conditions, while solid lines show constant value of manifold pressure.
      <br/>
      According to the present invention, the engine can quickly change operating points along the lines of constant pressure (thereby rapidly changing engine airflow and torque) since there are no manifold dynamics in this direction.
      <br/>
      However, the engine can change only relatively slowly along the dash dotted lines if air/fuel ratio is fixed (for example at stoichiometry).
      <br/>
      The dashed vertical line represents the nominal desired cam timing for the given operating conditions.
      <br/>
      For example, the nominal timing for idle conditions, or the nominal timing for the current desired engine torque.
    </p>
    <p num="44">
      In other words, manifold dynamics represent dynamics associated with changing manifold pressure and explain why flow entering the cylinder is not always equal to flow entering the manifold.
      <br/>
      Manifold pressure cannot instantly change due to manifold volume.
      <br/>
      As manifold volume increases, manifold dynamics become slower.
      <br/>
      Conversely, as manifold volume decreases, manifold dynamics become faster.
      <br/>
      Thus, manifold dynamics, or manifold delay, is a function of manifold volume.
      <br/>
      As described above, when moving along lines of constant pressure, manifold dynamics are essentially immaterial.
      <br/>
      Therefore, flow changes are not limited by manifold dynamics when inlet and outlet control devices are changed to affect flow in similar directions.
      <br/>
      By changing inlet and outlet control devices faster than manifold dynamics to increase along both the abscissa and ordinate of FIG. 6, cylinder flow changes faster than manifold dynamics.
      <br/>
      Stated another way, cylinder flow changes faster than it would if only the inlet control device changed infinitely fast.
      <br/>
      When inlet and outlet control devices are changed to affect flow in opposite directions, cylinder charge can be kept constant.
      <br/>
      In particular, both the inlet and outlet control devices are changed slower than manifold dynamics since manifold pressure is changed.
      <br/>
      This is particular useful when engine airflow, or engine torque, is to be kept relatively constant yet it is desired to place either the inlet control device or the outlet control device in a specified location.
    </p>
    <p num="45">
      Referring now to both FIGS. 6 and 7, an example of operation according to an aspect of the present invention is now described.
      <br/>
      First, the system is operating at point 1.
      <br/>
      For example, the desired engine torque (Ted) is Te2, or this happens to be the engine torque to maintain a desired engine speed.
      <br/>
      Then, either the desired engine torque (Ted) changes to Te3, or a torque disturbance causes an engine speed to drop, thereby requiring an increase in engine torque to Te3 to maintain the desired engine speed.
      <br/>
      At this point (time t5), controller 12 causes both the throttle position and cam timing to change so that the engine system quickly moves to point 2.
      <br/>
      Next, in order to maintain cam timing and the nominal cam timing, controller 12 causes both the throttle position and cam timing to move to point 3 at a rate slower than the manifold dynamics.
    </p>
    <p num="46">
      Thus, according to the present invention, throttle position and cam timing are caused to move in the following way.
      <br/>
      When it is desired to rapidly increase cylinder air charge irrespective of manifold volume: 1) throttle position moves in a way that causes an increase in throttle opening area, and 2) cam timing is adjusted in a way to increase the inducted cylinder air charge for a given manifold pressure. moved.
      <br/>
      Similarly, when it is desired to rapidly decrease cylinder air charge irrespective of manifold volume: 1) throttle position moves in a way that causes a decrease in throttle opening area, and 2) cam timing is adjusted in a way to decrease the inducted cylinder air charge for a given manifold pressure.
      <br/>
      Thus, it is possible to rapidly change and maintain flow into the cylinder by this combined action.
    </p>
    <p num="47">
      However, when it is desired to maintain cylinder air charge and either increase throttle opening or cause cam timing to move so that less air charge is inducted for a given manifold pressure, or both, 1) throttle position moves in a way that causes an increase in throttle opening area, and 2) cam timing is adjusted in a way to decrease the inducted cylinder air charge for a given manifold pressure.
      <br/>
      Thus, cylinder charge can be kept constant by this opposing action.
      <br/>
      Alternatively, when it is desired to maintain cylinder air charge and either decrease throttle opening or cause cam timing to move so that more air charge is inducted for a given manifold pressure, or both, 1) throttle position moves in a way that causes a decrease in throttle opening area, and 2) cam timing is adjusted in a way to increase the inducted cylinder air charge for a given manifold pressure.
      <br/>
      Again, cylinder charge can be kept constant by this opposing action.
    </p>
    <p num="48">Such coordinated control is advantageous in that steady state optimization constraints on cam timing can be provided while still providing the ability to control cylinder air charge rapidly.</p>
    <p num="49">Engine Torque Control</p>
    <p num="50">
      Referring now to FIG. 8, a routine is described for controlling engine torque rather than engine speed as described in FIG. 3.
      <br/>
      Engine torque control according to the present invention may be used for various reasons, including normal driving operating, traction control, and/or cruise control.
      <br/>
      In other words, FIG. 8, along with FIGS. 3-5 can be used to control engine torque, where steps 310-330 are replaced by FIG. 8.
      <br/>
      Regarding FIG. 8, first, in step 810, a desired engine torque (Ted) is determined.
      <br/>
      Those skilled in the art will recognize that desired engine torque (Ted) can be determined in various ways.
      <br/>
      For example, desired engine torque (Ted) can be determine from desired wheel torque and gear ratio, from pedal position and vehicle speed, from pedal position and engine speed, or any other method known to those skilled in the art.
      <br/>
      Then, in step 820, desired cylinder charge (mcyld) is determined based on a function (h) of desired engine torque (Ted).
      <br/>
      Function (h) is based on a desired air/fuel ratio, such as stoichiometric conditions.
    </p>
    <p num="51">
      Continuing with FIG. 8, in step 830, desired change in cylinder charge (Dmcyl) is determined based on the difference between desired cylinder charge (mcyld) and actual cylinder charge (mcyl).
      <br/>
      Then, in step 840, intermediate throttle position (Tpint) is calculated from desired change in cylinder charge (Dmcyl) and controller K3.
      <br/>
      As described above, various controllers can be used for controller K3.
      <br/>
      In a preferred embodiment, controller K3 is an integral controller.
      <br/>
      Then, in step 850, a nominal cam timing (VCTdesnom) if determined based on function (g) and desired engine torque (Ted).
      <br/>
      Then, the routine continues to step 340 in FIG. 3.
    </p>
    <p num="52">Alternative Embodiment for Cylinder Charge, Torque, and Engine Speed Control</p>
    <p num="53">
      An alternative embodiment is now described that can be used to control either cylinder air charge, Engine Torque at a given air/fuel ratio, or engine speed.
      <br/>
      Referring now to FIG. 9, in step 910, a determination is made as to whether the engine is currently in an idle condition.
      <br/>
      Those skilled in the art will recognize various methods for determining idle conditions such as accelerator pedal position, engine speed, and various other factors.
      <br/>
      When the answer to step 910 is YES, the routine continues to step 912.
      <br/>
      In step 912, the desired cylinder charge (mcyldes) based on an engine speed error (Nerr).
      <br/>
      The desired cylinder charge is calculated using function L1, which can represent any function such as, for example, engine speed error multiplied by a constant gain, which is the preferred embodiment.
      <br/>
      Otherwise, when the answer to step 910 is NO, the routine continues to step 914.
      <br/>
      In step 914, the desired cylinder charge is calculated based on either a driver command or operating conditions using function (L2).
      <br/>
      Those skilled in the art will recognize various methods for calculating a desired cylinder charge from a driver command such as, for example, to provide a desired engine torque, a desired wheel torque, an engine output, or provide any other condition requested by the driver.
      <br/>
      Those skilled in the art will also recognize various operating conditions that can affect a desired cylinder charge such as, for example, engine starting conditions, cold conditions, or cranking conditions.
    </p>
    <p num="54">
      Continuing with FIG. 9, the routine continues from either step 912 or step 914 to step 916.
      <br/>
      In step 916, a cylinder charge error (mcylerr) is calculated based on desired cylinder charge and actual cylinder charge (mcylact).
      <br/>
      Next, in step 918, cam timing nominal error is calculated.
      <br/>
      Next, in step 920, intermediate cam timing is calculated from cam timing nominal error and controller H1.
      <br/>
      In a preferred embodiment, controller HI is an integral controller known to those skilled in the art.
      <br/>
      Also, in a preferred embodiment, the gains of controller H1 are determined so that the cam timing is adjusted slower than manifold dynamics.
      <br/>
      In other words, the gains of controller H1 are determined based on manifold volume, and engine speed.
      <br/>
      However, controller H1 can be any controller known to those skilled in the art such as, for example, a PID controller, a PI controller, or a P controller.
      <br/>
      Next, in step 930, intermediate throttle position is calculated from cylinder charge error and controller H2.
      <br/>
      In a preferred embodiment, controller H2 is an integral controller; however, as those skilled in the art will recognize, various controllers can be used.
      <br/>
      Next, in step 940, a difference in cam timing is calculated from cylinder charge error and controller H3.
      <br/>
      In a preferred embodiment, controller H3 is a lead controller or a high pass filter type controller.
      <br/>
      Next, the routine continues to step 950, where a difference in throttle position is calculated from the difference in cam timing using controller H4.
      <br/>
      In a preferred embodiment, controller H4 is simply a constant gain.
      <br/>
      Next, the routine continues to FIG. 5.
    </p>
    <p num="55">Air/Fuel Constraints in Lean Conditions</p>
    <p num="56">
      Referring now to FIG. 10, a routine for restricting air/fuel ratio to specific regions is described.
      <br/>
      In step 1010, a determination is made as to whether the engine is operating in stratified conditions.
      <br/>
      When the answer to step 1010 is YES, the routine continues to step 1012.
      <br/>
      In step 1012, the required fuel injection amount (fi) is calculated based on driver commands or operating conditions.
      <br/>
      Again, those skilled in the art will recognize various methods for determining a fuel injection amount based on driver command or engine operating conditions.
      <br/>
      Next, the routine continues to step 1014, where a restricted air range is calculated.
      <br/>
      The restricted air range is calculated using a maximum and minimum allowable air/fuel ratio, the fuel injection amount, and a band parameter (B).
      <br/>
      The band parameter is used to allow room for calculation inaccuracies.
      <br/>
      Next, the routine continues to step 1016, where a determination is made as to whether actual cylinder charge is between the maximum and minimum allowable cylinder charges (mcyl1, mcyl2).
      <br/>
      When the answer to step 1016 is YES, a determination is then made in step 1018 as to whether it is possible, given the current operating conditions, to produce air charge (mcyl1).
      <br/>
      This determination can be made based on factors such as, for example, engine speed and atmospheric pressure.
      <br/>
      In particular, as atmospheric pressure increases, engine 10 is able to pump a greater maximum air amount.
      <br/>
      Therefore, in a preferred embodiment, limit mcyl1 is selected when atmospheric pressure is greater than a calibrated value, and mcyl2 is selected otherwise.
      <br/>
      In other words, in step 1018, a determination is made as to whether the engine can physically produce upper air charge (mcyl1).
      <br/>
      When the answer to step 1018 is NO, the routine sets the desired cylinder charge (mcyldes) equal to lower air charge (mcyl2) in step 1020.
      <br/>
      Otherwise, the desired cylinder charge is set to upper cylinder charge (mcyl1).
    </p>
    <p num="57">
      Referring now to FIG. 11, the present invention is compared to prior art approaches in controlling engine torque or keeping an air/fuel ratio outside of a restricted air/fuel ratio range.
      <br/>
      The FIG. 11a through 11f show a comparison of the present invention as represented by solid lines, and prior approaches as represented by dashed lines.
      <br/>
      In prior approaches, as shown in FIG. 11a, fuel injection amount increases at time T6 in response to a change in desired engine torque shown in FIG. 11d. To maintain the air/fuel ratio at a desired point, as shown in FIG. 11e, increased airflow is required.
      <br/>
      To provide increased airflow, prior approaches change throttle position, as shown in FIG. 11c, at time T6.
      <br/>
      However, because of airflow dynamics due to the manifold volume, air charge does not increase fast enough, as shown in FIG. 11f. This results in a temporary excursion in the air/fuel ratio into the restricted region as shown in FIG. 11e. Thus, the prior approaches cannot keep the air/fuel ratio completely out of the restricted region.
    </p>
    <p num="58">
      According to the present invention, and as described in FIG. 10, at time T6, cam timing, as shown in FIG. 11b, is also increased.
      <br/>
      This allows the air/fuel ratio, as shown in FIG. 11e, to refrain from entering the restricted air/fuel range.
      <br/>
      This is possible since the airflow was quickly changed using both cam timing and throttle position as shown in FIG. 11f by the solid line.
    </p>
    <p num="59">Vehicle Launch Improvement</p>
    <p num="60">
      Vehicle driveability is improved according to the present invention by providing engine torque increases at a rate faster than available by prior art methods.
      <br/>
      Regarding FIG. 12, engine 10 is coupled to automatic transmission (AT) 1200 via torque converter (TC) 1210. Automatic transmission (AT) 1200 is shown coupled to drive shaft 1202, which in turn is coupled to final drive unit (FD) 1204. Final drive unit (FD) is coupled wheel 1208 via second drive shaft 1208.
      <br/>
      In this configuration, engine 10 can be somewhat downsized and still produce acceptable drive feel by controlling engine torque or airflow using both throttle position and cam timing as describe above herein.
    </p>
    <p num="61">
      Regarding FIG. 13, torque converter 1210 is removed.
      <br/>
      Thus, even without downsizing engine 10, using prior approaches driveability is reduced.
      <br/>
      In other words, vehicle launch is normally assisting from torque multiplication provided by torque converter 1210.
      <br/>
      Without torque converter 1210, vehicle launch feel is degraded.
      <br/>
      To compensate for the lack of torque converter 1210, engine 10 is controlled according to the present invention using both throttle position and cam timing to rapidly increase engine torque or airflow, thereby improving drive feel and allowing elimination of torque converter 1210.
    </p>
    <p num="62">
      In a preferred embodiment, during vehicle launch at low vehicle speed and low engine speed, both inlet control device and outlet control device 170 and 171 are coordinated to rapidly control engine cylinder charge, thereby improving drive feel.
      <br/>
      Further to enable such operating, nominal cam timing (VCTdesnom) is set to a value where a large potential increase in cylinder air charge can be achieved when the transmission is in drive and vehicle speed is below a predetermine vehicle speed indicating potential for vehicle launch.
    </p>
    <p num="63">Turbo Lag Compensation</p>
    <p num="64">
      Referring now to FIG. 14, a configuration is shown where engine 10 is coupled to a compression device 1400.
      <br/>
      In a preferred embodiment, compression device 1400 is a turbocharger.
      <br/>
      However, compression device 1400 can be any compression device such as, for example, a supercharger.
      <br/>
      Engine 10 is shown coupled to intake manifold 44b and exhaust manifold 48b.
      <br/>
      Also shown is outlet control device 171 coupled between intake manifold 44b and engine 10.
      <br/>
      Inlet control device 170 is also shown coupled between intake manifold 44b and compression device 1400.
      <br/>
      Compression device 1400 contains compressor 1410.
    </p>
    <p num="65">
      According to the present invention, it is now possible to compensate for delays related to turbo lag.
      <br/>
      In a preferred embodiment, during vehicle launch at low vehicle speed and low engine speed, both inlet control device and outlet control device 170 and 171 are coordinated to rapidly control engine cylinder charge, thereby compensating for the delayed pressure buildup from compression device 1400.
      <br/>
      However, such an approach can be used throughout various driving conditions, such as, for example, during highway cruising operation.
    </p>
    <p num="66">
      While the invention has been shown and described in its preferred embodiments, it will be clear to those skilled in the arts to which it pertains that many changes and modifications may be made thereto without departing from the scope of the invention.
      <br/>
      For example, as described above herein, any device that affects flow exiting intake manifold 44 and entering cylinder 30 can be used as an outlet control device.
      <br/>
      For example, a swirl control valve, a charge motion control valve, an intake manifold runner control valve, or an electronically controlled intake valve can be used according to the present invention to rapidly change cylinder fresh charge.
      <br/>
      Further, any device that affects flow entering intake manifold 44 can be used in place of intake control device.
      <br/>
      For example, an EGR valve, a purge control valve, or an intake air bypass valve can be used in conjunction with the outlet control device so rapidly change cylinder fresh charge.
    </p>
    <p num="67">
      Also, the invention can be applied to any situation where engine cylinder charge needs to be controlled faster than manifold dynamics would normally allow.
      <br/>
      Accordingly, it is intended that the invention be limited only by the following claims.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>We claim:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A method for controlling an engine having at least one cylinder, the engine also having an intake manifold and an outlet control device for controlling flow from the intake manifold into the cylinder and an inlet control device for controlling flow into the intake manifold, comprising:</claim-text>
      <claim-text>generating a fuel injection amount;</claim-text>
      <claim-text>and preventing an engine air/fuel ratio from entering a predetermined air/fuel ratio range by changing both the inlet control device and the outlet control device based on said fuel injection amount.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. The method recited in claim 1 wherein said preventing step further comprises: determining a restricted air amount range based on said fuel injection amount; adjusting both the inlet control device and the outlet control device to control an actual air amount outside said restricted air amount range.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. The method recited in claim 2 wherein said restricted air amount range is further based on said predetermined air/fuel range.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. The method recited in claim 3 wherein said restricted air amount range is defined by a minimum air amount and a maximum air amount.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. The method recited in claim 4 wherein said actual air amount is controlled to be higher than said maximum air amount when said maximum air amount is achievable for current engine operating conditions.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. The method recited in claim 5 wherein said actual air amount is controlled to be lower than said minimum air amount when said maximum air amount is unachievable for current engine operating conditions.</claim-text>
    </claim>
    <claim num="7">
      <claim-text>7. The method recited in claim 1 wherein said outlet control device is a variable cam timing system.</claim-text>
    </claim>
    <claim num="8">
      <claim-text>8. The method recited in claim 1 wherein said outlet control device is a variable valve timing system.</claim-text>
    </claim>
    <claim num="9">
      <claim-text>9. The method recited in claim 1 wherein said inlet control device is a throttle.</claim-text>
    </claim>
    <claim num="10">
      <claim-text>10. The method recited in claim 9 wherein said inlet control device is an exhaust gas recirculation valve.</claim-text>
    </claim>
    <claim num="11">
      <claim-text>11. The method recited in claim 9 wherein said inlet control device is a throttle.</claim-text>
    </claim>
    <claim num="12">
      <claim-text>12. A method for controlling an engine having at least one cylinder, the engine also having an intake manifold and an outlet control device for controlling flow from the intake manifold into the cylinder and an inlet control device for controlling flow into the intake manifold, comprising: generating a fuel injection amount; determining a restricted range of the flow into the cylinders based on said fuel injection amount and a restricted air/fuel ratio range;</claim-text>
      <claim-text>and adjusting both the inlet control device and the outlet control device based on said restricted air amount range.</claim-text>
    </claim>
    <claim num="13">
      <claim-text>13. The method recited in claim 12 wherein said restricted air range of the flow into the cylinders is defined by a minimum air amount and a maximum air amount.</claim-text>
    </claim>
    <claim num="14">
      <claim-text>14. The method recited in claim 13 wherein said adjusting step further comprises the steps of: adjusting both the inlet control device and the outlet control device to provide said maximum air amount when atmospheric pressure is greater than a preselected value; adjusting both the inlet control device and the outlet control device to provide said minimum air amount when atmospheric pressure is less than said preselected value.</claim-text>
    </claim>
    <claim num="15">
      <claim-text>15. An article of manufacture comprising: a computer storage medium having a computer program encoded therein for controlling an engine having at least one cylinder, the engine also having an intake manifold and an outlet control device for controlling flow from the intake manifold into the cylinder and an inlet control device for controlling flow into the intake manifold, said computer storage medium comprising: code for generating a fuel injection amount; code for determining a restricted air amount range based on said fuel injection amount;</claim-text>
      <claim-text>and code for adjusting both the inlet control device and the outlet control device based on said restricted air amount range.</claim-text>
    </claim>
    <claim num="16">
      <claim-text>16. The article recited in claim 15 further comprising code for determining said restricted air range of the flow into the cylinders based on said fuel injection amount and a restricted air/fuel ratio range.</claim-text>
    </claim>
    <claim num="17">
      <claim-text>17. The article recited in claim 16 further comprising: code for determining a desired air amount based on said restricted air amount range; code for adjusting the inlet control device and the outlet control device to affect flow in similar directions in response to said desired air amount;</claim-text>
      <claim-text>and code for adjusting the inlet control device and the outlet control device to affect flow in opposite directions in response to an outlet control device setpoint error.</claim-text>
    </claim>
    <claim num="18">
      <claim-text>18. The article recited in claim 17 wherein said desired air amount is determined by selecting a maximum air amount outside said restricted air amount range in a first predetermine operating condition range.</claim-text>
    </claim>
    <claim num="19">
      <claim-text>19. The article recited in claim 18 wherein said desired air amount is determined by selecting a minimum air amount outside said restricted air amount range in a second predetermine operating condition range.</claim-text>
    </claim>
    <claim num="20">
      <claim-text>20. The article recited in claim 19 further comprising code for determining said first predetermined operating condition range and said second predetermined operating range based on atmospheric pressure.</claim-text>
    </claim>
  </claims>
</questel-patent-document>