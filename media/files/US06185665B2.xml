<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06185665B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06185665</doc-number>
        <kind>B2</kind>
        <date>20010206</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6185665</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference family-id="12746143" extended-family-id="4635509">
      <document-id>
        <country>US</country>
        <doc-number>09030373</doc-number>
        <kind>A</kind>
        <date>19980225</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1998US-09030373</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>4825293</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>JP</country>
        <doc-number>4640197</doc-number>
        <kind>A</kind>
        <date>19970228</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1997JP-0046401</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010206</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>G06F   3/06        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>3</main-group>
        <subgroup>06</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>G06F  17/30        20060101A I20060722RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>17</main-group>
        <subgroup>30</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20060722</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="3">
        <text>G11B  20/12        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>11</class>
        <subclass>B</subclass>
        <main-group>20</main-group>
        <subgroup>12</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="4">
        <text>G11B  27/00        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>11</class>
        <subclass>B</subclass>
        <main-group>27</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="5">
        <text>G11B  27/11        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>G</section>
        <class>11</class>
        <subclass>B</subclass>
        <main-group>27</main-group>
        <subgroup>11</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>711170000</text>
        <class>711</class>
        <subclass>170000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>707999202</text>
        <class>707</class>
        <subclass>999202</subclass>
      </further-classification>
      <further-classification sequence="2">
        <text>707999205</text>
        <class>707</class>
        <subclass>999205</subclass>
      </further-classification>
      <further-classification sequence="3">
        <text>707E17005</text>
        <class>707</class>
        <subclass>E17005</subclass>
      </further-classification>
      <further-classification sequence="4">
        <text>707E17010</text>
        <class>707</class>
        <subclass>E17010</subclass>
      </further-classification>
      <further-classification sequence="5">
        <text>711112000</text>
        <class>711</class>
        <subclass>112000</subclass>
      </further-classification>
      <further-classification sequence="6">
        <text>711171000</text>
        <class>711</class>
        <subclass>171000</subclass>
      </further-classification>
      <further-classification sequence="7">
        <text>711172000</text>
        <class>711</class>
        <subclass>172000</subclass>
      </further-classification>
      <further-classification sequence="8">
        <text>G9B020015</text>
        <class>G9B</class>
        <subclass>020015</subclass>
      </further-classification>
      <further-classification sequence="9">
        <text>G9B027001</text>
        <class>G9B</class>
        <subclass>027001</subclass>
      </further-classification>
      <further-classification sequence="10">
        <text>G9B027021</text>
        <class>G9B</class>
        <subclass>027021</subclass>
      </further-classification>
    </classification-national>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06F-017/30067</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>17</main-group>
        <subgroup>30067</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130823</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06F-003/061</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>3</main-group>
        <subgroup>061</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130823</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06F-003/0643</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>3</main-group>
        <subgroup>0643</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130823</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="4">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G06F-003/0677</classification-symbol>
        <section>G</section>
        <class>06</class>
        <subclass>F</subclass>
        <main-group>3</main-group>
        <subgroup>0677</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130823</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="5">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G11B-020/12</classification-symbol>
        <section>G</section>
        <class>11</class>
        <subclass>B</subclass>
        <main-group>20</main-group>
        <subgroup>12</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130823</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="6">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G11B-027/002</classification-symbol>
        <section>G</section>
        <class>11</class>
        <subclass>B</subclass>
        <main-group>27</main-group>
        <subgroup>002</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130823</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="7">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G11B-027/11</classification-symbol>
        <section>G</section>
        <class>11</class>
        <subclass>B</subclass>
        <main-group>27</main-group>
        <subgroup>11</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130823</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="8">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G11B-2220/20</classification-symbol>
        <section>G</section>
        <class>11</class>
        <subclass>B</subclass>
        <main-group>2220</main-group>
        <subgroup>20</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130823</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="9">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>G11B-2220/41</classification-symbol>
        <section>G</section>
        <class>11</class>
        <subclass>B</subclass>
        <main-group>2220</main-group>
        <subgroup>41</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130823</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="10">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>Y10S-707/99953</classification-symbol>
        <section>Y</section>
        <class>10</class>
        <subclass>S</subclass>
        <main-group>707</main-group>
        <subgroup>99953</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130518</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="11">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>Y10S-707/99956</classification-symbol>
        <section>Y</section>
        <class>10</class>
        <subclass>S</subclass>
        <main-group>707</main-group>
        <subgroup>99956</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>A</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130518</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>32</number-of-claims>
    <exemplary-claim>32</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>24</number-of-drawing-sheets>
      <number-of-figures>27</number-of-figures>
      <image-key data-format="questel">US6185665</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">File management apparatus, file management method, and recording medium containing file management program</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>KANEDA SABURO, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4347565</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4347565</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>MCENTEE TIMOTHY J, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4797810</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4797810</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>GUENTHER ROBERT L, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5109336</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5109336</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>JOSHI ASHOK M</text>
          <document-id>
            <country>US</country>
            <doc-number>5414839</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5414839</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="5">
          <text>BLANDY GEOFFREY O, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5561785</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5561785</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="6">
          <text>SHAW VENSON M, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5754766</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5754766</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="7">
          <text>MATSUSHITA ELECTRIC IND CO LTD</text>
          <document-id>
            <country>JP</country>
            <doc-number>H04225441</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>JP04225441</doc-number>
          </document-id>
        </patcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Matsushita Electric Industrial Co., Ltd.</orgname>
            <address>
              <address-1>JP</address-1>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>PANASONIC</orgname>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Owada, Kiyoshi</name>
            <address>
              <address-1>Hirakatashi, JP</address-1>
              <city>Hirakatashi</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="2">
          <addressbook lang="en">
            <name>Miyazaki, Masaya</name>
            <address>
              <address-1>Ikedashi, JP</address-1>
              <city>Ikedashi</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <orgname>Parkhurst &amp; Wendel, L.L.P</orgname>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Cabeca, John W.</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>LAPSED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      A file management apparatus is used in an information processor using a media exchange type storage device including a plurality of storage media, at least one data access device, and a storage media exchanging means as an external storage device.
      <br/>
      The file management apparatus includes a data block management device for dividing storage regions of the respective storage media into data blocks of fixed capacity and managing the use states of the divided data blocks.
      <br/>
      A data block allocation device allocates unused data blocks shown by the data block management device to a file to which a writing request from the information processor has been given.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>FIELD OF THE INVENTION</heading>
    <p num="1">The present invention relates to a file management apparatus, a file management method, and a recording medium containing a file management program, in an information processor using a media exchange type storage device which is represented by an optical disk library, as an external storage device and, more particularly, to those by which a file that is readable in real time and with less exchange of optical disks can be created.</p>
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="2">As prior art methods of using a media exchange type storage device represented by an optical disk library as an external storage device, there have been known two methods; a method which is basically equivalent to a method of utilizing external optical disk drives and has a means for automatically mounting an optical disk (storage medium) to be accessed, in an optical disk drive (data access device) as the only feature, and a method disclosed by Japanese Published Patent Application No. Hei. 7-93110, in which a plurality of optical disks are virtually treated as a single storage device.</p>
    <p num="3">In both of the methods, a prior art data writing process to an external storage device is used for data writing to an optical disk serving as a storage medium.</p>
    <p num="4">The prior art data writing process to an external storage device is disclosed in detail by Japanese Published Patent Application No. Hei. 4-225441.</p>
    <p num="5">As methods for locating file data on a storage medium, there are a data block allocation method and a continuous region allocation method.</p>
    <p num="6">
      The data block allocation method comprises dividing a storage medium into data blocks of fixed capacity, generally, a few hundreds of bytes to a few kilobytes, and writing data to the storage medium while successively allocating unused data blocks to the data.
      <br/>
      In this data block allocation method, when data of one file are written to plural data blocks, the positional relationships between the used data blocks are not considered.
      <br/>
      In this method, storage positions of a file are generally managed as a list of data block numbers (data block addresses) assigned to respective data blocks.
    </p>
    <p num="7">Meanwhile, in the continuous region allocation method, storage positions of a file are managed according to a top address and a length of data.</p>
    <p num="8">
      In the data block allocation method, since storage regions for respective blocks are allocated even when file writing and partial erasure are repeated, the storage regions can be effectively utilized.
      <br/>
      However, data of a file must be extracted from data blocks which are disorderedly located in several parts of a storage medium, so that it takes time to read the file.
    </p>
    <p num="9">
      In the continuous region allocation method, since data of a file are located continuously, file reading can be carried out at high speed.
      <br/>
      However, when file writing and partial erasure are repeated, continuous unused storage regions enough for file storage are not found although many unused storage regions remain, so that many useless storage regions are produced.
    </p>
    <p num="10">
      Conventiornally, it has been taken for granted that the continuous region allocation method is used for an optical disk, in order to read multimedia data, such as voice data and moving picture data, at high speed and perform processing in real time.
      <br/>
      In recent years, however, even when the data block allocation method is used for an optical disk, an improvement of reading performance has made processing in real time possible.
    </p>
    <p num="11">Further, effective use of storage regions of an optical disk of mass storage has been regarded as important, and the data block allocation method has been generally used for an optical disk.</p>
    <p num="12">A description is given of a data block allocation method in a prior art information processor in which a plurality of optical disks in an optical disk library are virtually treated as a single storage device, with reference to FIGS. 1, 2, 3, 4 and 5(a) and 5(b) which show component parts common with a file management apparatus according to a first embodiment of the present invention, and FIG. 24 which shows the operation of the prior art information processor.</p>
    <p num="13">FIG. 1 is a block diagram illustrating a general construction of an information processor in which a plurality of optical disks in an optical disk library are virtually treated as a single storage device.</p>
    <p num="14">
      In FIG. 1, an information processor 1 has an optical disk library 300 as an external storage device, and includes a file management apparatus 2.
      <br/>
      The file management apparatus 2 comprises a file managment unit 100 and a disk management unit 200.
    </p>
    <p num="15">
      The file management unit 100 comprises a data block management unit 110 for managing data blocks and a data block allocation unit 120 for allocating data blocks to files.
      <br/>
      The data block management unit 110 has a data block management table 111 illustrated in FIG. 2, and the data block allocation unit 120 has a file management table 121 illustrated in FIG. 3.
    </p>
    <p num="16">
      The disk management unit 200 comprises a virtual disk management unit 210 and an optical disk library control unit 220.
      <br/>
      The virtual disk management unit 210 has a data block corresponding table 211 illustrated in FIG. 4, and the optical disk library control unit 220 has an optical disk management table 221 illustrated in FIGS. 5(a) and 5(b).
    </p>
    <p num="17">The optical disk library 300 includes optical disk drives D0 to D3 serving as data access devices, optical disks M0 to M9 serving as storage media, and an optical disk exchanging device 310 for mounting the optical disks in the optical disk drives D0 to D3 according to requests from the outside.</p>
    <p num="18">FIG. 24 is a flow chart showing the operation of the information processor for virtually treating the plurality of optical disks in the optical disk library as a single storage device.</p>
    <p num="19">A description is given of the operation of the information processor thus constructed, with reference to FIG. 24.</p>
    <p num="20">When the file management unit 100 in the file management apparatus 2 receives a writing request of a file, at step S1201, the data block management unit 110 examines whether unused data blocks are present or not, using the data block management table 111.</p>
    <p num="21">
      When no unused data blocks are present, no file can be stored.
      <br/>
      Therefore, the writing process is completed as a file writing error due to shortage of the capacity (step S1207).
    </p>
    <p num="22">
      When the unused data blocks are present, step S1202 is executed, The data block management unit 110 selects one unused data block from the data block management table 111, and updates the data block management table 111, i.e., changes the use flag of the selected data block to "used".
      <br/>
      For example, the data block with the number "2" is selected from the data block management table 111 shown in FIG. 2, and the use flag of the data block with the number "2" is changed to "used".
    </p>
    <p num="23">
      Then, at step S1203, the data block allocation unit 120 allocates the selected data block as a data storage block for the file to be written, and updates the file management table 121.
      <br/>
      For example, when the file 3 is additionally written in the file management table 121 shown in FIG. 3, the data block number "2" of the data block selected at step S1202 is added to the used data block number list of the file 3, and the used data block number list of the file 3 is changed to "4, 2".
      <br/>
      When a new file which has been not recorded in the file management table 121, for example, a file 10, is written, a new field for the file 10 is created in the file management table 121, and the used data block number list of the field is made "2".
    </p>
    <p num="24">
      Subsequently, at step S1204, the file management unit 100 instructs the disk management unit 200 to write the file data to the allocated data block.
      <br/>
      When the disk management unit 200 receives this instruction, using the data block corresponding table 211, the disk management unit 200 obtains an optical disk number of an optical disk having the data block to which the file data is to be written, and calculates a real data block number of the data block on the optical disk, by the virtual disk management unit 210.
    </p>
    <p num="25">In this case, since the data block with the number "2" is on the optical disk M0, the real data block number of the data block on the optical disk M0 is "2" (2-0=2).</p>
    <p num="26">
      Then, using the optical disk management table 221, the disk management unit 200 selects an optical disk drive used in file data writing by the optical disk library control unit 220, and instructs the optical disk library 100 to mount the optical disk for file writing in the selected optical disk drive.
      <br/>
      When the optical disk library 300 receives this instruction, the optical disk library 300 mounts the optical disk in the optical disk drive according to the instruction, by the optical disk exchanging device 310.
    </p>
    <p num="27">
      Usually, as this selection method, it is first examined whether the optical disk for file writing is mounted in any of the optical disk drives or not.
      <br/>
      When the optical disk for file writing has been mounted in the optical disk drive, that optical disk drive is selected and the optical disk is left as it is.
      <br/>
      When the optical disk for file writing is mounted in none of the optical disk drives, the disk management unit 200 finds out and selects the optical disk drive in which no other optical disk is mounted, and instructs the optical disk library 300 to mount the optical disk for file writing in the selected optical disk drive.
      <br/>
      If the disk management unit 200 does not. find out the optical disk drive in which no other optical disk is mounted, the disk management unit 200 selects the optical disk drive having the oldest command accept time, and instructs the optical disk library 300 to return the optical disk mounted in the selected optical disk drive to its storage slot and then to mount the optical disk for file writing in the slected optical disk drive.
    </p>
    <p num="28">By using such a selection method, time required for exchanging optical disks is shortened and processing time is evenly allocated to each file access.</p>
    <p num="29">Thereafter, using the selected optical disk drive in the optical disk library 300, the disk management unit 200 writes the file data to the data block with the real data block number "2" on the optical disk M0 which is mounted in the optical disk drive, by the optical disk library control unit 220.</p>
    <p num="30">Then, at step S1205, the file management unit 100 examines whether the file data to be further written remains or not.</p>
    <p num="31">When the data to be written remains, the writing process returns to step S1201, and block allocation/file writing processes are repeated until all the data is written.</p>
    <p num="32">When no data to be written remains, the file writing process is completed (step S1206).</p>
    <p num="33">As in the information processor described above, however, when a media exchange type storage device, such as an optical disk library, is utilized, access performance of an optical disk serving as a storage medium is deteriorated as compared with that of a usual hard disk, arid processing required for exchanging optical disks adversely affects the performance of the data access.</p>
    <p num="34">
      Further, in the prior are data block allocation method, selection of data blocks to be allocated to a file is not taken into consideration.
      <br/>
      Therefore, there is a case where optical disks must be exchanged many times at access to the file, in a manner that a top data of the file is stored in the first optical disk and a next data of the file is stored in the second optical disk, so that it is difficult to use the data block allocation method for file reading in real time.
    </p>
    <p num="35">Still further, when plural file writing processes are simultaneously performed to one optical disk, the files scramble for data blocks on the optical disk, whereby all the data blocks on the optical disk are used up immediately and the remaining data of the files are written to a next optical disk, resulting in an increase in exchange of optical disks Consequently, in order to write files which is readable in real time, the plural simultaneous writing processes cannot be allowed.</p>
    <p num="36">
      Still further, when a file is written to an optical disk from which another file is being read, the limit of the access performance of the optical disk deteriorates reading performance, so that reading in real time cannot be realized.
      <br/>
      Consequently, it is impossible that file reading and file writing coexist.
    </p>
    <p num="37">
      Still further, when a file is written to an optical disk which is not mounted in an optical disk drive, the optical disk for writing is mounted to an optical disk drive.
      <br/>
      At this time, there is a case where an optical disk that is being currently accessed is dismounted from an optical disk drive and the optical disk for writing is mounted therein.
      <br/>
      In this case, the access to the optical disk which has been dismounted from the optical disk drive is suspended, so that the access takes time above required.
    </p>
    <p num="38">Furthermore, the operation of remounting the optical disk in the optical disk drive after the suspended access coexists with the operation of mounting the optical disk for writing in the optical disk drive, whereby exchange of the optical disks is repeated many times, resulting in incompletion of the previous access and the writing.</p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="39">It is an object of the present invention to provide a file management apparatus, a file management method, and a recording medium containing a file management program, by which a file that is readable in real time and with less exchange of optical disks can be created.</p>
    <p num="40">Another object of the present invention is to provide a file management apparatus in which, when a file that is readable in real time is created, plural file writing processes to one optical disk can coexist.</p>
    <p num="41">Further another object of the present invention is to provide a file management apparatus in which, when a file that is readable in real time is created, file reading and file writing from/to one optical disk can coexist.</p>
    <p num="42">Further another object of the present invention is to provide a file management apparatus in which, when a file that is readable in real time is created, suspension of access which is being currently performed and exchange of optical disks due to the suspended access are prevented, whereby time required for the writing can be shortened.</p>
    <p num="43">Other objects and advantages of the present invention will become apparent from the detailed description given hereinafter; it should be understood, however, that the detailed description and specific embodiment are given by way of illustration only, since various changes and modifications within the scope of the invention will become apparent to those skilled in the art from this detailed description.</p>
    <p num="44">
      According to a first aspect of the present invention, a file management apparatus is used in an information processor using a media exchange type storage device comprising a plurality of storage media, at least one data access device for recording and reproducing data to/from the storage media, and a storage media exchanging means for mounting and dismounting the arbitrary storage medium in/from the arbitrary data access device, as an external storage device, and the file management apparatus includes a data block management means for dividing storage regions of the respective storage media into data blocks of fixed capacity and managing the use states of the divided data blocks; and d data block allocation means for allocating unused data blocks shown by the data block management means to a file to which a writing request from the information processor has been given, wherein data writing of the file to which the writing request has been given is performed to the data blocks allocated by the data block allocation means, using the storage media exchanging means and the data access device; and at the start of file writing, the storage medium having the most unused data blocks which are shown by the data block management means is selected as a medium for writing.
      <br/>
      Therefore, it is possible to create a file which is read with less exchange of storage media during the reading process.
      <br/>
      Further, even when the file size is unknown at the start of file writing, it is immediately proved that the file cannot be written to any other storage medium when a writing error occurs due to shortage of the capacity of the selected storage medium.
      <br/>
      Accordingly, the writing process of the file does not need to be retried.
    </p>
    <p num="45">
      According to a second aspect of the present invention, in the file management apparatus of the first aspect, the data block allocation means limits the data blocks allocated to the file to which the writing request has been given to a range of the data blocks on the selected storage medium.
      <br/>
      Therefore, it is possible to create a file which is read without exchanging a storage medium during the reading process.
      <br/>
      Consequently, the file is readable at a constant access speed without suspending the reading process.
    </p>
    <p num="46">
      According to a third aspect of the present invention, the file management apparatus of the first or second aspect includes a file writing detection means for detecting the start and completion of the file writing; and a media writing management means for managing the presence of writing to the respective storage media based on information from the file writing detection means and information from the data block management means, wherein when the data blocks on the storage medium to which a file is being written, shown by the media writing management means, are allocated for writing a new file by the data block allocation means, the new file writing is temporarily suspended until the previous writing to the allocated storage medium is completed.
      <br/>
      Therefore, when plural file writing processes to one storage medium coexist, data block allocation to a file is not performed until writing of another file which has been first started is completed, whereby the files do not scramble for the data blocks.
      <br/>
      Consequently, even when there is not enough capacity for writing all the files, it is possible to decrease the number of data blocks which result in being wasted because parts of the files are written to the storage medium and the storage medium becomes short of the capacity, as compared with the case where the data blocks are allocated in parallel to the plural files.
    </p>
    <p num="47">
      Also in a case of a file extending over a plurality of storage media, when plural file writing processes to one storage medium coexist, the files do not scramble for data blocks.
      <br/>
      Consequently, even when there is not enough capacity for writing all the files, it is possible to decrease the number of files which result in extending over a plurality of storage media because parts of the files are written to the first storage medium and the storage medium becomes short of the capacity, as compared with the case where the data blocks are allocated to the plural files in parallel.
    </p>
    <p num="48">
      In addition, paying attention to one file, a file which has first started a writing process is given priority in that data block allocation.
      <br/>
      Therefore, more data blocks are allocated to one file as compared with the case where the data blocks are allocated to plural files in parallel, whereby it is possible to create a file which is read with less exchange of storage media during the reading process.
    </p>
    <p num="49">
      According to a fourth aspect of the present invention, the file management apparatus of the first or second aspect includes a file writing detection means for detecting the start and completion of the file writing; and a media writing management means for managing the presence of writing to the respective storage media based on information from the file writing detection means and information from the data block management means, wherein when the data blocks on the storage medium to which a file is being written, shown by the media writing management means, are allocated for writing a new file by the data block allocation means, the new file writing is aborted and the allocation of the data blocks is nullified.
      <br/>
      Therefore, when plural file writing processes to one storage medium coexist, writing of a new file is aborted until writing of a file which has been first started is completed, whereby the files do not scramble for the data blocks.
      <br/>
      Consequently, even when there is not enough capacity for writing all the files, it is possible to decrease the number of data blocks which result in being wasted because parts of the files are written to the storage medium and the storage medium becomes short of the capacity, as compared with the case where the data blocks are allocated to the plural files in parallel.
    </p>
    <p num="50">
      Further, when the new file writing is resumed after the abortion, the number of unused data blocks on each storage medium changes due to the previous file writing.
      <br/>
      Accordingly, a storage medium having the most unused data blocks after the change is selected.
    </p>
    <p num="51">
      According to a fifth aspect of the present invention, in the file management apparatus of the first or second aspect, data reading of a file to which a reading request from the information processor has been given is performed from the data blocks on the storage medium to which the data have been written, using the storage media exchanging means and the data access device, and the file management apparatus includes a file reading detection means for detecting the start and completion of the file reading; and a media reading management means for managing the presence of reading from the respective storage media based on information from the file reading detection means and information from the data block management means, wherein when the data blocks on the storage medium from which a file is being read, shown by the media reading management means, are allocated for writing a new file by the data block allocation means, the new file writing is aborted or temporarily suspended until the reading from the allocated storage medium is completed.
      <br/>
      Therefore, the previous reading process is not impeded.
      <br/>
      Consequently, when file reading and file writing coexist, an access speed for the reading can be kept constant without being disturbed by the writing.
    </p>
    <p num="52">
      According to a sixth aspect of the present invention, in the file management apparatus of the first or second aspect, data reading of a file to which a reading request from the information processor has been given is performed from the data blocks on the storage medium to which the data have been written, using the storage media exchanging means and the data access device, and the file management apparatus includes a file access detection means for detecting the start and completion of the file writing and reading; and a data access device management means for managing the use states of the respective data access devices based on information from the file access detection means, wherein the data access device which is being used, shown by the data access device management means, is not used for writing a new file; and when the data access device management means shows that all the data access devices are being used, the new file writing is aborted or temporarily suspended until one of the data access devices becomes unused.
      <br/>
      Therefore, the previous accesses are not impeded.
      <br/>
      Consequently, when file reading and file writing coexist, a storage medium from which a file is being read is not dismounted from a data access device used for the reading and a storage medium to which d file is to be written is not mounted therein.
      <br/>
      As a result, an access speed for the reading can be kept constant without being interrupted.
    </p>
    <p num="53">
      In addition, when plural file writing processes coexist, exchange of storage media for writing files is not performed until writing processes of other files which have been first started are completed, whereby the files do not scramble for the data access devices.
      <br/>
      Accordingly, it is possible to decrease the exchange of storage media which is performed until all the files are written and to shorten time required for the writing processes.
    </p>
    <p num="54">
      According to a seventh aspect of the present invention, the file management apparatus of the first or second aspect includes a file writing detection means for detecting the start and completion of the file writing; and a media writing management means for managing the presence of writing to the respective storage media based on information from the file writing detection means and information from the data block management means, wherein at the start of file writing, from among the storage media to which no files are being written, shown by the media writing management means, the storage medium having the most unused data blocks which are shown by the data block management means is selected as a medium for writing.
      <br/>
      Therefore, when plural file writing processes coexist, a file is written to a storage medium different from a storage medium to which writing of another file that has been first started is being performed.
      <br/>
      Consequently, the files do not scramble for data blocks on one storage medium, and the files are written in parallel when the media exchange type storage device has a plurality of data access devices, whereby time required for the file writing processes can be shortened.
    </p>
    <p num="55">
      According to an eighth aspect of the present invention, in the file management apparatus of the first or second aspect, data reading of a file to which a reading request from the information processor has been given is performed from the data blocks on the storage medium to which the data have been written, using the storage media exchanging means and the data access device, and the file management apparatus includes a file reading detection means for detecting the start and completion of the file reading; and a media reading management means for managing the presence of reading from the respective storage media based on information from the file reading detection means and information from the data block management means, wherein at the start of file writing, from among the storage media from which no files are being read, shown by the media reading management means, the storage medium having the most unused data blocks which are shown by the data block management means is selected as a medium for writing.
      <br/>
      Therefore, the previous reading process is not impeded.
      <br/>
      Consequently, when file reading and file writing coexist, an access speed for the reading can be kept constant without being disturbed by the writing.
    </p>
    <p num="56">
      According to a ninth aspect of the present invention, in the file management apparatus of the third, fifth, or sixth aspect, the data block allocation means receives a file size together with the file writing request from the information processor, and allocates data blocks corresponding to the received file size to the file, before the data writing.
      <br/>
      Therefore, even when access to a storage medium to which another file data is being written is not accepted, data block allocation to a file data is preformed in parallel with the previous writing process, and the data block allocation is already completed when the file data is written, whereby the total time required for the file writing can be shortened.
    </p>
    <p num="57">
      According to a tenth aspect of the present invention, in the file management apparatus of the ninth aspect, when the temporarily suspended writing is resumed, among the files to which the data blocks are allocated by the data block allocation means, the file that is to be written to the storage medium having the allocated data blocks which has been mounted in the data access device is given priority.
      <br/>
      Therefore, even when access to a storage medium to which another file data is being written is not accepted, if there is a request that is waiting for writing to a storage medium which has been already mounted in a data access device, the writing request is first processed.
      <br/>
      Consequently, the exchange of storage media is decreased, whereby time required for the writing can be shortened.
    </p>
    <p num="58">
      According to an eleventh aspect of the present invention, the file management apparatus of the second aspect includes a virtual disk management means for managing sets of media numbers for identifying the storage media and data block numbers for identifying the data blocks on the respective storage media, and the corresponding virtual data block numbers for identifying the data blocks on all the storage media, converting, for a writing request to the data block specified by the virtual data block number, the virtual data block number of the requested data block into the corresponding media number and data block number, and performing writing to the data block with the obtained data block number on the storage medium with the obtained media number, using the storage media exchanging means and the data access device, wherein the data block is specified by the virtual data block number in the data block management means and the data block allocation means; writing to the data block allocated by the data block allocation means is performed by the virtual disk management means; and available capacities of the respective storage media are externally displayed based on information from the data block management means and the virtual disk management means.
      <br/>
      Therefore, even in such a case, the unused quantity or the used quantity of the data blocks on each storage medium is known to the user.
      <br/>
      Consequently, when a file cannot extend over a plurality of storage media, the user can further know the largest file size which can be written.
    </p>
    <p num="59">
      According to a twelfth aspect of the present invention, the file management apparatus of the second aspect includes a virtual disk management means for managing sets of media numbers for identifying the storage media and data block numbers for identifying the data blocks on the respective storage media, and the corresponding virtual data block numbers for identifying the data blocks on all the storage media, converting, for a writing request to the data block specified by the virtual data block number, the virtual data block number of the requested data block into the corresponding media number and data block number, and performing writing to the data block with the obtained data block number on the storage medium with the obtained media number, using the storage media exchanging means and the data access device, wherein the data block is specified by the virtual data block number in the data block management means and the data block allocation means; writing to the data block allocated by the data block allocation means is performed by the virtual disk management means; and when an input specifying the storage medium for writing is given from the outside at the file writing, the specified storage medium is selected as a medium for writing, in place of the storage medium having the most unused data blocks.
      <br/>
      Therefore, in such a case, a storage medium for writing a file is specified by the user, whereby the user can select a storage medium for writing a file according to the frequency of access to the file and the storage capacity required for writing the file.
    </p>
    <p num="60">
      According to a thirteenth aspect of the present invention, a file management method is used in an information processor using a media exchange type storage device comprising a plurality of storage media, at least one data access device for recording and reproducing data to/from the storage media, and a storage media exchanging means for mounting and dismounting the arbitrary storage medium in/from the arbitrary data access device, as an external storage device, and the file management method includes a data block management process for dividing storage regions of the respective storage media into data blocks of fixed capacity and managing the use states of the divided data blocks; and a data block allocation process for allocating unused data blocks shown by the data block management process to a file to which a writing request from the information processor has been given, wherein data writing of the file to which the writing request has been given is performed to the data blocks allocated by the data block allocation process, using the storage media exchanging means and the data access device; and at the start of file writing, the storage medium having the most unused data blocks which are shown by the data block management process is selected as a disk to be written.
      <br/>
      Therefore, it is possible to create a file which is read with less exchange of storage media during the reading process.
      <br/>
      Further, even when the file size is unknown at the start of file writing, it is immediately proved that the file cannot be written to any other storage medium when a writing error occurs due to shortage of the capacity of the selected storage medium.
      <br/>
      Accordingly, the writing process of the file does not need to be retried.
    </p>
    <p num="61">
      According to a fourteenth aspect of the present invention, in the file management method of the thirteenth aspect, the data block allocation process limits the data blocks allocated to the file to which the writing request has been given to a range of the data blocks on the selected storage medium.
      <br/>
      Therefore, it is possible to create a file which is read without exchanging a storage medium during the reading process.
      <br/>
      Consequently, the file is readable at a constant access speed without suspending the reading process.
    </p>
    <p num="62">
      According to a fifteenth aspect of the present invention, in a recording medium containing a program for performing file management by a computer, which medium is readable by the computer, in an information processor using a media exchange type storage device comprising a plurality of storage media, at least one data access device for recording and reproducing data to/from the storage media, and a storage media exchanging means for mounting and dismounting the arbitrary storage medium in/from the arbitrary data access device, as an external storage device, file management processes in the program include a data block management process for dividing storage regions of the respective storage media into data blocks of fixed capacity and managing the use states of the divided data blocks, and a data block allocation process for allocating unused data blocks shown by the data block management process to a file to which a writing request from the information processor has been given; data writing of the file to which the writing request has been given is performed to the data blocks allocated by the data block allocation process, using the storage media exchanging means and the data access device; and at the start of file writing, the storage medium having the most unused data blocks which are shown by the data block management process is selected as a disk to be written.
      <br/>
      Therefore, it is possible to create a file which is read with less exchange of storage media during the reading process.
      <br/>
      Further, even when the file size is unknown at the start of file writing, it is immediately proved that the file cannot be written to any other storage medium when a writing error occurs due to shortage of the capacity of the selected storage medium.
      <br/>
      Accordingly, the writing process of the file does not need to be retried.
    </p>
    <p num="63">
      According to a sixteenth aspect of the present invention, in the recording medium of the fifteenth aspect containing the program including the file management processes, the data block allocation process limits the data blocks allocated to the file to which the writing request has been given to a range of the data blocks on the selected storage medium.
      <br/>
      Therefore, it is possible to create a file which is read without exchanging a storage medium during the reading process.
      <br/>
      Consequently, the file is readable at a constant access speed without.
      <br/>
      Suspending the reading process.
    </p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="64">
      FIG. 1 is a block diagram illustrating a general construction of a file management apparatus in accordance with a first embodiment of the present invention.
      <br/>
      FIG. 2 is a schematic diagram illustrating a data block management table in the file management apparatus according to the first embodiment of the invention.
      <br/>
      FIG. 3 is a schematic diagram illustrating a file management table in the file management apparatus according to the first embodiment of the invention.
      <br/>
      FIG. 4 is a schematic diagram illustrating a data block management table in the file management apparatus according to the first embodiment of the invention.
      <br/>
      FIGS. 5(a) and 5(b) are schematic diagrams illustrating an optical disk management table by disk and an optical disk management table by drive, in the file management apparatus according to the first embodiment of the invention.
      <br/>
      FIG. 6 is a flow chart showing the operation of the file management apparatus according to the first embodiment of the invention.
      <br/>
      FIG. 7 is a block diagram illustrating a general construction of a file management apparatus in accordance with a third embodiment of the present invention.
      <br/>
      FIG. 8 is a schematic diagram illustrating a disk access management table in the file management apparatus according to the third embodiment of the invention.
      <br/>
      FIG. 9 is a flow chart showing the operation of the file management apparatus according to the third embodiment the invention.
      <br/>
      FIG. 10 is a flow chart showing the operation of a file management apparatus in accordance with a fourth embodiment of the present invention.
      <br/>
      FIG. 11 is a flow chart showing the operation of a file management apparatus in accordance with a fifth embodiment of the present invention.
      <br/>
      FIG. 12 is a block diagram illustrating a general construction of a file management apparatus in accordance with a sixth embodiment of the present invention.
      <br/>
      FIG. 13 is a schematic diagram illustrating a drive access management table in the file management apparatus according to the sixth embodiment of the invention.
      <br/>
      FIG. 14 is a flow chart showing the operation of the file management apparatus according to the sixth embodiment of the invention.
      <br/>
      FIG. 15 is a flow chart showing the operation of a file management apparatus in accordance with a seventh embodiment of the present invention.
      <br/>
      FIG. 16 is a flow chart showing the operation of a file management apparatus in accordance with an eighth embodiment of the present invention.
      <br/>
      FIG. 17 is a block diagram illustrating a general construction of a file management apparatus in accordance with a ninth embodiment of the present invention.
      <br/>
      FIG. 18 is a schematic diagram illustrating a disk access management table in the file management apparatus according to the ninth embodiment of the invention.
      <br/>
      FIG. 19 is a flow chart showing the data block allocation operation of the file management apparatus according to the ninth embodiment of the invention.
      <br/>
      FIG. 20 is a flow chart showing the file data writing operation of the file management apparatus according to the ninth embodiment of the invention.
      <br/>
      FIG. 21 is a schematic diagram illustrating a drive access management table in a file management apparatus in accordance with a tenth embodiment of the present invention.
      <br/>
      FIG. 22 is a flow chart showing the file data writing operation of the file management apparatus according to the tenth embodiment of the invention.
      <br/>
      FIG. 23 is a flow chart showing the operation of a file management apparatus in accordance with a twelfth embodiment of the present invention.
      <br/>
      FIG. 24 is a flow chart showing the operation of a prior art information processor.
      <br/>
      FIG. 25 is a schematic diagram illustrating a disk access management table in the file management apparatus according to the eighth embodiment of the invention.
      <br/>
      FIG. 26 is a block diagram illustrating a general construction of a file management apparatus according to the twelfth embodiment of the invention.
    </p>
    <heading>DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
    <p num="65">Embodiment 1.</p>
    <p num="66">
      FIG. 1 is a block diagram illustrating a general construction of a file management apparatus according to a first embodiment of the present invention.
      <br/>
      In FIG. 1, an information processor 1 has an optical disk library (media exchange type storage device) 300 as an external storage device, and includes a file management apparatus 2.
    </p>
    <p num="67">
      The optical disk library 300 includes optical disk drives D0 to D3 serving as data access devices, optical disks M0 to M9 serving as storage media, and an optical disk exchanging device (storage media exchanging means) 310 for mounting the optical disks in the optical disk drives D0 to D3 according to requests from the outside.
      <br/>
      In the first embodiment of the invention, the optical disk library having four optical disk drives and ten optical disks is used as an example.
    </p>
    <p num="68">
      The file management apparatus 2 comprises a file management unit 100 and a disk management unit 200.
      <br/>
      The file management unit 100 comprises a data block management unit 110 for managing data blocks and a data block allocation unit 120 for allocating data blocks to files.
      <br/>
      The disk management unit 200 comprises a virtual disk management unit 210 and an optical disk library control unit 220.
    </p>
    <p num="69">
      The data block management unit 110 has a data block management table 111.
      <br/>
      Storage regions of the optical disks M0 to M9 in the optical disk library 300 are divided into data blocks of prescribed fixed capacity, and the data block management unit 110 manages the use states of the divided data blocks using the data block management table 111.
      <br/>
      In file writing, the data block management unit 110 selects a storage medium having the most unused data blocks, and successively selects one from among the unused data blocks on the selected storage medium.
    </p>
    <p num="70">
      The data block allocation unit 120 has a file management table 121.
      <br/>
      Using the file managment table 121, the data block allocation unit 120 allocates an unused data block selected by the data block management unit 110 to a file to which a writing request has been given from another block (not shown) in the information processor 1.
    </p>
    <p num="71">
      The virtual disk management unit 210 has a data block corresponding table 211.
      <br/>
      Using the data block corresponding table 211, the virtual disk management unit 210 manages optical disk numbers, i.e., media numbers, M0 to M9, real data block numbers, i.e., data block numbers for identifying data blocks on the respective optical disks M0 to M9, and data block numbers, i.e., virtual data block numbers for identifying data blocks on all the optical disks M0 to M9, which optical. disk numbers, real data block numbers, and virtual data block numbers correspond to one another.
      <br/>
      For a writing/reading request to a data block specified by a data block number, the virtual disk management unit 210 converts the data block number of the requested data block into corresponding optical disk number and real data block number.
      <br/>
      Accordingly, the plurality of optical disks M0 to M9 are virtually treated as a single storage device.
    </p>
    <p num="72">
      The optical disk library control unit 220 has an optical disk management table 221.
      <br/>
      Using the optical disk management table 221, the optical disk exchanging device 310, and the optical disk drives D0 to D3, the optical disk library control unit 220 performs writing of a file to which a used data block has been allocated by the data block allocation unit 120 or reading of a file to which a reading request has been given from another block in the information processor 1 via the file management unit 100, to a data block specified by a real data block number and an optical disk number which have been converted by the virtual disk management unit 210.
    </p>
    <p num="73">
      In addition, the file management apparatus 2 comprises a computer.
      <br/>
      The file management unit 100, the data block management unit 110, the data block allocation unit 120, the disk management unit 200, the virtual disk management unit 210, and the optical disk library control unit 220 are realized by CPU of the computer.
      <br/>
      The data block management table 111, the file management table 121, the data block corresponding table 211, and the optical disk management table, 221 are realized by a main memory of the computer.
    </p>
    <p num="74">
      FIG. 2 is a schematic diagram illustrating the data block management table 111 which is supposed on the memory and used in the data block management unit 110.
      <br/>
      In the data block management table 111 shown in FIG. 2, a data block number of each data block corresponds to a use flag indicating whether the data block is used or not.
    </p>
    <p num="75">
      FIG. 3 is a schematic diagram illustrating the file management table 121 which is supposed on the memory and used in the data block allocation unit 120.
      <br/>
      In the file management table 121 shown in FIG. 3, a file name of each file corresponds to all data block numbers allocated to the file, i.e., a used data block number list.
    </p>
    <p num="76">
      FIG. 4 is a schematic diagram illustrating the data block management table 211 which is supposed on the memory and used in the virtual disk management unit 210.
      <br/>
      In the data block management table 211 shown in FIG. 4, an optical disk number of each optical disk, data block numbers of data blocks on the optical disk, and real data block numbers on the optical disk, i.e., a calculating expression of the real data block number, correspond to one another.
    </p>
    <p num="77">
      FIGS. 5(a) and 5(b) are schematic diagrams illustrating the optical disk management table 221 which is supposed on the memory and used in the optical disk library control unit 220.
      <br/>
      FIG. 5(a) shows the optical disk management table 221a by disk, and FIG. 5(b) shows the optical disk management table 221b by drive.
      <br/>
      In the optical disk management table 221a shown in FIG.(a), an optical disk number of each optical disk corresponds to a number of an optical disk drive in which the optical disk is currently mounted, or a number of a storage slot in which the optical disk is currently stored.
      <br/>
      In the optical disk management table 221b shown in FIG. 5(b), a number of each optical disk drive, an optical disk number of an optical disk which is currently mounted in the optical disk drive, and command accept time of the optical disk drive correspond to one another.
    </p>
    <p num="78">FIG. 6 is a flow chart showing the operation of the file management apparatus according to the first embodiment of the invention.</p>
    <p num="79">A description is given of the operation of the file management apparatus thus constructed, with reference to FIGS. 1 to 6.</p>
    <p num="80">
      In this case, the data block management table 111, the file management table 121, the data block corresponding table 211, and the optical disk management table 221 are currently in the states shown in FIGS. 2, 3, 4, and 5(a) and 5(b), respectively.
      <br/>
      It is supposed that the unused data blocks shown by the data block management table 111 in FIG. 2 are most in the optical disk M0, and a writing request is given to the file 3 shown by the file management table 121 in FIG. 3.
    </p>
    <p num="81">
      When writing of a file is requested, the file management unit 100 receives the writing request of the file.
      <br/>
      At step S101, using information of the data block management table 111, and relationships between the data block numbers and the optical disk numbers which have been previously obtained from the data block corresponding table 211 in the virtual disk management unit 210, the data block management unit 110 selects an optical disk having the most unused data blocks.
      <br/>
      In this case, since the unused data blocks on the optical disk M0 are most, the optical disk M0 is selected.
    </p>
    <p num="82">Next, at step S102, the data block management unit 110 examines whether unused data blocks are present or not in a range of the numbers (0 to 999) of the data blocks on the selected optical disk M0, using the data block management table 111.</p>
    <p num="83">
      When no unused data blocks are present, no file can be stored.
      <br/>
      Therefore, the writing process is completed as a file writing error due to shortage of the capacity (step S108). when the unused data blocks are present, step S103 is executed.
      <br/>
      The data block management unit 110 selects one from among the unused data blocks in a range of the numbers (0 to 999) of the data blocks on the optical disk M0, and updates the data block management table 111, i.e., changes the use flag of the selected unused data block to "used".
      <br/>
      In this case, for example, the data block with the number "2" is selected from the data block management table 111 shown in FIG. 2, and the use flag of the data block with the number "2" is changed to "used".
    </p>
    <p num="84">
      Then, at step S104, the data block allocation unit 120 allocates the selected data block as a data storage block for the file to be written, and updates the file management table 121.
      <br/>
      In this case, the file 3 is additionally written.
      <br/>
      In the file management table 121 shown in FIG. 3, the data block number "2" of the data block selected at step S103 is added to the used data block number list of the file 3, and the used data block number list of the file 3 is changed to "4, 2".
      <br/>
      When a new file which has been not recorded in the file management table 121, for example, a file 10, is written, a new field for the file 10 is created in the file management table 121, and a used data block number list of the field is made "2".
    </p>
    <p num="85">
      Subsequently, at step S105, the file management unit 100 instructs the disk management unit 200 to write the file data to the allocated data block.
      <br/>
      When the disk management unit 200 receives this instruction, using the data block corresponding table 211, the disk management unit 200 obtains the optical disk number of the optical disk having the data block to which the file data is to be written, and calculates a real data block number of the data block on the optical disk, by the virtual disk management unit 210.
    </p>
    <p num="86">In this case, since the data block with the number "2" is on the optical disk M0, the real data block number of the data block on the optical disk is "2" (2-0=2).</p>
    <p num="87">
      Then, using the optical disk management table 221, the disk management unit 200 selects an optical disk drive used in file data writing by the optical disk library control unit 220, and instructs the optical disk library 300 to mount the optical disk for file writing in the selected optical disk drive.
      <br/>
      When the optical disk library 300 receives this instruction, the optical disk library 300 mounts the optical disk in the optical disk drive according to the instruction, by the optical disk exchanging device 310.
    </p>
    <p num="88">
      At this time, the disk management unit 200 first examines whether the optical disk for file writing is mounted in any of the optical disk drives or not.
      <br/>
      When the optical disk for file writing has been mounted in the optical disk drive, that optical disk drive is selected and the optical disk is left as it is.
      <br/>
      When the optical disk for file writing is mounted in none of the optical disk drives, the disk management unit 200 finds out and selects the optical disk drive in which no other optical disk is mounted, and instructs the optical disk library 300 to mount the optical disk for file writing in the selected optical disk drive.
      <br/>
      If the disk management unit 200 does not find out the optical disk drive in which no other optical disk is mounted, the disk management unit 200 selects the optical disk drive Slaving the oldest command accept time, and instructs the optical disk library 300 to return the optical disk mounted in the selected optical disk drive to its storage slot and then to mount the optical disk for file writing in the selected optical disk drive.
    </p>
    <p num="89">
      In this case, in the optical disk management tables 221a and 221b shown in FIGS. 5(a) and 5(b), the optical disk M0 is stored in the storage slot 0, and the optical disk drives D2 and D3 in which no other optical disks are mounted are present.
      <br/>
      For example, the optical disk drive D2 is selected and the optical disk M0 is mounted in the optical disk drive D2.
    </p>
    <p num="90">Thereafter, using the optical disk drive D2, the disk management unit 200 writes the data of the file 3 to the data block with the real data block number "2" on the optical disk M0 which is mounted in the optical disk drive D2, by the optical disk library control unit 220.</p>
    <p num="91">Then, at step S106, the file management unit 100 examines whether the data of the file 3 to be further written remains or not.</p>
    <p num="92">When the data to be written remains, the writing process returns to step S102, and block allocation/file writing processes at steps S102 to S106 are repeated until all the data is written.</p>
    <p num="93">When no data to be written remains, the writing process of the file 3 is completed (S107).</p>
    <p num="94">
      As described above, in the first embodiment of the invention, an optical disk having the most unused data blocks is selected at the start of file writing, whereby data blocks to be allocated to the file are limited to a range of the data blocks on the selected optical disk.
      <br/>
      Therefore, it is possible to create a file which is read without exchanging an optical disk during the reading process.
      <br/>
      Consequently, the file is readable at a constant access speed without suspending the reading process.
    </p>
    <p num="95">
      Further, since the optical disk having the most unused data blocks is selected, even when the file size is unknown at the start of file writing, it is immediately proved that the file cannot be written to any other optical disk when a writing error occurs due to shortage of the capacity of the selected optical disk.
      <br/>
      Accordingly, the writing process of the file does not need to be retried.
    </p>
    <p num="96">Embodiment 2.</p>
    <p num="97">A second embodiment of the present invention is different from the first embodiment in that a file can extend over a plurality of optical disks.</p>
    <p num="98">A general construction of a file management apparatus according to the second embodiment is the same as in the first embodiment, except That the data block management unit 110 is constructed so as to perform the following operation.</p>
    <p num="99">
      More specifically, in the second embodiment of the invention, as shown in FIG. 6, step S101 is executed and steps S102 to S106 are repeated as in the first embodiment.
      <br/>
      Thereafter, when the unused data blocks on the selected optical disk are used up, the data block management unit 110 again selects another optical disk at step S101.
      <br/>
      Then, the remaining data of the file is written to the second-selected optical disk, whereby the file extending over the plurality of optical disks is created.
    </p>
    <p num="100">
      By using such a construction, the file data is written to the first-selected optical disk as much as possible, and the remaining data is written to the second-selected optical disk.
      <br/>
      Therefore, it is possible to create a file which is read with less exchange of optical disks during the reading process.
    </p>
    <p num="101">
      Further, since the optical disk having the most unused data blocks is selected, even when the file size is unknown at the start of file writing, it is immediately proved that the file cannot be written to any other optical disk when a writing error occurs due to shortage of the capacity of the selected optical disk.
      <br/>
      Accordingly, the writing process of the file does not need to be retried.
    </p>
    <p num="102">Embodiment 3.</p>
    <p num="103">
      FIG. 7 is a block diagram illustrating a general construction of a file management apparatus according to a third embodiment of the present invention.
      <br/>
      In FIG. 7, the same reference numerals as those in FIG. 1 designate the same or corresponding parts.
      <br/>
      The third embodiment of the present invention is different from the first embodiment in that the file management unit 100 has a file access management unit (a file writing detection means and a media writing management means) 130 for detecting file writing and managing the writing states of storage media, in addition to the data block management unit 110 and the data block allocation unit 120.
    </p>
    <p num="104">The file access management unit 130 has a disk access management table 131, and detects the start and completion of file writing and manages the presence of writing to the optical disks M0 to M9 in the optical disk library 300, using the disk access management table 131 based on information from the data block management unit 110.</p>
    <p num="105">
      FIG. 8 is a schematic diagram illustrating the disk access management table 131 which is supposed on the memory and used in the file access management unit 130.
      <br/>
      In the disk access management table 131 shown in FIG. 8, an optical disk number of each optical disk corresponds to the access state of the optical disk.
    </p>
    <p num="106">FIG. 9 is a flow chart showing the operation of the file management apparatus according to the third embodiment of the invention.</p>
    <p num="107">A description is given of the operation of the file management apparatus thus constructed, with reference to FIGS. 2 to 9.</p>
    <p num="108">
      In this case, the data block management table 111, the file management table 121, the data block corresponding table 211, and the optical disk management table 221 are currently in the states different from those in the first embodiment, respectively.
      <br/>
      It is supposed that the unused data blocks shown by the data block management table 111 in FIG. 2 are most in the optical disk M0, and the disk access management table 131 is currently in the state shown in FIG. 8.
    </p>
    <p num="109">
      When writing of a file is requested, the file management unit 100 receives the writing request of the file.
      <br/>
      At step S201, as in the first embodiment, the data block management unit 110 selects an optical disk having the most unused data blocks.
      <br/>
      In this case, the optical disk M0 is selected.
    </p>
    <p num="110">Next, at step 202, the file access management unit 130 examines the access state of the selected optical disk using the disk access management table 131.</p>
    <p num="111">
      If another file is being written to tho selected optical disk, the later writing process is suspended and step S202 is repeated.
      <br/>
      After writing another file, the next step is executed.
    </p>
    <p num="112">
      In this case, since no file is being written to the selected optical disk M0, the writing processes proceeds to step S203.
      <br/>
      The file access management unit 130 updates the disk access management table 131, i.e., changes the access state of the optical disk M0 to "writing".
    </p>
    <p num="113">Then, at step S204, as in the first embodiment, the data block management unit 110 examines whether unused data blocks are present or not in a range of the numbers (0 to 999) of the data blocks on the selected optical disk M0, using the data block management table 111.</p>
    <p num="114">
      When no unused data blocks are present, step S211 is executed.
      <br/>
      The file access management unit 130 changes the access state of the optical disk M0 in the disk access management table 131 to "no access".
      <br/>
      Thereafter, the writing process is completed as a file writing error due to shortage of the capacity (step S212).
    </p>
    <p num="115">
      In this case, the unused data blocks are present.
      <br/>
      Therefore, similar to the file data writing process from step S102 to step S106 described in the first embodiment, a file data writing process from step S204 to step S208 is repeated.
      <br/>
      When no file data to be written remains at step S208, the writing process proceeds to step S209.
    </p>
    <p num="116">At step S209, the file access management unit 130 changes the access state of the optical disk M0 in the disk access management table 131 to "no access", thereby completing the file writing process (step S210).</p>
    <p num="117">
      In the above description, a file cannot extend over a plurality of optical disks.
      <br/>
      In FIG. 9, however, when the unused data blocks on the selected optical disk are used up at step S204, after the access state of the selected optical disk is changed to "no access" at step S211, another optical disk is selected again at step S201, whereby a file extending over a plurality of optical disks can be created.
    </p>
    <p num="118">
      As described above, in the third embodiment of the invention, the file management unit 100 has the file access management unit 130 for managing the access states of the respective optical disks, and writing of a file is temporarily suspended when another file is being written to an optical disk to which the file is to be written.
      <br/>
      Therefore, when plural file writing processes to one optical disk coexist, data block allocation to a file is not performed until writing of another file which has been first started is completed, whereby the files do not scramble for the data blocks.
      <br/>
      Consequently, even when there is not enough capacity for writing all the files, it is possible to decrease the number of data blocks which result in being wasted because parts of the files are written to the optical disk and the optical disk becomes short of the capacity, as compared with the case where the data blocks are allocated in parallel to the plural files.
    </p>
    <p num="119">
      Also in a case of a file extending over a plurality of optical disks, when plural file writing processes to one optical disk coexist, the files do not scramble for data blocks as described above.
      <br/>
      Consequently, even when there is not enough capacity for writing all the files, it is possible to decrease the number of files which result in extending over a plurality of optical disks because parts of the files are written to the first optical disk and the optical disk becomes short of the capacity, as compared with the case where the data blocks are allocated to the plural files in parallel.
    </p>
    <p num="120">
      In addition, paying attention to one file, a file which has first started a writing process is given priority in that data block allocation.
      <br/>
      Therefore, more data blocks are allocated to one file as compared with the case where the data blocks are allocated to plural file. in parallel, whereby it is possible to create a file which is read with less exchange of optical disks during the reading process.
    </p>
    <p num="121">Embodiment 4.</p>
    <p num="122">
      A general construction of a file management apparatus according to a fourth embodiment of the present invention is shown in FIG. 7.
      <br/>
      The fourth embodiment of the invention is different from the third embodiment in that the file access management unit 130 is constructed so that when data blocks on an optical disk to which a file is being written, shown in the disk access management table 131, are allocated for writing a new file by the data block allocation unit 120, the new file writing is aborted.
    </p>
    <p num="123">FIG. 10 is a flow chart showing the operation of the file management apparatus according to the fourth embodiment of the invention.</p>
    <p num="124">A description is given of the operation of the file management apparatus thus constructed, with reference to FIG. 10.</p>
    <p num="125">In the fourth embodiment of the invention, except the case where a file is being written to the selected optical disk at step S302 shown in FIG. 10, all the other processes are identical to those in the third embodiment, and no description is given thereof.</p>
    <p num="126">At step S302, when a file is being written to the selected optical disk, the file access management unit 130 aborts new file writing (step S311).</p>
    <p num="127">
      In the above description, a file cannot extend over a plurality of optical disks.
      <br/>
      As in the third embodiment, however, a file extending over a plurality of optical disks can be created.
    </p>
    <p num="128">
      As described above, in the fourth embodiment of the invention, the file management unit 100 has the file access management unit 130 for managing the writing states of the respective optical disks, and writing of a new file is aborted when a file is being written to an optical disk to which the new file is to be written.
      <br/>
      Therefore, when plural file writing processes to one optical disk coexist, writing of a new file is aborted until writing of a file which has been first started is completed, whereby the files do not scramble for the data blocks.
      <br/>
      Consequently, even when there is not enough capacity for writing all the files, it is possible to decrease the number of data blocks which result in being wasted because parts of the files are written to the optical disk and the optical disk becomes short of the capacity, as compared with the case where the data blocks are allocated to the plural files in parallel.
    </p>
    <p num="129">
      Further, when the new file writing is resumed after the abortion, the number of unused data blocks on each optical disk changes due to the previous file writing.
      <br/>
      Accordingly, an optical disk having the unused data blocks after the change is selected.
    </p>
    <p num="130">As a result, the effects obtained in the first embodiment are also obtained when the plural file writing processes to one optical disk coexist.</p>
    <p num="131">
      In addition, in the fourth embodiment of the invention, when a file is being written to the selected optical disk at step S302 shown in FIG. 10, the new file writing is aborted.
      <br/>
      In this case, however, the writing process returns to step S301, and another optical disk may be selected again.
    </p>
    <p num="132">Embodiment 5.</p>
    <p num="133">
      A general construction of a file management apparatus according to a fifth embodiment of the present invention is shown in FIG. 7.
      <br/>
      The fifth embodiment of the invention is different from the third embodiment in that the disk access management table 131 shows the reading states as the access states, and the file access management unit (a file reading detection means and a media reading management means) 130 detects the start and completion of file reading, manages the presence of writing to the optical disks M0 to M9 in the optical disk library 300, using the disk access management table 131 based on information from the data block management unit 110, and is constructed so that when data blocks on an optical disk from which a file is being read, shown in the disk access management table 131, are allocated to a new file to be written by the data block allocation unit 120, the new file writing is temporarily suspended.
    </p>
    <p num="134">FIG. 11 is a flow chart showing the operation of the file management apparatus according to the fifth embodiment of the invention.</p>
    <p num="135">A description is given of the operation of the file management apparatus thus constructed, with reference to FIG. 11.</p>
    <p num="136">In the fifth embodiment of the invention, except a process at step S405 shown in FIG. 11, all the other processes are identical to those in the first embodiment, and no description is given thereof.</p>
    <p num="137">At step S405, the file access management unit 130 examines the access state of the selected optical disk to which the new file is to be written using the disk access management table 131.</p>
    <p num="138">
      When a file is being read from the selected optical disk, the writing process is suspended and step S405 is repeated until the file is read.
      <br/>
      When no file is being read from the selected optical disk, the writing process proceeds to step S406 and the following processes are performed.
    </p>
    <p num="139">
      In the above description, a file cannot extend over a plurality of optical disks.
      <br/>
      In FIG. 11, however, when the unused data blocks on the selected optical disk are used up at step S402, another optical disk is selected again at step S401, whereby a file extending over a plurality of optical disks can be created.
    </p>
    <p num="140">
      As described above, in the fifth embodiment of the invention, the file management unit 100 has the file access management unit 130 for managing the reading states of the respective optical disks, and writing of a new file is temporarily suspended when a file is being read from an optical disk to which the new file is to be written, whereby the previous reading process is not impeded.
      <br/>
      Therefore, when file reading and file writing coexist, an access speed for the reading can be kept constant without being disturbed by the writing.
    </p>
    <p num="141">Embodiment 6.</p>
    <p num="142">
      FIG. 12 is a block diagram illustrating a general construction of a file management apparatus according to a sixth embodiment of the present invention.
      <br/>
      In FIG. 12, the same reference numerals as those in FIG. 1 designate the same or corresponding parts.
      <br/>
      The sixth embodiment of the present invention is different from the first embodiment in that the file management unit 100 has a file access management unit (a file access detection means and a data access device management means) 130 for detecting file access and managing data access devices, in addition to the data block management unit 110 and the data block allocation unit 120.
    </p>
    <p num="143">The file access management unit 130 has a drive access management table 132, and detects the start and completion of file access and controls file writing according to the use states of the optical disk drives, using the drive access management table 132.</p>
    <p num="144">
      FIG. 13 is a schematic diagram illustrating the drive access management table 132 which is supposed on the memory and used in the file access management unit 130.
      <br/>
      In the drive access management table 132 shown in FIG. 13, a drive number of each optical disk drive corresponds to the use state of the optical disk drive.
    </p>
    <p num="145">FIG. 14 is a flow chart showing the operation of the file management apparatus according to the sixth embodiment of the invention.</p>
    <p num="146">A description is given of the operation of the file management apparatus thus constructed, with reference to FIGS. 2 to 5(a) and 5(b), 13 and 14.</p>
    <p num="147">In this case, the drive access management table 132 is currently in the state shown in FIG. 13, and the other management tables in the file management apparatus are the same as in the first embodiment.</p>
    <p num="148">
      When writing of a file is requested, the file management unit 100 receives the writing request of the file.
      <br/>
      At step S501, as in the first embodiment, the data block management unit 110 selects the optical disk M0 having the most unused data blocks.
    </p>
    <p num="149">Next, at step 502, the file access management unit 130 examines the presence of unused optical disk drives using the drive access management table 132.</p>
    <p num="150">If all the optical disk drives are used, step S502 is repeated until one of the optical disk drives becomes unused.</p>
    <p num="151">
      In this case, since the unused optical disk drives D2 and D3 are present, the writing process proceeds to step S503 and one of the unused optical disk drives is selected.
      <br/>
      The method described in the first embodiment may be used as a selection method when a plurality of unused optical disk drives are present.
      <br/>
      In this case, for example, the optical disk drive D2 is selected.
    </p>
    <p num="152">Subsequently, at step S504, the file access management unit 130 updates the drive access management table 132, i.e., changes the access state of the selected optical disk drive D2 to "used".</p>
    <p num="153">
      Then, at step S505, the file management unit 100 instructs the optical disk exchanging device 310 in the optical disk library 300 to mount the selected optical disk M0 in the selected optical disk drive D2, via the optical disk library control unit 220 in the disk management unit 200.
      <br/>
      The optical disk exchanging device 310 performs mounting according to this instruction.
    </p>
    <p num="154">Then, at step S506, as in the first embodiment, the data block management unit 110 examines whether unused data blocks are present or not in a range of the numbers (0 to 999) of the data blocks on the selected optical disk M0, using the data block management table 111.</p>
    <p num="155">
      If no unused data blocks are present, step S513 is executed.
      <br/>
      The file access management unit 130 changes the access state of the optical disk drive D2 in the drive access management table 132 to "unused".
      <br/>
      Thereafter, the writing process is completed as a file writing error due to shortage of the capacity (step S514).
    </p>
    <p num="156">
      In this case, since the unused data blocks are present, similar to the file data writing process from step S102 to step S106 described in the first embodiment, a file data writing process from step S506 to step S510 is repeated until all the data is written.
      <br/>
      When no file data to be written remains at step S510, the writing process proceeds to step S511.
    </p>
    <p num="157">At step S511, the file access management unit 130 changes the access state of the optical disk drive D2 in the drive access management table 132 to "unused", thereby completing the file writing process from step S512).</p>
    <p num="158">
      In the above description, a file cannot extend over a plurality of optical disks.
      <br/>
      In FIG. 14, however, when the unused data blocks on the selected optical disk are used up at step S506, after the access state of the selected optical disk drive is changed to "unused" at step S513, another optical disk is selected again at step S501, whereby a file extending over a plurality of optical disks can be created.
    </p>
    <p num="159">
      As described above, in the sixth embodiment of the invention, the file management unit 100 has the file access management unit 130 for managing the access states of the respective optical disk drives, and writing of a file is temporarily suspended when no optical disk drives which can be used for the writing are present, whereby the previous accesses are not impeded.
      <br/>
      Therefore, when file reading and file writing coexist, an optical disk from which a file is being read is not dismounted from an optical disk drive used for the reading and an optical disk to which a file is to be written is not mounted therein.
      <br/>
      Consequently, an access speed for the reading can be kept constant without being interrupted.
    </p>
    <p num="160">
      In addition, when plural file writing processes coexist, exchange of optical disks for writing files is not performed until writing processes of other files which have been first started are completed, whereby the files do not scramble for the optical disk drives.
      <br/>
      Accordingly, it is possible to decrease the exchange of optical disks which is performed until all the files are written and to shorten time required for the writing processes.
    </p>
    <p num="161">Also in a case of a file extending over a plurality of optical disks, an access speed for reading can be kept constant, and time required for writing can be shortened.</p>
    <p num="162">Embodiment 7.</p>
    <p num="163">
      A general construction of a file management apparatus according to a seventh embodiment of the present invention is shown in FIG. 7.
      <br/>
      The seventh embodiment of the present invention is different from the third embodiment in that the file management unit 100 is constructed so that an optical disk having the most unused data blocks is selected from among optical disks to which no files are being written, at the start of file writing.
    </p>
    <p num="164">FIG. 15 is a flow chart showing the operation of the file management apparatus according to the seventh embodiment of the invention.</p>
    <p num="165">A description is given of the operation of the file management apparatus thus constructed, with reference to FIGS. 2 to 5(a) and 5(b), 7, 8 and 15.</p>
    <p num="166">In this case, the file management apparatus is currently in the state identical to that in the third embodiment, except that in the data block management table 111 shown in FIG. 2, the optical disk M3 has the most unused data blocks and the optical disk M0 has the second most unused data blocks.</p>
    <p num="167">
      When writing of a file is requested, the file management unit 100 receives the writing request of the file.
      <br/>
      At step S601, as in the third embodiment, the data block management unit 110 selects an optical disk having the most unused data blocks.
      <br/>
      In this case, since the unused data blocks on the optical disk M3 are most, the optical disk M3 is selected.
    </p>
    <p num="168">Next, at step S602, as in the third embodiment, the file access management unit 130 examines the access state of the selected optical disk using the disk access management table 131.</p>
    <p num="169">If no file is being written to the selected optical disk, the writing process proceeds to step S604.</p>
    <p num="170">
      In this case, since another file is being written to the selected optical disk M3 as shown in FIG. 8, step S603 is executed.
      <br/>
      At step S603, using information of the data block management table 111, and relationships between the data block numbers and the optical disk numbers which have been previously obtained from the data block corresponding table 211 in the virtual disk management unit 210, the data block management unit 110 selects an optimal disk having the second most unused data blocks.
      <br/>
      Thereafter, the writing process returns to step S602.
    </p>
    <p num="171">In this way, step S602 and step S603 are repeated until an optical disk to which no file is being written is found.</p>
    <p num="172">In this case, since no file is being written to the optical disk M0 having the second most unused data blocks, the optical disk M0 is selected and the writing process proceeds to step S604.</p>
    <p num="173">The following processes at steps S604 to S613 are identical to these at steps S203 to S212 described in the third embodiment, and no description is given thereof.</p>
    <p num="174">
      In the above description, a file cannot extend over a plurality of optical disks.
      <br/>
      In FIG. 15, however, when the unused data blocks on the selected optical disk are used up at step S605, after the access state of the selected optical disk is changed to "no access" at step S612, another optical disk is selected again at step S601, whereby a file extending over a plurality of optical disks can be created.
    </p>
    <p num="175">
      As described above, in the seventh embodiment of the invention, the file management unit 100 has the file access management unit 130 for managing the access states of the respective optical disks, and at the start of file writing, an optical disk having the most unused data blocks is selected as an optical disk for file writing, from among optical disks to which no files are being written.
      <br/>
      Therefore, when plural file writing processes coexist, a file is written to an optical disk different from an optical disk to which writing of another file that has been first started is being performed.
      <br/>
      Therefore, the files do not scramble for data blocks on one optical disk, and the files are written in parallel when the optical disk library has a plurality of optical disk drives, whereby time required for the file writing processes can be shortened.
    </p>
    <p num="176">Also in a case of a file extending over a plurality of optical disks, files does not scramble for data blocks on one optical disk and the files are written in parallel, whereby time required for the file writing processes can be shortened.</p>
    <p num="177">Embodiment 8.</p>
    <p num="178">
      A general construction of a file management apparatus according to an eighth embodiment of the present invention is shown in FIG. 7.
      <br/>
      The eighth embodiment of the present invention is different from the first embodiment in the following points.
      <br/>
      The file management unit 100 has a file access management unit 130 for detecting file reading and managing the reading states of storage media, in addition to the data block management unit 110 and the data block allocation unit 120.
      <br/>
      The file access management unit 130 has a disk access management table 131 shown in FIG. 25, and detects the start and completion of file reading and manages the presence of reading from the optical disks M0 to M9 in the optical disk library 300, using the disk access management table 131 based on information from the data block management unit 110.
      <br/>
      The file management unit 100 is constructed so that an optical disk having the most unused data blocks is selected from among optical disks from which no files are being read, at the start of file writing.
    </p>
    <p num="179">
      FIG. 25 is a schematic diagram illustrating the disk access management table 131 used in the file access management unit 130 according to the eighth embodiment of the invention.
      <br/>
      In FIG. 25, the same reference characters as shown in FIG. 8 denote the same or corresponding parts, and the disk access management table 131 according to the eighth embodiment is identical to that shown in FIG. 8, except that files are being read from the optical disks M3 and M7.
    </p>
    <p num="180">FIG. 16 is a flow chart showing the operation of the file management apparatus according to the eighth embodiment of the invention.</p>
    <p num="181">A description is given of the operation of the file management apparatus thus constructed, with reference to FIGS. 2 to 5(a) and 5(b), 7, 25 and 16.</p>
    <p num="182">
      In this case, the data block management table 111, the file management table 121, the data block corresponding table 211, and the optical disk management table 221 are currently in the states different from those in the first embodiment, respectively.
      <br/>
      It is supposed that the unused data blocks shown by the data block management table 111 in FIG. 2 are most in the optical disk M3 and the unused data blocks are second most in the optical disk M0, and files are being read from the optical disks M3 and M7 as shown by the disk access management table 131 in FIG. 25.
    </p>
    <p num="183">
      When writing of a file is requested, the file management unit 100 receives the writing request of the file.
      <br/>
      At step S701, the data block management unit 110 selects an optical disk having the most unused data blocks.
      <br/>
      In this case, since the unused data blocks on the optical disk M3 are most, the optical disk M3 is selected.
    </p>
    <p num="184">Next, at step S702, the file access management unit 130 examines the access state of the selected optical disk using the disk access management table 131.</p>
    <p num="185">If no file is being read from the selected optical disk, the writing process proceeds to step S704.</p>
    <p num="186">
      In this case, since another file is being read from the selected optical disk M3, step S703 is executed.
      <br/>
      At step 3703, using information of the data block management table 111, and relationships between the data block numbers and the optical disk numbers which have been previously obtained from the data block corresponding table 211 in the virtual disk management unit 210, the data block management unit 110 selects an optical disk having the second most unused data blocks.
      <br/>
      Thereafter, the writing process returns to step S702.
    </p>
    <p num="187">In this way, step S702 and step S703 are repeated until an optical disk to which no file is being read is found.</p>
    <p num="188">In this case, since no file is being written to the optical disk M0 having the second most unused data blocks, the optical disk M0 is selected and the writing process proceeds to step S704.</p>
    <p num="189">The following processes at steps S704 to S710 are identical to those at steps S102 to 5108 described in the first embodiment, and no description is given thereof.</p>
    <p num="190">
      In the above description, a file cannot extend over a plurality of optical disks.
      <br/>
      In FIG. 16, however, when the unused data blocks on the selected optical disk are used up at step S704, another optical disk is selected again at step S701, whereby a file extending over a plurality of optical disks can be created.
    </p>
    <p num="191">
      As described above, in the eighth embodiment of the invention, the file management unit 100 has the file access management unit 130 for managing the reading states of the respective optical disks, and at the start of file writing, an optical disk having the most unused data blocks is selected as an optical disk for file writing, from among optical disks from which no files are being read, whereby the previous reading process is not impeded.
      <br/>
      Therefore, when file reading and file writing coexist, an access speed for the reading can be kept constant without being disturbed by the writing.
    </p>
    <p num="192">Also in a case of a file extending over a plurality of optical disks, an access speed for reading can be kept constant.</p>
    <p num="193">Embodiment 9.</p>
    <p num="194">
      FIG. 17 is a block diagram illustrating a general construction of a file management apparatus according to a ninth embodiment of the present invention.
      <br/>
      In FIG. 17, the same reference numerals as those in FIG. 12 designate the same or corresponding parts.
      <br/>
      The ninth embodiment of the present invention is different from the sixth embodiment in that a file writing request with a file size is received, the file access management unit 130 has a disk access management table 131 and a drive access management table 132, and the data block allocation unit 120 is constructed so that data blocks corresponding to the received file size are allocated to the requested file, before a data writing process.
    </p>
    <p num="195">
      FIG. 18 is a schematic diagram illustrating tho disk access management table 131 used in the file access management unit 130 according to the ninth embodiment of the invention.
      <br/>
      In the disk access management table 131 shown in FIG. 18, an optical disk number of each optical disk, the access state of the optical disk, and the data block allocation state of the optical disk correspond to one another.
    </p>
    <p num="196">FIG. 19 is a flow chart showing the data block allocation operation of the file management apparatus according to the ninth embodiment of the invention.</p>
    <p num="197">FIG. 20 is a flow chart showing the file data writing operation of the file management apparatus according to the ninth embodiment of the invention.</p>
    <p num="198">A description is given of the operation of the file management apparatus thus constructed, with reference to FIGS. 2 to 5(a) and 5(b), and 17 to 20.</p>
    <p num="199">In this case, the disk access management table 131 and the drive access management table 132 are currently in the states shown in FIGS. 18 and 13, respectively, and the other management tables in the file management apparatus are the same as in the first embodiment.</p>
    <p num="200">When a file writing request with a file size is made, the file management unit 100 receives the file writing request and the file size, and starts a data block allocation process shown in FIG. 19.</p>
    <p num="201">Initially, at step S801, as in the first embodiment, the data block management unit 110 selects the optical disk M0 having the most unused data blocks.</p>
    <p num="202">Next, at step S802, the file access management unit 130 examines the allocation state of file selected optical disk M0 using the disk access management table 131.</p>
    <p num="203">If the selected optical disk M0 is not being allocated, the allocation process proceeds to step S803.</p>
    <p num="204">
      In this case, since the selected optical disk M0 is being allocated, selection of another optical disk at step S801 and examination of the allocation state of the optical disk at step S802 are repeated until an optical disk which is not being allocated is found.
      <br/>
      Finally, the optical disk M3 is selected and it is found that the selected optical disk M3 is not being allocated.
      <br/>
      Thereafter, step S803 is executed.
    </p>
    <p num="205">At step S803, the file access management unit 130 changes the allocation slate of the selected optical disk M3 in the disk access management table 131 to "allocated".</p>
    <p num="206">Then, at step S804, the data block management unit 110 examines whether unused data blocks are present on the selected optical disk M3 or not, using the data block management table 111.</p>
    <p num="207">
      When no unused data blocks are present, step S810 is executed.
      <br/>
      The file access management unit 130 changes the allocation state of the optical disk M3 in the disk access management table 131 to "unallocated".
      <br/>
      Thereafter, the allocation process is completed as a file writing error due to shortage of the capacity (step S811).
    </p>
    <p num="208">In this case, it is supposed that the unused data blocks are present, and the allocation process proceeds to step S805.</p>
    <p num="209">At steps S805 and S806, similar to the processes at steps S103 and S104 described in the first embodiment, data block allocation is performed.</p>
    <p num="210">At step S807, the data block allocation unit 120 compares the file size which has been received with the file writing request with the total size of the data block allocated to the file.</p>
    <p num="211">When the total size of the data block is smaller than the file size, the allocations process returns to step S804 and steps S805 and S806 are performed again, thereby further allocating a data block.</p>
    <p num="212">
      When the total size of the data block is equal to or larger than the file size, step S808 is executed.
      <br/>
      The file access management unit 130 changes the allocation state of the optical disk M3 in the disk access management table 131 to "unallocated", thereby completing the data block allocation process (step S809).
    </p>
    <p num="213">When the data block allocation is completed, the file management unit 100 starts a file data writing process shown in FIG. 20.</p>
    <p num="214">Initially, at step S901, the file access management unit 130 examines the access state of the selected optical disk M3 using the disk access management table 131.</p>
    <p num="215">If the optical disk M3 is not being accessed, the writing process proceeds to step S902.</p>
    <p num="216">
      In this case, since the optical disk M3 is being accessed, the writing process is suspended and step S901 is repeated until the access is completed.
      <br/>
      Then, step S902 is executed.
    </p>
    <p num="217">
      At step S902, the file access management unit 130 changes the access state of the optical disk M3 in the disk access management table 131 to "accessed".
      <br/>
      In this case, since the access state of the optical disk M3 has been originally "accessed", it is not substantially changed.
    </p>
    <p num="218">Then, at step S903, the file access management unit 130 examines whether unused optical disk drives are present or not using the drive access management table 132.</p>
    <p num="219">If all the optical disk drives are used, the writing process is suspended and step S903 is repeated until one of the optical disk drives becomes unused.</p>
    <p num="220">In this case, since the unused optical disk drives D2 and D3 are present, the writing process proceeds to step S904.</p>
    <p num="221">At steps S904 to S906, similar to steps S503 to S505 described in the sixth embodiment, the optical disk M3 is mounted in the unused optical disk drive D2.</p>
    <p num="222">Then, at step S907, similar to step S105 described in the first embodiment, the file management unit 100 writes the file data to the data block which has allocated in the data block allocation process.</p>
    <p num="223">
      Then, at step S908, the file management unit 100 examines whether the file data to be further written remains or not.
      <br/>
      When the file data to be written remains, steps S907 and S908 are repeated and all the file data is written.
    </p>
    <p num="224">When it is found at step S908 that no file data to be written remains, at step S909, the file access management unit 130 changes the access state of the optical disk M3 in the disk access management table 131 to "no access".</p>
    <p num="225">At step S910, the file access management unit 130 changes the access state of the optical disk drive D2 in the drive access management table 132 to "unused", thereby completing the file data writing process (step S911).</p>
    <p num="226">
      In the above description, a file cannot extend over a plurality of optical disks.
      <br/>
      In FIG. 19, however, when the unused data blocks on the selected optical disk are used up at step S804, after the allocation state of the selected optical disk is changed to "unallocated" at step S810, another optical disk is selected again at step S801, thereby allocating data blocks on a plurality of optical disks to a file.
      <br/>
      Thereafter, the file is written to the allocated data blocks on the respective optical disks.
      <br/>
      In this way, a file extending over a plurality of optical disks can be created.
    </p>
    <p num="227">
      As described above, in the ninth embodiment of the invention, the data block allocation process is separated from the file data writing process, and the allocation of all the data blocks is performed before the file data writing.
      <br/>
      Therefore, even when access to an optical disk to which another file data is being written is not accepted, data block allocation to a file data is preformed in parallel with the previous writing process, and the data block allocation is already completed when the file data is written, whereby the total time required for the file writing can be shortened.
    </p>
    <p num="228">Embodiment 10.</p>
    <p num="229">A general construction of a file management apparatus according to a tenth embodiment of the present invention is shown in FIG. 17. The tenth embodiment of the present invention is different from the ninth embodiment in that the file access management unit 130 is constructed so that when a temporarily suspended writing process is resumed, among files to which data blocks are allocated by the data block allocation unit 120, a file that is to be written to an optical disk having the allocated data blocks, which optical disk has been already mounted in an optical disk drive, is given priority in writing.</p>
    <p num="230">
      FIG. 21 is a schematic diagram illustrating a drive access management table 132 used in the file access management until 130 according to the tenth embodiment of the invention.
      <br/>
      In the drive access management table 132 shown in FIG. 21, a drive number of each optical disk drive, the access state of the optical disk drive, and the reservation state of the optical disk drive correspond to one another.
    </p>
    <p num="231">FIG. 22 is a flow chart showing the file data writing operation of the file management apparatus according to the tenth embodiment of the invention.</p>
    <p num="232">A description is given of the operation of the file management apparatus thus constructed, with reference to FIGS. 2 to 5(a) and 5(b), 18, 19, 21 and 22.</p>
    <p num="233">In this case, it is supposed that the optical disk M3 is mounted in the optical disk drive D0, the disk access management table 131 is currently in the state shown in FIG. 18, and the other management tables in the file management apparatus are the same as in the first embodiment.</p>
    <p num="234">A description will be given of two cases of the access state of the optical disk M3 in the disk access management table 131; the case where the optical disk M3 is in the state of "accessed" as shown in FIG. 18 and the case where the optical disk M3 is in the state of "no access".</p>
    <p num="235">The case where the optical disk M3 is currently in the state of "accessed" is described.</p>
    <p num="236">The data block allocation operation shown in FIG. 19 after the file management unit 100 receives a file writing request and a file size is identical that in the ninth embodiment, and no description is given thereof.</p>
    <p num="237">When the data block allocation is completed, the file management unit 100 starts the file data writing process shown in FIG. 22.</p>
    <p num="238">Initially, at step S1001, as in the ninth embodiment, the file access management unit 130 examines the access state of the selected optical disk M3 using the disk access management table 131.</p>
    <p num="239">
      In this case, since the optical disk M3 is being accessed, step S1014 is executed.
      <br/>
      The file access management unit 130 changes the reservation state of the optical disk drive D0 in which the optical disk M3 is mounted, in the drive access management table 132 to "reserved".
    </p>
    <p num="240">Thereafter, at step S1015, the file access management unit 130 examines the access state of the optical disk M3 again, and when the optical disk M3 is being accessed, the writing process is suspended and steps S1014 and S1015 are repeated until the access to the optical disk M3 is completed.</p>
    <p num="241">
      When the access to the optical disk M3 is completed at step S1015, step S1016 is executed.
      <br/>
      The file access management unit 130 changes the access state of the optical disk M3 in the disk access management table 131 to "accessed".
    </p>
    <p num="242">Then, at step S1017, the file access management unit 130 examines the access state of the optical disk drive D0 in which the optical disk M3 is mounted.</p>
    <p num="243">
      If the optical disk drive D0 is unused, step S1019 is executed.
      <br/>
      The file access management unit 130 changes the access state of the optical disk drive D0 in the drive access management table 132 to "used".
      <br/>
      Thereafter, the writing process proceeds to step S1008.
    </p>
    <p num="244">
      In this case, since the optical disk drive D0 is used, step S1018 is executed.
      <br/>
      The file access management unit 130 changes the reservation state of the optical disk drive D0 in the drive access management table 132 to "unreserved", and the writing process proceeds to step S1008.
    </p>
    <p num="245">
      At steps S1008 and S1009, similar to steps S907 and S908 described in the ninth embodiment, the file is written to the allocated data block.
      <br/>
      When the writing is completed, at step S1010, the file access management unit 130 changes the access state of the optical disk M3 in the disk access management table 131 to "no access".
    </p>
    <p num="246">Then, at step S1011, the file access management unit 130 examines whether the optical disk drive D0 used for the writing is reserved or not using the drive access management table 132.</p>
    <p num="247">If the optical disk drive D0 is reserved, the file data writing process is completed (step S1013).</p>
    <p num="248">
      In this case, since the optical disk drive D0 is not reserved, step S1012 is executed.
      <br/>
      The file access management unit 130 changes the access state of the optical disk drive D0 used for the writing in the drive access management table 132 to "unused", thereby completing the file data writing process (step S1013).
    </p>
    <p num="249">The case where the optical disk M3 is currently in the state of "no access" in the disk access management table 131 is described.</p>
    <p num="250">In this case, since the optical disk M3 is not being accessed, at step S1002, the file access management unit 130 changes the access state of the optical disk M3 in the disk access management table 131 to "accessed".</p>
    <p num="251">Then, at step S1003, it is examined whether the optical disk M3 is mounted in one of the optical disk drives or not.</p>
    <p num="252">When the optical disk M3 is mounted in one of the optical disk drives, the writing process proceeds to step S1017 and the following processes are as described above.</p>
    <p num="253">
      Meanwhile, when the optical disk M3 is mounted in none of the optical disk drives, step S1004 is executed.
      <br/>
      At steps S1004 to S1007, similar to steps S502 to S505 described in the sixth embodiment, the optical disk M3 is mounted to the selected optical disk drive.
    </p>
    <p num="254">Then, step S1008 is executed and the following processes are as described above, thereby completing the file data writing process.</p>
    <p num="255">
      In the above description, a file cannot extend over a plurality of optical disks.
      <br/>
      In FIG. 19, however, when the unused data blocks on the selected optical disk are used up at step S804, after the allocation state of the selected optical disk is changed to "unallocated" at step S810, another optical disk is selected again at step S801, thereby allocating data blocks on a plurality of optical disks to a file.
      <br/>
      Thereafter, the file is written to tho allocated data blocks on the respective optical disks.
      <br/>
      In this way, a file extending over a plurality of optical disks can be created.
    </p>
    <p num="256">
      As described above, in the tenth embodiment of the invention, the data block allocation process is separated from the file data writing process, and the allocation of all the data blocks is performed before the file data writing.
      <br/>
      Further, a file data that is to be written to an optical disk, which has been already mounted in an optical disk drive, is given priority in writing.
      <br/>
      Therefore, even when across to an optical disk to which another file data is being written is not accepted, if there is a request that is waiting for writing to an optical disk which has been already mounted in an optical disk drive, the writing request is first processed.
      <br/>
      Consequently, the exchange of optical disks is decreased, whereby time required for the writing can be shortened.
    </p>
    <p num="257">Embodiment 11.</p>
    <p num="258">
      A general construction of a file management apparatus according to an eleventh embodiment of the present invention is shown in FIG. 1.
      <br/>
      The eleventh embodiment of the present invention is different from the first embodiment in that the data block management unit 110 is constructed so that available capacities of the respective optical disks M0 to M9 are externally displayed based on the data block management table 111 and information form the virtual disk management unit 210.
    </p>
    <p num="259">A description is given of the operation of the file management apparatus thus constructed, with reference to FIGS. 1 to 5(a) and 5(b).</p>
    <p num="260">As described in the prior art and the first to ninth embodiments of the present invention, when a file data is written, a use flag of a data block to which the file data is written, in the data block management table 111 is changed from "unused" to "used".</p>
    <p num="261">When the use states of the data blocks at one point of time are obtained, the data block management unit 110 counts the unused data blocks or the used data blocks from the data block management table 111 to give the unused quantity or the used quantity to the user.</p>
    <p num="262">When the use states of the data blocks on cach optical disk at one point of time are obtained, the data block management unit 110 counts the unused data blocks or the used data blocks only on the optical disk the use state of which is to be obtained, from the data block management table 111 using information from the data block corresponding table 211 in the virtual disk management unit 210, to give the unused quantity or the used quantity to the user.</p>
    <p num="263">
      As described above, in the eleventh embodiment of the invention, when a plurality of optical disks are virtually treated as a single disk, the available capacities of the respective optical disks are externally displayed.
      <br/>
      Therefore, even in such a case, the unused quantity or the used quantity of the data blocks on each storage medium is known to the user.
      <br/>
      Consequently, when a file cannot extend over a plurality of optical disks, the user can further know the largest file size which can be written.
    </p>
    <p num="264">Embodiment 12.</p>
    <p num="265">
      FIG. 26 is a block diagram illustrating a general construction of a file management apparatus according to a twelfth embodiment of the present invention.
      <br/>
      In FIG. 26, the same reference numerals as those in FIG. 1 designate the same or corresponding parts.
      <br/>
      The twelfth embodiment of the present invention is different from the first embodiment in that the file management apparatus is constructed so that an optical disk specification request including information for specifying an optical disk and a specified optical disk number is input from an input means (not shown) to the data block management unit 110, and the data block management unit 110 is constructed so that when a file is written, the specified optical disk or the optical disk having the most unused data blocks is selected as a disk for writing, according to the presence of the optical disk specification request.
    </p>
    <p num="266">FIG. 23 is a flow chart showing the operation of the file management apparatus according to the twelfth embodiment of the invention, when the specified optical disk is selected as a disk for writing.</p>
    <p num="267">A description is given of the operation of the file management apparatus thus constructed, with reference to FIGS. 26 and 23.</p>
    <p num="268">
      Initially, using an input means (not shown), such as a keyboard, in the information processor 1, file user inputs information for specifying an optical disk and a specified optical disk number as an optical disk specification request.
      <br/>
      In this case, the optical disk number M0 is input.
      <br/>
      Then, the data block management unit 110 in the file management unit 100 receives and remains this optical disk specification request.
    </p>
    <p num="269">When a file writing request is made in this state, the file management unit 100 receives this file writing request and examines whether an optical disk specification request has been input or not at step S1110.</p>
    <p num="270">
      If no optical disk specification request has been input, step S1111 is executed.
      <br/>
      At step S1111, the data block management unit 110 selects a a optical disk having the most unused data blocks as a disk for writing.
      <br/>
      Thereafter, the writing process proceeds to step S1102 and the following operation is identical to that in the first embodiment.
    </p>
    <p num="271">In this case, since the optical disk specification request has been input, step S1101 is executed.</p>
    <p num="272">At step S1101, the data block management unit 110 selects the specified optical disk M0 as a disk for writing, and the writing process proceeds to step S1102.</p>
    <p num="273">Then, as in the first embodiment, the file is written to the specified optical disk M0.</p>
    <p num="274">
      In the above description, the file management apparatus is constructed so that a specified optical disk is selected as a disk for writing, according to an optical disk specification request which is input separately from a file writing request.
      <br/>
      However, receiving a specified optical disk number together with a file writing request, the data block management unit 110 may select an optical disk with the specified number, with the disk given priority, as a disk for writing.
    </p>
    <p num="275">
      As described above, in the twelfth embodiment of the invention, when a plurality of optical disks are virtually treated as a single disk, if an input for specifying a storage medium for writing is given from the outside at file writing, the specified storage medium is selected as a medium for writing, in place of the storage medium having the most unused data blocks.
      <br/>
      Therefore, in such a case, an optical disk for writing a file is specified by the user, whereby the user can select an optical disk for writing a file according to the frequency of access to the file and the storage capacity required for writing the file.
    </p>
    <p num="276">
      In addition, in the first to twelfth embodiments of the invention, although a plurality of optical disks are treated as a single storage device, the respective optical disks may be treated as storage devices.
      <br/>
      Also in such a case, the same effects as described above are obtained.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
    </claim>
    <claim num="32">
      <claim-text>32.</claim-text>
      <claim-text>A file management apparatus used in an information processor using a media exchange type storage device comprising a plurality of storage media, at least one of a data access device for recording and reproducing data to/from the storage media, and a storage media exchanging means for mounting and dismounting the arbitrary storage medium in/from the arbitrary data access device, as an external storage device, the file management apparatus including: a data block management means for dividing storage regions of the respective storage media into data blocks of fixed capacity and managing the use states of the divided data blocks; a data block allocation means for allocating unused data blocks shown by the data block management means to a file to which a writing request from the information processor has been given, said data blocks being limited to a range of data blocks on the selected storage medium;</claim-text>
      <claim-text>and a virtual disk management means for managing sets of media numbers for identifying the storage media and data block numbers for identifying the data blocks on the respective storage media, and the corresponding virtual data block numbers for identifying the data blocks on all the storage media, converting, for a writing request to the data block specified by the virtual data block number, the virtual data block number of the requested data block into the corresponding media number and data block number, and performing writing to the data block with the obtained data block number on the storage medium with the obtained media number, using the storage media exchanging means and the data access device, wherein: - (1) data writing of the file to which the writing request has been given is performed on the data blocks allocated by the data block allocation means, using the storage media exchanging means and the data access device; - (2) at the start of file writing, the storage medium having the most unused data blocks that are shown by the data block management means is selected as a medium for writing; - (3) the data block is specified by the virtual data block number in the data block management means and the data block allocation means; - (4) writing to the data block allocated by the data block allocation means is performed by the virtual disk management means;</claim-text>
      <claim-text>and - (5) when an input specifying the storage medium for writing is given from the outside at the file writing, the specified storage medium is selected as a medium for writing, in place of the storage medium having the most unused data blocks.</claim-text>
      <claim-text>1. A file management apparatus used in an information processor using a media exchange type storage device comprising a plurality of storage media, at least one data access device for recording and reproducing data to/from the storage media, and a storage media exchanging means for mounting and dismounting the arbitrary storage medium in/from the arbitrary data access device, as an external storage device, the file management apparatus including:</claim-text>
      <claim-text>a data block management means for dividing storage regions of the respective storage media into data blocks of fixed capacity and managing the use states of the divided data blocks;</claim-text>
      <claim-text>and a data block allocation means for allocating unused data blocks shown by the data block management means to a file to which a writing request from the information processor has been given, wherein:</claim-text>
      <claim-text>- data writing of the file to which the writing request has been given is performed to the data blocks allocated by the data block allocation means, using the storage media exchanging means and the data access device;</claim-text>
      <claim-text>and - at the start of file writing, the storage medium having the most unused data blocks which are shown by the data block management means is selected as a medium for writing.</claim-text>
      <claim-text>2. The file management apparatus of claim 1 wherein the data block allocation means limits the data blocks allocated to the file to which the writing request has been given to a range of the data blocks on the selected storage medium.</claim-text>
      <claim-text>3. The file management apparatus of claim 1 including: a file writing detection means for detecting the start and completion of the file writing;</claim-text>
      <claim-text>and a media writing management means for managing the presence of writing to the respective storage media based on information from the file writing detection means and information from the data block management means, wherein; when the data blocks on the storage medium to which a file is being written, shown by the media writing management means, are allocated for writing a new file by the data block allocation means, the new file writing is temporarily suspended until the previous writing to the allocated storage medium is completed.</claim-text>
      <claim-text>4. The file management apparatus of claim 2 including: a file writing detection means for detecting the start and completion of the file writing;</claim-text>
      <claim-text>and a media writing management means for managing the presence of writing to the respective storage media based on information from the file writing detection means and information from the data block management means, wherein; when the data blocks on the storage medium to which a file is being written, shown by the media writing management means, are allocated for writing a new file by the data block allocation means, the new file writing is temporarily suspended until the previous writing to the allocated storage medium is completed.</claim-text>
      <claim-text>5. The file management apparatus of claim 1 including: a file writing detection means for detecting the start and completion of the file writing;</claim-text>
      <claim-text>and a media writing management means for managing the presence of writing to the respective storage media based on information from the file writing detection means and information from the data block management means, wherein; when the data blocks on the storage medium to which a file is being written, shown by the media writing management means, are allocated for writing a new file by the data block allocation means, the new file writing is aborted and the allocation of the data blocks is nullified.</claim-text>
      <claim-text>6. The file management apparatus of claim 2 including: a file writing detection means for detecting the start and completion of the file writing;</claim-text>
      <claim-text>and a media writing management means for managing the presence of writing to the respective storage media based on information from the file writing detection means and information from the data block management means, wherein; when the data blocks on the storage medium to which a file is being written, shown by the media writing management means, are allocated for writing a new file by the data block allocation means, the new file writing is aborted and the allocation of the data blocks is nullified.</claim-text>
      <claim-text>7. The file management apparatus of claim 1 wherein data reading of a file to which a reading request from the information processor has been given is performed from the data blocks on the storage medium to which the data have been written, using the storage media exchanging means and the data access device, the file management apparatus including: a file reading detection means for detecting the start and completion of the file reading;</claim-text>
      <claim-text>and a media reading management means for managing the presence of reading from the respective storage media based on information from the file reading detection means and information from the data block management means, wherein; when the data blocks on the storage medium from which a file is being read, shown by the media reading management means, are allocated for writing a new file by the data block allocation means, the new file writing is aborted or temporarily suspended until the reading from the allocated storage medium is completed.</claim-text>
      <claim-text>8. The file management apparatus of claim 2 wherein data reading of a file to which a reading request from the information processor has been given is performed from the data blocks on the storage medium to which the data have been written, using the storage media exchanging means and the data access device, the file management apparatus including: - a file reading detection means for detecting the start and completion of the file reading;</claim-text>
      <claim-text>and - a media reading management means for managing the presence of reading from the respective storage media based on information from the file reading detection means and information from the data block management means, wherein; when the data blocks on the storage medium from which a file is being read, shown by the media reading management means, are allocated for writing a new file by the data block allocation means, the new file writing is aborted or temporarily suspended until the reading from the allocated storage medium is completed.</claim-text>
      <claim-text>9. The file management apparatus of claim 1 wherein data reading of a file to which a reading request from the information processor has been given is performed from the data blocks on the storage medium to which the data have been written, using the storage media exchanging means and the data access device, the file management apparatus including: a file access detection means for detecting the start and completion of the file writing and reading;</claim-text>
      <claim-text>and a data access device management means for managing the use states of the respective data access devices based on information from the file access detection means, wherein; the data access device which is being used, shown by the data access device management means, is not used for writing a new file;</claim-text>
      <claim-text>and when the data access device management means shows that all the data access devices are being used, the new file writing is aborted or temporarily suspended until one of the data access devices becomes unused.</claim-text>
      <claim-text>10. The file management apparatus of claim 2 wherein data reading of a file to which a reading request from the information processor has been given is performed from the data blocks on the storage medium to which the data have been written, using the storage media exchanging means and the data access device, the file management apparatus including: a file access detection means for detecting the start and completion of the file writing and reading;</claim-text>
      <claim-text>and a data access device management means for managing the use states of the respective data access devices based on information from the file access detection means, wherein; the data access device which is being used, shown by the data access device management means, is not used for writing a new file;</claim-text>
      <claim-text>and when the data access device management means shows that all the data access devices are being used, the new file writing is aborted or temporarily suspended until one of the data access devices becomes unused.</claim-text>
      <claim-text>11. The file management apparatus of claim 1 including: a file writing detection means for detecting the start and completion of the file writing;</claim-text>
      <claim-text>and a media writing management means for managing the presence of writing to the respective storage media based on information from the file writing detection means and information from the data block management means, wherein; at the start of file writing, from among the storage media to which no files are being written, shown by the media writing management means, the storage medium having the most unused data blocks which are shown by the data block management means is selected as a medium for writing.</claim-text>
      <claim-text>12. The file management apparatus of claim 2 including: a file writing detection means for detecting the start and completion of the file writing;</claim-text>
      <claim-text>and a media writing management means for managing the presence of writing to the respective storage media based on information from the file writing detection means and information from the data block management means, wherein; at the start of file writing, from among the storage media to which no files are being written, shown by the media writing management means, the storage medium having the most unused data blocks which are shown by the data block management means is selected as a medium for writing.</claim-text>
      <claim-text>13. The file management apparatus or claim 1 wherein data reading of a file to which a reading request from the information processor has been given is performed from the data blocks on the storage medium to which the data have been written, using the storage media exchanging means and the data access device, the file management apparatus including: - a file reading detection means for detecting the start and completion of the file reading;</claim-text>
      <claim-text>and - a media reading management means for managing the presence of reading from the respective storage media based on information from the file reading detection means and information from the data block management means, wherein; at the start of file writing, from among the storage media from which no files are being read, shown by the media reading management means, the storage medium having the most unused data blocks which are shown by the data block management means is selected as a medium for writing.</claim-text>
      <claim-text>14. The file management apparatus of claim 2 wherein data reading of a file to which a reading request from the information processor has been given is performed from the data blocks on the storage medium to which the data have been written, using the storage media exchanging means and the data access device, the file management apparatus including: a file reading detection means for detecting the start and completion of the file reading;</claim-text>
      <claim-text>and a media reading management means for managing the presence of reading from the respective storage media based on information from the file reading detection means and information from the data block management means, wherein; at the start of file writing, from among the storage media from which no files are being read, shown by the media reading management means, the storage medium having the most unused data blocks which are shown by the data block management means is selected as a medium for writing.</claim-text>
      <claim-text>15. The file management apparatus of claim 3 wherein the data block allocation means receives a file size together with the file writing request from the information processor, and allocates data blocks corresponding to the received file size to the file, before the data writing.</claim-text>
      <claim-text>16. The file management apparatus of claim 4 wherein the data block allocation means receives a file size together with the file writing request from the information processor, and allocates data blocks corresponding to the received file size to the file, before the data writing.</claim-text>
      <claim-text>17. The file management apparatus of claim 7 wherein the data block allocation means receives a file size together with the file writing request from the information processor, and allocates data blocks corresponding to the received file size to the file, before the data writing.</claim-text>
      <claim-text>18. The file management apparatus of claim 8 wherein the data block allocation means receives a file size together with the file writing request from the information processor, and allocates data blocks corresponding to the received file size to the file, before the data writing.</claim-text>
      <claim-text>19. The file management apparatus of claim 9 wherein the data block allocation means receives a file size together with the file writing request from the information processor, and allocates data blocks corresponding to the received file size to the file, before the data writing.</claim-text>
      <claim-text>20. The file management apparatus of claim 10 wherein the data block allocation means receives a file size together with the file writing request from the information processor, and allocates data blocks corresponding to the received file size to the file, before the data writing.</claim-text>
      <claim-text>21. The file management apparatus of claim 15 wherein when the temporarily suspended writing is resumed, among the files to which the data blocks are allocated by the data block allocation means, the file that is to be written to the storage medium having the allocated data blocks which has been mounted in the data access device is given priority.</claim-text>
      <claim-text>22. The file management apparatus of claim 16 wherein when the temporarily suspended writing is resumed, among the files to which the data blocks are allocated by the data block allocation means, the file that is to be written to the storage medium having the allocated data blocks which has been mounted in the data access device is given priority.</claim-text>
      <claim-text>23. The file management apparatus of claim 17 wherein when the temporarily suspended writing is resumed, among the files to which the data blocks are allocated by the data block allocation means, the file that is to be written to the storage medium having the allocated data blocks which has been mounted in the data access device is given priority.</claim-text>
      <claim-text>24. The file management apparatus of claim 18 wherein when the temporarily suspended writing is resumed, among the files to which the data blocks are allocated by the data block allocation means, the file that is to be written to the storage medium having the allocated data blocks which has been mounted in the data access device is given priority.</claim-text>
      <claim-text>25. The file management apparatus of claim 19 wherein when the temporarily suspended writing is resumed, among the files to which the data blocks are allocated by the data block allocation means, the file that is to be written to the storage medium having the allocated data blocks which has been mounted in the data access device is given priority.</claim-text>
      <claim-text>26. The file management apparatus of claim 20 wherein when the temporarily suspended writing is resumed, among the files to which the data blocks are allocated by the data block allocation means, the file that is to be written to the storage medium having the allocated data blocks which has been mounted in the data access device is given priority.</claim-text>
      <claim-text>27. The file management apparatus of claim 2 including; a virtual disk management means for managing sets of media numbers for identifying the storage media and data block numbers for identifying the data blocks on the respective storage media, and the corresponding virtual data block numbers for identifying the data blocks on all the storage media, converting, for a writing request to the data block specified by the virtual data block number, the virtual data block number of the requested data block into the corresponding media number and data block number, and performing writing to the data block with the obtained data block number on the storage medium with the obtained media number, using the storage media exchanging means and the data access device, wherein: - the data block is specified by the virtual data block number in the data block management means and the data block allocation means; - writing to the data block allocated by the data block allocation means is performed by the virtual disk management means;</claim-text>
      <claim-text>and - available capacities of the respective storage media are externally displayed based on information from the data block management means and the virtual disk management means.</claim-text>
      <claim-text>28. A file management method used in an information processor using a media exchange type storage device comprising a plurality of storage media, at least once data access device for recording and reproducing data to/from the storage media, and a storage media exchanging means for mounting and dismounting the arbitrary storage medium in/from the arbitrary data access device, as an external storage device, the file management method including: a data block management process for dividing storage regions of the respective storage media into data blocks of fixed capacity and managing the use states of the divided data blocks;</claim-text>
      <claim-text>and a data block allocation process for allocating unused data blocks shown by the data block management process to a file to which a writing request from the information processor has been given, wherein: data writing of the file to which the writing request has been given is performed to the data blocks allocated by the data block allocation process, using the storage media exchanging means and the data access device;</claim-text>
      <claim-text>and at the start of file writing, the storage medium having the most unused data blocks which are shown by the data block management process is selected as a disk to be written.</claim-text>
      <claim-text>29. The file management method of claim 28 wherein the data block allocation process limits the data blocks allocated to the file to which the writing request has been given to a range of the data blocks on the selected storage medium.</claim-text>
      <claim-text>30. A recording medium containing a program for performing file management by a computer, which medium is readable by the computer, in an information processor using a media exchange type storage device comprising a plurality of storage media, at least one data access device for recording and reproducing data to/from the storage media, and a storage media exchanging means for mounting and dismounting the arbitrary storage medium in/from the arbitrary data access device, as an external storage device, the recording medium wherein: file management processes in the program include a data block management process for dividing storage regions of the respective storage media into data blocks of fixed capacity and managing the use states of the divided data blocks, and a data block allocation process for allocating unused data blocks shown by the data block management process to a file to which a writing request from the information processor has been given; data writing of the file to which the writing request has been given is performed to the data blocks allocated by the data block allocation process, using the storage media exchanging means and the data access device;</claim-text>
      <claim-text>and at the start of file writing, the storage medium having the most unused data blocks which are shown by tho data block management process is selected as a disk to be written.</claim-text>
      <claim-text>31. The recording medium of claim 30 containing the program including the file management processes, wherein the data block allocation process limits the data blocks allocated to the file to which the writing request has been given to a range of the data blocks on the selected storage medium.</claim-text>
    </claim>
  </claims>
</questel-patent-document>