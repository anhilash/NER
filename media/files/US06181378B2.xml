<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06181378B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06181378</doc-number>
        <kind>B2</kind>
        <date>20010130</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6181378</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference is-representative="YES" family-id="27527749" extended-family-id="19664814">
      <document-id>
        <country>US</country>
        <doc-number>08874589</doc-number>
        <kind>A</kind>
        <date>19970613</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1997US-08874589</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>20181315</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>JP</country>
        <doc-number>17577996</doc-number>
        <kind>A</kind>
        <date>19960614</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1996JP-0175779</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="2">
        <country>JP</country>
        <doc-number>17706396</doc-number>
        <kind>A</kind>
        <date>19960617</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="2">
        <doc-number>1996JP-0177063</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="3">
        <country>JP</country>
        <doc-number>18140296</doc-number>
        <kind>A</kind>
        <date>19960620</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="3">
        <doc-number>1996JP-0181402</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="4">
        <country>JP</country>
        <doc-number>18140396</doc-number>
        <kind>A</kind>
        <date>19960620</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="4">
        <doc-number>1996JP-0181403</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="5">
        <country>JP</country>
        <doc-number>14581597</doc-number>
        <kind>A</kind>
        <date>19970520</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="5">
        <doc-number>1997JP-0145815</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010130</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>H04N   5/232       20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>5</main-group>
        <subgroup>232</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>H04N   1/00        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>1</main-group>
        <subgroup>00</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>348353000</text>
        <class>348</class>
        <subclass>353000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>348345000</text>
        <class>348</class>
        <subclass>345000</subclass>
      </further-classification>
      <further-classification sequence="2">
        <text>348349000</text>
        <class>348</class>
        <subclass>349000</subclass>
      </further-classification>
      <further-classification sequence="3">
        <text>348E05045</text>
        <class>348</class>
        <subclass>E05045</subclass>
      </further-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>H04N-001/00D2K</text>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>001</main-group>
        <subgroup>00D2K</subgroup>
      </classification-ecla>
      <classification-ecla sequence="2">
        <text>H04N-001/00C3</text>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>001</main-group>
        <subgroup>00C3</subgroup>
      </classification-ecla>
      <classification-ecla sequence="3">
        <text>H04N-001/00D8</text>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>001</main-group>
        <subgroup>00D8</subgroup>
      </classification-ecla>
      <classification-ecla sequence="4">
        <text>H04N-001/024A</text>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>001</main-group>
        <subgroup>024A</subgroup>
      </classification-ecla>
      <classification-ecla sequence="5">
        <text>H04N-005/232F</text>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>005</main-group>
        <subgroup>232F</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04N-001/00384</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>1</main-group>
        <subgroup>00384</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04N-001/00204</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>1</main-group>
        <subgroup>00204</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04N-001/00496</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>1</main-group>
        <subgroup>00496</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="4">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04N-001/02409</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>1</main-group>
        <subgroup>02409</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="5">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H04N-005/23212</classification-symbol>
        <section>H</section>
        <class>04</class>
        <subclass>N</subclass>
        <main-group>5</main-group>
        <subgroup>23212</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>19</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>41</number-of-drawing-sheets>
      <number-of-figures>48</number-of-figures>
      <image-key data-format="questel">US6181378</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Image reading device</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>FUJII NORIO, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4342905</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4342905</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>KOSHIISHI SHINICHIROU</text>
          <document-id>
            <country>US</country>
            <doc-number>4615598</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4615598</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>BIBER CONRAD H, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4752831</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4752831</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>MATSUI TORU, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4818865</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4818865</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="5">
          <text>HAMADA MASATAKA, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4931821</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4931821</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="6">
          <text>KUBO KAZUTOSHI</text>
          <document-id>
            <country>US</country>
            <doc-number>5404163</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5404163</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <nplcit num="1">
          <text>U.S. Army Material Command; "Engineering Design Handbook"; National Technical Information Service (NTIS); pp. 4-8, 5-31 and 5-32, Apr. 1971.</text>
        </nplcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Asahi Kogaku Kogyo Kabushiki Kaisha</orgname>
            <address>
              <address-1>Tokyo, JP</address-1>
              <city>Tokyo</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>ASAHI OPTICAL</orgname>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Horie, Mikio</name>
            <address>
              <address-1>Tokyo, JP</address-1>
              <city>Tokyo</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
        <inventor data-format="original" sequence="2">
          <addressbook lang="en">
            <name>Suzuki, Minoru</name>
            <address>
              <address-1>Tokyo, JP</address-1>
              <city>Tokyo</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <orgname>Greenblum &amp; Bernstein, P.L.C.</orgname>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Garber, Wendy</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>LAPSED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      An image reading device is provided that includes a linear image sensor (such as a CCD), a contrast detecting system, and a focus condition judging system.
      <br/>
      The focus condition judging system is arranged to detect when the image reading device is in an in-focus condition based on output of the image sensor.
      <br/>
      Further, a driving mechanism is provided that moves an imaging lens or the image sensor, while the contrast detecting system monitors contrast data calculated from the output of the image sensor.
      <br/>
      An in-focus condition may be detected when the contrast data substantially reaches a maximum value.
      <br/>
      The maximum value may be a first maximum value detected during the movement controlled by the driving mechanism or may be a maximum value over a predetermined range of the controlled movement.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="1">The present invention relates to an image reading device having an automatic focusing function.</p>
    <p num="2">In a camera-type image reading device, since the distance between the image reading device and an object varies, data related to the distance should be obtained in order to focus on the object.</p>
    <p num="3">
      In the field of photography in which a camera uses a film, an active and passive distance measuring method are well known.
      <br/>
      In the active method, an infrared light is emitted from the camera to the object, and by detecting the reflected infrared light, the distance is measured.
      <br/>
      In the passive method, by detecting a phase difference of an object image, or detecting a distribution of contrast information of the object, the distance or defocus amount is detected.
      <br/>
      In such a camera, an automatic focusing mechanism is provided, which moves a focusing lens in accordance with the detected object distance or the defocus amount so that an in-focus image is formed on a film plane.
    </p>
    <p num="4">
      Specifically, when the phase difference of the object image is detected, a pair of separator lenses are provided to form a pair of images to be compared with each other.
      <br/>
      When the contrast distribution is detected, a half mirror is used to split the light from the object, and the contrast distribution on planes which have different optical distances from a focusing lens.
    </p>
    <p num="5">
      In the image reading device using an image sensor, such as a CCD (Charge Coupled Device) to capture an object image, since the optical image is converted into a digital data which can be processed by a microprocessor or the like easily, it is preferable that the focus condition is detected with use of the image sensor.
      <br/>
      However, the conventional methods mentioned above cannot be applied to the image capturing system, and therefore, in order to employ the conventional focusing system, an extra optical system should be introduced in the image reading device.
    </p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="6">It is therefore an object of the invention to provide an improved image reading device which is capable of detecting a focusing condition using the image sensor which is used for capturing the image.</p>
    <p num="7">According to one aspect of the invention, there is provided an image reading device that includes: a focusing lens for forming an image of an object; a linear image sensor for capturing the image, the image sensor including a plurality of image receiving elements arranged in a line along a predetermined direction, the plurality of image receiving elements outputting image signals corresponding to the image; a contrast detecting system which detects contrast data representative of a contrast of the image based on the image signals; a rotatable mirror arranged between the object and the focusing lens, the rotatable mirror being rotatable about an axis parallel to the predetermined direction and reflecting light from the object towards the focusing lens; a driving mechanism which moves at least one of the focusing lens and the image sensor to change a distance therebetween; and a focusing condition judging system which, while controlling the contrast detecting system to detect the contrast data and controlling the driving mechanism to move the at least one of the focusing lens and the image sensor, determines an in-focus condition of the image in accordance with the contrast data.</p>
    <p num="8">In a particular case, the focusing condition judging system controls the contrast detecting system to periodically detect the contrast data during the movement of at least one of the focusing lens and the image sensor and judges whether the in-focus condition is obtained in accordance with a change in the contrast data.</p>
    <p num="9">In another particular case, the focusing condition judging system judges that the in-focus condition is obtained when the contrast data has a maximum value.</p>
    <p num="10">
      In yet another particular case, the focusing condition judging system controls the driving mechanism to periodically move at least one of the lens and the image sensor by a predetermined unit amount, and controls the contrast detecting system to detect the contrast data for each movement of at least one of the focusing lens and the image sensor.
      <br/>
      The focusing condition judging system also determines that the in-focus condition is obtained when a current contrast data is less than a previous contrast data.
    </p>
    <p num="11">
      In still another particular case, the focusing condition judging system controls the driving mechanism to periodically move at least one of the lens and the image sensor by a predetermined unit amount, and controls the contrast detecting system to detect the contrast data for each movement of at least one of the focusing lens and the image sensor.
      <br/>
      In this case, the focusing condition judging system may determine that the in-focus condition is obtained when the contrast data is substantially a maximum.
    </p>
    <p num="12">In still another particular case, the contrast data is a difference between a maximum brightness image signal and a minimum brightness image signal.</p>
    <p num="13">In still another particular case, the contrast data is a sum of a difference of image signals for adjacent light receiving elements.</p>
    <p num="14">In still another particular case, the focusing condition judging system controls the driving mechanism to move at least one of the focusing lens and the image sensor through a predetermined range, and controls the contrast detecting system to detect the contrast data periodically during the movement, such that the focusing condition judging system determines the in-focus condition based on a maximum of the contrast data.</p>
    <p num="15">In still another particular case, the contrast data is an average of a plurality of contrast measurements performed at a single position of the driving mechanism.</p>
    <p num="16">In still another particular case, the predetermined range is divided into a plurality of sub-ranges, and the contrast data is an average of a plurality of contrast measurements performed at a predetermined number of positions of the driving mechanism within each of the sub-ranges, and the focusing condition judging system determines the in-focus condition also based on the sub-ranges.</p>
    <p num="17">In still another particular case, the focusing condition judging system controls the driving mechanism such that the imaging lens is moved from a farthest position farthest from the image sensor to a nearest position nearest to the image sensor.</p>
    <p num="18">In still another particular case, the image reading device may be further provided with a projecting unit for projecting a contrast pattern towards the object, and the image reading device may operate such that, if the focusing condition judging system fails to detect an in-focus condition, the projecting unit is turned ON and the focusing condition judging system is operated again.</p>
    <p num="19">In this case, when the imaging lens and the image sensor are located a maximum distance apart, the focusing condition judging system controls the contrast detecting system to detect projecting unit contrast data when the projecting unit is ON, compares the projecting unit contrast data with the contrast data, and determines that the in-focus condition is obtained if the projecting unit contrast data and the contrast data match.</p>
    <p num="20">Further, if the projecting unit contrast data and the contrast data do not match, the focusing condition judging system controls the driving mechanism to move at least the imaging lens or the image sensor such that the imaging lens and the image sensor move closer together while detecting an in-focus condition based on the contrast data.</p>
    <p num="21">In still another particular case, the image reading device may be further provided with a projecting unit for projecting a contrast pattern towards the object and the projecting unit is turned ON during operation of the focusing condition judging system.</p>
    <p num="22">In still another particular case, the focusing condition judging system further controls the rotatable mirror such that, if the in-focus condition is not obtained, the rotating mirror is rotated until the contrast detecting system detects a change of the contrast data.</p>
    <p num="23">
      In this case, it the change of the contrast data is detected, the focusing condition judging system controls the driving mechanism and the contrast detecting mechanism to detect an in-focus condition.
      <br/>
      Further, the focusing condition judging system calculates a home in-focus condition, representing an in-focus condition of the imaging lens when the rotatable mirror is at a home position, based on the in-focus condition.
      <br/>
      In a particular case, the home position is a center of a rotatable range of the rotatable mirror.
    </p>
    <p num="24">
      In still another particular case, the image reading device may be further provided with a projecting unit for projecting a contrast pattern towards the object and the contrast pattern may be projected through the rotatable mirror.
      <br/>
      With this structure, the contrast pattern is always projected towards the object regardless of the rotating position of the rotatable mirror.
    </p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="25">
      FIG. 1 shows an optical system of a scanner according to an embodiment of the present invention;
      <br/>
      FIG. 2 is an external perspective view of the scanner of the embodiment;
      <br/>
      FIG. 3 is a broken-away perspective view of the scanner of FIG. 2 showing an arrangement of some internal elements;
      <br/>
      FIG. 4 is a plan view of the camera type scanner of the embodiment showing internal construction;
      <br/>
      FIG. 5 is a sectional view along a line V--V in FIG. 4;
      <br/>
      FIG. 6 is a sectional view along a line VI--VI in FIG. 4;
      <br/>
      FIG. 7 is a schematic view showing a driving mechanism;
      <br/>
      FIG. 8 is a perspective view of a mirror holding portion;
      <br/>
      FIG. 9 is a schematic view showing the driving mechanism of FIG. 7 in a different state;
      <br/>
      FIG. 10 is a schematic view showing the driving mechanism of FIG. 7 in another different state;
      <br/>
      FIG. 11A shows a relationship between a driving member and a scanning mirror when the scanning mirror is at a reference scanning position;
      <br/>
      FIG. 11B shows a relationship between the driving member and the scanning mirror when the scanning mirror is scanning at the finder side of the reference scanning position;
      <br/>
      FIG. 11C shows the relationship between the driving member and the scanning mirror when the scanning mirror is scanning at the lens side of the reference scanning position;
      <br/>
      FIG. 12 is a graph of scanning line interval versus rotational angle;
      <br/>
      FIG. 13 is a schematic view showing a relationship between a scanning angle and a scanning range;
      <br/>
      FIG. 14 is a sectional view along a line XIV--XIV in FIG. 4;
      <br/>
      FIG. 15 is a perspective view of a color filter unit;
      <br/>
      FIG. 16 is a schematic view showing the driving mechanism of FIG. 7 in yet another different state;
      <br/>
      FIG. 17 is a sectional view along a line XVII--XVII in FIG. 4;
      <br/>
      FIG. 18A is a plan view showing a lens driving mechanism;
      <br/>
      FIG. 18B is a plan view showing detail of the lens driving mechanism;
      <br/>
      FIG. 18C is a side cross-section view showing detail of the lens driving mechanism;
      <br/>
      FIG. 19 is a block diagram of the scanner;
      <br/>
      FIG. 20 is a schematic diagram of a CCD processing circuit;
      <br/>
      FIG. 21 shows an LCD panel;
      <br/>
      FIG. 22 is a schematic diagram illustrating a relationship between scanning motor drive pulses and scanning mirror positions;
      <br/>
      FIG. 23 is a schematic diagram illustrating a relationship between lens drive motor drive pulses and lens positions;
      <br/>
      FIG. 24 is a flowchart for a main process;
      <br/>
      FIG. 25 is a flowchart for an initialization process;
      <br/>
      FIG. 26 is a continuation of the flowchart for the initialization process;
      <br/>
      FIG. 27 is a flowchart for a mode setting process;
      <br/>
      FIG. 28 is a flowchart for a focusing process;
      <br/>
      FIG. 29 is a continuation of the flowchart for the focusing process;
      <br/>
      FIG. 30 is a flowchart for a photometering process;
      <br/>
      FIG. 31 is a flowchart for a capture process;
      <br/>
      FIG. 32 is a continuation of the flowchart for the capture process;
      <br/>
      FIGS. 33A and 33B illustrate a reason that magnification compensation is required;
      <br/>
      FIG. 34 illustrates a method of magnification compensation;
      <br/>
      FIGS. 35 and 36 illustrate an actual example of magnification compensation;
      <br/>
      FIG. 37 shows a flowchart of a focusing process according to a second embodiment of the invention;
      <br/>
      FIG. 38 shows a flowchart of a focusing process according to a third embodiment of the invention;
      <br/>
      FIG. 39 shows a flowchart of a focusing process according to a fourth embodiment of the invention;
      <br/>
      FIG. 40 shows a flowchart of a focusing process according to a fifth embodiment of the invention;
      <br/>
      FIG. 41 shows a flowchart of a focusing process according to a sixth embodiment of the invention;
      <br/>
      FIG. 42 shows a flowchart of a focusing process according to a seventh embodiment of the invention; and
      <br/>
      FIG. 43 shows a flowchart which is a continuation of the focusing process of FIG. 42.
    </p>
    <heading>DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
    <p num="26">An image reading device according to an embodiment of the present invention, in particular, a scanner, is described with reference to FIGS. 1 to 43.</p>
    <p num="27">General</p>
    <p num="28">
      The scanner 1 (shown in FIG. 2) is a camera-type scanner that creates a digital image of an object O placed at a distance therefrom.
      <br/>
      The digital image is captured by scanning the object O using a line-type CCD image sensor 16.
      <br/>
      FIG. 1 is a schematic view showing an imaging optical system 1a of the scanner 1.
      <br/>
      The imaging optical system 1a includes a scanning mirror 2, an imaging lens 3, and the image sensor 16.
      <br/>
      When capturing an image, the scanning mirror 2 reflects light rays received from the object O toward the imaging lens 3 and the imaging lens 3 focuses the light rays to form an image on the image sensor 16.
      <br/>
      The image sensor 16 receives the image, representing one scanning line for the object O. Then, by rotating the scanning mirror 2 about a rotation axis Rx (parallel to the length of the image sensor 16), the scanning line is moved perpendicular to the image sensor 16 in order to scan the whole object O. Thus, the image sensor 16 reads a two-dimensional image of the object O one scanning line at a time.
      <br/>
      In the embodiment, as a particular example, the image sensor 16 includes 2088 pixels arranged along the length thereof and a scanning range of the scanning mirror 2 includes 2870 scanning lines.
      <br/>
      Thus, the resolution of the scanner 1 is almost 6,000,000 pixels (2088 * 2870).
      <br/>
      This resolution corresponds to 300 dpi (dots per inch) for an object having maximum dimensions of approximately 240 mm * 180 mm positioned at 23 cm from the scanner 1.
    </p>
    <p num="29">
      In the following description, a coordinate system is defined in which an X-axis is a direction of the optical axis of the imaging lens 3 and a Y-axis is a direction parallel to the image sensor 16.
      <br/>
      Further, the Y-axis direction, i.e., the direction of the image sensor 16, is referred to as a "main scanning direction" and the X-axis direction, i.e., the direction in which the scanning line moves during scanning, is referred to as an "auxiliary scanning directions".
      <br/>
      Still further, when the scanning mirror 2 is positioned such that the optical axis of the imaging lens 3 is deflected at a right angle, the position of the scanning mirror 2 and of the scanning line are referred to as a "reference scanning position".
      <br/>
      Other scanning positions within the scanning range along the Y-axis direction are generally defined in relation to the reference scanning position.
      <br/>
      Still further, the term "magnification" is used in relation to the effect of the imaging lens 3 on the size of an image of the object O formed on the image sensor 16 even though, in this embodiment, the optical system is a reduction optical system, and the "magnification" is less than one.
    </p>
    <p num="30">FIG. 1 also shows a projecting mechanism 11 for projecting a contrast pattern P onto the object O. The projecting mechanism 11 and the contrast pattern P are described in more detail below.</p>
    <p num="31">
      In the present embodiment, the scanning mirror 2 is rotated to scan the object O. This arrangement has an advantage in that light is incident on the imaging lens 3 at the same angle irrespective of the scanning position along the Y-axis direction.
      <br/>
      Thus, the required size of the imaging lens 3 is relatively small.
      <br/>
      This may be compared with a scanner in which the image sensor 16 is rotated to scan an object, in which case the direction of light incident on the imaging lens changes according to the scanning position and the required size of the imaging lens is relatively large due to the problem of vignetting.
    </p>
    <p num="32">However, when the scanning mirror 2 is rotated to scan the object O, the conjugate surface of the image sensor 16 is a cylindrical surface, which causes the following three problems: (1) if the imaging lens 3 is focused for the reference scanning position, the periphery of the scanning range will be out of focus; (2) a magnification of a scanning line at the reference scanning position will be larger than that of a scanning line at the periphery of the scanning range; (3) the interval between scanning lines in the vicinity of the reference scanning position will be smaller than the interval between scanning lines near the periphery of the scanning range.</p>
    <p num="33">Detailed descriptions of the solutions to the above problems are provided below, however, generally, in order to solve problem (1), the imaging lens is moved along the optical axis thereof according to the scanning position, in order to solve problem (2), the scanner compensates for the difference in magnification by adjusting the digital image data at the periphery of the scanning range, and in order to solve problem (3), the rotational speed of the scanning mirror 2 is arranged to vary depending on scanning position so that the interval between scanning lines is substantially constant.</p>
    <p num="34">Physical Structure</p>
    <p num="35">
      FIGS. 2 and 3 are perspective views showing exemplary external and internal structures of the scanner 1, respectively.
      <br/>
      As shown in FIG. 2, the scanner 1 has a box-shaped body 10.
      <br/>
      As shown in FIG. 3, the image sensor 16, the scanning mirror 2, and the imaging mirror 3 are provided in the body 10.
      <br/>
      Also as shown in FIG. 3, the body 10 includes a window 12 for providing light from the object O to the scanning mirror 2 and a finder window 13 for providing light from the object O to a finder system 150.
      <br/>
      The body 10 is further provided with a main switch 310 for turning the scanner ON and OFF.
    </p>
    <p num="36">
      In this embodiment, the image sensor 16 is a monochrome type CCD image sensor 16.
      <br/>
      As such, a color filter unit 4 is provided between the scanning mirror 2 and the image sensor 16 to allow a color image to be captured.
      <br/>
      However, a color CCD may also be used, in which case, the color filter unit 4 would not be required.
    </p>
    <p num="37">FIG. 4 is a plan view showing the internal structure of the scanner 1 in more detail.</p>
    <p num="38">
      The scanning mirror 2 is held by a mirror holder 20.
      <br/>
      The mirror holder 20 is rotated by a scanning motor 70 (described below) clockwise and counterclockwise in the view of FIG. 4.
    </p>
    <p num="39">
      A housing 120, provided adjacent to the scanning mirror 2, houses the imaging lens 3 and the image sensor 16.
      <br/>
      The housing 120 includes a cylindrical portion 121 that houses a lens barrel 30.
      <br/>
      The lens barrel 30 supports the imaging lens 3 which includes three lenses 3a, 3b and 3c.
      <br/>
      The lens barrel 30 is moved toward and away from the scanning mirror 2 by a lens driving motor 60.
    </p>
    <p num="40">
      The color filter unit 4 includes, for example, a colorless filter 4a, a red filter 4b, a green filter 4c, and a blue filter 4d and is provided between the imaging lens 3 and the image sensor 16.
      <br/>
      The color filter unit 4 further includes a filter holder 40 which supports the filters 4a, 4b, 4c and 4d at, for example, 90 degree angles with respect to each other.
      <br/>
      The filter holder 40 is rotated about an axis parallel to the image sensor 16 by the scanning motor 70 in order to change the filter positioned in the optical path from the scanning mirror 2 to the image sensor 16.
    </p>
    <p num="41">
      The mirror holder 2 and the housing 120 are supported on a support frame 130 provided at the bottom of the body 10.
      <br/>
      The support frame 130 also supports a motor frame 135 for supporting the scanning motor 70 and lens driving motor 60 and a battery frame 136 for supporting a battery 210.
    </p>
    <p num="42">Finder</p>
    <p num="43">
      FIG. 5 is a sectional view taken along a line V--V of FIG. 4.
      <br/>
      As shown in FIG. 5, the finder system 150 includes a finder window 13, an object lens 141, a finder mirror 145, a fresnel lens 143, a cover glass 15 and an LCD (Liquid Crystal Display) panel 152.
      <br/>
      The object lens 141 and the fresnel lens 143 are unitarily formed as a lens unit 140, which is fixed on the support frame 130 via bolts at two fixing portions 146.
    </p>
    <p num="44">Remote Control Device</p>
    <p num="45">
      The scanner 1 is operated by a remote control device 5 (shown in FIG. 2).
      <br/>
      The remote control device 5 is provided with operation buttons 350 that include a start button 51, an up/tele button 54, a down/wide button 55, a mode button 53, and a stop/delete button 52.
      <br/>
      The remote control device 5 is storable in a recess 17 provided at the top of the body 10.
    </p>
    <p num="46">
      The remote control device 5 has a signal sending portion 56 for emitting infrared rays representing predetermined commands.
      <br/>
      The body 10 is provided with a first LED sensor 201 for receiving infrared rays from the remote control device 5.
      <br/>
      The body 10 also includes a second LED sensor 202 provided in the recess 17 and located so as to confront the signal sending portion 56 when the remote control device 5 is stored in the recess 17.
      <br/>
      Since the second LED sensor 202 will be much closer to the remote control device 5 during use, the second LED sensor 202 may have lower sensitivity compared with the first LED sensor 201.
    </p>
    <p num="47">
      In order to detect if the remote control device 5 is detached from or mounted on the body 10, the body 10 is provided with a remote control sensor 311 at the recess 17.
      <br/>
      The remote control sensor 311 emits an ON signal when the remote control device 5 is detected.
      <br/>
      The scanner 1 is so arranged that the first LED sensor 201 receives signals from the remote control device 5 when the remote control device 5 is detached from the body 10 and the second LED sensor 202 receives signals from the remote control device 5 when the remote control device 5 is mounted at the recess 17.
    </p>
    <p num="48">Scanning Mirror Driving Mechanism</p>
    <p num="49">
      FIG. 6 is a sectional view of the scanner 1 taken along line VI--VI of FIG. 4.
      <br/>
      The scanning motor 70 for rotating the scanning mirror 2 is provided on the motor frame 135.
      <br/>
      A driving mechanism 7 includes five reduction gear pairs 74, 77, 75, 78, and 76 are provided to reduce the output rotation speed of the scanning motor 70.
      <br/>
      Each gear pair 74, 77, 75, 78, and 76 includes unitarily formed large gears 74a, 77a, 75a, 78a, and 76a, and small gears 74b, 77b, 75b, 78b, and 76b.
    </p>
    <p num="50">
      The first, third and fifth gear pairs 74, 75 and 76 are rotatably supported by a first shaft 72 and the second and fourth gear pairs 77 and 78 are rotatably supported by a second shaft 73.
      <br/>
      The first shaft 72 and the second shaft 73 are supported between the motor frame 135 and the support frame 130.
      <br/>
      A drive gear 71 fixed to an output shaft 70a of the scanning motor 70 engages the large gear 74a of the first gear pair 74.
      <br/>
      The small gear 74b of the first gear pair 74 engages the large gear 77a of the second gear pair 77.
      <br/>
      The small gear 77b of the second gear pair 77 engages the large gear 75a of the third gear pair 75.
      <br/>
      The small gear 75b of the third gear pair 75 engages the large gear 78a of the fourth gear pair 78.
      <br/>
      The small gear 78b of the fourth gear pair 78 engages the large gear 76a of the fifth gear pair 76.
      <br/>
      As constructed above, the rotational speed of the scanning motor 70 is reduced with a reduction ratio of 1/1000 to drive a driving member 80 that is engaged with the small gear 76b of the fifth gear pair 76.
    </p>
    <p num="51">
      FIG. 7 is a plan view showing further elements of the driving mechanism 7.
      <br/>
      The driving member 80 includes a first sector gear 82 and a second sector gear 83 and is rotatably supported by the second shaft 73.
      <br/>
      The first sector gear 82 has a sector angle of approximately 120 (degree)  with respect to the center of the second shaft 73 and the second sector gear 83 has a sector angle of approximately 20 (degree) .
    </p>
    <p num="52">
      The first sector gear 82 engages the small gear 76b of the fifth gear pair 76 such that the driving member 80 is rotated by the rotation of the fifth gear pair 76.
      <br/>
      The driving member 80 further includes a driving pin 81 positioned on an extended line of the pitch circle of the sector gear 82.
    </p>
    <p num="53">
      The driving pin 81 engages with the mirror holder 20 to drive the scanning mirror 2.
      <br/>
      FIG. 8 is a perspective view showing the engagement of the driving pin 81 with the mirror holder 20.
      <br/>
      The mirror holder 20 includes a mirror frame 21 for mounting the scanning mirror 2.
      <br/>
      The mirror frame 21 is supported on a disk 25, which is unitarily formed with a rotating shaft 27.
      <br/>
      The rotating shaft 27 fits into a hole 139 formed on the support frame 130, such that the rotating shaft 27 (and therefore, the mirror holder 20) can rotate.
      <br/>
      The rotation axis coincides with a center axis of the surface of the scanning mirror 2 when the scanning mirror 2 is mounted on the mirror frame 21.
    </p>
    <p num="54">
      The disk 25 is further provided with a driven member 23 that is driven by the driving member 80.
      <br/>
      The driven member 23 is provided with a groove 24, extending in the direction of the radius of the disk 25, with which the driving pin 81 (of the driving member 80) engages.
    </p>
    <p num="55">
      Since there may be clearance between the driving pin 81 and the groove 24, in order to reduce backlash, a torsion spring 28 is provided around the shaft 27 to bias the mirror holder 20 in a predetermined direction.
      <br/>
      The disk 25 has a sector-shaped cut-away portion 25a in which both ends of the coil spring 28 extend.
      <br/>
      One end of the coil spring 28 abuts a side of the shaped cut-away portion 25a and the other end of the coil spring 28 abuts a boss 29 provided to the support frame 130.
      <br/>
      In this embodiment, the mirror holder 2 is biased in the direction shown by an arrow A in FIG. 8.
    </p>
    <p num="56">FIGS. 9 and 10 illustrate the rotation of the driving member 80 from the state shown in FIG. 7 in a counterclockwise and a clockwise direction, respectively.</p>
    <p num="57">
      As described briefly above, in this embodiment, the scanning speed of the scanning mirror 2 is adjusted depending on the scanning position.
      <br/>
      A detailed explanation is now provided.
    </p>
    <p num="58">
      FIGS. 11A, 11B, and 11C are schematic views of the driving member 80 and the scanning mirror 2.
      <br/>
      FIG. 11A shows a state in which the rotation center of the driving member 80, the center of the driving pin 81, and the rotation center of the mirror holder 20 are all arranged in a straight line (the same state as that shown in FIG. 7).
      <br/>
      In this state, the angle of the scanning mirror 2 with respect to the X-axis is 45 (degree)  and the scanning mirror 2 is at the reference scanning position R (FIG. 1).
    </p>
    <p num="59">As shown in FIGS. 11B and 11C, as the driving member 80 rotates in either the counterclockwise or the clockwise direction, a distance between the center of the driving pin 81 and the rotation center of the mirror holder 20 increases.</p>
    <p num="60">
      The distance between the rotation centers of the driving member 80 and the scanning mirror 2 is referred to as "d".
      <br/>
      The distance between the rotation center of the driving member 80 and the center of the driving pin 81 is referred to as "r".
      <br/>
      A rotational angle of the driving member 80 (with respect to the state of FIG. 11A) is referred to as  THETA  and a rotational angle of the scanning mirror 2 (also with respect to the state of FIG. 11A) is referred to as  OMEGA .
      <br/>
      In particular, FIGS. 11B and 11C illustrate a state in which the scanning mirror 2 is scanning near the periphery of the scanning range, i.e. at predetermined angles  THETA a,  OMEGA a, and  OMEGA 'a.
    </p>
    <p num="61">
      The equation (1) describes a relationship between the rotational angles  THETA  and  OMEGA  of the driving member 80 and the scanning mirror 2.
      <br/>
      tan  OMEGA =r sin  THETA /(d-rcos  THETA )  (1)
    </p>
    <p num="62">
      Further, equation (2) describes a relationship between the rotational angle  OMEGA  of the scanning mirror 2 and a scanning angle  OMEGA ' of the scanning line.
      <br/>
      OMEGA '=2 OMEGA   (2)
    </p>
    <p num="63">
      A scanning position Y of the scanning line on the surface of the object O with respect to the reference scanning position R is determined by Y=L tan  OMEGA ', where L is a distance between the object O and the scanning mirror 2 at the reference scanning position.
      <br/>
      Referring to FIG. 11B, if we consider the driving of the scanning motor 70 between two scanning lines, the driving member 80 moves through an angle  DELTA  THETA  (not shown) and, when scanning near the reference scanning position R, the scanning line moves through a scanning angle  OMEGA '1 producing an interval between scanning lines  DELTA Y1.
      <br/>
      Similarly, when scanning at the periphery of the scanning range, a movement of the driving member 80 through an angle  DELTA  THETA  results in a scanning angle  OMEGA '2 and an interval between scanning lines  DELTA Y2.
      <br/>
      The intervals between scanning lines  DELTA Y1 and  DELTA Y2 are:
      <br/>
      DELTA Y1=L tan( OMEGA '1-0)  (3)
      <br/>
      DELTA Y2=L tan  OMEGA 'a-L tan( OMEGA 'a- OMEGA '2)  (4)
    </p>
    <p num="64">where  OMEGA 'a is a scanning angle of the scanning line from the reference scanning position to the periphery of the scanning range.</p>
    <p num="65">
      In order to ensure that  DELTA Y1= DELTA Y2 (that is, that the intervals at the center and the periphery of the scanning range are the same), the following equation (5) must be satisfied:
      <br/>
      tan  OMEGA '1=tan  OMEGA 'a-tan( OMEGA 'a- OMEGA '2)  (5).
    </p>
    <p num="66">
      Substituting the equations (1) and (2) gives the equation (6);
      <br/>
      tan( OMEGA '1/2)=r sin  DELTA  THETA /(d-r cos  DELTA  THETA )  (6).
    </p>
    <p num="67">
      By selecting a maximum scanning angle  OMEGA 'a and a desired interval between scanning lines as the scanning angle at the periphery  OMEGA '2,  OMEGA '1 can be determined from equation (5).
      <br/>
      Then, based on a desired drive amount of the drive member 80, the appropriate ratio of d/r to maintain a substantially constant interval between scanning lines can be determined from equation (6).
    </p>
    <p num="68">
      As a numerical example, we assume  OMEGA 'a=27.2 (degree)  (based on a desired scannable object size, as described below) and  OMEGA '2=0.6 (degree) . Thus,  OMEGA '1 is determined to be 0.82 (degree)  by equation (5).
      <br/>
      Further, assuming a drive amount  DELTA  THETA =1 (degree) , the ratio d/r is determined to be 2.2 from the equation (6).
      <br/>
      Thus, by arranging the driving member 80 and the mirror holder 20 so as to satisfy d/r=2.2, the intervals of the scanning lines at the center and at the periphery of the scanning range will be substantially the same.
    </p>
    <p num="69">
      The above described drive method may be compared to a situation in which the scanning mirror 2 is driven in 1 (degree)  steps about the axis thereof.
      <br/>
      FIG. 12 shows the change in the interval between scanning lines when the driving member 80 is rotated by 1 (degree)  steps (solid line), i.e., using the method of the embodiment as compared to the case in which the scanning mirror 2 is directly rotated by 1 (degree)  steps (dotted line).
    </p>
    <p num="70">In the embodiment, the interval between scanning lines is in a range from 6.86 mm up to 6.76 mm. On the other hand, in the case in which the scanning mirror 2 is directly rotated, the interval between scanning lines ranges between 14.68 mm to 8.13 mm. Thus, in the embodiment, the intervals of the scanning lines at the center and at the periphery of the object surface are substantially the same.</p>
    <p num="71">The setting of the scanning range of the scanning mirror 2 is now described.</p>
    <p num="72">
      FIG. 13 is a schematic view showing the relationship between a maximum scanning angle  OMEGA 'a and a position of the scanning line Ya.
      <br/>
      The relationship is defined as follows:
      <br/>
      OMEGA 'a=arc tan(Ya/L)  (7),
    </p>
    <p num="73">where L is a distance between the object O and the scanning mirror 2.</p>
    <p num="74">
      In the embodiment, as a numerical example, a desired object size in the auxiliary scanning direction is Ya=120 mm at L=23 cm.
      <br/>
      Thus, from equation (7) the scanning angle  OMEGA 'a of the scanning line is set to 27.2 (degree) . From equation (2), the rotating angle  OMEGA a of the scanning mirror 2 is determined to be 13.6 (degree) . Further, by solving equation (1) for  THETA , equation (8) is obtained:
      <br/>
      THETA =arc sin(d/r sin  OMEGA )- OMEGA   (8),
    </p>
    <p num="75">and the rotating angle  THETA a of the driving member 80 is determined to be 17.5 (degree) .</p>
    <p num="76">
      However, since in the scanner 1, the finder system 150 and the imaging optical system 1a are separate, the scanner 1 is further arranged to compensate for parallax by adjusting a start of scanning position Xs based on a distance to the object O, as described below.
      <br/>
      Thus, although the scanning range will remain constant, the operating range of the scanning mirror 2 must be set somewhat larger to allow for this compensation.
      <br/>
      In particular, the scanning range is shifted within the operating range such that the scanning range at the finder side of the reference scanning position ("finder-side scanning range") is larger than the scanning range at the lens side of the reference scanning position ("lens-side scanning range").
      <br/>
      In the embodiment, when L=23 cm (i.e., the minimum object distance) the finder-side scanning range must be set to 147 mm in order to compensate for parallax.
      <br/>
      Thus, using the following equation (9):
      <br/>
      OMEGA 'h=arc tan(Yh/L)  (9),
    </p>
    <p num="77">the finder-side scanning angle  OMEGA 'h at the is 32.3 (degree)  and further, since the scanning range is constant at 54.4 (degree) , the lens-side scanning angle  OMEGA 'k in the is set to -22.1 (degree) . Accordingly, the rotating angle of the driving member 80 in the finder side  THETA h is 21.5 (degree)  and the rotating angle of the driving member 80 in the lens side  THETA k is -14.5 (degree) .</p>
    <p num="78">
      The setting of the scanning mirror 2 at the mirror home position is now described.
      <br/>
      Since the rotation of the driving member 80 is controlled by the scanning motor 70 using "open-loop" control, it is necessary to set the scanning mirror 2 at the home position accurately.
      <br/>
      As shown in FIG. 7, a positioning sensor 204 is provided to allow the scanning mirror 2 to be accurately positioned at the home position.
      <br/>
      The positioning sensor 204 is, for example, a transmission type photo sensor which is arranged to turn OFF when interrupted by a shutter plate 85 provided to the driving member 80.
    </p>
    <p num="79">
      The positioning sensor 204 is positioned such that when the angle of the scanning mirror 2 with respect to the X-axis is significantly less than 45 (degree)  as shown in FIG. 9 (i.e., the finder-side scanning range), the shutter plate 85 interrupts the positioning sensor 204 and the positioning sensor 204 is OFF.
      <br/>
      Also, when the angle of the scanning mirror 2 with respect to the X-axis is substantially greater than 45 (degree)  (the lens-side scanning range) as shown in FIG. 10, the shutter plate 85 moves out from the positioning sensor 204, which turns the positioning sensor 204 ON.
      <br/>
      In particular, the positioning sensor 204 is positioned such that the transition between the OFF to ON states occurs just prior to the reference scanning position as the scanning mirror 2 moves from the finder side of the reference scanning position.
    </p>
    <p num="80">
      As explained in more detail below, the scanning mirror 2 is set accurately at the home position by counting a predetermined center correction pulse Xc after the positioning sensor 204 turns ON.
      <br/>
      In manufacturing the scanner 1, the center correction pulse Xc is determined for each scanner 1 depending on particular characteristics such as the assembled position of the positioning sensor 204.
    </p>
    <p num="81">Color Filter Unit</p>
    <p num="82">
      As shown in FIG. 10, when the driving member 80 rotates to the end of the rotating area for scanning, the second sector gear 83 of the driving member 80 moves into engagement with a transmission gear 91 for switching the color filter unit 4.
      <br/>
      FIG. 14 is a sectional view of the scanner 1 taken along a line XIV--XIV of FIG. 4.
      <br/>
      As shown in FIG. 14, the transmission gear 91 is rotatably supported by a shaft 92 provided on the support frame 130.
      <br/>
      A filter drive gear 93 is also rotatably supported by the shaft 92, with a one-way clutch 94 interposed between the filter drive gear 93 and the transmission gear 91.
      <br/>
      The one-way clutch 94 transmits only the counterclockwise rotation (in the view of FIG. 10) of the transmission gear 91 to the filter drive gear 93.
    </p>
    <p num="83">
      FIG. 15 shows the color filter unit.
      <br/>
      The filter holder 40 includes a rotation shaft 45, a disk 48 provided to the rotation shaft 45, and a filter holding portion 46 provided on the disk 48.
      <br/>
      The filter holding portion 46 holds the four color filters 4a, 4b, 4c and 4d radially and equally displaced at 90 (degree)  apart on the disk 48.
      <br/>
      The rotation shaft 45 is provided with a filter gear 95 to be driven by the filter drive gear 93.
    </p>
    <p num="84">
      The rotation shaft 45 is provided with a cut-away portion 45a.
      <br/>
      The upper end 45b of the cut-away portion 45a is perpendicular to the axis of the rotation shaft 45.
      <br/>
      The filter gear 95 is provided with a D-shaped hole 95a.
      <br/>
      The filter gear 95 is fixed to the bottom end of the shaft 45 in such a manner that the shaft 45 is inserted into the D-shaped hole 95a so that the upper end of the filter gear 95 abuts the upper end 45b of the cut-away portion 45a.
      <br/>
      Thus, since the filter driving gear 93 and the filter gear 95 are helical gears, the filter gear 95 transmits a thrust force (particularly an upward force) to the shaft 45 as well as a rotational force.
    </p>
    <p num="85">
      Four projections 49 are provided on the bottom surface of the disk 48, which protrude downward and are equally spaced at 90 (degree)  around the disk 48.
      <br/>
      A bottom plate 125 of the housing 120 (FIG. 12) has a center hole 126 to which the shaft 45 fits and four holes 127 to which the four projections 49 fit, respectively.
    </p>
    <p num="86">The upper end of the shaft 45 is provided with a coil spring 43 which abuts a top plate 128 of the housing 120 (FIG. 14) and biases the filter holder 40 downward.</p>
    <p num="87">
      As constructed above, when the filter driving gear 93 rotates counterclockwise (as shown by a CCW arrow), the filter gear 95 rotates clockwise.
      <br/>
      Since the filter driving gear 93 and the filter gear 95 are helical gears, the engagement of the filter driving gear 93 and the filter gear 95 causes the filter gear 95 to move upward such that the rotation shaft 45 also moves upward and the projections 49 are released from the holes 127, which makes the rotation shaft 45 rotatable in the center hole 126.
      <br/>
      Thus, the filter holder 40 rotates clockwise.
      <br/>
      The driving member 80 is arranged such that the filter gear 95 rotates 90 (degree)  and stops and, thus, after rotating 90 (degree) , the thrust force stops and the filter holder 40 moves down by the force of the spring 43, so that the projections 49 engage the holes 127 again.
      <br/>
      Thus, the filter holder 40 is held in place until the next rotation of the filter driving gear 93.
      <br/>
      Further, since the projections 49 are rounded, even if the rotation is not exactly 90 (degree) , the projections 49 will slide into the holes 127 to position the filter holder 40 precisely.
    </p>
    <p num="88">The switching of the color filter unit 4 is performed by the rotation of the driving member 80 between states shown in FIGS. 10 and 16. As an example, in the case where the colorless filter 4a is positioned in the light path between the scanning mirror 2 and the image sensor 16, the rotation of the filter holder 40 moves the colorless filter 4a to be replaced by the red filter 4b.</p>
    <p num="89">
      As constructed above, the switching of the color filter 4 and the scanning of the scanning mirror 2 are performed by the same drive source (the scanning motor 70).
      <br/>
      Further, the structure for stopping the rotation of the filter holder 40 is simple and inexpensive.
    </p>
    <p num="90">
      In order to allow the identification of which of the filters 4a, 4b, 4c, and 4d is positioned in the light path between the scanning mirror 2 and the image sensor 16, a filter sensor 205 (e.g., a reflection type photo-sensor) is provided to the support frame 130 (FIG. 14), which detects a hole 96 formed on the filter gear 95.
      <br/>
      When the hole 96 is on the filter sensor 205, the colorless filter 4a is positioned between the scanning mirror 2 and the image sensor 16.
    </p>
    <p num="91">Lens Driving Mechanism</p>
    <p num="92">
      As shown in FIG. 6, the cylindrical portion 121 of the housing 120 is provided with a groove 121a extending along the X-axis direction.
      <br/>
      The lens barrel 30 has a first arm 32 extending through the groove 121a to the exterior of the cylindrical portion 121.
      <br/>
      As shown in FIG. 4, the lens barrel 30 is further provided with a second arm 33, which is parallel to the first arm 32.
      <br/>
      A guide bar 35 is provided to guide the lens barrel 30 along the X-axis.
      <br/>
      The guide bar 35 is inserted through through-holes 32a and 33a provided to the first and second arms 32 and 33, respectively.
    </p>
    <p num="93">
      FIG. 17 is a sectional view of the scanner 1 taken along a line XVII--XVII of FIG. 4.
      <br/>
      An upright frame 132 is provided on the motor frame 135, to which a lens driving motor 60 (which is a stepping motor) is secured.
      <br/>
      A screw gear 63 is fixed to an output shaft 61 of the lens driving motor 60.
      <br/>
      The screw gear 63 engages a nut 31 provided to the first arm 32.
      <br/>
      Thus, the rotation of the driving motor 60 moves the lens barrel 30 along the X-axis.
      <br/>
      In this embodiment, the stroke of the lens barrel 30 is 6 mm.
    </p>
    <p num="94">
      FIG. 18A is a plan view of the lens barrel 30 and the lens barrel driving mechanism.
      <br/>
      In order to smoothly move the lens barrel 30, a predetermined clearance is provided between the lens barrel 30 and the cylindrical portion 121 and also between the guide bar 35 and the hole 32a and between the guide bar 35 and the hole 33a.
    </p>
    <p num="95">
      However, in order to ensure that the lens barrel 30 does not incline in the Y-axis direction (i.e., the main-scanning direction), in the embodiment, the lens barrel 30 is biased to incline in the X-axis direction.
      <br/>
      Thus, a coil spring 64 is provided around the screw 63, between the upright frame 132 and the first arm 32.
      <br/>
      As shown in more detail in FIG. 18B, the coil spring 64 is attached to the first arm 32 at a fixing point W. As shown in FIG. 18C, the fixing point W and the center of the guide bar 35 are aligned in a plane parallel to the X-axis and perpendicular to the Y-axis, such that the coil spring 64 biases the first arm 32 to rotate in the plane of the X-axis, about the Y-axis as shown by the arrow M of FIG. 18B. In particular, as shown in FIG. 18A, a fulcrum F of the rotation of the lens barrel 30 is located between principal points P1 and P2 of the imaging lens 3.
    </p>
    <p num="96">
      As constructed above, since the lens barrel 30 is biased to incline in the X-axis direction, inclination of the lens barrel 30 in the main scanning direction (Y-axis direction) is prevented.
      <br/>
      Further, backlash of the motor 60, screw 63 and the nut 64 can be eliminated.
    </p>
    <p num="97">
      In order to set the lens barrel 30 at the lens home position, the first arm is provided with a shutter plate 36.
      <br/>
      When the lens barrel 30 moves to the closest position to the scanning mirror 2, the shutter plate 36 is detected by a lens sensor 203 provided on a pillar 138 provided on the support frame 130.
      <br/>
      The closest position of the lens barrel with respect to the scanning mirror 2 is defined as a lens home position of the lens barrel.
    </p>
    <p num="98">Projecting Unit</p>
    <p num="99">
      As shown in FIG. 1, the projecting unit 11 is provided adjacent to the imaging lens 3 for projecting the contrast pattern P onto the object O in order to give additional contrast to the object O. As explained in briefly above, and in more detail below, in order to focus the object O, the scanner 1 is arranged to detect the contrast of the object O using data from the image sensor 16.
      <br/>
      Since the projecting unit 11 provides additional contrast to the object O, it is even possible to focus on an white object O or on an object O on a white surface or any other surface having little contrast.
    </p>
    <p num="100">
      The projecting unit 11 includes an LED 11a which emits light having a striped contrast pattern P and a lens 11b which projects the striped contrast pattern P onto the object O via the scanning mirror 2.
      <br/>
      As shown in FIGS. 3 and 6, the projecting unit 11 is provided in the housing 120 and projects the contrast pattern P through the window 12 via the scanning mirror 2.
    </p>
    <p num="101">Electrical Structure</p>
    <p num="102">
      FIG. 19 is a block diagram showing electrical systems for the scanner 1 and the remote control device 5.
      <br/>
      Note that FIG. 19 does not show electrical connections through which power is supplied to elements other than the CPU 301.
      <br/>
      The electrical system of the scanner 1 will be described first.
    </p>
    <p num="103">
      The electrical system of the scanner 1 includes a scanner control circuit 300 that is provided with power, either through the power switch 310 or from the battery 210.
      <br/>
      The electrical system also includes several input elements that provide input to the control circuit 300.
      <br/>
      The input elements include the image sensor 16, the lens sensor 203, the positioning sensor 204, the filter sensor 205, the first and second LED sensors 201 and 202, and the remote control sensor 311.
    </p>
    <p num="104">
      The electrical system in the scanner body further includes several output elements that receive output from the control circuit 300.
      <br/>
      The output elements include the LCD panel 152, the scanning motor 70, the lens driving motor 60, and the projecting unit 11.
    </p>
    <p num="105">The electrical system also includes a memory slot 230 into which a memory card 220 (see FIG. 2) may be inserted for connection to the control circuit 300 and an output port 231 to which an external device (not shown), such as a personal computer or the like, may be attached for connection to the control circuit 300.</p>
    <p num="106">
      The control circuit 300 includes a CPU 301 and an address/data bus (shown as a thick line in FIG. 19).
      <br/>
      The address/data bus connects the CPU 301 to a program memory 341, an internal memory 340, a CCD processing circuit 320, an LCD driving circuit 334, and to the memory slot 230 and the output port 231.
      <br/>
      The control circuit 300 also includes a CCD driver 331, a first motor driver 332, and a second motor driver 333.
    </p>
    <p num="107">All of the input elements except the image sensor 16 provide input directly to the CPU 301 which, according to a program stored in the program memory 341, controls the CCD driver 331 to drive the image sensor 16, the first motor driver 332 to drive the scanning motor 70, the second motor driver 333 to drive the lens driving motor 60, and the LCD driver 334 to drive the LCD panel 152 based on data input from the input elements.</p>
    <p num="108">
      Generally, image signals input from the image sensor 16 are processed by the CCD signal processing circuit 320, transferred through the address/data bus, and stored in the internal memory 340 as a digital image.
      <br/>
      The digital image may then be provided as output to the memory card 220 through the memory slot 230 or to an external device through the output port 231.
      <br/>
      For example, when the scanner 1 is used in a stand-alone mode, digital images may be captured and recorded on the memory card 220, while when the scanner 1 is operated while connected to a personal computer, digital images may be directly provided as output from the internal memory 340 to the personal computer and recorded in the personal computer memory.
      <br/>
      Further, if a printer driver is provided in the scanner 1, digital images may be directly provided as output from the internal memory 340 to a printer (not shown).
    </p>
    <p num="109">The electrical system of the remote control device 5 includes the switch group 350 and an LED drive circuit 352 that drives an infrared LED 351 mounted on the transmission part 56 (shown in FIG. 2) according to signals input from each switch of the switch group 350.</p>
    <p num="110">CCD Signal Processing Circuit</p>
    <p num="111">
      FIG. 20 is a block diagram showing the CCD signal processing circuit 320 that processes image data signals output by the image sensor 16.
      <br/>
      An image data signal from the image sensor 16 is clamped based on a clamp pulse from the CCD driver 331 which operates clamping switch 321 to fix a standard voltage level of the image data signal and is amplified by a buffer amplifier 322.
      <br/>
      The output signal from the buffer amplifier 322 is held in a capacitor C as an analog data signal according to operation of a hold switch 323 by a sample-hold pulse and is provided as input to a multiplier 324.
      <br/>
      The sample-hold pulse is generated in synchronization with the sequential reading of data from each pixel (transmission timing of the accumulated voltage).
    </p>
    <p num="112">
      The multiplier 324 compensates for any change in the signal intensity due to shading by multiplying the image data by a predetermined coefficient for each pixel or group of pixels depending on a distance from the center pixel (i.e., an image height).
      <br/>
      Additional shading compensation to compensate for shading due to changes in magnification for each scanning line is also performed, as described below with reference to FIG. 32. In operation, a counter 327 counts a number of pulses output from the CCD driver 331 according to the transmission of each pixel and the counted number is used to read a correction coefficient from a shading RAM 326.
      <br/>
      The predetermined correction coefficients are stored digitally in the shading RAM 326 and thus a D/A converter 328 is provided to convert the digital correction coefficients to analog correction coefficients before being input to the multiplier 324.
      <br/>
      The multiplier 324 outputs corrected image data as a product of the image data and the correction coefficient, and then an A/D converter 325 converts the corrected image data into digital image data that is input to the CPU 301.
    </p>
    <p num="113">LCD Panel</p>
    <p num="114">
      As shown in FIG. 21, the LCD panel 152 is provided with first to seventh segment groups 152a to 152g.
      <br/>
      The LCD panel 152 is arranged in the finder system 150 such that segment groups 152a to 152g may be displayed overlapping with an object image displayed in the finder system 150.
      <br/>
      Although FIG. 21 shows a condition when all of the segments in the segment groups 152a to 152g are turned ON for the purposes of description, in actual use, particular segments will only turn ON as required or set.
    </p>
    <p num="115">
      For example, the first segment group 152a is for indicating information related to power supply.
      <br/>
      The first segment group 152a includes the segments "pow", which is displayed when the power is turned ON (i.e., power switch 310 is turned ON), and the segment "batt", which is displayed when the voltage of the battery 210 is lower than a predetermined level.
      <br/>
      The second to seventh segment groups 152b-152h show information that corresponds to the mode set by operation of the remote control device 5.
      <br/>
      The segments displayed at each of the segment groups 152b-152h is described below.
    </p>
    <p num="116">Scanning Motor Pulses</p>
    <p num="117">
      In the following description, as noted above, a mirror home position of the scanning mirror 2 is defined as the position where the optical axis of the imaging lens 3 and the optical axis as deflected by the scanning mirror 2 form a right angle.
      <br/>
      Note that, at the home position, the optical axis of the imaging lens 3 is parallel to the optical axis of the finder system 150.
    </p>
    <p num="118">Further, "forward" rotation of the scanning motor 70. moves the scanning mirror 2 in a direction from a start position to an end position and "reverse" rotation of the scanning motor 70 moves the scanning mirror 2 in a direction from the end position to the start position.</p>
    <p num="119">
      FIG. 22 shows a relationship between driving pulses of the scanning motor 70 and positions of the scanning mirror 2.
      <br/>
      Thus, each position of the scanning mirror 2 may be defined as a pulse number counted from the mirror home position.
    </p>
    <p num="120">
      The scanning mirror 2 is designed to rotate within a predetermined mechanical range; however, in operation, the scanning mirror 2 is actually controlled to rotate within a narrower operating range.
      <br/>
      As mentioned above, the scanning motor 70 is also used for switching the filter 4, and as such, the operating range of the scanning mirror 2 includes a scanning range for capturing an image and a filter switching range.
      <br/>
      The scanning range is defined between a start position and an end position and, as described below, the scanning range may be adjusted within the operating range to compensate for parallax.
      <br/>
      The filter switching range is defined as a range between the end position and a filter switching completion position.
    </p>
    <p num="121">As the scanning motor 70 is driven between the end position for capturing an image and a completed position for filter switching, the filter holder 40 rotates by 90 degrees and a subsequent filter is positioned in the optical path between the imaging lens 3 and the image sensor 16.</p>
    <p num="122">
      As described above, the scanning mirror 2 is positioned at the mirror home position using the positioning sensor 204.
      <br/>
      Referring to FIG. 22, the positioning sensor 204 turns OFF when the scanning mirror 2 is positioned at the start position side of the reference scanning position R, and the positioning sensor 204 turns ON when the scanning mirror 2 is positioned at the end position side of the reference scanning position R. The positioning sensor 204 is positioned such that the switching point of the positioning sensor 204 is offset from the home position of the scanning mirror 2 to the start position side of the scanning range by the center correction pulse Xc.
      <br/>
      That is, the scanning mirror 2 is set at the home position when the scanning motor 70 rotates in the forward direction by a number of pulses equal to the center correction pulse Xc after the positioning sensor 204 turns ON.
      <br/>
      The center correction pulse Xc is determined for each scanner 1 in order to compensate for errors in positioning of the positioning sensor 204 and the like.
      <br/>
      For the current example, an average center correction pulse Xc is about 15.
      <br/>
      In particular, the position of the positioning sensor 204 is set such that the center correction pulse Xc is always a positive value.
      <br/>
      That is, the home position of the scanning mirror 2 is always located at the end position side of the scanning range with respect to the switching position of the positioning sensor 204.
      <br/>
      Thus, the scanning mirror 2 can be accurately set at the home position and, since the rotation of the scanning mirror 2 is based on the home position, the scanning range is also accurately set.
    </p>
    <p num="123">
      In particular, the start position of the scanning range is defined by driving the scanning motor 70 in the reverse direction by a start position pulse Xs from the home position of the scanning mirror 2.
      <br/>
      The start position pulse Xs is determined based on a distance to the object O in order to compensate for parallax with respect to the finder system.
      <br/>
      In this example, the start position pulse Xs can take a value between 5740 pulses and 6942 pulses.
      <br/>
      The setting of the start position pulse Xs is described below with reference to the flowcharts.
    </p>
    <p num="124">
      Once the start position has been defined, the end position of the scanning range is a position reached after the scanning mirror 2 is driven by the scanning motor 70 in the forward direction by a scanning pulse Xt from the start position.
      <br/>
      The scanning pulse Xt is a fixed number of pulses of the mirror scanning motor 70 between the start position and the end position of the scanning range.
      <br/>
      The scanning pulse Xt does not vary with respect to individual scanners and/or parallax.
      <br/>
      In this embodiment, the value of the scanning pulse Xt is set to 11480 in order to correspond to the desired size of object O, as described above.
    </p>
    <p num="125">
      Accordingly, in the particular case where the value of the start position pulse Xs is equal to 5740, the scanning range will be symmetrical with respect to the home position of the scanning mirror 2.
      <br/>
      Otherwise, the scanning range at the start position side of the home position (finder-side scanning range) will be larger than the scanning range at the end position side of the home position (lens-side scanning range).
      <br/>
      Within the scanning range defined by the scanning pulse Xt, the image sensor 16 captures an image for every four pulses of the scanning motor 70 such that 2870 image (scanning) lines are captured during scanning.
    </p>
    <p num="126">
      In order to define the filter switching range, a first filter switching pulse Xf1 defines a number of pulses to rotate the scanning mirror 2 from the home position to a filter switching completion position (that is, the end position of the filter switching range).
      <br/>
      Further, a second filter switching pulse Xf2 defines a number of pulses to rotate the scanning mirror 2 from the end position of the scanning range to the filter switching completion position.
      <br/>
      The first filter switching pulse Xf1 is a constant (8000 pulses, in this example) and the value of the second filter switching pulse Xf2 is calculated using (Xs-3480), thus Xf2 varies between 3500 and 4702 pulses depending on the value of the start position pulse Xs.
    </p>
    <p num="127">
      If the rotating position of the scanning mirror 2 is represented by a scanning pulse counter X, as shown in the example of FIG. 22, when the value of the start position pulse Xs is 6942, representing the case where the imaging lens is located at the closest position to the scanning mirror 2, the value of the scanning pulse counter X will be equal to 6942 at the start position and will be -4538 at the end position of the scanning range.
      <br/>
      The value of the scanning pulse counter X will be equal to -8000 at the completed position for filter swithching.
    </p>
    <p num="128">Lens Driving Motor Pulses</p>
    <p num="129">
      FIG. 23 shows a relationship between driving pulses of the lens driving motor 60 and the position of the imaging lens 3.
      <br/>
      The imaging lens 3 moves between a near side (i.e., close to the scanning mirror 2) and a far side (i.e., away from the scanning mirror 2 and close to the image sensor 16).
      <br/>
      The imaging lens 3 has a stroke of 6 mm and 480 pulses are required for moving the imaging lens 3 through the stroke.
      <br/>
      Accordingly, the imaging lens 3 moves 12.5  MU m for each pulse.
      <br/>
      A "forward" direction is defined as a rotation of the lens driving motor 60 to move the imaging lens 3 toward the near side, and a "reverse" direction is defined as a rotation to move the imaging lens 3 toward the far side.
    </p>
    <p num="130">
      A home position of the imaging lens 3 is defined as a position where the imaging lens 3 forms an in-focus image of an object that is located at 23 cm from the scanner 1 onto the image sensor 16.
      <br/>
      The position of the imaging lens 3 is represented by a lens position counter Paf.
      <br/>
      The value of the lens position counter Paf is set to 460 at the home position and is decreased by one for every driving pulse of the lens driving motor 60, and will be 0 at the far side.
    </p>
    <p num="131">
      The lens home position of the imaging lens 3 is determined by rotating the lens driving motor 60 by a lens home position correcting pulse Phc from the switching position of the lens sensor 203.
      <br/>
      That is, the lens driving motor 60 rotates in reverse by the lens home position correcting pulse Phc after the output of the lens sensor 203 changes from OFF to ON in order to position the imaging lens 3 at the lens home position.
      <br/>
      The lens home position correcting pulse Phc is set for each scanner to compensate for differences in individual scanners.
      <br/>
      With this construction, the lens home position of the imaging lens 3 can be accurately determined even if the arrangement of the lens sensor 203 or the shutter plate 36 is different in individual scanners.
    </p>
    <p num="132">Flowcharts</p>
    <p num="133">
      The functions of the control circuit 300 (i.e., the CPU 301 operating according to the program stored in the program memory 341) provided in the scanner 1 are now described with reference to the flowcharts in FIGS. 24 through 32.
      <br/>
      In the description below, each step in a flowchart is represented by "S" plus a reference number and, thus, the word "step" has been omitted.
    </p>
    <p num="134">Main Process</p>
    <p num="135">
      As the main switch 310 of the scanner body 1 is turned ON, the scanner 1 is controlled in accordance with the main process shown in FIG. 24. At S001 of the main process, an initializing process is executed.
      <br/>
      The initialization process is described below with reference to FIGS. 25 and 26; however, generally, the scanning mirror 2 is set at the mirror home position, the colorless filter 4a is set in the optical path, and the imaging lens 3 is set at the lens home position.
    </p>
    <p num="136">
      After the initializing process at S001, the CPU checks the mode button 53 on the remote control device 5.
      <br/>
      If the CPU detects that the mode button 53 has turned from OFF to ON, a mode setting process shown in FIG. 27 is executed at S005.
      <br/>
      If the mode button 53 has not turned from OFF to ON, the mode setting process of S005 is skipped.
    </p>
    <p num="137">
      At steps S007 through S013, the CPU determines the conditions of the up/tele button 54 and the down/wide button 55.
      <br/>
      If the up/tele button 54 is turned from OFF to ON (Yes at S007), the capture area is reduced at S009.
      <br/>
      If the down/wide button 55 is turned from OFF to ON (Yes at S011), the capture area is enlarged at S013.
    </p>
    <p num="138">
      The scanner 1 according to the embodiment includes three capture areas that may be selected using the up/tele button 54 and the down/wide button 55.
      <br/>
      The capture areas are defined by changing the number of effective pixels of the image sensor 16 in the main scanning direction and the width of the scanning range in the auxiliary scanning direction.
      <br/>
      The number of pixels in a two dimensional image is determined by the product of the effective pixels of the image sensor 16 and the number of scanning lines.
      <br/>
      In this embodiment, the largest size image includes 6 million pixels, the middle size image includes 2 million pixels and the smallest size image includes half a million pixels.
    </p>
    <p num="139">
      The selected capture area is displayed on the LCD panel 152 by the second segment group 152b.
      <br/>
      The second segment group 152b indicates one of three rectangular areas representing the capture area selected by the operation of the buttons 54 and 55.
      <br/>
      Each rectangular area is defined by four L-shaped segments that are positioned at each of four corners of the rectangular area.
      <br/>
      The method of changing the capture area is known and is not described further.
    </p>
    <p num="140">
      At S015, the CPU determines whether the start button 51 is turned from OFF to ON.
      <br/>
      If the start button 51 remains OFF, the CPU repeats the processes of S003 through S013.
      <br/>
      When the start button 51 is turned ON (Yes at S015), the CPU checks the signal from the remote control sensor 311 at S017.
      <br/>
      If the remote control sensor 311 outputs an ON signal, that is, if the remote control device 5 is attached to the scanner body, at S019 the CPU 301 transfers image data from the memory card loaded in the memory slot 230 or from the inner memory 340 to an external device such as a computer connected to the output connector 231.
    </p>
    <p num="141">
      If the remote control sensor 311 outputs an OFF signal (Yes at S017), that is, if the remote control device 5 is separated from the device body, the CPU 301 executes a focusing process (FIGS. 28 and 29) at S021, a photometering process (FIG. 30) at S023 and a capturing process (FIGS. 31 and 32) at S025.
      <br/>
      Generally, the focusing process is to move the imaging lens 3 to an in-focus position with respect to the object O. The photometering process is to detect a brightness of the object O and to determine whether the object O is against a white background or a black background.
      <br/>
      The capturing process is to capture an image of the object O by scanning the object O using settings determined in the focusing and photometering processes.
      <br/>
      If the capturing process is completed normally, the CPU repeats the processes from S001.
    </p>
    <p num="142">Initializing Process</p>
    <p num="143">FIGS. 25 and 26 show the initializing process that is executed at S001 in the main process.</p>
    <p num="144">
      At S101 of the initializing process, the filter counter FC, the mode counter MC and the lens pulse counter Paf are reset to "0".
      <br/>
      At S103 through S127, the CPU controls the scanning motor 70 to set the scanning mirror 2 at the mirror home position and the colorless filter 4a in the optical path.
      <br/>
      At S129 through S149 in FIG. 26, the imaging lens 3 is positioned at the lens home position.
    </p>
    <p num="145">
      At S103, if the scanning mirror 2 is positioned in the range where the positioning sensor 204 is OFF (Yes at S103), the scanning motor 70 is driven in the forward direction at S109.
      <br/>
      However, if the scanning mirror 2 is positioned in the range where the positioning sensor 204 is ON (No at S103), the scanning motor 70 is first driven in the reverse direction (S105) until the positioning sensor 204 turns OFF (S107) before the scanning motor 70 is driven in the forward direction at S109.
      <br/>
      According to these steps, the CPU 301 detects a switching point where the signal from the positioning sensor 204 changes from OFF to ON.
      <br/>
      This process is performed because it is necessary to accurately set the scanning mirror 2 at the home position, in particular, as described above, the scanning mirror 2 is set at the home position after being driven by the scanning motor 70 in the forward direction by the center correction pulse Xc from the OFF to ON switching point of the positioning sensor 204.
    </p>
    <p num="146">
      At S111, the CPU determines if the positioning sensor 204 has turned ON during the forward rotation of the scanning motor 70.
      <br/>
      After the positioning sensor 204 turns ON the scanning pulse counter X starts to count at S113.
      <br/>
      The counter X increases in response to each driving pulse of the scanning motor 70.
      <br/>
      If, at S115, the signal from the filter sensor 205 is OFF, that is, the colorless filter 4a is positioned in the optical path, the CPU 301 waits until the value of the scanning pulse counter X is equal to the center correction pulse Xc (S117) and then stops the scanning motor 70 (S119).
    </p>
    <p num="147">
      If the signal from the filter sensor 205 is ON (No at S115), the CPU checks whether the filter counter FC is smaller than 3 at S121.
      <br/>
      If the filter counter FC is smaller than 3, the scanning motor 70 is driven in the forward direction until the scanning pulse counter X is equal to the first filter switching pulse Xf1, and then the filter counter FC increases by one (S123 to S127).
      <br/>
      This operation rotates the filter holder by 90 degrees and the filter is switched to a next filter.
      <br/>
      After switching the filter, the CPU repeats the process from S103.
      <br/>
      The processes of S103 to S115 and S123 to S127 are repeated until the signal from the filter sensor 205 turns OFF.
      <br/>
      However, if the signal from the filter sensor 205 is not OFF even after the filter counter FC is equal to or larger than 3 (No at S121), the CPU executes an error process assuming that an error has occurred.
      <br/>
      That is, since there are four filters 4a, 4b, 4c, 4d on the filter holder 40, in a normal condition the signal of the filter sensor 205 must turn OFF before the filter holder 40 has been switched four times.
    </p>
    <p num="148">
      Continuing from S119 of FIG. 25, at S129 of FIG. 26, if the imaging lens 3 is positioned in the range where the signal from the lens sensor 203 is OFF (No at S129), the lens driving motor 60 is driven in the reverse direction at S139.
      <br/>
      However, if the imaging lens 3 is positioned in the range where the signal from the lens sensor 203 is ON (Yes at S129), the lens driving motor 60 is first driven in the forward direction (S131) and the CPU waits for the lens sensor 203 to turn OFF (S133).
      <br/>
      After the lens sensor 203 turns OFF (Yes at S133), the lens driving motor 60 is driven by an additional three pulses in the forward direction (S135 and S137) and then the lens driving motor 60 is driven in the reverse direction at S139.
    </p>
    <p num="149">
      The CPU 301 waits until the lens sensor 203 turns ON during the reverse rotation of the lens driving motor 60 (S141) and then the lens pulse counter Paf is set to zero and increases in response to each driving pulse of the lens driving motor 60 (S143).
      <br/>
      The lens driving motor 60 is stopped when the value of the lens pulse counter Paf is equal to the home position correcting pulse Phc (S145 and S146).
      <br/>
      The imaging lens 3 is thus positioned at the lens home position and the home position count, i.e., "460", is then set to the lens pulse counter Paf (S149).
    </p>
    <p num="150">
      According to these steps, the CPU detects a switching point where the signal from the lens sensor 203 changes from OFF to ON in order to accurately set the imaging lens 3 at the lens home position.
      <br/>
      As described above, the imaging lens 3 is set at the lens home position by driving the lens driving motor 60 in the reverse direction by the home position correcting pulse Phc from the switching point of the lens sensor 203.
    </p>
    <p num="151">The initialization process then ends and control returns to the main process of FIG. 24.</p>
    <p num="152">Mode Setting Process</p>
    <p num="153">
      FIG. 27 shows the mode setting process executed in S005 in the main flowchart.
      <br/>
      The segment groups 152c-152h on the LCD panel 152 will also be described.
      <br/>
      In the mode setting process, settings of each of five items may be adjusted depending on a value of the mode counter MC.
      <br/>
      The detailed procedure for the setting of each of the items is not shown in the flowchart.
    </p>
    <p num="154">
      As described above, the mode counter MC is set to "0" at S101 of the initializing process, such that when the CPU detects that the mode button 53 turns from OFF to ON (i.e., when the mode button 53 is pushed) at S003 of the main process, the mode counter MC is first set to "1" at S201.
      <br/>
      In the mode setting process, the mode counter MC increases by one (S207) each time the CPU detects that the mode button 53 is pushed (S203).
      <br/>
      If the mode button 53 is pushed (Yes at S203) and the mode counter MC is equal to "5" (No at S205), the mode counter MC is reset to "0" (S209) and the CPU returns to the process of the main flowchart.
    </p>
    <p num="155">
      If the mode counter MC is set to "1" (Yes at S211), a process for selecting gradation of image data is performed (213).
      <br/>
      At S213, "1-bit data", "1-bit data (reversed)" and "8-bit data" can be selected by operation of the up/tele button 54 and down/wide button 55.
      <br/>
      The third segment group 152c of the LCD panel 152 displays the setting of the gradation of image data.
      <br/>
      A left segment (white filled and not shaded) of the third segment group 152c turns ON when the image data is to be output as 1-bit data, a center segment (white filled with shade) turns ON when the image data is to be output as 1-bit data (reversed), and a right segment (black filled) turns ON when the image data is to be output as 8-bit data.
    </p>
    <p num="156">
      If the mode counter MC is set at "2", a process for selecting a CCD charging period is performed (S215, S217).
      <br/>
      At S217, one of 4 manual settings (i.e., four predetermined charging periods for the image sensor 16) or an automatic setting can be selected by operation of the up/tele button 54 and down/wide button 55.
      <br/>
      The selection of charging period is similar to an exposure compensation procedure in a film camera.
      <br/>
      The fourth segment group 152d of the LCD panel 152 consists of four black filled segments and a segment for indicating the word auto.
      <br/>
      When the charging period is manually set, at least one segment of the four black filled segments turns ON.
      <br/>
      The number of ON segments represents the manually adjusted charging period.
      <br/>
      When the charging period is to be set automatically, the segment "auto" turns ON.
    </p>
    <p num="157">
      If the mode counter MC is set to "3", a process for inputting an image data title is performed (S219, S221).
      <br/>
      The image data title may include alphabetic characters and/or numerical characters.
      <br/>
      For example, if the fifth segment group 152e includes three characters, a cursor is positioned at a first character and a user may cycle through the available letters and numbers in ascending order, i.e., A, B, C, etc., by pressing the up/tele button 54 and in descending order, i.e., C, B, A, etc., by pressing the down/wide button 55.
      <br/>
      Then, when the stop/delete button 52 is operated, the selected character is fixed and the cursor moves to the next character.
      <br/>
      The process is repeated and then when the stop/delete button 52 is operated when the cursor is positioned at the third character, the cursor moves back to the first character.
      <br/>
      All of the characters, i.e., the title, is fixed when the mode button 53 is operated.
    </p>
    <p num="158">
      If the mode counter MC is set at "4", a process for handling captured image data is performed (S223, S225).
      <br/>
      At S225, a setting concerning the handling of image data stored in the internal memory 340 is changed when the up/tele button 54 or the down/wide button 55 are operated.
      <br/>
      In this mode, "delete" or "send" can be selected as the setting for the image data. "Delete" means that the image data will be deleted from the internal memory 340 and "send" means that the image data will be transmitted from the inner memory to the memory card 220 or an external device.
      <br/>
      After the data handling mode is selected, the image data is deleted or sent accordingly when the start switch 51 is operated.
      <br/>
      The sixth segment group 152f on the LCD panel 152 indicates the setting and displays "del" for data deletion mode and "send" for data transmission mode.
    </p>
    <p num="159">
      If the mode counter MC is set to "5", a process for changing between a monochrome capturing mode and a color capturing mode is performed (S227, S229).
      <br/>
      In the monochrome/color selecting process at S229, the CPU 301 toggles between the monochrome capturing mode and the color capturing mode when either the up/tele button 54 or the down/wide button 55 are operated.
      <br/>
      The seventh segment group 152g on the LCD panel 152 indicates the setting and displays "mono" in the monochrome capturing mode and "color" in the color capturing mode.
    </p>
    <p num="160">Focusing Process</p>
    <p num="161">
      FIGS. 28 and 29 show a flowchart illustrating the focusing process which is executed at S021 of the main process.
      <br/>
      In the scanner 1, photometry data and focusing data for the object are obtained using the image sensor 16.
      <br/>
      The photometry and the focusing detection are determined in a state when the scanning mirror 2 is located at the home position and a reference scanning line is being read.
      <br/>
      That is, based on the contrast and brightness for the reference scanning line, the focusing condition and the brightness for the entire image of the object O are determined.
    </p>
    <p num="162">
      Generally, when adjusting the focusing condition, the focusing lens 3 is moved from the closest position towards the farthest position step by step while the output of the image sensor 16 is read at each step.
      <br/>
      A difference between a maximum brightness and a minimum brightness is regarded as a contrast for the objective area, and the focusing lens is set at a position which is one step towards the far side with respect to the position at which the contrast is maximum.
      <br/>
      This method is analogous to a conventional contrast method in which two sensors are located at symmetrical positions with respect to the focal point of the focusing lens.
      <br/>
      However, in the above method, contrasts at different lens positions are compared to determine the focused position.
      <br/>
      This method will be referred to as a scanning-contrast method hereinafter.
    </p>
    <p num="163">
      In the focusing process shown in FIGS. 28 and 29, as well as determining the focusing condition, the CPU also determines whether a brightness of the object is appropriate for capturing an image.
      <br/>
      Typically, if the maximum brightness of the object O is less than the a predetermined minimum brightness at which image capture is possible, image capture should be prohibited unless a manual charging period has been set (see the mode setting procedure above).
      <br/>
      Note that, only one measurement may be necessary to determine whether the minimum brightness is available or not.
      <br/>
      In particular, if the minimum brightness is not available due to the environment being too dark, it is appropriate to prohibit image capture.
      <br/>
      However, if the minimum brightness is not available due the object being black, a portion which is sufficiently bright may exist outside of the detected range and, in such a case, it is preferable that the image capture is not prohibited.
      <br/>
      Therefore, in the embodiment, even if the maximum brightness detected by one measurement that is lower than the minimum brightness at which image capturing is possible, the image capturing is not prohibited and a comparison of the maximum and minimum brightness detected at each movement of the focusing lens is executed.
    </p>
    <p num="164">
      When the focusing lens is moved long the optical axis towards the image sensor 16, the magnification changes and the angle of view is broadened, and accordingly, the area of the object formed on the image sensor 16 is widened.
      <br/>
      In this way, an area which might have higher brightness but that is located outside the angle of view when the lens is located at the closer side may be inside the angle of view when the lens is moved towards the image sensor 16.
    </p>
    <p num="165">
      Further, as the focusing lens approaches an in-focus position, the image formed on the image sensor 16 becomes sharper, which may increase the detected value of the maximum brightness.
      <br/>
      In particular, if the object O is black, the detected value of the maximum brightness may change as the lens moves.
      <br/>
      However, if the environment is dark, the detected value of the maximum brightness will not change.
      <br/>
      Therefore, whether or not the maximum brightness changes while the focusing lens is moved is examined, and the CPU 301 determines whether the object is black or the environment is dark.
    </p>
    <p num="166">
      In the embodiment, if the detected value of the maximum brightness exceeds the reference minimum brightness at least once within the movable range of the focusing lens 3, before the in-focus position is detected, image capture is permitted.
      <br/>
      If the maximum brightness does not exceed the reference minimum brightness, image capture is prohibited, except when the a manual charging period has been set (see the mode setting procedure above).
    </p>
    <p num="167">
      In the focusing process shown in FIG. 28, 1000 pixels of the image signal are obtained for examination (S301).
      <br/>
      The 1000-pixel data is selected such that the center pixel along the scanning line is located at the center of the image represented by the 1000-pixel data.
      <br/>
      Note that the electrical charge corresponding to the image incident on the image sensor 16 is accumulated for a predetermined default charge period.
      <br/>
      At this stage, the scanning mirror 2 is located at the home position, and the focusing lens is located at the lens home position (i.e., the position at which the lens is focused on a subject located at the nearest point within the distance range for image capturing).
    </p>
    <p num="168">
      The 1000-pixel data is processed, for example, in order to compensate for dark current, and then. the maximum brightness Bmax and the minimum brightness Bmin are determined (S303).
      <br/>
      If the maximum brightness Bmax is less than the minimum reference brightness Bd (Yes at S305), a dark environment flag Fd is set to 1 (S307).
      <br/>
      If the maximum brightness Bmax is greater than the minimum reference value Bd (No at S305), the dark environment flag Fd is set to 0 (S309).
    </p>
    <p num="169">
      The dark environment flag Fd indicates whether or not the environment including the object is determined to be too dark for image capture.
      <br/>
      If the maximum brightness that is detected when the focusing lens is located at the near terminal is less than the minimum reference brightness, the flag Fd is set to 1, and if the maximum brightness which is detected when the focusing lens is moved exceeds the minimum reference brightness at least once, the flag Fd is set to 0 at S325.
      <br/>
      Note that the minimum reference brightness Bd is, for example, the brightness which causes the accumulated electric charge to be 0.5 volts within the default charge period.
    </p>
    <p num="170">
      At S311, the difference between the maximum brightness Bmax and the minimum brightness Bmin obtained at S303 is calculated and stored in a first brightness difference variable Bsub1.
      <br/>
      The brightness difference is used as an index indicating the contrast of the object O. Then, the first brightness difference variable Bsub1 is transferred to the second brightness variable Bsub2 (S313).
      <br/>
      Thereafter, the lens driving motor 60 is rotated by one pulse in the reverse direction and the lens pulse counter decreases by one (S315 and S317).
      <br/>
      The value of the lens pulse counter at the start of the focusing process is 460 (as set during the initialization process).
    </p>
    <p num="171">
      After the focusing lens is driven by one pulse, the central portion (1000-pixel data) of the image sensor 16 is read, and the maximum brightness Bmax and the minimum brightness Bmin are determined (S319, S321).
      <br/>
      At steps S323 and S325, if the maximum brightness Bmax is greater than the minimum reference brightness Bd, the dark environment flag Fd is set to 0.
      <br/>
      At S327, the difference between the maximum and minimum brightness is stored as the first brightness difference variable Bsub1.
      <br/>
      By the processes of S313 and S327, the first brightness difference variable Bsub1 stores a brightness difference after the focusing lens is moved to the image sensor 16 side by one pulse with respect to the lens position when the brightness difference stored in the variable Bsub2 is detected.
    </p>
    <p num="172">
      The process of S313 through S327 is repeated while the lens pulse counter Paf is larger than 0 (S329) and the value of the latest brightness difference variable Bsub1 is larger than that of the previous brightness difference variable Bsub2 (S331).
      <br/>
      As the imaging lens 3 moves along the optical axis in one direction, typically the contrast of the image will become larger as the imaging lens 3 closes on the in-focus position and then will become smaller after the imaging lens 3 passes over the in-focus position.
      <br/>
      Therefore, the imaging lens 3 is positioned at an appropriate in-focus position when the latest brightness difference Bsub1 is smaller than the previous brightness difference Bsub2.
      <br/>
      If the dark environment flag Fd is "0", the CPU saves the value of the lens pulse counter Paf and returns to the main process (S333, S335).
    </p>
    <p num="173">
      If the lens pulse counter Paf reaches "0" at S331, this indicates that the imaging lens 3 has reached the farthest edge without reaching an in-focus position.
      <br/>
      In this case, if the dark environment flag Fd is equal to "0" (S337) indicating sufficient brightness, the CPU saves the data from the image sensor 16 (S339) and the process proceeds to S341 in FIG. 29.
    </p>
    <p num="174">If it is determined that the dark environment flag Fd is "1" (i.e., not equal to "0") at either S333 or S337, the CPU determines that the brightness of the object O is too low for image capture and the CPU executes the error process.</p>
    <p num="175">
      The process shown in FIG. 29 is executed when an in-focus position cannot be detected throughout the movement of the imaging lens 3 from the nearest position to the farthest position even though the object O is sufficiently bright.
      <br/>
      In the process of FIG. 29, the contrast pattern P is projected by the projecting device 11 and a change of the contrast of the image is detected for each lens position corresponding to a single pulse rotation of the lens driving motor 60 moving the imaging lens 3 from the farthest position toward the nearest position.
    </p>
    <p num="176">
      In the process of FIG. 29, the projecting device 11 is turned ON and projects a contrast pattern P onto the object and an image signal is then provided as input from the image sensor 16 (S341, S343).
      <br/>
      The CPU then judges at S345 whether the image signal stored at S339 (i.e., an image signal without a contrast pattern) is the same as the image signal provided as input at S343.
    </p>
    <p num="177">
      If the two image signals are the same (Yes at S345), the contrast pattern projecting device 11 turns OFF, the CPU saves the value of the lens pulse counter Paf and returns to the main process (S363, S365).
      <br/>
      In this case, it is assumed that the object O is too far and therefore the projected contrast pattern P does not reach the object O. Thus, the present lens position (the farthest position) is the best position for capturing an image.
    </p>
    <p num="178">
      If the image signal changes after projecting the contrast pattern (No at S345), it is assumed that the object O is located within a range where the projected contrast pattern P can reach the object O. In this case, the contrast is detected from the image signal while rotating the lens driving motor 60 by one pulse in the forward direction to find the point where the contrast starts to decrease at S347 through S357.
      <br/>
      If, before the value of the lens pulse counter Paf reaches "460", the contrast of the present position of the imaging lens is lower than that of the previous position of the imaging lens (No at S361), the position of the imaging lens is determined as the in-focus position, the contrast pattern projecting device 11 is turned OFF, and the CPU saves the value of the lens pulse counter Paf and returns to the main process (S363, S365).
    </p>
    <p num="179">
      If it is determined that the lens pulse counter Paf reaches "460" (No at S359) before the in-focus position is found (No at S361), the projecting device 11 is turned OFF and the CPU executes the error process (S359, S367).
      <br/>
      In this case, the peak of the contrast cannot be detected in spite of the fact that the object has sufficient brightness and the object is located within a range in which the projected contrast pattern can reach the object.
      <br/>
      In this case, it may be that the object distance is shorter than 23 cm (i.e., the closest limit) or an error has occurred in the scanner 1.
    </p>
    <p num="180">Photometering Process</p>
    <p num="181">
      FIG. 30 is a flowchart showing the photometering process executed at S023 of the main flowchart.
      <br/>
      Here, the term "photometering" means to detect the maximum brightness in a target area on the reference scanning line.
      <br/>
      In the photometering process, a charging period of the image sensor 16 for each line during image capturing is selected based on the maximum brightness at which pixels will not be saturated.
      <br/>
      The rotating speed of the scanning motor 70 is then determined to correspond to the charging period.
    </p>
    <p num="182">
      Generally, in an image capturing device using a CCD sensor, the charging period is controlled in response to brightness so that the most suitable image signal can be obtained.
      <br/>
      The scanner 1 of the embodiment also determines the charging period in response to the brightness of the object.
      <br/>
      However, since the charging period is constant and is determined based on the maximum brightness on the reference scanning line, some high brightness pixels on scanning lines other than the reference scanning line may be saturated.
      <br/>
      Thus, in this embodiment, the scanner 1 determines whether the object is against a white background or a black background, and then determines the charging period based on the type of background.
      <br/>
      This process is performed to attempt to reduce the number of saturated pixels as much as possible and thereby obtain as large a signal level as possible.
    </p>
    <p num="183">
      The CPU initially reads an image signal from the image sensor 16 at a default charge period and the center 1000 pixels of data are input to the CPU at S401 and processed to compensate for dark current and the like.
      <br/>
      Then, the maximum brightness Bmax is detected from the 1000 pixels of data (S403).
      <br/>
      At S405, a dark pixel number Nd of pixels which have a brightness that is lower than a reference brightness Bsh is determined by comparing the brightness of every pixel of the compensated 1000-pixel data with the reference brightness Bsh.
      <br/>
      The reference brightness Bsh is, for example, 16/256 when a quantization level for A/D conversion is 256 steps.
    </p>
    <p num="184">
      If the dark pixel number Nd is lower than 85% of the 1000 pixels on the reference scanning line, it is assumed that the object is against a white background such as a white board.
      <br/>
      In this case, the charging period is set so that the output of the pixel that output the maximum brightness Bmax at S403 will be 1.0 V (S407, S409) and the CPU returns to the main process.
      <br/>
      If the dark pixel number Nd is higher than 85% of the 1000 pixels, it is assumed that the object is against a black background such as a black board.
      <br/>
      In this case, the charging period is determined so that the output of the pixel that output the maximum brightness Bmax at S403 will be 0.5 V (S407, S411) and the CPU returns to the main process.
    </p>
    <p num="185">
      The method of photometering describe above is now described in more detail.
      <br/>
      In the image sensor 16, an electrical charge, which is stored in a photodiode for each pixel in response to a received light amount, is transformed to a transmission part through a shift gate.
      <br/>
      The transmitted electrical charge is sequentially input into a floating capacitor in response to a transmission pulse and then converted to a voltage.
      <br/>
      The received light amount at each of the pixels is detected as a voltage drop of a source follower using a MOS transistor.
      <br/>
      Under a condition when a photodiode is not saturated, an output voltage from each pixel of the image sensor 16 is in direct proportion to the received light amount.
    </p>
    <p num="186">
      To provide the best image, the charging period should be controlled so that all photodiodes in the image sensor 16 will not be saturated, since, if a photodiode is saturated, overflow electric charge may flow into peripheral photodiodes and causes blooming, disturbing the output signal.
      <br/>
      On the other hand, it is also desirable that the output signal level be as high as possible in order to improve a S/N ratio.
      <br/>
      The saturation voltage of the image sensor 16 of the embodiment is 2.0 V, and thus, the charging period should be controlled so that the output voltage from the maximum brightness pixel is about 1.0 V to satisfy the above requirements.
      <br/>
      That is, the peak voltage should be about a half of the saturation voltage.
    </p>
    <p num="187">
      Furthermore, as briefly explained above, since the charging period of the image sensor 16 for the entire scanning range is determined based on the image signal at the reference scanning line, the charging period should be determined while estimating a brightness for the entire scanning range so that pixels in scanning lines other than the reference line will not be saturated.
      <br/>
      Thus, the charging period is determined using two different standards, that is, assuming either a black background or a white background.
    </p>
    <p num="188">
      In using these standards, there are two assumptions that are made, the first is that, when the object is against a white background, there will be a relatively small possibility of finding a pixel on scanning lines other than the reference scanning line that is brighter than the maximum brightness pixel on the reference scanning line.
      <br/>
      The second assumption is that, when the object is against a black background, there is a relatively large possibility of finding a pixel on scanning lines other than the reference scanning line that is brighter than the maximum brightness pixel on the reference scanning line.
    </p>
    <p num="189">
      If, based on the brightness distribution at the reference scanning line, the object is determined to be against a white background, the charging period is determined so that the output of the pixel that output the maximum brightness will be 1.0 V (i.e., the peak voltage for this example).
      <br/>
      In. this case, the charging period is determined to be suited to the maximum brightness because it is assumed that there is only a low possibility that any pixels on scanning lines other than the reference scanning line will be saturated.
    </p>
    <p num="190">
      If the object is determined to be against a black background, the charging period is set so that the output of the pixel that output the maximum brightness will be 0.5 V (i.e., half of the peak voltage).
      <br/>
      In this case, the charging period is determined to be a half of the above period to the maximum brightness because there is a high possibility that some pixels on scanning lines other than the reference scanning line will be saturated if the charging period is determined in the same way as for the white background case.
    </p>
    <p num="191">Since the output voltage of each pixel of the image sensor 16 may be considered to be in direct proportion to the charging period when the intensity of the received light is constant, the charging period for a black background object is half of that for a white background object for a given maximum brightness.</p>
    <p num="192">
      When quantizing (digitizing) the image data signal, for example, quantization levels may be set having 256 steps such that the range of 1 V is divided into 256 gradations.
      <br/>
      The quantization process is identical for both the white and black background objects.
      <br/>
      Thus, if the object is against a white background, the signal from the maximum brightness pixel at the reference scanning line is allotted to the 256 level (i.e., the maximum level), whereas, if the object is against a black background, the signal from the maximum brightness pixel is allotted to the 128 level (i.e., half of the maximum level).
    </p>
    <p num="193">
      For the white background object, all steps of the gradation can be effectively used and the brightness gradation of the object can be accurately detected since it is assumed that there is a low possibility of finding a pixel on scanning lines other than the reference scanning line that is brighter than the maximum brightness pixel at the reference scanning line.
      <br/>
      That is, since there are few pixels that have a larger output level than that of the maximum brightness pixel on the reference scanning line, it is not necessary to distinguish the output level of the maximum brightness pixel on the reference scanning line and the brighter pixels on other scanning lines.
    </p>
    <p num="194">On the other hand, for the black background object, if there are some pixels on scanning lines other than the reference scanning line that are brighter than the maximum brightness pixel at the reference scanning line, those pixels can be appropriately quantized as long as a voltage from those pixels does not pass over 1 V.</p>
    <p num="195">
      Moreover, the gradation level of all pixels having an electrical charge that is larger than 1 V are allotted to the 256th step regardless of the background of an object.
      <br/>
      Although the 1V level is lower than the saturation level of the photodiodes of the image sensor 16, these pixels are considered to be saturated in view of the quantization.
      <br/>
      However, since the standard for determining the charge period in the photometering process is different for the white background object and the black background object, the possibility of having saturated pixels in the quantization is reduced.
    </p>
    <p num="196">
      As described above, the initial charging period in the photometering process is the default charge period.
      <br/>
      This default charge period is also used in the focusing process of FIG. 28. Thus, for example, if a voltage from the maximum brightness pixel is 0.8 V, and the object is determined as being against a white background, a charging period for scanning is set so that the voltage from that pixel is 1.0 V, that is, the charging period for scanning is longer than the default period.
      <br/>
      On the other hand, if the object is determined as being against a black background, a charging period for scanning is determined so that the voltage from that pixel is 0.5 V, that is, the charging period for scanning is shorter than the default period.
    </p>
    <p num="197">Capturing Process</p>
    <p num="198">
      FIGS. 31 and 32 are flowcharts showing the capture process that is executed at S025 of the main process.
      <br/>
      During the capture process, image data are sequentially captured by the image sensor 16 as the scanning mirror 2 rotates.
      <br/>
      The scanning mirror 2 is rotated at a rotating speed based on the charging period determined in the photometering process.
      <br/>
      The in-focus position detected in the focusing process is used as a base position for driving the imaging lens.
    </p>
    <p num="199">
      In the capture process, at S501, the filter counter FC is initialized to "0" and, at S503, a standard magnification mb and a start position pulse Xs are calculated based on the value of the lens pulse counter Paf at the in-focus position using the approximation formulas (10) and (11):
      <br/>
      mb=0.00036Paf+0.000009  (10)
      <br/>
      Xs-INT(-0.00057Paf2 +2.8706Paf+5741.1)  (11).
    </p>
    <p num="200">
      Then, at S505, a scanning speed fp for the scanning motor 70 is determined.
      <br/>
      The scanning speed fp is defined as a motor driving pulse cycle calculated to provide the charging period determined in the photometering process.
      <br/>
      For example, in the present embodiment, since an image signal is captured every 4 driving pules of the scanning motor 70, the scanning speed fp is determined by dividing the charging period by 4.
    </p>
    <p num="201">
      As described above, the scanning range is changed in response to an object distance so as to reduce parallax between the finder optical system 150 and the imaging optical system 1a.
      <br/>
      Rather than detect the object distance directly, the CPU 301 uses the value of the lens pulse counter Paf at the in-focus position to determine an object distance.
      <br/>
      Generally, when the in-focus position of the imaging lens 3 is close to the home position of the imaging lens 3, the imaging lens 3 focuses an object located at a short distance and the object distance can be considered short.
      <br/>
      Also, when the in-focus position of the imaging lens 3 is close to the image sensor 16, the imaging lens 3 focuses an object located at a long distance and the object distance can be considered long.
    </p>
    <p num="202">
      Thus, parallax can be reduced by changing the start position Xs of the scanning range in response to the number of driving pulses of the lens driving motor 60 required to move the imaging lens 3 from its home position to an in-focus position.
      <br/>
      If the pulse number from the home position is small, the parallax is considered to be large and therefore, the start position Xs of the scanning range shifts so that the center of the scanning range is positioned at the finder side of the reference scanning line.
      <br/>
      As a result of this shift, the finder side scanning range is wider than the lens side scanning range.
    </p>
    <p num="203">
      The difference between the center of the scanning range and the reference scanning line reduces as the pulse number from the home position increases.
      <br/>
      When the in-focus position of the imaging lens 3 is at the farthest position, it is assumed that there is no parallax and the scanning range is symmetric with respect to the reference scanning line.
    </p>
    <p num="204">The following TABLE 1 shows back focus fb of the imaging lens 3, the standard magnification mb at the reference scanning line, and the value of the start position pulse Xs based on the value of the lens pulse counter Paf at the in-focus position.</p>
    <p num="205">
      --         TABLE 1
      <br/>
      --         Paf    fb                    mb     Xs
      <br/>
      --         460    35.009                0.165  6942
      <br/>
      --         437    34.722                0.157  6887
      <br/>
      --         414    34.434                0.149  6832
      <br/>
      --         391    34.147                0.141  6777
      <br/>
      --         368    33.859                0.132  6720
      <br/>
      --         345    33.572                0.124  6664
      <br/>
      --         322    33.284                0.116  6606
      <br/>
      --         299    32.997                0.108  6548
      <br/>
      --         276    32.709                0.099  6490
      <br/>
      --         253    32.422                0.091  6431
      <br/>
      --         230    32.134                0.083  6371
      <br/>
      --         207    31.847                0.074  6311
      <br/>
      --         184    31.559                0.066  6250
      <br/>
      --         161    31.272                0.058  6189
      <br/>
      --         138    30.984                0.050  6127
      <br/>
      --         115    30.697                0.041  6064
      <br/>
      --         92     30.409                0.033  6001
      <br/>
      --         69     30.122                0.025  5936
      <br/>
      --         46     29.834                0.017  5872
      <br/>
      --         23     29.547                0.008  5806
      <br/>
      --         0      29.259                0.000  5740
    </p>
    <p num="206">
      Returning to the flowchart of FIG. 31, since the operation of the filter unit 4 will be different for monochrome mode and color mode, the CPU 301 checks if monochrome mode is set at S507.
      <br/>
      Note that, after the initializing process, the colorless filter 4a is positioned in the optical path and is appropriate for the monochrome mode.
      <br/>
      Thus, if the CPU judges that the monochrome mode is set at S507, the scanning mirror 2 is again set at its home position at S525 through S545 (similar to the process at S103 through S119 of the initializing process).
      <br/>
      Otherwise, if the CPU judges that the monochrome mode is not set at S507 (i.e., color mode), the filter holder 40 is driven to rotate such that the filter in the optical path is changed at S509 through S523.
    </p>
    <p num="207">
      In the filter changing process of S509 through S523, the scanning pulse counter X is first reset to "0" and set to increment for each driving pulse at S509.
      <br/>
      The scanning motor 70 starts to rotate in the forward direction at S511.
      <br/>
      The driving amount of the scanning motor 70 in the filter changing process varies according to the value of the filter counter FC.
      <br/>
      If the value. of the filter counter Fc is "0", the scanning mirror 2 is positioned at the home position.
      <br/>
      In this case, the scanning motor 70 is driven until the value of the scanning pulse counter X reaches the first filter switching pulse Xf1 (=8000 pulses) at S513 and S515, i.e., driven to move to the filter changing range and then rotate the filter unit 40 by 90 degrees.
      <br/>
      When the value of the filter counter FC is not "0", the scanning mirror 2 is assumed to be positioned at the end position of the scanning range since the scanning mirror 2 will have just completed a scan (see S579-S585 below).
      <br/>
      In this case, the scanning motor 70 is driven until the value of the scanning pulse counter X equals the second filter switching pulse Xf2 (=Xs-3480) at S513 and S517, i.e., driven to rotate the filter holder 40 by 90 degrees.
    </p>
    <p num="208">
      When the driving pulse of the scanning motor 70 equals the predetermined pulse number (Yes at S515 or S517), the scanning motor 70 is stopped at S519 and the filter counter FC is increased by 1 at S521.
      <br/>
      As a result of the filter changing process, the filter holder 40 rotates by 90 degrees and the filter is switched to a subsequent filter.
    </p>
    <p num="209">
      At S523, the signal from the filter sensor 205 is checked.
      <br/>
      Since the filter sensor 205 turns OFF only when the colorless filter 4a is set in the optical path, if the signal from the filter sensor 205 is OFF, it means that the filter holder 40 did not rotate or the filter holder 40 rotated more than the required amount.
      <br/>
      In this case, the CPU executes the error process.
    </p>
    <p num="210">
      At S525 through S545, if the scanning mirror 2 is positioned in the range where the positioning sensor 204 is OFF, the scanning motor 70 is driven in the forward direction, or, if the scanning mirror 2 is positioned in the range where the positioning sensor 204 is ON, the scanning motor 70 is once driven in the reverse direction until the positioning sensor 204 turns OFF and then the scanning motor 70 is driven in the forward direction.
      <br/>
      After the positioning sensor 204 turns ON during the forward rotation of the scanning motor 70, the scanning pulse counter X starts to count.
      <br/>
      The scanning motor 70 stops when the value of the scanning pulse counter X is equal to the center correction pulse Xc.
      <br/>
      After these steps, the scanning mirror 2 is positioned at the mirror home position.
    </p>
    <p num="211">
      The scanning motor 70 then rotates in the reverse direction and stops when the value of the scanning pulse counter X is equal to or larger than the value of the start position pulse Xs (calculated at S503) from the mirror home position in order to define a scanning range after compensating for parallax (S547, S549, S551 and S553).
      <br/>
      Then, at S555, the scanning motor 70 starts to rotate in the forward direction from the start position Xs of the scanning range at the scanning speed fp (determined at S505).
      <br/>
      The scanning pulse counter X starts to decrement in response to the driving pulses of the scanning motor 70 at S557.
    </p>
    <p num="212">
      The process of S558 through S579 is the actual capture of an image of the object O. Basically, the scanning motor 70 is driven through the scanning range, i.e., until the value of the scanning pulse counter X amounts to (Xs-Xt) and, during this driving, image signals are read from the image sensor 16 every 4 driving pulses (S558).
      <br/>
      In this example, the number of driving pulses corresponding to the scanning range is equal to 11480 pulses and image signals from 2870 scanning lines are captured.
      <br/>
      That is, the object O within the scanning range is divided into 2870 lines in the auxiliary scanning direction.
    </p>
    <p num="213">
      In the present embodiment, it is assumed that the object O to be captured is substantially a flat surface that is perpendicular to the optical axis at the mirror home position of the scanning mirror 2.
      <br/>
      On the basis of this assumption, the object distance at the periphery of the scanning range will be different from that at the reference scanning position.
      <br/>
      Thus, the scanner 1 compensates for changes of object distance and resulting changes in magnification as the scanning mirror 2 rotates.
      <br/>
      The focusing state and the magnification are compensated for by an open-loop control using approximation formulas described below.
    </p>
    <p num="214">Generally, at S559 and S561, the imaging lens 3 is driven along the optical axis to change the focusing state in order to maintain the in-focus condition.</p>
    <p num="215">Then, at S563, image signals for the current scanning line are read from the image sensor 16.</p>
    <p num="216">
      As described in more detail below, any distortion of the image due to a change of the magnification must be digitally compensated for by adding compensating pixels to scanning lines as necessary.
      <br/>
      Thus, at S565 and S567, a pixel differential  DELTA b, an insertion start pixel Yc, and a pitch Pit used for magnification compensation (at S577 below) are calculated.
      <br/>
      A detailed description of these calculations is provided below with reference to FIGS. 33 to 36.
    </p>
    <p num="217">
      At S571, the light quantity distribution of the image data is corrected to remove an effect of shading.
      <br/>
      The shading correction at S571 is in addition to the hardware shading correction described above with respect to FIG. 20 in order to correct in more detail for changes caused by the change in magnification along the scanning range.
      <br/>
      In particular, the shading correction is performed before the magnification compensation of S577 and is a known process to remove unevenness of the light quantity distribution in the main scanning direction due to the cosine fourth law or the like.
    </p>
    <p num="218">
      If the color mode is selected, at S573 and S575, the brightness signal of each pixel is also adjusted in order to correct for color shift due to differences in the incident angle to the color filter.
      <br/>
      That is, since a band of the transmission wavelength of the filter varies corresponding to the change of incident angle and such a color shift can be considered as a change of light amount for each color, the effect of the color shift can be corrected by compensating the level of the signal that corresponds to the received light amount.
    </p>
    <p num="219">
      At S577, the magnification compensation is performed based on the values calculated at S565 and S567.
      <br/>
      Then, at S579, the CPU 301 checks if the scanning pulse counter X has reached the end position of the scanning range.
      <br/>
      If not (No at 3579), the process returns to S558 to check that their are 4 pulses of the scanning motor 70 before reading the next scanning line (i.e., repeating S559-S579).
    </p>
    <p num="220">
      When the value of the scanning pulse counter X reaches the value indicating the end position of the scanning range (Yes at S579), the scanning motor 70 stops at S581 and the CPU 301 judges whether the mode is set to monochrome or not at S583.
      <br/>
      If the mode is set to the monochrome mode, the CPU 301 returns to the main process.
      <br/>
      Otherwise, the mode is the color mode, and the CPU 301 checks the value of the filter counter FC at S585.
      <br/>
      If the value of the filter counter FC is smaller than 3, the CPU 301 returns to the process of S509 in FIG. 31 to change the filter and scan the object with a different color filter.
      <br/>
      If the value of the filter counter FC is equal to or larger than 3, the image capturing for three colors has been completed and the CPU 301 returns to the main process.
    </p>
    <p num="221">Note that, in the process above, the compensation for the focusing condition and the magnification are performed for each scanning line, the compensation for shading is performed for each pixel, and the color correction is performed for each pixel or for each color group that includes a plurality of pixels.</p>
    <p num="222">The focusing condition compensation and the magnification compensation described above with respect to the flowchart of FIG. 32 are now described in detail.</p>
    <p num="223">
      Generally, since the scanning mirror 2 is rotated to scan the object O forming an image of the object O scanning line by scanning line on the image sensor 16, an imaginary object surface that is formed by scanning a line that is conjugate with the image sensor 16 is a cylindrical surface having a center axis that coincides with the rotation axis of the scanning mirror 2.
      <br/>
      Thus, if the object O is a flat surface such as a white board or a blackboard, the difference between the cylindrical imaginary object surface and the flat object surface causes focusing error.
      <br/>
      In the present embodiment, the imaging lens 3 is initially moved to a position where an in-focus image of the reference scanning line is formed on the image sensor 16, however, the object distance increases as the distance of the present scanning line from the reference scanning line increases on the object surface.
      <br/>
      Thus, it is necessary to adjust the position of the imaging lens 3 when the image sensor 16 captures scanning lines other than the reference scanning line.
    </p>
    <p num="224">
      The position of the imaging lens 3 for scanning lines other than the reference scanning line is calculated using the value of the lens pulse counter Paf at the in-focus position for the reference scanning line and the scanning position represented by the value of the scanning pulse counter X. The lens position pulse Ps for compensating for the change of the object distance is also represented by a number of driving pulses for the lens driving motor 60.
      <br/>
      The compensating pulse number Ps is determined at S559 of FIG. 32 by the approximation formula (12):  (Equation image '1' not included in text)
    </p>
    <p num="225">For example, if the value of the lens pulse counter Paf at the reference scanning line is 460, that is, the imaging lens 3 focuses an object at a distance of 23 cm, the lens position pulse Ps varies as shown in TABLE 2 in accordance with a change of the value of the scanning pulse counter X. The values  DELTA b, Pit and Pt are used in magnification compensation and are described in detail below.</p>
    <p num="226">
      -- TABLE 2
      <br/>
      -- X                  Ps      DELTA b           Pit    Pt
    </p>
    <p num="227">
      -- 6948               383    174              6      0
      <br/>
      -- 6310               395    147              7      15
      <br/>
      -- 5672               406    122              8      68
      <br/>
      -- 5034               416    99               10     54
      <br/>
      -- 4396               426    77               13     43
      <br/>
      -- 3759               434    59               17     41
      <br/>
      -- 3121               442    40               26     4
      <br/>
      -- 2483               448    27               38     18
      <br/>
      -- 1845               453    15               69     9
      <br/>
      -- 1208               457    6                174    0
      <br/>
      -- 570                459    2                522    0
      <br/>
      -- -68          460    0                -- --
      <br/>
      -- -706         458    4                261    0
      <br/>
      -- -1344        456    9                116    0
      <br/>
      -- -1981        452    18               58     0
      <br/>
      -- -2619        447    29               36     0
      <br/>
      -- -3257        440    45               23     9
      <br/>
      -- -3895        432    63               16     36
      <br/>
      -- -4532        423    83               12     48
    </p>
    <p num="228">If the scanning lens 3 is moved to the position represented by the lens position pulse Ps in accordance with the value of the scanning pulse counter X, the imaging lens is able to form an in-focus image on the image sensor 16 at any scanning line, as long as the object can be approximated as a flat surface perpendicular to the optical axis at the mirror home position of the scanning mirror 2.</p>
    <p num="229">
      In changing the in-focus position, the magnification is also changed and the change of the magnification is compensated for by inserting a predetermined number of compensation pixels into the image signal.
      <br/>
      The magnification varies due to the change of the object distance and the change of the position of the imaging lens.
      <br/>
      The magnification decreases as the distance of the scanning line from the reference scanning line increases.
      <br/>
      For example, when a rectangular object having long sides that are aligned in the auxiliary scanning direction (as shown in FIG. 33A) is scanned, the captured image includes barrel distortion (as shown in FIG. 33B).
      <br/>
      That is, the short sides become shorter.
    </p>
    <p num="230">
      In order to compensate for the distortion of the image due to the change of the magnification, the CPU 301 determines a pixel differential  DELTA b based on a ratio of the magnification on the present scanning line to that on the reference scanning line.
      <br/>
      The pixel differential  DELTA b is a difference between a number of effective pixels of the image sensor 16 and a number of pixels that capture a predetermined length of the object.
    </p>
    <p num="231">Since the change in magnification can be calculated based on the value of the lens pulse counter Paf at the reference scanning line and the value of the lens position pulse Ps, the pixel differential  DELTA b (and related variables: an insertion start pixel Yc, a pitch Pit, and a remainder pitch Pt) may also be calculated from the values of Paf and Ps using the following equations:  (Equation image '2' not included in text)</p>
    <p num="232">
      where Km is the number of effective pixels of the image sensor 16, and K is the maximum number of pixels of the image sensor 16.
      <br/>
      These calculations are performed at S565 and S567 of FIG. 32. The magnification compensation for pixels for the upper half of the image sensor 16 can also be applied to pixels for the lower half, and thus, the following description is directed to the pixels for the upper half only.
    </p>
    <p num="233">
      In the magnification compensation at S577, the top  DELTA b pixels of the actual image data are discarded and an equivalent number of compensating pixels are inserted into the image data one by one at a predetermined pitch Pit.
      <br/>
      FIG. 34 is a schematic, showing a relationship between actual image data and corrected image data.
      <br/>
      In FIG. 34, a left bar shows pixels of the actual image data from the image sensor 16 and a right bar shows corrected image data after magnification compensation.
      <br/>
      In principle, the first pixel of the corrected image data is filled by a first compensation pixel, then Pit-1 pixels of the actual image data counted from the insertion start pixel Yc fill the corrected image data from the second pixel, then a second compensation pixel is inserted and another Pit-1 pixels of the actual image data are inserted.
    </p>
    <p num="234">
      For the upper half of the corrected image data, Km/2 pixels of the image data, 1044 pixels in this example, are produced by repeating insertion of a compensation pixel at every Pit pixels toward the center of the actual image data.
      <br/>
      The values of the pitch Pit and the insertion start pixel Yc are determined by the above equations (14) and (15).
      <br/>
      In this embodiment, since K=Km=2088, Yc is equal to  DELTA b. Note that the number of effective pixels Km varies depending on the capturing area that is set in the mode setting process.
    </p>
    <p num="235">
      The remainder pitch Pt is a difference between the product of the pitch Pit and the pixel differential  DELTA b and half the number of effective pixels Km/2.
      <br/>
      The remainder pitch is also equal to the remainder of Km/2Pit.
      <br/>
      If the remainder Pt is not equal to zero, at the center side, Pit-1+Pt pixels of the actual image data fill the corrected image data without a compensation pixel.
    </p>
    <p num="236">
      Generally, the value of the compensation pixel is set to have the same value as the previous pixel of the actual image data.
      <br/>
      However, as an exception, if there is a group of adjacent pixels that output identical level signals and the group represents over 30% of the number of pixels in one pitch Pit, the compensation pixel is inserted as the next pixel of the group.
      <br/>
      The value of the compensation pixel is set to be identical to that of the pixel in the group.
    </p>
    <p num="237">
      For example, if the pitch Pit is equal to 100 and 35 adjacent pixels form a group within the pitch Pit, the next pixel of the group, that is, the 36th pixel, is filled by a compensation pixel having a value that is identical to the 35th pixel in the group.
      <br/>
      In this case, the compensation pixel is not inserted at the 100th pixel.
      <br/>
      Note that an "identical level" means 0 or 1 in the 1-bit data mode, but means within a full step in the 8-bit data mode.
      <br/>
      That is, in the 8-bit data mode, if the values of the pixels fall within a step having a width of 16 values, it is considered that these pixels have the identical value.
    </p>
    <p num="238">
      FIGS. 35 and 36 show an example of the magnification compensation when the value of the lens pulse counter Paf at the reference scanning line is 460.
      <br/>
      FIG. 35 shows the compensation for the scanning line at X=6948, that is, the start position of the scanning range.
      <br/>
      For this scanning line,  DELTA b=Yc=174, Pit=6 and Pt 0.
      <br/>
      The first pixel of the corrected image data is filled by the first compensation pixel.
      <br/>
      The first to 174th pixels of the actual image data are not used.
      <br/>
      The second to sixth pixels of the corrected image data are filled by the 175th to 179th pixels of the actual image data.
      <br/>
      The seventh pixel of the corrected image data is filled by the second compensation pixel and the eighth to 12th pixels of the corrected image data are filled by the 180th to 184th pixels of the actual image data.
      <br/>
      In a similar way, a compensation pixel is inserted at every 5-pixel interval of the actual image data.
      <br/>
      The 1033rd pixel of the corrected image data is filled by the 173rd compensation pixel, and the 1034th to 1038th pixels of the corrected image data are filled by the 1035th to 1039th pixels of the actual image data.
      <br/>
      Finally, the 1039th pixel of the corrected image data is filled by the 174th compensation pixel, and the 1040th to 1044th pixels of the corrected image data are filled by the 1040th to 1044th pixels of the actual image data.
    </p>
    <p num="239">
      FIG. 36 shows the compensation for the scanning line at X=2483.
      <br/>
      In the example of FIG. 36,  DELTA b=27, Pit=38 and Pt=18.
      <br/>
      In this case, the effective actual image data starts from the 28th pixel and, therefore, 1017 pixels of actual image data are expanded to 1044 pixels by inserting 27 compensation pixels.
      <br/>
      The first pixel of the corrected image data is filled by the first compensation pixel, and the second to 39th pixels are filled by the 28th to 65th pixels of the actual image data.
      <br/>
      In a similar way, 1 pixel of the compensation data and 37 pixels of the actual image data alternatively fill the corrected image data.
      <br/>
      At the center of the corrected image data, 55 (=Pit-1+Pt) pixels of the actual image data fill the corrected image data without adding any compensation data.
    </p>
    <p num="240">Since the magnification is compensated for by the above mentioned process, barrel distortion of the image is prevented as long as the object is a flat surface perpendicular to the optical axis at the home position of the scanning mirror 2.</p>
    <p num="241">As described above with reference to FIGS. 28 and 29, according to the above-described embodiment, the difference between the maximum brightness and the minimum brightness is regarded as the contrast for the objective area, and the focusing lens is positioned at a position which is one step towards the far side with respect to the position at which the contrast is maximum.</p>
    <p num="242">FIG. 37 shows an alternative focusing process referred to as "Focusing(2)", according to a second embodiment of the invention.</p>
    <p num="243">The process shown in FIG. 37 may be executed at S021 of the main process instead of the process shown in FIGS. 28 and 29. In the Focusing(2) process shown in FIG. 37, a sum of differences between the brightness of adjacent pixels represents the contrast, and when the sum exceeds a predetermined reference value, it is determined that the focusing lens is located at the in-focus position.</p>
    <p num="244">
      In the Focusing(2) process, similar to the first embodiment described above, the brightness values for the central 1000 pixels of the scanning line are obtained for examination (S601).
      <br/>
      Then, a difference of the brightness values between every adjacent two pixels is obtained.
      <br/>
      The difference values thus obtained are summed and stored as a summation variable Btotal (S603).
      <br/>
      The summation variable Btotal is used as a value representative of the contrast of the object image.
      <br/>
      At S605, the summation variable Btotal is compared with a reference value Bref.
      <br/>
      If the summation variable Btotal exceeds the reference value Bref (Yes at S605), it is determined that the focusing lens is located at the in-focus position, and control goes to S635 at which the value of the lens pulse counter Paf is stored.
      <br/>
      If the summation variable Btotal is less than the reference value Bref (No at S605), the lens drive motor 60 is rotated by one pulse in the reverse direction and the lens pulse counter decreases by one (S607 and S609).
      <br/>
      If the lens pulse counter Paf is greater than 0 (Yes at S611), the CPU repeats the procedure starting from S601.
    </p>
    <p num="245">
      If the in-focus position is not detected (No at S605), and the pulse counter Paf is determined to be less than 0 (No at S611), the CPU saves the data from the image sensor 16 (S613), the projecting device 11 is turned ON and projects a contrast pattern P onto the object (S615).
      <br/>
      An image signal is then input from the image sensor 16 (S617).
      <br/>
      The CPU then judges, at S619, whether the image signal stored at S613 is the same as the image signal input at S617.
    </p>
    <p num="246">If the two image signals are the same (Yes at S619) the contrast pattern projecting device 11 is turned OFF (S633), the CPU saves the value of the lens pulse counter Paf (S635) and returns to the main process.</p>
    <p num="247">
      If the image signal changes after projecting the contrast pattern (No at S619), it is assumed that the object O is located within a range where the projected contrast pattern P can reach the object O. In this case, similar to the procedure shown in FIG. 29, the CPU drives the focusing lens motor 60 by one pulse in the forward direction (S621), increases the lens pulse counter Paf (S623), and 1000-pixel image data is obtained (S625).
      <br/>
      At S627, the sum of the difference of brightness values between adjacent pixels is calculated, and if the lens pulse counter Paf is less than the upper limit 460 (Yes at S629), the summation variable Btotal is compared with the reference brightness Bref (S631).
    </p>
    <p num="248">
      If the summation variable Btotal exceeds the reference brightness value Bref (Yes at S631), the CPU judges that the focusing lens is located at the in-focus position.
      <br/>
      In this case, the CPU turns OFF the contrast pattern projecting device 11 (S633), stores the lens pulse counter Paf (S635), and returns to the main process.
    </p>
    <p num="249">
      If the lens pulse counter Paf reaches 460 at S629 before the summation variable Btotal becomes greater than the reference value Bref at S631, the projecting device 11 is turned OFF at S637 and an error process is executed.
      <br/>
      In other words, if the in-focus condition has not been detected before the focusing lens reaches the near extremity, the projecting device 11 is turned OFF, image scanning is inhibited, and the error process is executed.
    </p>
    <p num="250">
      However, each of the embodiments described above may encounter problems if the object O is illuminated by a flickering light source, such as a fluorescent light.
      <br/>
      In particular, if the object O is illuminated by a flickering light source, due to a phase difference between the integration of the CCD and the illumination, contrast may vary even if the lens stays at one position.
    </p>
    <p num="251">
      In other words, if the object is illuminated by a light source having a constant brightness, as the focusing lens moves, the contrast changes smoothly and the above embodiments work well.
      <br/>
      However, if the light source is a flickering one, the contrast signal varies at a high frequency.
      <br/>
      If the change of the contrast signal is illustrated in a graph, the former has a smooth curve, while the latter may show a similar curve but with a high frequency component overlapped.
    </p>
    <p num="252">
      Thus, for example, in the first embodiment, since a decrease in contrast signal value is used to determine that the lens is located at the in-focus position, in the flickering environment, a decrease of the contrast signal value due to the flickering illumination may be used to incorrectly determine that the lens is located at the in-focus position.
      <br/>
      Several embodiments intended to handle this problem are now described with reference to FIGS. 38-40. Note that for the embodiments described with reference to FIGS. 38-40, the projecting unit 11 is not used, however, of course, the projecting unit 11 may be used by incorporating a similar process to that described above with reference to the first embodiment.
    </p>
    <p num="253">
      FIG. 38 shows a focusing process, referred to as "Focusing(3)" according to a third embodiment of the invention.
      <br/>
      The process shown in FIG. 38 may be executed at S021 of the main process instead of the process shown in FIGS. 28 and 29. In this embodiment, a value representing the contrast is obtained at every movement of the lens, as the lens is moved over the entire movable range and the position of the maximum contrast over the entire movable range is set as the in-focus position of the lens.
      <br/>
      That is, the in-focus position represents a macroscopic maximum of contrast in order to avoid the problem of encountering a local maximum such as may be caused by flickering illumination.
    </p>
    <p num="254">
      As shown in FIG. 38, the Focusing(3) process also begins with the CPU 301 reading the brightness values for the central 1000 pixels of the scanning line (S701).
      <br/>
      Then, at S703, the maximum and minimum brightness values Bmax, Bmin are obtained.
      <br/>
      At S705, the contrast, i.e., the difference between the maximum brightness Bmax and the minimum brightness Bmin, is stored in the variable Bsub2.
      <br/>
      The lens drive motor 60 is then rotated by one pulse in the reverse direction and the lens pulse counter Paf decreases by one (S709 and S711).
      <br/>
      At S713, the CPU 301 reads 1000 image signals for the center 1000 pixels for the new lens position and at S715 determines values for maximum and minimum brightness Bmax, Bmin.
      <br/>
      Thereafter, at S717, the contrast, i.e., the difference between the maximum brightness Bmax and the minimum brightness Bmin, is stored in the variable Bsub1.
    </p>
    <p num="255">
      At S719, the variable Bsub2 (i.e., the contrast for the previous reading) is compared with the variable Bsub1 (i.e., the contrast for the current reading).
      <br/>
      If the variable Bsub2 is less than the variable Bsub1 (Yes at S719), the variable Bsub2 is replaced by the variable Bsub1 (S721) and the position of the imaging lens 3, i.e., the lens pulse counter Paf, is saved (S723) and the process proceeds to S725.
      <br/>
      If the variable Bsub2 is not less than the variable Bsub1 (No at S719), the process jumps directly to S725.
    </p>
    <p num="256">
      At S725, the CPU 301 checks if the lens pulse counter Paf is greater than 0.
      <br/>
      If the lens pulse counter Paf is greater than 0 (Yes at S725), the process returns to S709, to move the imaging lens by one pulse and take another reading.
      <br/>
      If the lens pulse counter Paf is not greater than 0 (No at S725), the imaging lens 3 has reached the end of the moving range and the CPU 301 returns to the main process of FIG. 24. At this point, the variable Bsub2 represents a macroscopic maximum brightness over the entire movement range, and the saved value of the lens pulse counter Paf represents the position of the imaging lens 3 for the macroscopic maximum brightness.
    </p>
    <p num="257">Thus, by checking values of contrast through the whole range of movement of the imaging lens 3, the problem of local maximums that may be caused by flickering illumination is avoided.</p>
    <p num="258">
      FIG. 39 shows a focusing process, referred to as "Focusing(4)", according to a fourth embodiment of the invention.
      <br/>
      The process shown in FIG. 39 may be executed at S021 of the main process instead of the process shown in FIGS. 28 and 29. in this embodiment, a value representing the contrast is obtained a plurality of times (10 in the embodiment) at every position of the imaging lens 3 as the imaging lens 3 is moved over the entire movable range.
      <br/>
      Similar to the previous embodiment, the position of the maximum contrast over the entire movable range is set as the in-focus position of the imaging lens 3.
      <br/>
      That is, at each position of the imaging lens 3, the contrast is sampled 10 times in order to average the effect of flickering illumination and then the in-focus position is determined as a macroscopic maximum of contrast in order to further avoid the problem of encountering a local maximum, such as may be caused by flickering illumination.
    </p>
    <p num="259">
      As shown in FIG. 39, the Focusing(4) process begins by initializing a counter i, and a variable Btotal to 0 (S801).
      <br/>
      At S803, the CPU 301 reads the brightness values for the central 1000 pixels of the scanning line and, at S805, determines the maximum and minimum brightness values Bmax, Bmin.
      <br/>
      At S807, the contrast, i.e., the difference between the maximum brightness Bmax and the minimum brightness Bmin, is stored in the variable Bsub and, at S809, the variable Bsub is added to the variable Btotal.
      <br/>
      At S811, the counter i is incremented and, at S813, if the counter i is lens than 10, the CPU 301 loops back to S803 to take another reading of contrast.
      <br/>
      When 10 contrast readings have been taken (No at S813), the variable Bsub2 is set to the average of the 10 contrast readings, i.e., Btotal/10, at S815.
    </p>
    <p num="260">
      At S817, the lens drive motor 60 is rotated by one pulse in the reverse direction and, at S819, the lens pulse counter Paf is decreased by one.
      <br/>
      At S821, the counter i and the variable Btotal are reset to 0 to prepare to collect 10 contrast readings for the current lens position.
    </p>
    <p num="261">
      The CPU 301 then, at S823, reads 1000 image signals for the center 1000 pixels for the new lens position.
      <br/>
      Then at S825, the CPU 301 determines values for maximum and minimum brightness Bmax, Bmin, and, at S827, calculates and stores the contrast, i.e., the difference between the maximum brightness Bmax and the minimum brightness Bmin, in the variable Bsub.
      <br/>
      At S829, the variable Bsub is added to the variable Btotal.
      <br/>
      At S831, the counter i is incremented and, at S833, if i is less than 10, the CPU 301 loops back to S823 to take another reading of contrast.
      <br/>
      When 10 contrast readings have been taken (No at S833), the variable Bsub1 is set to the average of the 10 contrast readings, i.e., Btotal/10, at S835.
    </p>
    <p num="262">
      At S837, the variable Bsub2 (i.e., the averaged contrast for the previous reading) is compared with the variable Bsub1 (i.e., the averaged contrast for the current reading).
      <br/>
      If the variable Bsub2 is less than the variable Bsub1 (Yes at S837), the variable Bsub2 is replaced by the variable Bsub1 (S839), the position of the imaging lens 3, i.e., the lens pulse counter Paf, is saved (S841), and the process proceeds to S843.
      <br/>
      If the variable Bsub2 is not less than the variable Bsub1 (No at S837), the process jumps directly to S843.
    </p>
    <p num="263">
      At S843, the CPU 301 checks if the lens pulse counter Paf is greater than 0.
      <br/>
      If the lens pulse counter Paf is greater than 0 (Yes at S843), the process jumps to S817, to move the imaging lens 3 by one pulse and take another reading of average contrast.
      <br/>
      If the lens pulse counter Paf is not greater than 0 (No at S843), the imaging lens 3 has reached the end of the moving range and the CPU 301 returns to the main process of FIG. 24.
    </p>
    <p num="264">At this point, the variable Bsub2 represents a macroscopic maximum brightness over the entire movement range and the saved value of the lens pulse counter Paf represents the position of the imaging lens 3 for the macroscopic maximum brightness.</p>
    <p num="265">
      In this embodiment, since an average contrast value for each lens position is used, the effect of flickering illumination is compensated for.
      <br/>
      Further, since the values of averaged contrast are obtained over the entire movable range, erroneous detection of a local maximum of contrast can be avoided.
    </p>
    <p num="266">
      FIG. 40 shows a focusing process, referred to as "Focusing(5)", according to a fifth embodiment of the invention.
      <br/>
      The process shown in FIG. 40 may be executed at S021 of the main process instead of the process shown in FIGS. 28 and 29. In this embodiment, an average value of contrast is obtained over a plurality (10 in the embodiment) of lens positions as the imaging lens 3 is moved over the entire movable range.
      <br/>
      The process is similar to the previous embodiment, except that the imaging lens 3 is driven by one pulse for each sample contrast included in the average value.
      <br/>
      As above, the position of the maximum averaged contrast over the entire movable range is set as the in-focus position of the imaging lens 3.
      <br/>
      That is, the contrast is averaged every ten positions of the imaging lens 3, in order to average the effect of flickering illumination and then the in-focus position is determined as a maximum of the averaged contrast values in order to further avoid the problem of encountering a local maximum such as may be caused by flickering illumination.
    </p>
    <p num="267">
      As shown in FIG. 40, the Focusing(5) process begins by initializing a counter i, and a variable Btotal to 0 (S901).
      <br/>
      At S903, the CPU 301 reads the brightness values for the central 1000 pixels of the scanning line and, at S905, determines the maximum and minimum brightness values Bmax, Bmin.
      <br/>
      At S907, the contrast, i.e., the difference between the maximum brightness Bmax and the minimum brightness Bmin, is stored in the variable Bsub and, at S909, the variable Bsub is added to the variable Btotal.
      <br/>
      At S911, the counter i is incremented and, at S913, the lens drive motor 60 is rotated by one pulse in the reverse direction.
      <br/>
      Then, at S915, if the counter i is lens than 10, the CPU 301 loops back to S903 to take a reading of contrast at the new lens position.
      <br/>
      When contrast readings have been taken at 10 lens positions (No at S915), the variable Bsub2 is set to the average of the 10 contrast readings, i.e., Btotal/10 (S917) and, at S919 the lens pulse counter Paf is decremented by 10.
    </p>
    <p num="268">At S921, the counter i and the variable Btotal are reset to 0 to prepare to collect contrast readings for the next 10 lens positions.</p>
    <p num="269">
      The CPU 301, at S923, reads 1000 image signals for the center 1000 pixels.
      <br/>
      Then, at S925, the CPU 301 determines values for maximum and minimum brightness Bmax, Bmin, and, at S927, calculates and stores the contrast, i.e., the difference between the maximum brightness Bmax and the minimum brightness Bmin, in the variable Bsub.
      <br/>
      At S929, the variable Bsub is added to the variable Btotal.
      <br/>
      At S931, the counter i is incremented and, at S933, the lens drive motor 60 is rotated by one pulse in the reverse direction.
      <br/>
      Then, at S935, if the counter i is lens than 10, the CPU 301 loops back to S923 to take a reading of contrast at the new lens position.
      <br/>
      When contrast readings have been taken at 10 lens positions (No at S935), the variable Bsub1 is set to the average of the 10 contrast readings, i.e., Btotal/10 (S937) and, at S939, the lens pulse counter Paf is decremented by 10.
    </p>
    <p num="270">
      At S941, the variable Bsub2 (i.e., the averaged contrast over the previous 10 lens positions) is compared with the variable Bsub1 (i.e., the averaged contrast over the current 10 lens positions).
      <br/>
      If the variable Bsub2 is less than the variable Bsub1 (Yes at S941), the variable Bsub2 is replaced by the variable Bsub1 (S943), the position of the imaging lens 3, i.e., the lens pulse counter Paf, is saved (S945), and the process proceeds to S947.
      <br/>
      If the variable Bsub2 is not less than the variable Bsub1 (No at S941), the process jumps directly to S947.
    </p>
    <p num="271">
      At S947, the CPU 301 checks if the lens pulse counter Paf is greater than 0.
      <br/>
      If the lens pulse counter Paf is greater than 0 (Yes at S947), the process jumps to S921, to check the average contrast for the next 10 lens positions.
      <br/>
      If the lens pulse counter Paf is not greater than 0 (No at S947), the imaging lens 3 has reached the end of the moving range and the CPU 301 returns to the main process of FIG. 24.
    </p>
    <p num="272">Thus, the movable range of the imaging lens 3 is divided into a plurality of sub-ranges, and a sub-range corresponding to the maximum contrast (stored in the variable Bsub2) and represented by the lens pulse counter Paf is saved as the position of the imaging lens 3 for the macroscopic maximum contrast.</p>
    <p num="273">Note that, in the embodiments described with reference to FIGS. 39 and 40, although a maximum of the average contrast (either over 10 readings at one lens position or over readings at 10 lens positions) is determined based on comparisons over the entire movement range of the imaging lens 3, the processes may be modified such that once a maximum of the average contrast is detected, the current lens position is set as the in-focus position, in a similar way to the first embodiment described above.</p>
    <p num="274">
      FIG. 41 shows a focusing process, referred to as "Focusing(6)", according to a sixth embodiment of the invention.
      <br/>
      The process shown in FIG. 41 may be executed at S021 of the main process instead of the process shown in FIGS. 28 and 29. In this embodiment, projecting unit 11 is turned ON at the beginning of the focusing process in order to provide additional information about the distance to the object.
    </p>
    <p num="275">
      As shown in FIG. 41, the Focusing(6) process begins with the CPU 301 turning ON the projecting unit 11 (S1001).
      <br/>
      At S1003, 1000 pixels of image signals are obtained for examination, and the maximum brightness Bmax and the minimum brightness Bmin are determined (S1005).
    </p>
    <p num="276">
      At S1007, the difference between the maximum brightness Bmax and the minimum brightness Bmin is calculated and stored in the variable Bsub1.
      <br/>
      At S1009, the variable Bsub1 is transferred to the variable Bsub2.
      <br/>
      The lens driving motor 60 is then rotated by one pulse in the reverse direction and the lens pulse counter Paf is decreased by one (S1011 and S1013).
    </p>
    <p num="277">
      At the new lens position, image signals for the central 1000 pixels are read, and the maximum brightness Bmax and the minimum brightness Bmin are determined (S1015 and S1017).
      <br/>
      At S1019, the difference between the maximum and minimum brightness is stored as the variable Bsub1.
    </p>
    <p num="278">
      At S1021, the CPU 301 determines if the lens pulse counter Paf is greater than 0.
      <br/>
      If the lens pulse counter Paf is greater than 0 (Yes at S1021), the CPU 310 then checks if the variable Bsub2 is less than the variable Bsub1 at S1023.
      <br/>
      If so (Yes at S1023), a maximum of contrast has not been reached yet, and the process jumps to S1009 to obtain a new contrast value for comparison.
      <br/>
      If the variable Bsub2 is not less than the variable Bsub1 (No at S1023), then a maximum of the contrast has been reached, and the process proceeds to S1025.
    </p>
    <p num="279">
      If the lens pulse counter Paf is not greater than 0 (No at S1021), this indicates that the imaging lens 3 has reached the farthest edge without reaching an in-focus position.
      <br/>
      In this case, the CPU saves the data from the image sensor 16 (S1027), turns the projecting unit 11 OFF (S1029), and re-reads the 1000 pixel image signals (S1031).
      <br/>
      At S1033, the CPU 301 compares the re-read image signals and the saved image signals.
      <br/>
      If the re-read image signals match the saved image signals (Yes at S1033), it is assumed that the object O is too far and therefore the projected contrast pattern P does not reach the object O. Thus, the present lens position (the farthest position) is the best position for capturing an image and the process jumps to S1025.
      <br/>
      If the image signal changes after turning OFF the contrast pattern (No at S1033), it is assumed that the object O is located within a range where the projected contrast pattern P can reach the object O but that an error has occurred and the CPU 301 executes an error process.
    </p>
    <p num="280">At S1025, the CPU 301 saves the lens pulse counter Paf representing the position of the imaging lens 3 at which a maximum contrast is found.</p>
    <p num="281">
      FIGS. 42 and 43 show a focusing process, referred to as "Focusing(7)", according to a seventh embodiment of the invention.
      <br/>
      The process shown in FIGS. 42 and 43 may be executed at S021 of the main process instead of the process shown in FIGS. 28 and 29. in this embodiment, if an in-focus position of the imaging lens 3 cannot be detected when the scanning mirror 2 is at the mirror home position (reference scanning position), the scanning mirror 2 is rotated by a predetermined amount and the imaging lens 3 is moved to attempt to find an in-focus position with respect to the new scanning position of the scanning mirror 2.
      <br/>
      The in-focus position for the imaging lens 3 when the scanning mirror 2 is at the mirror home position is then calculated using the approximation formula (12) described above.
    </p>
    <p num="282">As shown in FIG. 42, the Focusing(7) process begins with the CPU 301 reading 1000 pixels of image signals (S1101), and determining the maximum brightness Bmax and the minimum brightness Bmin (S1103).</p>
    <p num="283">
      At S1105, the difference between the maximum brightness Bmax and the minimum brightness Bmin is calculated and stored in the variable Bsub1.
      <br/>
      At S1107, the variable Bsub1 is transferred to the variable Bsub2.
      <br/>
      The lens driving motor 60 is then rotated by one pulse in the reverse direction and the lens pulse counter is decreased by one (S1109 and S1111).
    </p>
    <p num="284">
      At the new lens position, image signals for the central 1000 pixels are read, and the maximum brightness Bmax and the minimum brightness Bmin are determined (S1113 and S1115).
      <br/>
      At S1117, the difference between the maximum and minimum brightness is stored as the variable Bsub1.
    </p>
    <p num="285">
      At S1119, the CPU 301 determines if the lens pulse counter Paf is greater than 0.
      <br/>
      If the lens pulse counter Paf is greater than 0 (Yes at S1119), the CPU 310 then checks if the variable Bsub2 is less than the variable Bsub1 at S1121.
      <br/>
      If so (Yes at S1121), a maximum of contrast has not been reached yet, and the process jumps to S1107 to obtain a new contrast value for comparison.
      <br/>
      If the variable Bsub2 is not less than the variable Bsub1 (No at S1121), then a maximum of the contrast has been reached, and the lens pulse counter Paf is saved at S1123 before the CPU 301 returns to the main process.
    </p>
    <p num="286">
      If the lens pulse counter Paf is not greater than 0 (No at S1119), this indicates that the imaging lens 3 has reached the farthest edge without reaching an in-focus position.
      <br/>
      In this case, the CPU 301 saves the data from the image sensor 16 (S1125), and then drives the scanning mirror 70 forward by a predetermined number of pulses n (S1127).
      <br/>
      Prior to S1127 the scanning mirror 2 is positioned at the mirror home position.
      <br/>
      Thus, at S1127, the scanning mirror 2 is rotated by an amount corresponding to the number of pulses n and is positioned such that a different scanning line is imaged onto the image sensor 16.
    </p>
    <p num="287">
      At S1129, the CPU 301 reads the image signals for the new scanning line and, at S1133, compares the new image signals and the saved image signals.
      <br/>
      If the new image signals match the saved image signals (Yes at S1131), the scanning mirror 2 has not been moved far enough to find a focusable scanning line.
      <br/>
      Thus, at S1133, the CPU 301 checks if the scanning mirror 2 has reached the scanning end position.
      <br/>
      If the scanning mirror 2 has not reached the scanning end position (No at S1133), the process jumps back to S1125 to try a new scanning position.
    </p>
    <p num="288">If the scanning mirror 2 has reached the scanning end position (Yes at S1133), the scanning mirror 2 is reset at the mirror home position (S1135) and a similar process of reading image signals (S1137), driving the scanning motor 70 by n pulses (Sll39), reading new image signals (S1141), and comparing the new image signals with the saved image signals (S1143) is repeated in the reverse direction while checking if the scanning mirror 2 has reached the scanning start position (S1145).</p>
    <p num="289">
      If the scanning mirror 2 reaches the scanning start position (Yes at S1145), the CPU 301 determines that an error has occurred and executes an error process.
      <br/>
      This may be the case if the object O is in a very dark environment or the like.
    </p>
    <p num="290">If, at either of S1131 or S1143, the CPU 301 determines that a saved image is different from a new (i.e., currently input) image signal, there is a chance that an in-focus position may be determined for the new scanning line and the process jumps to S1147 of FIG. 43.</p>
    <p num="291">Recall that, as described above, the lens position pulse Ps represents an in-focus position of the imaging lens 3 for a scanning line represented by the scanning pulse counter X that is other than the reference scanning line.</p>
    <p num="292">Thus, using the lens position pulse Ps as a counter, the imaging lens 3 is driven forward while monitoring the contrast to determine an in-focus position for the imaging lens 3 similar to S1103 through S1121 described above.</p>
    <p num="293">In particular, the lens position pulse Ps is first set to 0 at S1147, the maximum and minimum brightness' Bmax and Bmin are determined at S1149, and the contrast is stored in the variable Bsub1 at S1151.</p>
    <p num="294">The variable Bsub1 is transferred to the variable Bsub2 (S1153), the lens driving motor 60 is rotated by one pulse forward (S1155) and the lens position pulse Ps is increased by one (S1157).</p>
    <p num="295">
      At the new lens position, image signals for the central 1000 pixels are read, and the maximum brightness Bmax and the minimum brightness Bmin are determined (S1159, S1161).
      <br/>
      At S1163, the difference between the maximum and minimum brightness is stored as the variable Bsub1.
    </p>
    <p num="296">
      At S1165, the CPU 301 determines if the lens position pulse Ps is less than 460 (i.e., the imaging lens 3 has returned to the lens home position).
      <br/>
      If the lens position pulse Ps is not less than 460 (No at S1165), the imaging lens 3 has returned to the lens home position without reaching an in-focus condition and the CPU 301 performs an error process.
    </p>
    <p num="297">
      If the lens position pulse Ps is less than 460 (Yes at S1165), the CPU 310 then checks if the variable Bsub2 is less than the variable Bsub1 at S1167.
      <br/>
      If so (Yes at S1167), a maximum of contrast has not been reached yet, and the process jumps to S1153 to advance the lens position and obtain a new contrast value for comparison.
      <br/>
      If the variable Bsub2 is not less than the variable Bsub1 (No at S1167), then a maximum of the contrast has been reached, and the lens pulse counter Paf representing an in-focus position for the reference scanning line is calculated based on Ps at S1169.
      <br/>
      As noted above, the approximation formula (12) may be manipulated and used to calculate Paf based on the value of Ps.
      <br/>
      The lens pulse counter Paf is then saved at S1171 and the CPU 301 returns to the main process.
    </p>
    <p num="298">
      Of course, in each of the above embodiments, concepts and procedures used An each of the other embodiments may be applied according to the requirements of the scanner 1.
      <br/>
      For example, in the first embodiment, a dark environment flag Fd is used in, for example, at S307 and S309, of the focusing process as an indicator of whether or not the object O is determined to be in a dark environment.
      <br/>
      A similar process may be used as appropriate with each of the other embodiments.
    </p>
    <p num="299">Further, although the above embodiments describe an arrangement for adjusting the position of the imaging lens 3 relative to the image sensor 16, the embodiments may alternatively be arranged for adjusting the position of the image sensor 16 relative to the imaging lens 3.</p>
    <p num="300">The present disclosure relates to subject matter contained in Japanese Patent Applications No. HEI 08-175779, filed on Jun. 14, 1996, No. HEI 08-177063, filed on Jun. 17, 1996, No. HEI 08-181402, filed on Jun. 20, 1996, No. HEI 08-181403, filed on Jun. 20, 1996, and No. HEI 09-145815, filed on May 20, 1997, which are expressly incorporated herein by reference in their entirety.</p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>An image reading device, comprising:</claim-text>
      <claim-text>a focusing lens for forming an image of an object; a linear image sensor for capturing said image, said image sensor including a plurality of image receiving elements arranged in a line along a predetermined direction, said plurality of image receiving elements outputting image signals corresponding to said image; a contrast detecting system which detects contrast data representative of a contrast of said image based on said image signals; a rotatable mirror arranged between said object and said focusing lens, said rotatable mirror being rotatable about an axis parallel to said predetermined direction and reflecting light from said object towards said focusing lens; a driving mechanism which moves at least one of said focusing lens and said image sensor to change a distance therebetween;</claim-text>
      <claim-text>and a focusing condition judging system which controls said contrast detecting system to detect said contrast data, controls said driving mechanism to move said at least one of said focusing lens and said image sensor, and determines an in-focus condition of said image in accordance with contrast data having a maximum value, which is obtained for various values of said distance between said focusing lens and said image sensor.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. The image reading device according to claim 1, wherein said focusing condition judging system controls said contrast detecting system to periodically detect said contrast data during said movement of said at least one of said focusing lens and said image sensor and judges whether said in-focus condition is obtained in accordance with a change in said contrast data.</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. The image reading device according to claim 1, wherein said focusing condition judging system controls said driving mechanism to periodically move said at least one of said lens and said image sensor by a predetermined unit amount and controls said contrast detecting system to detect said contrast data for each movement of said at least one of said focusing lens and said image sensor, and wherein said focusing condition judging system determines that said in-focus condition is obtained when a current contrast data is less than a previous contrast data.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. The image reading device according to claim 1, wherein said focusing condition judging system controls said driving mechanism to periodically move said at least one of said lens and said image sensor by a predetermined unit amount and controls said contrast detecting system to detect said contrast data for each movement of said at least one of said focusing lens and said image sensor, and wherein said focusing condition judging system determines that said in-focus condition is obtained when said contrast data is substantially a maximum valve.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. The image reading device according to claim 1, wherein said contrast data is detected by said contrast detecting system based on a difference between a maximum brightness image signal and a minimum brightness image signal.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. The image reading device according to claim 1, wherein said focusing condition judging system controls said driving mechanism to move said at least one of said focusing lens and said image sensor through a predetermined range and controls said contrast detecting system to detect said contrast data periodically during said movement, and wherein said focusing condition judging system determines said in-focus condition based on a maximum valve of said contrast data.</claim-text>
    </claim>
    <claim num="7">
      <claim-text>7. The image reading device according to claim 6, wherein said contrast data is detected by said contrast detecting system based on an average of a plurality of contrast measurements performed at a single position of said driving mechanism.</claim-text>
    </claim>
    <claim num="8">
      <claim-text>8. The image reading device according to claim 7, wherein said predetermined range is divided into a plurality of sub-ranges, and said contrast data is detected by said contrast detecting system based on an average of a plurality of contrast measurements performed at a predetermined number of positions of said driving mechanism within each of said sub-ranges, and said focusing condition judging system determines said in-focus condition based on said sub-ranges.</claim-text>
    </claim>
    <claim num="9">
      <claim-text>9. The image reading device according to claim 1, wherein said focusing condition judging system controls said driving mechanism such that said imaging lens is moved from a farthest position, located farthest from said image sensor, to a nearest position, nearest to said image sensor.</claim-text>
    </claim>
    <claim num="10">
      <claim-text>10. The image reading device according to claim 1, further comprising a projecting unit for projecting a contrast pattern towards said object, wherein if said focusing condition judging system fails to detect an in-focus condition, said projecting unit is turned ON and said focusing condition judging system is operated again.</claim-text>
    </claim>
    <claim num="11">
      <claim-text>11. The image reading device according to claim 9, wherein when said imaging lens and said image sensor are located at a maximum distance apart, said focusing condition judging system controls said contrast detecting system to detect projecting unit contrast data when said projecting unit is ON, compares said projecting unit contrast data with said contrast data, and determines that said in-focus condition is obtained if said projecting unit contrast data and said contrast data match.</claim-text>
    </claim>
    <claim num="12">
      <claim-text>12. The image reading device according to claim 11, wherein, if said projecting unit contrast data and said contrast data do not match, said focusing condition judging system controls said driving mechanism to move said at least said imaging lens or said image sensor such that said imaging lens and said image sensor move closer together while detecting an in-focus condition based on said contrast data.</claim-text>
    </claim>
    <claim num="13">
      <claim-text>13. The image reading device according to claim 1, further comprising a projecting unit for projecting a contrast pattern towards said object, wherein said projecting unit is turned ON during operation of said focusing condition judging system.</claim-text>
    </claim>
    <claim num="14">
      <claim-text>14. The image reading device according to claim 1, wherein said focusing condition judging system further controls said rotatable mirror such that, if said in-focus condition is not obtained, said rotating mirror is rotated until said contrast detecting system detects a change of the contrast data.</claim-text>
    </claim>
    <claim num="15">
      <claim-text>15. The image reading device according to claim 14, wherein, if said change of the contrast data is detected, said focusing condition judging system controls said driving mechanism and said contrast detecting system to detect an in-focus condition.</claim-text>
    </claim>
    <claim num="16">
      <claim-text>16. The image reading device according to claim 15, wherein said focusing condition judging system calculates a home in-focus condition, representing an in-focus condition of said image when said rotatable mirror is at a home position, based on said in-focus condition.</claim-text>
    </claim>
    <claim num="17">
      <claim-text>17. The image reading device according to claim 16, wherein said home position is a center of a movable range of said rotatable mirror.</claim-text>
    </claim>
    <claim num="18">
      <claim-text>18. The image reading device according to claim 1, further comprising a projecting unit for projecting a contrast pattern towards said object, wherein said contrast pattern is projected by said rotatable mirror.</claim-text>
    </claim>
    <claim num="19">
      <claim-text>19. An image reading device, comprising: a focusing lens for forming an image of an object; a linear image sensor for capturing said image, said image sensor including a plurality of image receiving elements arranged in a line along a predetermined direction, said plurality of image receiving elements outputting image signals corresponding to said image; a contrast detecting system which detects contrast data representative of a contrast of said image based on said image signals; a rotatable mirror arranged between said object and said focusing lens, said rotatable mirror being rotatable about an axis parallel to said predetermined direction and reflecting light from said object towards said focusing lens; a driving mechanism which moves at least one of said focusing lens and said image sensor to change a distance therebetween;</claim-text>
      <claim-text>and a focusing condition judging system which controls said contrast detecting system to detect said contrast data, controls said driving mechanism to move said at least one of said focusing lens and said image sensor, and determines an in-focus condition of said image in accordance with contrast data, said contrast data comprising a sum of a difference of image signals for adjacent image receiving elements of said image sensor, which is obtained for various values of said distance between said focusing lens and said image sensor.</claim-text>
    </claim>
  </claims>
</questel-patent-document>