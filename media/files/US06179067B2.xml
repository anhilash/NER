<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06179067B2.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as second publication">
      <document-id>
        <country>US</country>
        <doc-number>06179067</doc-number>
        <kind>B2</kind>
        <date>20010130</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6179067</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B2</original-publication-kind>
    <application-reference family-id="22215686" extended-family-id="1202540">
      <document-id>
        <country>US</country>
        <doc-number>09329857</doc-number>
        <kind>A</kind>
        <date>19990611</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1999US-09329857</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>1422453</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>32985799</doc-number>
        <kind>A</kind>
        <date>19990611</date>
        <priority-active-indicator>N</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1999US-09329857</doc-number>
      </priority-claim>
      <priority-claim kind="national" sequence="2">
        <country>US</country>
        <doc-number>8910098</doc-number>
        <kind>P</kind>
        <date>19980612</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="2">
        <doc-number>1998US-60089100</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010130</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>E21B  47/022       20120101A I20111231RMEP</text>
        <ipc-version-indicator>
          <date>20120101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>E</section>
        <class>21</class>
        <subclass>B</subclass>
        <main-group>47</main-group>
        <subgroup>022</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20111231</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>175045000</text>
        <class>175</class>
        <subclass>045000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>033304000</text>
        <class>033</class>
        <subclass>304000</subclass>
      </further-classification>
      <further-classification sequence="2">
        <text>702006000</text>
        <class>702</class>
        <subclass>006000</subclass>
      </further-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>E21B-047/022</text>
        <section>E</section>
        <class>21</class>
        <subclass>B</subclass>
        <main-group>47</main-group>
        <subgroup>022</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>E21B-047/022</classification-symbol>
        <section>E</section>
        <class>21</class>
        <subclass>B</subclass>
        <main-group>47</main-group>
        <subgroup>022</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>10</number-of-claims>
    <exemplary-claim>1</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>5</number-of-drawing-sheets>
      <number-of-figures>8</number-of-figures>
      <image-key data-format="questel">US6179067</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Method for magnetic survey calibration and estimation of uncertainty</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>DIPERSIO RICHARD D</text>
          <document-id>
            <country>US</country>
            <doc-number>5452518</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5452518</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>TOWLE JAMES N, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5960370</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5960370</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="3">
          <text>VAN DONGEN JOHANNES C M, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>4682421</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4682421</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="4">
          <text>WALTERS PHILIP H</text>
          <document-id>
            <country>US</country>
            <doc-number>4709486</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4709486</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="5">
          <text>COLES MARK</text>
          <document-id>
            <country>US</country>
            <doc-number>4956921</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4956921</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="6">
          <text>ENGEBRETSON HAROLD J</text>
          <document-id>
            <country>US</country>
            <doc-number>5321893</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5321893</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="7">
          <text>BROOKS ANDREW G</text>
          <document-id>
            <country>US</country>
            <doc-number>5623407</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5623407</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="8">
          <text>HALLIBURTON CO</text>
          <document-id>
            <country>EP</country>
            <doc-number>0793000</doc-number>
            <kind>A2</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>EP-793000</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="applicant">
        <patcit num="9">
          <text>BAROID TECHNOLOGY INC, et al</text>
          <document-id>
            <country>GB</country>
            <doc-number>2305250</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>GB2305250</doc-number>
          </document-id>
        </patcit>
      </citation>
    </references-cited>
    <related-documents>
      <related-publication>
        <document-id>
          <country>US</country>
          <doc-number>60/089,100</doc-number>
          <date>19980612</date>
        </document-id>
        <document-id>
          <country>US</country>
          <doc-number>60/089100</doc-number>
          <date>19980612</date>
        </document-id>
      </related-publication>
    </related-documents>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Baker Hughes Incorporated</orgname>
            <address>
              <address-1>Houston, TX, US</address-1>
              <city>Houston</city>
              <state>TX</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>BAKER HUGHES</orgname>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Brooks, Andrew G.</name>
            <address>
              <address-1>Houston, TX, US</address-1>
              <city>Houston</city>
              <state>TX</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <orgname>Madan, Mossman &amp; Sriram, P.C.</orgname>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Pezzuto, Robert E.</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>GRANTED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      The present invention provides a method for determining magnetometer errors during wellbore survey operations.
      <br/>
      It is capable of determining errors on up to three axes, with or without the use of an external reference measurement of the local magnetic field, and is capable of providing an accurate result using data from a minimum number of surveys.
      <br/>
      A model is used to correct the observed data and the corrected data are transformed from the tool coordinate system to a different coordinate system referenced to the earth.
      <br/>
      The difference between the corrected transformed data and reference data in the earth coordinate system is minimized to determine the model parameters.
      <br/>
      The present invention also provides a method for determining residual uncertainty in the measurements and for quality control of the measurements.
      <br/>
      By making the observations over a period of time, any deterioration of the sensors may be identified.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>CROSS REFERENCES TO RELATED APPLICATIONS</heading>
    <p num="1">This application takes priority from U.S. Provisional Patent Application Serial No. 60/089,100 filed on Jun. 12, 1998.</p>
    <heading>BACKGROUND OF THE INVENTION</heading>
    <p num="2">
      1.
      <br/>
      Field of the Invention
    </p>
    <p num="3">
      Surveying of wellbore orientation is commonly performed by the use of instruments containing sets of three orthogonal accelerometers and magnetometers, which are inserted within the drillstring and used to measure the orientations of the local gravitational and magnetic field vectors.
      <br/>
      In order to measure the earth's magnetic field, which is used as a north reference from which wellbore azimuth may be computed, the instruments must be placed within a section of non-magnetic material extending between upper and lower ferromagnetic drillstring sections.
      <br/>
      These ferromagnetic portions of the drillstring tend to acquire magnetization as they are repeatedly strained in the earth's magnetic field during drilling operations.
      <br/>
      The nominally non-magnetic portion of the drillstring may also acquire some lesser magnetization as a result of imperfections.
      <br/>
      The result is that magnetometer measurements made by an instrument within a drillstring may measure not the undisturbed magnetic field, but the vector sum of the earth's field and an error field caused by drillstring magnetization.
      <br/>
      Since the tool is fixed with respect to the drillstring, the error field is fixed with respect to the tool's coordinate system and it appears as bias errors on the magnetometer measurements, which can lead to errors in the determination of wellbore azimuth and trajectory unless measures are taken to compensate for these bias errors.
    </p>
    <p num="4">2. Description of the Prior Art</p>
    <p num="5">
      Since the greater part of the drillstring magnetization occurs in the ferromagnetic portions of the drillstring, which are displaced axially from the instrument, the bias error in the axial direction usually exceeds the transverse bias errors.
      <br/>
      Various methods have therefore been published which seek to determine axial magnetometer bias errors in a single directional survey, including U.S. Pat. No. 3,791,043 to Russell, U.S. Pat. No. 4,163,324 to Russell, U.S. Pat. No. Re. 33,708 to Roesler, U.S. Pat. No. 4,761,889 to Cobern, U.S. Pat. No. 4,819,336 to Russell, U.S. Pat. No. 4,999,920 to Russell, and U.S. Pat. No. 5,155,916 to Engebretson.
      <br/>
      All of these methods require the provision of an independent estimate of one or more components of the earth's magnetic field, and as a result all of them tend to lose accuracy in those attitudes in which the direction of the independent estimate is perpendicular to the drillstring and therefore contributes little or no axial information.
      <br/>
      In particular, all of these methods lose accuracy as the wellbore attitude approaches horizontal east-west.
      <br/>
      A number of methods have also been published which seek to determine magnetometer biases on all three axes, including U.S. Pat. No. 4,682,421 to van Dongen and U.S. Pat. No. 4,956,921 to Coles, and UK Pat.
      <br/>
      No. 2,256,492 to Nicolle.
      <br/>
      While certain of these methods can resolve transverse bias components without external estimates of the field, they all require an independent estimate of the earth's magnetic field in order to determine the axial bias component, and therefore they also tend to lose accuracy as the attitude approaches horizontal east-west. U.S. Pat. No. 4,709,486 to Walters discloses a method for determining axial bias errors without any external estimate, by the simultaneous use of transverse magnetometer data from a plurality of surveys.
      <br/>
      However the method fails to make use of the valuable information contained in the axial magnetometer measurements, since it does not require any correlation between the axial biases determined at the plurality of attitudes.
      <br/>
      In U.S. Pat. No. 5,321,893, Engebretson discloses a method which may be used to determine magnetometer scale factor and bias errors from a plurality of surveys with or without requiring any external estimate of the earth's field.
      <br/>
      However, the method is inherently approximate since it requires the construction of a "measurement matrix", whose elements depend on the unknown borehole attitude and magnetic dip angle. U.S. Pat. No. 5,623,407 to the present inventor and having the same assignee discloses a method for determining magnetometer biases during wellbore survey operations, which is capable of determining biases on up to three axes, with or without the use of an external estimate of the local magnetic field, and which is capable of providing an accurate result using data from a minimum number of surveys.
      <br/>
      Also disclosed in U.S. Pat. No. 5,623,407 is a method for determining magnetometer biases which may vary between surveys in a predefined manner.
      <br/>
      What is lacking in prior art is the ability to deal with biases in the accelerometer and properly correcting for the, and the ability to estimate the uncertainty of correlated measurements.
    </p>
    <p num="6">Additional objectives, features and advantages of the present invention will be apparent in the written description which follows.</p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="7">
      The present invention provides a method for determining magnetometer errors during wellbore survey operations.
      <br/>
      It is capable of determining errors on up to three axes, with or without the use of an external reference measurement of the local magnetic field, and is capable of providing an accurate result using data from a minimum number of surveys.
      <br/>
      A model is used to correct the observed data and the corrected data are transformed from the tool coordinate system to a different coordinate system referenced to the earth.
      <br/>
      The difference between the corrected transformed data and reference data in the earth coordinate system is minimized to determine the model parameters.
      <br/>
      The present invention also provides a method for determining residual uncertainty in the measurements and for quality control of the measurements.
      <br/>
      By making the observations over a period of time, any deterioration of the sensors may be identified.
    </p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="8">
      The novel features believed characteristic of the invention are set forth in the appended claims. The invention itself, however, as well as a preferred mode of use, further objectives and advantages thereof, will best be understood by reference to the following detailed description of an illustrative embodiment when read in conjunction with the accompanying drawings, wherein:
      <br/>
      FIG. 1 shows a typical drilling operation comprising a drilling rig, a drillstring including a survey instrument, and a fluid circulating system;
      <br/>
      FIG. 2 shows a typical tool-fixed coordinate system used by a magnetic survey instrument located within a drillstring;
      <br/>
      FIG. 3 (PRIOR ART) shows the application of conventional methods for the correction of bias errors based upon external field measurements;
      <br/>
      FIG. 4 shows the application of the present invention for correction of errors in multiple surveys;
      <br/>
      FIG. 5 shows the result of using the present invention on a near horizontal east-west survey;
      <br/>
      FIG. 6 shows the result of using the present invention on test stand data;
      <br/>
      FIG. 7 shows test stand data with magnetization errors; and
      <br/>
      FIG. 8 shows a comparison of the present method with a high accuracy inertial navigation survey.
    </p>
    <heading>DETAILED DESCRIPTION OF THE INVENTION</heading>
    <p num="9">
      FIG. 1 illustrates a rig engaged in drilling operations; the equipment includes a derrick 1, drawworks 2, cable 3, crown block 4, traveling block 5, and hook 6, supporting a drillstring which includes a swivel joint 7, kelly 8, drillpipe 9, drill collars 10, and drill bit 11.
      <br/>
      Pumps 12 circulate drilling fluid through a standpipe 13 and flexible hose 14, down through the hollow drillstring and back to the surface through the annular space 15 between the drillstring and the borehole wall 16.
      <br/>
      During the course of drilling a borehole for oil or gas exploration, it is advantageous to measure from time to time the orientation of the borehole in order to determine its trajectory.
      <br/>
      This can be accomplished by the use of a survey tool 17 located within the drill collars 10, for measuring the direction and magnitude of the local gravitational and magnetic fields with respect to a tool-fixed coordinate system.
      <br/>
      It is customary to take one survey each time the drilling operation is interrupted to add a new section to the drilistring; however, surveys can be taken at any time.
    </p>
    <p num="10">
      Still referring again to FIG. 1, the measured data are transmitted to the surface by modulating a valve (not shown) placed in the flow passage within or adjacent to survey tool 17, causing pressure pulses to propagate in the mud column up the drillstring, where they are detected by a pressure transducer 18 placed in the standpipe 13 and communicated to data processing system 24 which may be located on the rig floor or in a logging trailer or other work area, which is approximately programmed to (1) to interpret the pressure pulses (2) eliminate the influence of magnetic field bias error components and (3) calculate one or more conventional wellbore orientation indicators.
      <br/>
      Data processing system 24 may be programmed in accordance with the present invention.
      <br/>
      Other methods and devices for communicating data uphole, such as electromagnetic methods or acoustic signals in the drillstring, could also be used and are intended to be within the scope of the invention.
    </p>
    <p num="11">
      The borehole inclination can be determined by use of the gravitational measurements alone, while the borehole azimuth is determined from the gravitational and magnetic measurements; since the azimuth uses the direction of the local magnetic field as a north reference, it is necessary for the survey tool 17 to be placed in non-magnetic portions 19 and 20 of the drillstring situated between upper and lower ferromagnetic sections 21 and 22.
      <br/>
      Magnetization of the upper and lower ferromagnetic sections 21 and 22, as well as imperfections in the non-magnetic materials comprising the survey tool 17 and the non-magnetic collars 19 and 20 can produce a magnetic error field, which is fixed in the tool's frame of reference and which therefore appears as bias errors affecting the magnetic measurements.
      <br/>
      The present invention is directed to determining these errors in order to compensate for their presence and thus to provide more accurate measurements of borehole azimuth.
    </p>
    <p num="12">
      The invention will first be described as it pertains to solving for constant bias errors along each axis.
      <br/>
      It is conventional to define the tool-fixed coordinates as x, y and z, the z-coordinate being aligned with the drillstring axis as illustrated in FIG. 2.
      <br/>
      The instrument measures three components Gx, Gy and Gz of the gravitational vector G, and three components Bx, By and Bz of the magnetic flux density vector B.
    </p>
    <p num="13">
      The principal sources of azimuth uncertainty in magnetic surveys are sensor errors, uncertainty in the magnetic declination, instrument misalignment, and drilling magnetization.
      <br/>
      The overall uncertainty at a bottomhole location tends to be dominated by the declination and magnetization errors, since these are systematic over a group of surveys.
      <br/>
      Arrays of accelerometers and magnetometers respectively measure the direction of the gravity and magnetic field vectors with respect to the tools x-y-z coordinate frame.
      <br/>
      The azimuth is then computed as  (Equation image '1' not included in text)
    </p>
    <p num="14">Accelerometer and magnetometer sensor errors  EPSILON g and  EPSILON b cause the measurements to be imprecise, and the consequent uncertainties in azimuth may be estimated as  (Equation image '2' not included in text)</p>
    <p num="15">where Bh and Bv are the horizontal and vertical components of the local magnetic flux density, and I is the inclination.</p>
    <p num="16">
      The accelerometer and magnetometer errors are uncorrelated, thus the overall azimuth uncertainty due to sensor errors is
      <br/>
      DELTA A=( DELTA Ag2 + DELTA Ab2)0.5  (4)
    </p>
    <p num="17">
      Incorrect declination values are a primary source of azimuth error in magnetic surveys.
      <br/>
      One method of avoiding large declination errors is a site survey and in-field referencing to provide local magnetic field parameters in real time.
    </p>
    <p num="18">Another source of errors in survey tools is misalignment of the tool's axis with the borehole, however these azimuth errors are usually small in comparison with the others and their effect tends to be randomized as the toolface angle changes between surveys.</p>
    <p num="19">
      Yet another source of errors arises from the fact that as magnetic drillstring materials are rotated and stressed in the earth's magnetic field, they may develop permanent magnetization.
      <br/>
      Some components may be magnetized further during inspection and transportation.
      <br/>
      Magnetic poles are produced close to the ends of each member of the drillstring, although some components may also develop intermediate poles.
      <br/>
      Each pole produces an error field at the sensor proportional to its pole strength and inversely proportional to the square of its distance from the sensor.
      <br/>
      The error field seen by the sensor is assumed to be the sum of the contributions from all the poles.
    </p>
    <p num="20">
      Since magnetic drillstring components are normally spaced at least several meters axially from the sensors, the error fields due to permanent magnetization tend to be closely aligned with the z-axis.
      <br/>
      The error field therefore appears equivalent to a bias error on the z-magnetometer.
      <br/>
      A cross-axial bias effect may also be present as a result of off-axis magnetic poles, drillstring bending, or hot spots in nonmagnetic collars, but the cross-axial effect is typically an order of magnitude smaller than axial.
    </p>
    <p num="21">
      Magnetic drillstring components may exhibit both remanent and induced magnetization.
      <br/>
      The error field due to induced magnetization is caused by magnetic poles where the flux enters or leaves the more permeable materials; it is proportional to the magnitude of the external field and therefore it appears similar to a magnetometer scale factor error.
      <br/>
      The induced error field is not necessarily parallel to the external field, thus the apparent scale factor errors may differ among the three magnetometer axes.
      <br/>
      Experiments have shown that the induced axial magnetization associated with drillstring components is usually small in comparison with the remanent component, and its effect may sometimes be masked by downhole changes in remanent magnetization over a period of time.
      <br/>
      The error field due to induced magnetization is particularly small near the important horizontal east-west attitudes, as the axial component of the external field then approaches zero.
    </p>
    <p num="22">
      Conventional magnetic corrections process each survey independently, by assuming the error field to be aligned with the z-axis.
      <br/>
      The unknown z-component of the flux density leaves a single degree of freedom between the components of the local field.
    </p>
    <p num="23">
      A prior art method is illustrated schematically in FIG. 3.
      <br/>
      The abscissa 101 is the horizontal component of the magnetic field and the ordinate 103 is the vertical component of the magnetic field.
      <br/>
      Different points along the curve 105 correspond to different biases in the z-component of the gravity measurement and corresponding values of the apparent azimuth of the tool.
      <br/>
      The equations relating the gravity measurements to the magnetometer measurements are:
      <br/>
      Gmeas =(Gxmeas2 +Gymeas2 +Gzmeas2)0.5
      <br/>
      Bmeas =(Bxmeas2 +Bymeas2 +Bzmeas2)0.5
    </p>
    <p num="24">
      Bvmeas =(Bxmeas Gxmeas +Bymeas Gymeas +Bzmeas Gzmeas)/Gmeas
      <br/>
      Bhmeas =(Bmeas2 -Bvmeas2)0.5
    </p>
    <p num="25">
      The point 107 represents an externally supplied reference field measurement.
      <br/>
      Methods for obtaining this reference measurements are discussed below.
      <br/>
      In prior art, the solution is taken as the point 109 on the curve which minimizes the vector distance to the externally-supplied reference field.
      <br/>
      This point is obtained by dropping a perpendicular from 107 to the curve.
    </p>
    <p num="26">
      The major problem with prior art corrections of this type is that their accuracy degrades in horizontal boreholes having an east-west orientation.
      <br/>
      These attitudes are, unfortunately, those in which the drillstring magnetization effects tend to reach a maximum.
    </p>
    <p num="27">
      The present invention uses data from a number of surveys and explicitly assumes that error components are common to all surveys.
      <br/>
      Based on this assumption, the variance among apparent local field values is minimized.
      <br/>
      For example, if a common axial magnetic error component is estimated as a bias  EPSILON bz, the z-magnetometer measurement of the n-th survey can be corrected by
      <br/>
      Bzcorrn  =Bzmeasn  - EPSILON bz  (5)
    </p>
    <p num="28">The vertical and horizontal components of the local magnetic flux density can then be computed by  (Equation image '3' not included in text)</p>
    <p num="29">
      Bvn and Bhn are thus measurements that have been corrected and transformed from the tool coordinate system (x,y,z) to horizontal and vertical coordinates, i.e., an earth-referenced coordinate system.
      <br/>
      The variance in the corrected transformed measurements over N surveys with respect to reference vertical and horizontal measurements Bvref and Bhref is thus  (Equation image '4' not included in text)
    </p>
    <p num="30">
      Those versed in the art would recognize that instead of horizontal and vertical reference data, the reference data could be in any other set of coordinates.
      <br/>
      Such variations are intended to be within the scope of the invention.
    </p>
    <p num="31">
      The method of using multiple surveys is illustrated in FIG. 4, where three surveys are shown, depicted by 123, 125 and 127.
      <br/>
      The raw data are indicated by the points 123a, 125a and 127a.
      <br/>
      The data corresponding to one trial value of the z-magnetometer bias  EPSILON bz are denoted by 123b, 125b and 127b.
      <br/>
      Correction with a second trial value of the z-magnetometer bias  EPSILON bz are denoted by 123c, 125c and 127c while correction with a third trial value of the magnetometer bias gives the points 123d, 125d and 127d.
      <br/>
      In this example, the points are grouped most closely about the reference value 107 and the variance is minimized by using trial value 3 (corresponding to zone 135).
      <br/>
      A bias value close to this is selected as the optimum and the surveys are corrected accordingly.
    </p>
    <p num="32">Since the variance V is nonlinear with respect to  EPSILON bz, it is minimized by setting ( DELTA V/ DELTA  EPSILON bz) to zero, using an iterative technique such as Newton's method, in which successive approximations to  EPSILON bz are obtained by  (Equation image '5' not included in text)</p>
    <p num="33">After the iterative process converges to a solution, the residual value of V may be used as a quality indicator and as an input quantity for the calculation of residual uncertainty.</p>
    <p num="34">
      This invention is not limited to solving for a single unknown  EPSILON bz.
      <br/>
      It can be extended to solve for any number of unknown parameters, limited only by the number of surveys.
      <br/>
      The m unknowns are expressed as a vector U, then the solution is obtained by iteration:  (Equation image '6' not included in text)
    </p>
    <p num="35">
      where (.differential.V/.differential.U) is a vector of length m, and (.differential.2 V/.differential.U2) is a mxm matrix.
      <br/>
      This is done in the preferred embodiment of the intention.
    </p>
    <p num="36">
      In one embodiment of the invention, the unknown vector U can contain coefficients applicable to each of the three sensor axes.
      <br/>
      The unknowns may include not only the magnetometer coefficients, but also accelerometer parameters.
      <br/>
      In this case, the expression for V is of the form  (Equation image '7' not included in text)
    </p>
    <p num="37">
      where W is a weighting factor relating the measurement units and the residual uncertainties in the G and B fields.
      <br/>
      The same method may be used for determining biases, scale factors, and misalignments from data obtained during total field calibrations in the laboratory.
      <br/>
      Since the errors in the magnetic field have no effect on the accelerometer measurements, an alternate embodiment of the invention solves for the accelerometer term alone, i.e., minimizing equation (11) with W having a very large value, and then repeating the minimization using values of the accelerometer parameters to find the magnetometer parameters that minimize equation (8).
      <br/>
      Coefficients for computing reference magnetic field values for use in equations (8) and (11) are regularly published by agencies such as the British Geologic Survey.
    </p>
    <p num="38">
      Another embodiment of the invention can be used where there is no independent estimate of the reference field.
      <br/>
      The reference values in equations (8) and (11) for variance are replaced by mean values.
      <br/>
      After making the computation, the mean field components provide an estimate of the local field without the need for any external information.
    </p>
    <p num="39">
      Another embodiment of the invention uses in-field referencing (IFR) or interpolation in-field referencing (IIFR).
      <br/>
      As would be known to those versed in the art, IFR provides an onsite monitoring of the local magnetic field of the earth and IIFR makes use of monitoring of the magnetic field of the earth at a location away from the wellsite in combination with a single onsite survey.
      <br/>
      This embodiment makes use of updated three-component reference field values for each survey.
      <br/>
      Substantial improvement in survey quality is obtained when the correction is combined with IFR or IIFR.
      <br/>
      By addressing both drilistring interference and declination uncertainty, the two largest contributors to azimuth uncertainty have been reduced.
    </p>
    <p num="40">
      For subsurface anomalies, or for IIFR applications without a site survey, the present invention can calculate two components of the local flux density, although not the declination.
      <br/>
      Offsets are added to the reference components in the variance expression, and they are solved as additional elements of the unknown vector U. Specifically, these may be a bias term in the reference field and a bias term in the dip angle.
      <br/>
      In the case where all three magnetometer scale factor errors are unknowns, a local dip offset can still be determined, although the reference total flux density must then be accepted from an external source.
      <br/>
      This mode of operation is limited by the assumption that the anomalies are the same for all surveys processed as a group.
    </p>
    <p num="41">
      Unlike conventional corrections, the multiple-survey technique makes use of the z-magnetometer measurements and consequently it can still provide a robust solution in attitudes near horizontal east-west.
      <br/>
      An example of this is given in FIG. 5.
      <br/>
      The abscissa 151 is the depth and the ordinate 153 is the determined azimuth.
      <br/>
      Without using the multiple surveys of the present invention, the results of a prior art, single-survey correction, given by the curve 161 are relatively unstable.
      <br/>
      Curve 163 corresponds to no correction being made while curve 165 shows corrections with the use of multiple surveys in combination with IIFR.
      <br/>
      The gap 166 shows a steady difference when curve 165 is compared to the uncorrected curve 163.
    </p>
    <p num="42">
      Since the computation can identify and correct most of the systematic errors common to all surveys in the set, the residual errors are modeled as random errors or sensor noise.
      <br/>
      The magnitude of the noise can be estimated from sensor specifications and knowledge of the local field, or it can be estimated more directly from the residual variance V observed in total flux density.
      <br/>
      The square root of V may be used to approximate the standard deviation  SIGMA  of the noise on each magnetometer channel.
      <br/>
      For a three-axis correction, the effect on the solution vector of this level of noise is approximated by the covariance matrix  (Equation image '8' not included in text)
    </p>
    <p num="43">
      where Uij is the solution obtained when the 1- SIGMA  noise perturbation was applied to the i-th magnetometer channel for the j-th survey, and U is the unperturbed solution.
      <br/>
      The index i in equation 12 corresponds to the three coordinate axes of the tool while the index j corresponds to the number of surveys.
      <br/>
      Elements of the normalized covariance matrix (C/V) can be used to indicate matrix condition and stability of the solution.
      <br/>
      The effect on azimuth at each survey station can be expressed at one standard deviation by  (Equation image '9' not included in text)
    </p>
    <p num="44">where Aij is the azimuth value at that station computed using sensor measurements adjusted by the coefficient vector Uij, and A is the azimuth corresponding to U.</p>
    <p num="45">Similarly, the uncertainty in the borehole position may be estimated by  (Equation image '10' not included in text)</p>
    <p num="46">where rij is the position vector with components (north, east, vertical) determined using perturbed measurements, and r is the unperturbed value of the position vector.</p>
    <p num="47">
      To verify the validity of the method, a magnetic survey probe was placed in a calibrated precision stand in a magnetically clean environment with a reference probe alongside.
      <br/>
      The stand was then moved through a series of positions with inclinations ranging from near-vertical north to approximately horizontal east, with a wide range of toolface angles.
      <br/>
      The angles selected are representative of those encountered in a single well, although it is unlikely that a single magnetic survey tool would see such a wide range in a single run.
      <br/>
      The correction algorithm was used to estimate scale factor and bias values for each accelerometer and magnetometer axis.
      <br/>
      FIG. 6 shows the results of the comparison.
      <br/>
      The abscissa 201 is the inclination angle (in degrees) and the ordinate 203 is the error in azimuth determination (in degrees), defined as the difference between the nominal test stand position and the measured angle, obtained with the correction 207 and without the correction 205.
    </p>
    <p num="48">
      The ability of the algorithm to reduce effects due to magnetic interference was examined by repeating the experiment, with a socket with unknown magnetization mounted near the bottom end of the probe.
      <br/>
      The results are depicted in FIG. 7.
      <br/>
      The abscissa 221 is the inclination of the tool (in degrees) and the ordinate 223 is the error in azimuth (in degrees).
      <br/>
      The survey 231 shows the results when no correction was applied while the survey 225 shows the results of using the method of the present invention.
      <br/>
      Also shown in FIG. 7 is the estimated residual uncertainty at the two standard deviation level.
      <br/>
      This is depicted by the point 226 and the bars extending on either side of the point 226 to the two standard deviation points 226a, 226b.
      <br/>
      Application of the correction reduced the maximum azimuth error from more than 4 degrees to less than 0.4 degrees.
      <br/>
      Processing the raw data with a conventional single survey magnetic correction algorithm produced errors (not shows) in excess of 10 degrees in attitudes near horizontal east-west.
    </p>
    <p num="49">
      Still referring to FIG. 7, the expected azimuth uncertainty at each station was computed using the residual variance in total gravity field to estimate the standard deviation of the accelerometer errors, then using equation (2) to determine the standard deviation of the azimuth uncertainty due to accelerometer errors.
      <br/>
      Next, the residual variance in total magnetic flux density was used to find the standard deviation of the magnetometer errors, and equation (13) was used to find the standard deviation of the azimuth uncertainly due to magnetometer errors.
      <br/>
      The overall azimuth uncertainty was then determined by using equation (4) to combine the uncorrelated accelerometer and magnetometer contributions.
      <br/>
      In this controlled experiment, the observed residual errors appear to conform well within their predicted values, which are at a ninety-five percent (95%) confidence level.
    </p>
    <p num="50">
      Since the method can correct for most systematic errors that are correlated between the measurements, the residual errors may be considered to be uncorrelated random errors.
      <br/>
      Each of these residuals propagates into all of the correlated measurements through errors in the computed coefficients.
      <br/>
      These errors are important since they can become large in ill-conditioned cases.
    </p>
    <p num="51">The solution to the equations .differential.V/.differential.U=0 can be solved iteratively as indicated in equation (10), and the final variance V gives the noise on the individual recording channels and serves as a quality control check on the data acquisition procedure.</p>
    <p num="52">The errors due to M individual measurements can then be combined into a covariance matrix C that describes the overall uncertainty in the computed coefficient vector U by the relation  (Equation image '11' not included in text)</p>
    <p num="53">The effect on azimuth at each survey station can be expressed at one standard deviation by equation (13) above.</p>
    <p num="54">
      The quality control (QC) aspect is used to aid post drilling assessment of the magnetic data on a daily basis.
      <br/>
      In order to exclude unreliable surveys from the data set, user-definable setpoints are used to reject surveys based on excessive departure of their total gravity field, total magnetic field, or dip angle.
      <br/>
      These setpoints are normally set to values consistent with tool performance as claimed in the position uncertainty model.
      <br/>
      For surveys which do not pass the setpoints, checkshots can be taken subsequently with the same tool to replace the suspect data.
    </p>
    <p num="55">
      The calculation algorithm is used with IFR or IIFR techniques to determine apparent calibration coefficients.
      <br/>
      Trend analysis is then undertaken to establish if there is any apparent deterioration in accelerometer or magnetometer performance, and to verify whether the tool performance is maintained within the specification established at the calibration stage.
      <br/>
      The trend analysis can be used to advise the operational personnel that, even though the tool may be performing within specification at the moment, consideration should be given to replacing the tool on the next trip out of hole.
    </p>
    <p num="56">Those versed in the art would recognize that any misalignment of sensors in the tool with respect to the tool's (x,y,z) axis would show up in a systematic manner in the determined biases and could be determined by including them in the unknown vector U. The present invention also includes the ability to detect such misalignment.</p>
    <p num="57">
      The drillstring interference effect can be estimated by the change in azimuth introduced by the correction.
      <br/>
      To provide acceptable surveys without making magnetic corrections, this azimuth change should be less than the uncorrelated statistical sum of the allowable magnetic interference effect as stated in the error model, and the residual uncertainty of the correction, each evaluated at the appropriate confidence level.
    </p>
    <p num="58">
      As in prior art, the present invention includes the capability for transmitting measurements to the earth's surface utilizing measurement-while-drilling (MWD) transmission techniques.
      <br/>
      These data may be used by a processor 24 that is preprogrammed in accordance with the methods discussed above.
      <br/>
      The program includes as inputs the x-, y- and z-components of the local magnetic and gravitational fields at each survey station.
      <br/>
      The calculations are performed in accordance with the description above, and the processor provides as an output for each survey station the wellbore azimuth and inclination.
      <br/>
      In an alternate embodiment of the invention, the processor may be downhole, and reference field measurements may be transmitted downhole to the processor.
    </p>
    <p num="59">
      FIG. 8 is an example of a survey that has been corrected using the multiple survey technique.
      <br/>
      The results of using the IIFR method alone are shown by the curve 251.
      <br/>
      The results of using the IIFR method with the present invention are shown by 253 while 255 is the result of an accurate Inertial Navigation Survey in the same borehole.
      <br/>
      The combination of the IIFR and the multiple survey correction 253 results in azimuth values extremely close to those obtained from a high accuracy inertial navigation tool 255.
      <br/>
      In this case, the computed residual uncertainty, depicted by the error bars on curve 253 appears to be conservative when compared to the azimuth difference between the magnetic and inertial tools.
    </p>
    <p num="60">
      The present intention is illustrated by way of the foregoing description, and various modifications will be apparent to those skilled in the art.
      <br/>
      It is intended that all such variations be within the scope and spirit of the appended claims.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
      <claim-text>1.</claim-text>
      <claim-text>A method of correcting magnetic and gravitational measurement errors during drilling of a wellbore, comprising:</claim-text>
      <claim-text>(a) obtaining a plurality of magnetic and gravitational measurements at selected locations in said wellbore; (b) using a model comprising a set of model parameters for correcting values of said plurality of magnetic and gravitational measurements and producing therefrom a plurality of corrected magnetic and gravitational measurements; (c) performing a coordinate transformation of the plurality of corrected magnetic and gravitational measurements to give a plurality of transformed corrected magnetic and gravitational measurements; (d) defining a measure of a difference between the plurality of transformed corrected measurements and reference values of magnetic and gravitational measurements; (e) determining values for the set of model parameters that minimize the measure of difference giving a minimized residual;</claim-text>
      <claim-text>and (f) using the determined values of the model parameters and the minimized residual for obtaining a quantitative estimate of the accuracy of one or more of the plurality of magnetic and gravitational measurements.</claim-text>
    </claim>
    <claim num="2">
      <claim-text>2. The method of claim 1 wherein the plurality of magnetic and gravitational measurements are sent by telemetry to a surface processor and the surface processor is adapted to perform steps (b), (c), (d) and (e).</claim-text>
    </claim>
    <claim num="3">
      <claim-text>3. The method of claim 1 further comprising obtaining a quantitative estimate of the accuracy the determination of at least one of (i) an azimuth at said selected locations, and, (ii) a position of the borehole at said selected locations.</claim-text>
    </claim>
    <claim num="4">
      <claim-text>4. The method of claim 1 wherein the model includes one or more parameters selected from (i) a bias in at least one component of the gravity measurements, (ii) a bias in at least one component of the magnetic measurements, (iii) a scale factor for the gravity measurements, (iv) a scale factor for the magnetic measurements, (v) a misalignment of a sensor making the gravity measurements, and (vi) a misalignment of sensor making the magnetic measurements.</claim-text>
    </claim>
    <claim num="5">
      <claim-text>5. The method of claim 1 wherein determining the model parameter includes one or more parameters selected from (i) a bias in at least one component of the gravity measurements, (ii) a scale factor for the gravity measurements, and, (iii) a misalignment of a sensor used to make the gravity measurements, to give a subset of determined model parameters, the method further comprising using the subset of determined model parameters to obtain additional model parameters selected from (A) a bias for at least one component of the magnetic measurements(B) a scale factor for the magnetic measurements, and (C) a misalignment of a sensor used for making the magnetic measurements.</claim-text>
    </claim>
    <claim num="6">
      <claim-text>6. The method of claim 1 further comprising providing an onsite monitoring of the local magnetic field of the earth to give said reference values.</claim-text>
    </claim>
    <claim num="7">
      <claim-text>7. The method of claim 1 further comprising monitoring the magnetic field of the earth at a location away from the wellsite to give said reference values.</claim-text>
    </claim>
    <claim num="8">
      <claim-text>8. The method of claim 1 wherein said reference values further comprise at least one independent measurement selected from (i) a component of the gravitational field, and (ii) a component of the magnetic field.</claim-text>
    </claim>
    <claim num="9">
      <claim-text>9. The method of claim 1 wherein said reference values are averages of said plurality of said transformed corrected measurements.</claim-text>
    </claim>
    <claim num="10">
      <claim-text>10. The method of claim 1 further comprising determining a variation in the values for the set of model parameters over a period of time to determine any deterioration in sensors making the plurality of measurements.</claim-text>
    </claim>
  </claims>
</questel-patent-document>